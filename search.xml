<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Access数据导出到MySQL</title>
    <url>/2021/12/01/Access%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E5%88%B0MySQL/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、安装MySQL的ODBC驱动"><a href="#一、安装MySQL的ODBC驱动" class="headerlink" title="一、安装MySQL的ODBC驱动"></a>一、安装<code>MySQL</code>的<code>ODBC</code>驱动</h1><p><a href="https://dev.mysql.com/downloads/connector/odbc/">MySQL Community Downloads Connector/ODBC下载地址</a><br>根据<code>access</code>版本选择<code>32位</code>或者<code>64位</code>,完成安装。  </p>
<h1 id="二、导出Access表到MySQL"><a href="#二、导出Access表到MySQL" class="headerlink" title="二、导出Access表到MySQL"></a>二、导出<code>Access</code>表到<code>MySQL</code></h1><h2 id="1、打开Access-在Access中右键选择要导出的表。"><a href="#1、打开Access-在Access中右键选择要导出的表。" class="headerlink" title="1、打开Access,在Access中右键选择要导出的表。"></a>1、打开<code>Access</code>,在<code>Access</code>中右键选择要导出的表。</h2><p>依次选择<code>导出</code>—&gt;<code>ODBC数据库</code>—&gt;<code>确定</code>—&gt;<code>机器源数据</code>—&gt;<code>确定</code>—&gt;<code>用户数据源</code>—&gt;<code>下一页</code>—&gt;<code>MySQL ODBC 8.0 Unicode Driver</code>—&gt;<code>完成</code>。如图：<br><img src="\pic\2021\12\access2mysql-1.png" alt="access2mysql-1.png"><br><img src="\pic\2021\12\access2mysql-2.png" alt="access2mysql-2.png"><br><img src="\pic\2021\12\access2mysql-3.png" alt="access2mysql-3.png"><br>在弹窗里根据自己情况填入如图数据：<br><img src="\pic\2021\12\access2mysql-4.png" alt="access2mysql-4.png"></p>
<h1 id="三、进入MySQL查看数据"><a href="#三、进入MySQL查看数据" class="headerlink" title="三、进入MySQL查看数据"></a>三、进入<code>MySQL</code>查看数据</h1><p>进入<code>MySQL</code>查看导入的数据：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\Users\XXX&gt; mysql -u用户名 -p study_test</span><br><span class="line">Enter password: ******</span><br><span class="line">...</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+----------------------+</span><br><span class="line">| Tables_in_study_test |</span><br><span class="line">+----------------------+</span><br><span class="line">| stuinfo              |</span><br><span class="line">| usr_score_table      |</span><br><span class="line">| usr_table            |</span><br><span class="line">+----------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select count(*) from stuinfo;</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|      451 |</span><br><span class="line">+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure><br>如图所示：<br><img src="\pic\2021\12\access2mysql-5.png" alt="access2mysql-5.png"></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>Access</category>
        <category>运维</category>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>数据导出</tag>
        <tag>Access</tag>
        <tag>数据库</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Apt升级提示dpkg error processing package libc-bin错误解决办法</title>
    <url>/2021/07/01/Apt%E5%8D%87%E7%BA%A7%E6%8F%90%E7%A4%BAdpkg%20error%20processing%20package%20libc-bin%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>用<code>apt</code>工具进行安装或卸载时提示“<code>dpkg: error processing package libc-bin (--configure)</code>”错误。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dpkg: error processing package libc-bin (--configure):</span><br><span class="line"> installed libc-bin package post-installation script subprocess returned error <span class="built_in">exit</span> status 134</span><br><span class="line">Errors were encountered <span class="keyword">while</span> processing:</span><br><span class="line"> libc-bin</span><br><span class="line">E: Sub-process /usr/bin/dpkg returned an error code (1)</span><br></pre></td></tr></table></figure></p>
<p>以下是解决办法    </p>
<h1 id="1-登录root账户"><a href="#1-登录root账户" class="headerlink" title="1.登录root账户"></a>1.登录<code>root</code>账户</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(yk㉿yk-pc)-[~]</span><br><span class="line">└─$ sudo su                                         <span class="comment"># 切换到root用户</span></span><br></pre></td></tr></table></figure>
<h1 id="2-运行一下命令"><a href="#2-运行一下命令" class="headerlink" title="2.运行一下命令"></a>2.运行一下命令</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># mv /var/lib/dpkg/info/ /var/lib/dpkg/info_old/   # 备份保存的各个软件包的配置文件列表</span></span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># mkdir /var/lib/dpkg/info/                        # 新建保存的各个软件包的配置文件列表文件夹</span></span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># apt update                                       # 重新获取软件包列表</span></span><br><span class="line">Hit:1 http://mirrors.neusoft.edu.cn/kali kali-rolling InRelease</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree... Done</span><br><span class="line">Reading state information... Done</span><br><span class="line">20 packages can be upgraded. Run <span class="string">&#x27;apt list --upgradable&#x27;</span> to see them.</span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># apt -f install                                   # 尝试修正系统依赖损坏处 </span></span><br><span class="line"> <span class="comment"># 以下内容省略</span></span><br><span class="line"> <span class="comment"># ......</span></span><br><span class="line"> <span class="comment"># ......</span></span><br><span class="line"> <span class="comment"># ......</span></span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># mv /var/lib/dpkg/info/* /var/lib/dpkg/info_old/  # 备份保存的各个软件包的配置文件列表</span></span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># rm -rf /var/lib/dpkg/info                        # 删除各个软件包的配置文件列表文件</span></span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># mv /var/lib/dpkg/info_old/ /var/lib/dpkg/info    # 重新恢复保存的各个软件包的配置文件列表文件</span></span><br></pre></td></tr></table></figure>
<h1 id="3-验证是否成功"><a href="#3-验证是否成功" class="headerlink" title="3.验证是否成功"></a>3.验证是否成功</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># apt -f install                                    # 尝试修正系统依赖损坏处 </span></span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree... Done</span><br><span class="line">Reading state information... Done</span><br><span class="line">0 upgraded, 0 newly installed, 0 to remove and 20 not upgraded.</span><br></pre></td></tr></table></figure>
<h1 id="4-重新升级"><a href="#4-重新升级" class="headerlink" title="4.重新升级"></a>4.重新升级</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root💀yk-pc)-[/home/yk]                         </span><br><span class="line">└─$ apt upgrade                                        <span class="comment"># 重新获取软件包列表</span></span><br><span class="line">┌──(root💀yk-pc)-[/home/yk]</span><br><span class="line">└─<span class="comment"># apt upgrade -y                                     # 更新软件包列表</span></span><br></pre></td></tr></table></figure>
<h1 id="5-参考资料"><a href="#5-参考资料" class="headerlink" title="5.参考资料"></a>5.参考资料</h1><p><a href="https://www.cnblogs.com/live41/p/14237280.html">dpkg: error processing package xxx (—configure)的解决方法</a></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Linux</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Apt</tag>
        <tag>问题解决</tag>
        <tag>Error</tag>
      </tags>
  </entry>
  <entry>
    <title>Aria2在windows10下的配置</title>
    <url>/2020/11/05/Aria2%E5%9C%A8window10%E4%B8%8B%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、aria2设置aira2-conf文件"><a href="#1、aria2设置aira2-conf文件" class="headerlink" title="1、aria2设置aira2.conf文件"></a>1、<code>aria2</code>设置<code>aira2.conf</code>文件</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#下载文件默认保存路径</span><br><span class="line">&lt;code&gt;dir=F:\MyDownload\Aria2\</span><br><span class="line">### 日志文件保存路径及级别，可选 debug, info, notice, warn, error 。默认：debug</span><br><span class="line">log=E:\Aria2\aria2.log</span><br><span class="line">log-level=error</span><br><span class="line"># 从会话中读取任务</span><br><span class="line">input-file=E:\Aria2\aria2.session</span><br><span class="line"># 在Aria2退出时保存`错误/未完成`的下载任务到会话文件</span><br><span class="line">save-session=E:\Aria2\aria2.session</span><br><span class="line">#配置dht.dat文件存放位置</span><br><span class="line">dht-file-path=E:\Aria2\dht.dat&lt;/code&gt;</span><br><span class="line"># 定时保存会话, 0为退出时才保存, 需1.16.1以上版本, 默认:0</span><br><span class="line">save-session-interval=60</span><br><span class="line"># 强制保存会话, 即使任务已经完成, 默认:false</span><br><span class="line"># 较新的版本开启后会在任务完成后依然保留.aria2文件</span><br><span class="line">force-save=true</span><br><span class="line"></span><br><span class="line"># 下载选项</span><br><span class="line"># 最大同时下载任务数, 运行时可修改, 默认:5</span><br><span class="line">max-concurrent-downloads=5</span><br><span class="line"># 断点续传</span><br><span class="line">continue=true</span><br><span class="line"># 整体下载速度限制, 运行时可修改, 默认:0 </span><br><span class="line">max-overall-download-limit=5M</span><br><span class="line"># 单个任务下载速度限制, 默认:0</span><br><span class="line">max-download-limit=10M</span><br><span class="line"># 整体上传速度限制, 运行时可修改, 默认:0</span><br><span class="line">max-overall-upload-limit=1K</span><br><span class="line"># 单个任务上传速度限制, 默认:0</span><br><span class="line">max-upload-limit=1K</span><br><span class="line"></span><br><span class="line"># Http/FTP 选项</span><br><span class="line"># 连接超时，建立链接后失效</span><br><span class="line">connect-timeout=120</span><br><span class="line"># 最小速度限制</span><br><span class="line"># 当下载速度低于此选项设置的值(B/s) 时将会关闭连接. 0 表示不设置最小速度限制. </span><br><span class="line">lowest-speed-limit=1K</span><br><span class="line"># 同一服务器连接数, 添加时可指定, 默认:1,范围1-16</span><br><span class="line">max-connection-per-server=15</span><br><span class="line"># 文件未找到重试次数</span><br><span class="line"># 设置为 0 将会禁用此选项</span><br><span class="line">max-file-not-found=0</span><br><span class="line"># 最小文件分片大小, 添加时可指定, 取值范围1M -1024M, 默认:20M</span><br><span class="line"># 假定size=10M, 文件为20MiB 则使用两个来源下载; 文件为15MiB 则使用一个来源下载</span><br><span class="line">min-split-size=10M</span><br><span class="line"># 单个任务最大线程数, 添加时可指定, 默认:5</span><br><span class="line">split=5</span><br><span class="line"># 检查证书</span><br><span class="line">check-certificate=false</span><br><span class="line"># 禁用缓存</span><br><span class="line">http-no-cache=true</span><br><span class="line"># 磁盘缓存</span><br><span class="line"># 如果设置为 0, 将禁用磁盘缓存. 此功能将下载的数据缓存在内存中</span><br><span class="line"># 最多占用此选项设置的字节数. </span><br><span class="line">disk-cache=32M</span><br><span class="line"># FTP Specific Options</span><br><span class="line"></span><br><span class="line"># BT/PT Setting</span><br><span class="line"># 本地节点查找, PT需要禁用, 默认:false</span><br><span class="line">bt-enable-lpd=true</span><br><span class="line">#最大连接节点数</span><br><span class="line">#设置每个BT下载的最大连接节点数. 0 表示不限制.</span><br><span class="line">bt-max-peers=100</span><br><span class="line"># 自动BT任务</span><br><span class="line">follow-torrent=true</span><br><span class="line"></span><br><span class="line"># 启用 DHT (IPv6)</span><br><span class="line"># 启用 IPv6 DHT 功能. 如果种子设置为私有, 即使此选项设置为&quot;是&quot;, aria2 也不会启用</span><br><span class="line">enable-dht6=true</span><br><span class="line">enable-dht=true</span><br><span class="line">dht-listen-port=6881-6999</span><br><span class="line"></span><br><span class="line"># 不检查已经下载的文件</span><br><span class="line"># 不检查之前下载文件中每个分片的哈希值.</span><br><span class="line">bt-seed-unverified=false</span><br><span class="line"># 做种前检查文件哈希</span><br><span class="line"># 如果设置为&quot;是&quot;, 当使用 --check-integrity 选项完成哈希检查及文件完成后才继续做种. 如果您希望仅当文件损坏或未完成时检查文件, 请设置为&quot;否&quot;. 此选项仅对 BT 下载有效</span><br><span class="line">bt-hash-check-seed=false</span><br><span class="line"># 保存上传的种子文件</span><br><span class="line">rpc-save-upload-metadata=true</span><br><span class="line"># 删除未选择的文件</span><br><span class="line"># 当 BT 任务完成后删除未选择的文件. 要选择需要下载的文件, 请使用 --select-file选项. </span><br><span class="line"># 如果没有选择, 则所有文件都默认为需要下载. 此选项会从磁盘上直接删除文件, </span><br><span class="line"># 请谨慎使用此选项.</span><br><span class="line">bt-remove-unselected-file=false</span><br><span class="line"># 每个种子限速, 对少种的PT很有用, 默认:50K</span><br><span class="line">bt-request-peer-speed-limit=2M</span><br><span class="line">#做种时间</span><br><span class="line">seed-time=0</span><br><span class="line">#优先下载</span><br><span class="line">bt-prioritize-piece=head=10M</span><br><span class="line"># 当种子的分享率达到这个数时, 自动停止做种, 0为一直做种, 默认:1.0</span><br><span class="line">seed-ratio=1.0</span><br><span class="line"></span><br><span class="line"># Metalink Specific Options</span><br><span class="line"># RPC Options</span><br><span class="line"># 启用RPC, 默认:false</span><br><span class="line">enable-rpc=true</span><br><span class="line"># 种子文件下载完后暂停</span><br><span class="line">pause-metadata=false</span><br><span class="line"></span><br><span class="line">#种子交换, PT需要禁用, 默认:true</span><br><span class="line">enable-peer-exchange=true</span><br><span class="line"># 允许所有来源, 默认:false</span><br><span class="line">rpc-allow-origin-all=true</span><br><span class="line"># 允许非外部访问, 默认:false</span><br><span class="line">rpc-listen-all=true</span><br><span class="line">#保存上传的种子文件</span><br><span class="line">rpc-save-upload-metadata=true</span><br><span class="line"># 启用加密后 RPC 服务需要使用 https 或者 wss 协议连接</span><br><span class="line">rpc-secure=false</span><br><span class="line"></span><br><span class="line"># Advanced Options</span><br><span class="line">#启用后台进程</span><br><span class="line">daemon=true</span><br><span class="line"># 禁用IPV6，默认：false</span><br><span class="line">disable-ipv6=true</span><br><span class="line"># 启用 MMap</span><br><span class="line"># 内存中存放映射文件. 当文件空间没有预先分配至, 此选项无效. 参见 --file-allocation.</span><br><span class="line">enable-mmap=true</span><br><span class="line"># 文件分配方法  </span><br><span class="line"># &quot;prealloc&quot;会在下载开始前预先分配空间.</span><br><span class="line"># ext4 (带扩展支持), btrfs, xfs 或 NTFS (仅 MinGW 构建), &quot;falloc&quot; 是最好的选择</span><br><span class="line">file-allocation=falloc </span><br><span class="line">#最多下载结果 下载结果包括已完成/错误/已删除的下载</span><br><span class="line">max-download-result=30</span><br><span class="line"># 文件分配限制</span><br><span class="line"># 不对比此参数设置大小小的分配文件. 您可以增加数值的单位 K 或 M </span><br><span class="line">#no-file-allocation-limit=32M</span><br><span class="line"># 强制顺序</span><br><span class="line">force-sequential=true</span><br><span class="line"># 启用参数化 URI 支持</span><br><span class="line"># 您可以指定部分的集合: http://&#123;sv1,sv2,sv3&#125;/foo.iso. </span><br><span class="line"># 同时您也可以使用步进计数器指定数字化的序列: http://host/image[000-100:2].img. </span><br><span class="line"># [需使用 -z 选项]</span><br><span class="line"># 步进计数器可以省略.</span><br><span class="line">parameterized-uri=true</span><br><span class="line">#延迟加载</span><br><span class="line">deferred-input=true</span><br><span class="line"></span><br><span class="line"># bt-tracker=BT服务器（多个服务器之间用,分开）</span><br><span class="line">bt-tracker=udp://tracker.coppersurfer.tk:6969/announc,udp://tracker.leechers-paradise.org:6969/announc,udp://tracker.opentrackr.org:1337/announc,udp://p4p.arenabg.com:1337/announc,udp://9.rarbg.to:2710/announc,udp://9.rarbg.me:2710/announc,udp://exodus.desync.com:6969/announc,udp://tracker.pomf.se:80/announc,udp://tracker.openbittorrent.com:80/announc,udp://tracker.tiny-vps.com:6969/announc,udp://open.stealth.si:80/announc,udp://denis.stalker.upeer.me:6969/announc,udp://tracker.torrent.eu.org:451/announc,udp://tracker.moeking.me:6969/announc,udp://tracker.cyberia.is:6969/announc,udp://ipv4.tracker.harry.lu:80/announc,udp://tracker3.itzmx.com:6961/announc,udp://open.demonii.si:1337/announc,udp://explodie.org:6969/announc,udp://valakas.rollo.dnsabr.com:2710/announe</span><br><span class="line"></span><br><span class="line">## 执行额外命令 ##</span><br><span class="line"></span><br><span class="line"># 下载停止后执行的命令</span><br><span class="line"># 从 正在下载 到 删除、错误、完成 时触发。暂停被标记为未开始下载，故与此项无关。</span><br><span class="line">on-download-stop=/etc/aria2/delete.sh</span><br><span class="line"></span><br><span class="line"># 下载完成后执行的命令</span><br><span class="line"># 此项未定义则执行 下载停止后执行的命令 (on-download-stop)</span><br><span class="line">on-download-complete=/etc/aria2/clean.sh</span><br><span class="line"></span><br><span class="line"># 下载错误后执行的命令</span><br><span class="line"># 此项未定义则执行 下载停止后执行的命令 (on-download-stop)</span><br><span class="line">#on-download-error=</span><br><span class="line"></span><br><span class="line"># 下载暂停后执行的命令</span><br><span class="line">#on-download-pause=</span><br><span class="line"></span><br><span class="line"># 下载开始后执行的命令</span><br><span class="line">#on-download-start=</span><br><span class="line"></span><br><span class="line"># BT 下载完成后执行的命令</span><br><span class="line">#on-bt-download-complete=</span><br><span class="line"></span><br><span class="line">#注意修改aria2.conf文件中以下选项：</span><br><span class="line">#下载文件保存路径，改为你想要的</span><br><span class="line">#dir=D:\MyDownload\aria2\</span><br><span class="line"># 日志文件，路径D:\aria2\，改为你安装aria2的路径</span><br><span class="line">&lt;code&gt;#log=D:\aria2\aria2.log</span><br><span class="line">#input-file=D:\aria2\aria2.session</span><br><span class="line">#save-session=D:\aria2\aria2.session&lt;/code&gt;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/P3TERX/aria2.conf">一键安装及配置开源项目地址：</a></p>
<h1 id="2、aria2开机启动设置"><a href="#2、aria2开机启动设置" class="headerlink" title="2、aria2开机启动设置"></a>2、<code>aria2</code>开机启动设置</h1><p>创建一个<code>Start.vbs</code>，内容如下，将其快捷方式或者直接复制<code>start.vbs</code>，放到<code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>路径下即可。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">CreateObject(<span class="string">&quot;wscript.shell&quot;</span>).Run  <span class="string">&quot;D:\Programs\Aria2\aria2c.exe --conf-path=D:\Programs\Aria2\aria2.conf&quot;</span>,0</span><br></pre></td></tr></table></figure><br>或者下面的<code>vbs</code>批处理命令<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># currentpath = createobject(&quot;Scripting.FileSystemObject&quot;).GetFile(Wscript.ScriptFullName).ParentFolder.Path</span></span><br><span class="line">currentpath = createobject(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>).GetFolder(<span class="string">&quot;.&quot;</span>).Path</span><br><span class="line">CreateObject(<span class="string">&quot;wscript.shell&quot;</span>).Run  currentpath+<span class="string">&quot;\aria2c.exe --conf-path=aria2.conf&quot;</span>,0</span><br></pre></td></tr></table></figure></p>
<h1 id="3、-更新trackers批处理命令"><a href="#3、-更新trackers批处理命令" class="headerlink" title="3、 更新trackers批处理命令"></a>3、 更新<code>trackers</code>批处理命令</h1><h2 id="（1）powershell下运行新建trackersList-psl的批处理文件，输入以下内容"><a href="#（1）powershell下运行新建trackersList-psl的批处理文件，输入以下内容" class="headerlink" title="（1）powershell下运行新建trackersList.psl的批处理文件，输入以下内容"></a>（1）<code>powershell</code>下运行新建<code>trackersList.psl</code>的批处理文件，输入以下内容</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;aria2.conf位置、要下载的trackers文件，在这里修改</span><br><span class="line">$ConfigFile = &quot;D:\Programs\Aria2\aria2.conf&quot;</span><br><span class="line">$TrackersFile = &quot;trackers_best.txt&quot;</span><br><span class="line">$DownloadLink = &quot;https://raw.githubusercontent.com/ngosang/trackerslist/master/$TrackersFile&quot;</span><br><span class="line"></span><br><span class="line">Invoke-WebRequest -Uri $DownloadLink -OutFile $env:TEMP\$TrackersFile</span><br><span class="line"></span><br><span class="line">$TrackersStream = (Get-Content $env:TEMP\$TrackersFile -Raw).Replace(&quot;`n`n&quot;, &quot;,&quot;).Insert(0, &quot;bt-tracker=&quot;)</span><br><span class="line">$TrackersStream = $TrackersStream.Substring(0, $TrackersStream.Length - 1)</span><br><span class="line"></span><br><span class="line">$ExcludeLineNum=(Select-String -Path $ConfigFile -SimpleMatch &quot;bt-tracker=&quot;).LineNumber</span><br><span class="line">$ConfigStream = Get-Content $ConfigFile</span><br><span class="line">$ConfigStream[$ExcludeLineNum-1]=$TrackersStream</span><br><span class="line">Set-Content -Path $ConfigFile -Value $ConfigStream -Encoding Default</span><br><span class="line"></span><br><span class="line">Remove-Item -Path $env:TEMP\trackers*</span><br></pre></td></tr></table></figure>
<p>【ps版本运行会出错，待解决】或者 <code>cmd</code> 下运行新建<code>trackersList.bat</code>的批处理文件，<code>trackersList.bat</code>输入以下内容<br><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line">:: aria2.conf位置、要下载的trackers文件，在这里修改</span><br><span class="line">::<span class="built_in">set</span> CONF_FILE=<span class="variable">%USERPROFILE%</span>\.aria2\aria2.conf</span><br><span class="line"><span class="built_in">set</span> CONF_FILE=E:\Aria2\aria2.conf</span><br><span class="line"><span class="built_in">set</span> TRACKER_FILE=trackers_best.txt</span><br><span class="line"><span class="built_in">set</span> DOWNLOAD_LINK=https://raw.githubusercontent.com/ngosang/trackerslist/master/<span class="variable">%TRACKER_FILE%</span></span><br><span class="line"></span><br><span class="line">::下载 trackerlist</span><br><span class="line">::aria2c --<span class="built_in">dir</span>=<span class="variable">%TEMP%</span> --allow-overwrite=true &quot;<span class="variable">%DOWNLOAD_LINK%</span>&quot;</span><br><span class="line">aria2c --<span class="built_in">dir</span>=%~dp0 --allow-overwrite=true &quot;<span class="variable">%DOWNLOAD_LINK%</span>&quot;</span><br><span class="line"></span><br><span class="line">::用 sed 整理 trackerlist 格式</span><br><span class="line">sed.exe -i &quot;:a;N;s/\n/ /; ta;&quot; <span class="variable">%~dp0%</span>TRACKER_FILE%</span><br><span class="line">sed.exe -i &quot;<span class="number">1</span>s/^/bt-tracker=/g; s/  /,/g; s/ $//;&quot; <span class="variable">%~dp0%</span>TRACKER_FILE%</span><br><span class="line"></span><br><span class="line">::删除当前 aria2 配置 中的 trackerlist</span><br><span class="line">sed.exe -i &quot;/^bt-tracker=/d&quot; <span class="variable">%CONF_FILE%</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> <span class="variable">%~dp0%</span>TRACKER_FILE% &gt;&gt; <span class="variable">%CONF_FILE%</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">del</span> .\sed*</span><br><span class="line"><span class="built_in">del</span> .\trackers_best.txt</span><br></pre></td></tr></table></figure><br>①需要安装<code>sed.exe</code>，安装<code>git</code>,<a href="https://git-scm.com/download/win">git下载地址</a>后自带<code>sed.exe</code>程序文件,安装完成后（32位路径）如：<code>E:\Program Files\Git\usr\bin</code><br>【或者单独下载windows系统下的<code>sed</code> 软件，需要下载以下两个链接的文件，<strong>解压到同一文件夹</strong>，<code>Bin</code> 文件内的 <code>sed.exe</code> 和 <code>dll</code> 不能删除。<br><a href="https://sourceforge.net/projects/gnuwin32/files/sed/4.2.1/sed-4.2.1-bin.zip/download">sed-4.2.1-bin</a><br><a href="https://sourceforge.net/projects/gnuwin32/files/sed/4.2.1/sed-4.2.1-dep.zip/download">sed-4.2.1-dep</a>】<br>②将<code>sed.exe</code>加入到环境变量方法：<code>运行</code>→<code>sysdm.cpl</code>→<code>高级</code>→<code>环境变量</code>→<code>用户环境变量里面  选中“path”</code>→<code>编辑</code>→<code>新建</code>→<code>E:\Program Files\Git\usr\bin</code>  </p>
<p>参考：<br><a href="https://www.dazhuanlan.com/sparrow1998/topics/989486">Aria2 Tracker 更新脚本</a><br><a href="https://meta.appinn.net/t/topic/9086">Aria2 bt-tracker自动更新脚本</a></p>
<h2 id="（2）利用python更新"><a href="#（2）利用python更新" class="headerlink" title="（2）利用python更新"></a>（2）利用<code>python</code>更新</h2><p>新建<code>trackerslist.py</code>文件，输入以下内容<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2021-06-04 15:29:54</span></span><br><span class="line"><span class="comment"># @Author  : KY (owenyk@g.com)</span></span><br><span class="line"><span class="comment"># @Link    : http://example.org</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PepTrader &amp; PepCoder</span></span><br><span class="line"><span class="comment"># 一切从兴趣开始...</span></span><br><span class="line"><span class="comment"># It all starts with interests...</span></span><br><span class="line"><span class="comment"># I am PepCoder</span></span><br><span class="line"><span class="comment"># This is a Windows version of BT Trackers Updater via Python 3.6.6</span></span><br><span class="line"><span class="comment"># Original work belongs to @zmr, you can find his original work at</span></span><br><span class="line"><span class="comment"># 最初代码源来自于 @zmr，您可以在以下网址找到其最初的作品版本</span></span><br><span class="line"><span class="comment"># https://gitee.com/Zero_gitee/UpdateTrackers</span></span><br><span class="line"><span class="comment"># Trackers的代码源是来自于： https://github.com/XIU2/TrackersListCollection</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#--------- 安装库------------#</span></span><br><span class="line"><span class="comment"># PS E:\Aria2&gt; pip3 install bs4</span></span><br><span class="line"><span class="comment"># PS E:\Aria2&gt; pip install lxml</span></span><br><span class="line"><span class="comment"># PS E:\Aria2&gt; pip install requests</span></span><br><span class="line"><span class="comment"># PS E:\Aria2&gt; pip install html5lib</span></span><br><span class="line"><span class="comment">#---------------------------#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局配置：</span></span><br><span class="line"><span class="comment"># url_trackers_best = &quot;https://trackerslist.com/all.txt&quot;  # 这个是普通版的，可以用在其它BT用户端上</span></span><br><span class="line">url_trackers_best = <span class="string">&quot;https://trackerslist.com/best.txt&quot;</span>  <span class="comment"># 这个是aria2友好版，为aria2专门设计的</span></span><br><span class="line">aria2_config = <span class="string">&quot;D:\\Programs\\Aria2\\aria2.conf&quot;</span>    <span class="comment"># 设定好您的aira2所在位置，因为每个人放aria2的文件夹都不一样。</span></span><br><span class="line">logFile = os.path.join(os.path.dirname(os.path.abspath(__file__)), <span class="string">&#x27;logger.log&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置日志参数</span></span><br><span class="line">logging.basicConfig(filename=logFile,</span><br><span class="line">                    <span class="built_in">format</span>=<span class="string">&quot;%(asctime)s \n%(message)s&quot;</span>,</span><br><span class="line">                    datefmt=<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,</span><br><span class="line">                    filemode=<span class="string">&#x27;w&#x27;</span>,</span><br><span class="line">                    level=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log</span>(<span class="params">level, message</span>):</span><br><span class="line">    <span class="string">&quot;写日志&quot;</span></span><br><span class="line">    logging.log(level, message)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getTrackers</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="string">&quot;更新Trackers&quot;</span></span><br><span class="line">    t = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime())</span><br><span class="line">    log(logging.DEBUG, <span class="string">&quot;更新Trackers【开始】&#123;0&#125;\n url = &#123;1&#125;&quot;</span>.<span class="built_in">format</span>(t, url))</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 获取最新数据</span></span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) &#x27;</span></span><br><span class="line">                          <span class="string">&#x27;AppleWebKit/537.36 (KHTML, like Gecko) &#x27;</span></span><br><span class="line">                          <span class="string">&#x27;Chrome/67.0.3396.99 Safari/537.36&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.get(url, headers=headers).content</span><br><span class="line">        soup = bs4.BeautifulSoup(response, <span class="string">&#x27;html5lib&#x27;</span>)  <span class="comment"># 解析</span></span><br><span class="line">        all_trackers = soup.find(name=<span class="string">&#x27;body&#x27;</span>).get_text().replace(<span class="string">&quot;\n\n&quot;</span>,<span class="string">&quot;,&quot;</span>)  <span class="comment"># 复制</span></span><br><span class="line">        <span class="built_in">print</span>(all_trackers)</span><br><span class="line">        log(logging.DEBUG, <span class="string">&quot;更新Trackers【结束】&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(all_trackers))</span><br><span class="line">        <span class="keyword">return</span> all_trackers</span><br><span class="line">    <span class="keyword">except</span> BaseException <span class="keyword">as</span> e:</span><br><span class="line">        log(logging.ERROR, <span class="string">&quot;更新Trackers【异常】&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_config</span>(<span class="params">all_trackers</span>):</span><br><span class="line">    <span class="string">&quot;更新aria2.conf文件 bt-tracker=best_tracker&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        btTrackerIndex = -<span class="number">1</span></span><br><span class="line">        cfgList = <span class="built_in">list</span>()</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(aria2_config, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf8&#x27;</span>) <span class="keyword">as</span> cfgFile:</span><br><span class="line">            lines = cfgFile.readlines()</span><br><span class="line">            cfgList = <span class="built_in">list</span>(lines)</span><br><span class="line">            <span class="built_in">print</span>(cfgList)</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> cfgList:</span><br><span class="line">                <span class="keyword">if</span> line.startswith(<span class="string">&quot;bt-tracker=&quot;</span>):  <span class="comment"># 在.conf里遍历寻找这一行设置</span></span><br><span class="line">                    btTrackerIndex = cfgList.index(line)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> btTrackerIndex &gt;= <span class="number">0</span>:</span><br><span class="line">                cfgList.pop(btTrackerIndex)</span><br><span class="line">                <span class="keyword">if</span> btTrackerIndex - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> cfgList[btTrackerIndex - <span class="number">1</span>].startswith(<span class="string">&quot;#更新于&quot;</span>):</span><br><span class="line">                    cfgList.pop(btTrackerIndex - <span class="number">1</span>)</span><br><span class="line">                    btTrackerIndex = btTrackerIndex - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                btTrackerIndex = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        cfgList.insert(btTrackerIndex, <span class="string">&quot;bt-tracker=&quot;</span>+all_trackers+<span class="string">&quot;\n&quot;</span>)  <span class="comment"># 覆盖写入更新内容</span></span><br><span class="line">        update_time = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime())</span><br><span class="line">        cfgList.insert(btTrackerIndex, <span class="string">&quot;#更新于&quot;</span>+update_time+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\Programs\\Aria2\\aria2.conf&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf8&#x27;</span>) <span class="keyword">as</span> cfgFile:  <span class="comment"># 存储</span></span><br><span class="line">            cfgFile.writelines(cfgList)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> BaseException <span class="keyword">as</span> e:</span><br><span class="line">        log(logging.ERROR, <span class="string">&quot;更新aria2.conf文件【异常】&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reset_config</span>():</span><br><span class="line">    <span class="string">&quot;aria2c --conf-path=D:\Programs\Aria2\aria2.conf&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        os.system(<span class="string">&quot;aria2c.exe --conf-path=&quot;</span> + aria2_config)</span><br><span class="line">    <span class="keyword">except</span> BaseException <span class="keyword">as</span> e:</span><br><span class="line">        log(logging.ERROR, <span class="string">&quot;重新载入配置文件【异常】&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置日志输出级别</span></span><br><span class="line">logger = logging.getLogger()</span><br><span class="line">logger.setLevel(logging.ERROR)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始更新操作</span></span><br><span class="line">log(logging.DEBUG, <span class="string">&quot;开始更新操作【开始】&quot;</span>)</span><br><span class="line">all_trackers = getTrackers(url_trackers_best)</span><br><span class="line">update_config(all_trackers)</span><br><span class="line">reset_config()</span><br><span class="line">log(logging.DEBUG, <span class="string">&quot;开始更新操作【结束】\n&quot;</span>)</span><br></pre></td></tr></table></figure><br>trackerlist的开源项目：<br><a href="https://github.com/XIU2/TrackersListCollection/blob/master/README-ZH.md">XIU2/TrackersListCollection</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Aria2</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Aria2</tag>
        <tag>TrackersList</tag>
      </tags>
  </entry>
  <entry>
    <title>Asp操作MsSQL数据库</title>
    <url>/2020/11/05/Asp%E6%93%8D%E4%BD%9CMsSQL%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>asp查询页面</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;%@LANGUAGE=&quot;VBSCRIPT&quot; CODEPAGE=&quot;65001&quot;%&gt;</span><br><span class="line">&lt;!--#include virtual=&quot;/conn.asp&quot; --&gt;</span><br><span class="line">&lt;%Session.CodePage=65001%&gt;</span><br><span class="line">response.expires=-1</span><br><span class="line">user = trim(request.querystring(&quot;name&quot;))</span><br><span class="line">if user = &quot;&quot; then</span><br><span class="line">    response.write escape(&quot;&lt;font style=&quot;&quot;color:red&quot;&quot;&gt;姓名或学员ID不能为空格！&lt;/font&gt;&quot;)</span><br><span class="line">    response.End()</span><br><span class="line">end if</span><br><span class="line">sql = &quot;select * from students where usrname =&#x27;&quot;&amp;user&amp;&quot;&#x27; or usr_ID=&#x27;&quot;&amp;user&amp;&quot;&#x27;&quot;</span><br><span class="line">&#x27;sql = sql &amp;&quot;&#x27;&quot;&amp; request.querystring(&quot;name&quot;) &amp;&quot;&#x27;&quot;</span><br><span class="line">&#x27;使用sql对conn进行查询，后面的参数代表我要完全操作这个数据库</span><br><span class="line">Set rs = Server.CreateObject( &quot;ADODB.Recordset&quot; )</span><br><span class="line">rs.open sql,conn,1,1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>js处理页面</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createAjax</span>(<span class="params"></span>) &#123;<span class="comment">//该函数将返回XMLHTTP对象实例</span></span><br><span class="line"><span class="keyword">var</span> _xmlhttp; </span><br><span class="line"><span class="keyword">try</span> &#123; </span><br><span class="line">    _xmlhttp=<span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line"><span class="keyword">catch</span> (e) &#123; </span><br><span class="line"><span class="keyword">try</span> &#123; </span><br><span class="line">    _xmlhttp=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); </span><br><span class="line"> &#125; </span><br><span class="line"><span class="keyword">catch</span> (e) &#123; </span><br><span class="line">    _xmlhttp=<span class="literal">false</span>; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> _xmlhttp; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkname</span>(<span class="params">name</span>) &#123; <span class="comment">//该函数用来获取数据 用户名//alert(idname)</span></span><br><span class="line"><span class="keyword">var</span> xmlhttp1=<span class="title function_">createAjax</span>();</span><br><span class="line"><span class="keyword">if</span> (xmlhttp1) &#123;</span><br><span class="line">    <span class="keyword">var</span> span=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;check&#x27;</span>); <span class="comment">// 获取显示节点  </span></span><br><span class="line">    xmlhttp1.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;checkname.asp?name=&#x27;</span>+name+<span class="string">&#x27;&amp;n=&#x27;</span>+<span class="title class_">Math</span>.<span class="title function_">random</span>(),<span class="literal">true</span>);   </span><br><span class="line">    xmlhttp1.<span class="property">onreadystatechange</span>=<span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line">    <span class="keyword">if</span> (xmlhttp1.<span class="property">readyState</span>==<span class="number">4</span> &amp;&amp; xmlhttp1.<span class="property">status</span>==<span class="number">200</span>)&#123;</span><br><span class="line">        span.<span class="property">innerHTML</span>=<span class="built_in">unescape</span>(xmlhttp1.<span class="property">responseText</span>);</span><br><span class="line">          &#125;    </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        span.<span class="property">innerHTML</span>=<span class="string">&#x27;&lt;span style=&quot;color:red&quot;&gt;xmlhttp对象正在初始化......&lt;/span&gt;&#x27;</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br><span class="line">    xmlhttp1.<span class="title function_">send</span>(<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>数据库</category>
        <category>程序语言</category>
        <category>ASP</category>
        <category>运维</category>
        <category>JavaScript</category>
        <category>MsSQL</category>
        <category>Ajax</category>
      </categories>
      <tags>
        <tag>数据库</tag>
        <tag>Ajax</tag>
        <tag>Asp</tag>
        <tag>MsSQL</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian环境安装新版Nginx及配置Webdav</title>
    <url>/2021/06/06/Debian%20%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E6%96%B0%E7%89%88Nginx%E5%8F%8A%E9%85%8D%E7%BD%AEWebdav/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Debian-环境安装新版nginx及配置webdav"><a href="#Debian-环境安装新版nginx及配置webdav" class="headerlink" title="Debian 环境安装新版nginx及配置webdav"></a>Debian 环境安装新版<code>nginx</code>及配置<code>webdav</code></h1><h2 id="一、Nginx用源安装最新稳定版"><a href="#一、Nginx用源安装最新稳定版" class="headerlink" title="一、Nginx用源安装最新稳定版"></a>一、<code>Nginx</code>用源安装最新稳定版</h2><h2 id="二、源码编译安装最新稳定版："><a href="#二、源码编译安装最新稳定版：" class="headerlink" title="二、源码编译安装最新稳定版："></a>二、源码编译安装最新稳定版：</h2><h2 id="三、配置webdav模块"><a href="#三、配置webdav模块" class="headerlink" title="三、配置webdav模块"></a>三、配置<code>webdav</code>模块</h2><p> （1）配置<code>webdav</code><br> （2）设置<code>webdav</code>帐号和密码：<br> （3）挂载到坚果云方法<br> （4）<code>nginx</code>加入到<code>systemctl</code>服务运行<br> （5）常用命令</p>
<h2 id="四、手机用的连接为webdav软件："><a href="#四、手机用的连接为webdav软件：" class="headerlink" title="四、手机用的连接为webdav软件："></a>四、手机用的连接为webdav软件：</h2><h2 id="五、一些问题及解决方法"><a href="#五、一些问题及解决方法" class="headerlink" title="五、一些问题及解决方法"></a>五、一些问题及解决方法</h2><h2 id="一、Nginx用源安装最新稳定版-1"><a href="#一、Nginx用源安装最新稳定版-1" class="headerlink" title="一、Nginx用源安装最新稳定版"></a>一、<code>Nginx</code>用源安装最新稳定版</h2><p>参见文章：<a href="https://debian.cn/articles/466?www">Debian 环境安装新版 nginx :</a><br>在 <code>Debian</code> 系统中，我们可以通过 <code>apt-get</code> 安装系统自带的 <code>nginx</code>，这样安装的 <code>nginx</code> 版本略旧。<code>Nginx</code> 官网提供了一些编辑绎好的<code>deb</code>安装包，我们只需更新安装源，就可以通过 <code>apt-get</code> 来安装最新的稳定版 <code>Nginx</code>了。</p>
<p>加载安装源并导入<code>key</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> deb http://nginx.org/packages/debian/ buster nginx | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/nginx.list </span><br><span class="line">$ wget http://nginx.org/keys/nginx_signing.key &amp;&amp; sudo apt-key add nginx_signing.key </span><br><span class="line">$ sudo apt update &amp;&amp; apt install nginx -y </span><br></pre></td></tr></table></figure><br>到这一部分就完成了最新稳定版的 <code>Nginx</code> 的安装。</p>
<p><em>需要注意的是，这一步安装的 Nginx 和系统自带的 nginx 的配置目录略有区别，可以用一下几个简单的命令修正</em>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /etc/nginx/&#123;sites-available,sites-enabled&#125;</span><br><span class="line">sudo <span class="built_in">mv</span> /etc/nginx/conf.d/* /etc/nginx/sites-available</span><br><span class="line">sudo <span class="built_in">rmdir</span> -f /etc/nginx/conf.d/</span><br><span class="line">sudo perl -pi -e <span class="string">&#x27;s/conf.d/sites-enabled/g&#x27;</span> /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure></p>
<p>其他问题：<br><code>bash: nginx：未找到命令</code><br>由于shell命令基本都在<code>/usr/bin</code>，<code>/usr/sbin</code>，<code>/bin</code>，<code>/sbin</code>，<code>/usr/X11R6/bin</code>中有定义。<br>所以，只要把这些命令重新取出来就能使用了，也算是个补救的办法。<br><code>export PATH=/usr/bin:/usr/sbin:/bin:/sbin:/usr/X11R6/bin</code><br>转载于:<a href="https://www.cnblogs.com/young233/p/10879077.html">修改profile导致bash不能用的补救方法</a></p>
<h2 id="二、源码编译安装最新稳定版：-1"><a href="#二、源码编译安装最新稳定版：-1" class="headerlink" title="二、源码编译安装最新稳定版："></a>二、源码编译安装最新稳定版：</h2><p><a href="http://nginx.org/download/nginx-1.21.1.tar.gz">nginx1.21.1下载地址：</a><br><a href="https://github.com/arut/nginx-dav-ext-module/archive/refs/tags/v3.0.0.tar.gz">nginx-dav-ext-module v3.0.0下载地址：</a>  </p>
<h3 id="1-卸载并清理安装的nginx"><a href="#1-卸载并清理安装的nginx" class="headerlink" title="1. 卸载并清理安装的nginx"></a>1. 卸载并清理安装的nginx</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt autoremove nginx</span><br><span class="line">$ sudo apt purge nginx</span><br><span class="line">$ sudo apt clean</span><br></pre></td></tr></table></figure>
<h3 id="2-下载并编译安装"><a href="#2-下载并编译安装" class="headerlink" title="2. 下载并编译安装"></a>2. 下载并编译安装</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ tar zxvf nginx-1.21.0.tar.gz</span><br><span class="line">$ tar zxvf nginx-dav-ext-module-3.0.0.tar.gz -C /home/你的用户名/下载/压缩包/</span><br><span class="line">$ tar zxvf nginx-1.21.1.tar.gz -C /home/你的用户名/下载/压缩包/</span><br><span class="line">$ <span class="built_in">cd</span> nginx-1.21.1</span><br><span class="line">$ sudo apt install gcc make libpcre3 libpcre3-dev zlib1g-dev openssl libssl-dev libxslt-dev libgd-dev libgeoip-dev apache2-utils</span><br><span class="line">~<span class="comment"># /下载/压缩包/nginx-1.20.1$ su root</span></span><br><span class="line">密码：</span><br><span class="line">~<span class="comment">#  ./configure --prefix=/etc/nginx --with-http_dav_module --with-http_stub_status_module --with-http_flv_module --with-http_gzip_static_module --with-stream --with-stream=dynamic --with-http_realip_module --with-http_v2_module --with-http_image_filter_module  --with-http_image_filter_module=dynamic --with-http_ssl_module --add-module=/home/你的用户名/下载/压缩包/nginx-dav-ext-module-3.0.0</span></span><br><span class="line">~<span class="comment"># make &amp;&amp; make install</span></span><br><span class="line">~<span class="comment">#  ln -s /etc/nginx/sbin/nginx /usr/bin/nginx </span></span><br></pre></td></tr></table></figure>
<h2 id="三、配置webdav模块-1"><a href="#三、配置webdav模块-1" class="headerlink" title="三、配置webdav模块"></a>三、配置webdav模块</h2><h3 id="配置webdav"><a href="#配置webdav" class="headerlink" title="配置webdav"></a>配置webdav</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sudo vim /etc/nginx/conf/nginx.conf</span></span><br></pre></td></tr></table></figure>
<p>用以下内容替换原内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        </span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">       error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        location ~ \.php$ &#123;</span><br><span class="line">            proxy_pass   http://127.0.0.1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        location ~ \.php$ &#123;</span><br><span class="line">            root           html;</span><br><span class="line">            fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">            fastcgi_index  index.php;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">            include        fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        location ~ /\.ht &#123;</span><br><span class="line">            deny  all;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">      server&#123;</span><br><span class="line">          listen    81;</span><br><span class="line">          server_name webdav;</span><br><span class="line">          error_log /etc/nginx/logs/webdav.error.log error;</span><br><span class="line">          access_log  /etc/nginx/logs/webdav.access.log combined;</span><br><span class="line">       location / &#123;</span><br><span class="line">             root /home/你的用户名/www/nginx/webdav;</span><br><span class="line">             charset utf-8;</span><br><span class="line">             autoindex on;</span><br><span class="line">             dav_methods  PUT DELETE MKCOL COPY MOVE;</span><br><span class="line">             dav_ext_methods PROPFIND OPTIONS;</span><br><span class="line">             create_full_put_path on;</span><br><span class="line">             dav_access user:rw group:r all:r;</span><br><span class="line">             auth_basic &quot;Authorized Users Only&quot;;</span><br><span class="line">             auth_basic_user_file /etc/nginx/.htpasswd;</span><br><span class="line">             client_max_body_size 5G;</span><br><span class="line">                &#125;</span><br><span class="line">           error_page   500 502 503 504  /50x.html;</span><br><span class="line">           location = /50x.html &#123;</span><br><span class="line">               root   /etc/nginx/html;</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 8080;</span><br><span class="line">    error_log /etc/nginx/logs/jianguoyun.error.log error;</span><br><span class="line">    access_log  /etc/nginx/logs/jianguoyun.access.log combined;</span><br><span class="line"> </span><br><span class="line">    location / &#123;</span><br><span class="line">        root /home/你的用户名/www/nginx/jianguoyun;</span><br><span class="line">        autoindex on;</span><br><span class="line">        dav_methods PUT DELETE MKCOL COPY MOVE;</span><br><span class="line">        dav_ext_methods PROPFIND OPTIONS;</span><br><span class="line">        create_full_put_path on;</span><br><span class="line">        dav_access user:rw group:r all:r;</span><br><span class="line">        auth_basic &quot;Authorized Users Only&quot;;</span><br><span class="line">        auth_basic_user_file /etc/nginx/.htpasswd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="设置webdav帐号和密码："><a href="#设置webdav帐号和密码：" class="headerlink" title="设置webdav帐号和密码："></a>设置webdav帐号和密码：</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">~<span class="comment"># echo -n &#x27;你的用户名:&#x27; | tee /etc/nginx/.htpasswd</span></span><br><span class="line">~<span class="comment"># openssl passwd -apr1 | tee -a /etc/nginx/.htpasswd</span></span><br><span class="line">  Password: </span><br><span class="line">  Verifying - Password: </span><br><span class="line">  $apr1$*****.3F$**76W8E9vT65vn1cE/Mk41</span><br></pre></td></tr></table></figure>
<h3 id="挂载到坚果云方法"><a href="#挂载到坚果云方法" class="headerlink" title="挂载到坚果云方法"></a>挂载到坚果云方法</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install davfs2</span><br><span class="line">$ <span class="built_in">mkdir</span> -p /home/你的用户名/www/nginx/jianguoyun</span><br><span class="line">$ sudo vim  /etc/davfs2/davfs2.conf</span><br><span class="line">  <span class="comment">#ignore_dav_header 0</span></span><br></pre></td></tr></table></figure>
<p>改为：<br><code>ignore_dav_header 1</code><br>挂载：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo mount -t davfs https://dav.jianguoyun.com/dav/ /home/你的用户名/www/nginx/jianguoyun</span><br></pre></td></tr></table></figure><br>取消挂载：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo fusermount -u /home/你的用户名/www/nginx/jianguoyun</span><br></pre></td></tr></table></figure></p>
<h3 id="nginx加入到systemctl服务运行"><a href="#nginx加入到systemctl服务运行" class="headerlink" title="nginx加入到systemctl服务运行"></a><code>nginx</code>加入到<code>systemctl</code>服务运行</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo vim /usr/lib/systemd/system/nginx.service</span><br></pre></td></tr></table></figure>
<p>输入以下内容并保存<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx</span><br><span class="line">After=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/etc/nginx/logs/nginx.pid</span><br><span class="line">ExecStart=/etc/nginx/sbin/nginx</span><br><span class="line">ExecReload=/etc/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/etc/nginx/sbin/nginx -s stop</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><br>重新加载服务配置：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload  <span class="comment"># 重新加载服务配置文件</span></span><br><span class="line">sudo systemctl start/stop/reload nginx <span class="comment">#开启、停止、重新加载nginx</span></span><br></pre></td></tr></table></figure></p>
<h2 id="四、手机用的连接为webdav软件：-1"><a href="#四、手机用的连接为webdav软件：-1" class="headerlink" title="四、手机用的连接为webdav软件："></a>四、手机用的连接为webdav软件：</h2><p>   <strong>苹果：<a href="http://www.skyjos.cn/fileexplorer/">FE文件管理器</a>、<a href="http://www.estrongs.com/">ES文件浏览器</a></strong><br>   <strong>安卓：<a href="https://apkdl.in/app/details?id=com.cxinventor.file.explorer">CX文件管理器</a>或者<a href="https://apkpure.com/cn/cx-file-explorer/com.cxinventor.file.explorer">Cx File Explorer</a>、<a href="http://www.estrongs.com/">ES文件浏览器</a></strong></p>
<p>   推荐几个安卓下载<code>google apk</code>网站:<br>   1、<a href="https://apkcombo.com/zh/">apkcombo</a> 【已墙】<br>   3、<a href="https://apkpure.com/cn">apkpure</a> 【已墙】<br>   2、<a href="https://apkdl.in/">apkdl</a>  </p>
<h2 id="五、一些问题及解决方法："><a href="#五、一些问题及解决方法：" class="headerlink" title="五、一些问题及解决方法："></a>五、一些问题及解决方法：</h2><h3 id="1-查找进程："><a href="#1-查找进程：" class="headerlink" title="1. 查找进程："></a>1. 查找进程：</h3><p>  查询端口：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ps -ef |grep nginx</span><br></pre></td></tr></table></figure></p>
<h3 id="2-开放端口："><a href="#2-开放端口：" class="headerlink" title="2. 开放端口："></a>2. 开放端口：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install iptables</span><br><span class="line">$ sudo <span class="built_in">ln</span> -s /usr/sbin/iptables /usr/bin/iptables  //建立软连接</span><br><span class="line">$ sudo iptables -I INPUT -p tcp --dport 81 -j ACCEPT  //开放81端口</span><br></pre></td></tr></table></figure>
<p>持久化规则：这里我们需要在安装一下工具来帮我们实现，这里我们使用 <code>iptables-persistent</code><br>安装<code>iptables-persistent</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install iptables-persistent</span><br></pre></td></tr></table></figure><br>持久化规则<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo netfilter-persistent save</span><br><span class="line">$ sudo netfilter-persistent reload</span><br></pre></td></tr></table></figure><br>完成上述操作就可以永久打开我们需要的端口了</p>
<h3 id="3-关于权限问题："><a href="#3-关于权限问题：" class="headerlink" title="3. 关于权限问题："></a>3. 关于权限问题：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo vim nginx.conf</span><br><span class="line">  [sudo] 你的用户名 的密码：</span><br><span class="line">	<span class="comment">#user  nobody;</span></span><br></pre></td></tr></table></figure>
<p>注释掉<code>user</code>，改为<br><code>user  nginx;</code><br>重新加载出现：错误提示如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo nginx -s reload</span><br><span class="line">  nginx: [emerg] getpwnam(<span class="string">&quot;nginx&quot;</span>) failed <span class="keyword">in</span> /etc/nginx/conf/nginx.conf:2</span><br><span class="line">$ sudo nginx -s closed</span><br><span class="line">  nginx: invalid option: <span class="string">&quot;-s closed&quot;</span></span><br><span class="line">$ sudo nginx -s stop</span><br><span class="line">  nginx: [emerg] getpwnam(<span class="string">&quot;nginx&quot;</span>) failed <span class="keyword">in</span> /etc/nginx/conf/nginx.conf:2</span><br></pre></td></tr></table></figure><br><strong>解决办法：</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo useradd -s /sbin/nologin -M  nginx</span><br><span class="line">  useradd：用户“nginx”已存在</span><br><span class="line">$ <span class="built_in">id</span> nginx</span><br><span class="line">  uid=117(nginx) gid=125(nginx) 组=125(nginx)</span><br><span class="line">$ systemctl start nginx</span><br><span class="line">$ sudo nginx -s reload</span><br></pre></td></tr></table></figure></p>
<h3 id="4-make-upgrade-平滑升级"><a href="#4-make-upgrade-平滑升级" class="headerlink" title="4. make upgrade 平滑升级"></a>4. <code>make upgrade</code> 平滑升级</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">~<span class="comment"># /sbin/mount.davfs: mounting failed; the server does not support WebDAV</span></span><br></pre></td></tr></table></figure>
<p>原因是<code>mount.davfs</code>命令在挂载时和 <code>WebDAV</code> 服务器建立连接，并通过 <code>libneon</code>库的 <code>ne_options</code> 函数发送 <code>HTTP OPTIONS</code> 请求获取 <code>WebDAV</code> 服务器能力，虽然返回成功但判断坚果云 <code>WebDAV</code> 服务器不支持 <code>Class 1 WebDAV</code>，因此直接报错挂载失败。<br>看到这里解决办法也就简单了，<code>davfs2</code> 提供了通过配置文件禁用 <code>WebDAV</code>头检测的功能，<br><strong>直接修改<code>/etc/davfs2/davfs2.conf</code>配置文件解注释并改为：<code>ignore_dav_header 1</code></strong></p>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><ol>
<li><a href="http://www.v5b7.com/webserver/nginx/nginx_webdav.html">nginx配置webdav：</a></li>
<li><a href="https://www.cnblogs.com/catlee/p/10290497.html">源码编译安装nginx详细步骤：</a></li>
<li><a href="https://xieshaohu.wordpress.com/2019/07/12/nginx%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85webdav%E6%A8%A1%E5%9D%97/">nginx编译安装webdav模块：</a></li>
<li><a href="https://blog.ghostry.cn/server/889.html">debian下为Nginx添加webdav:</a></li>
<li><a href="https://blog.csdn.net/u013401853/article/details/113094734">davfs挂载与使用缺陷：</a></li>
<li><a href="https://www.moerats.com/archives/317/">Linux通过安装davfs2来挂载webdav网盘：</a></li>
<li><a href="https://www.cnblogs.com/Dev0ps/p/12000221.html">Nginx服务加到systemctl:</a></li>
</ol>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Webdav</category>
        <category>Nginx</category>
      </categories>
      <tags>
        <tag>Webdav</tag>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian10系统systemctl服务管理方式下Nginx设置开机启动</title>
    <url>/2021/06/20/Debian10%E7%B3%BB%E7%BB%9Fsystemctl%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F%E4%B8%8BNginx%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>linux服务目前主要有service和systemctl两种管理方式，systemd是Linux系统最新的初始化系统(init),作用是提高系统的启动速度，尽可能启动较少的进程，尽可能更多进程并发启动，对应的进程管理命令是systemctl。  </p>
<h1 id="1-建立服务文件"><a href="#1-建立服务文件" class="headerlink" title="1. 建立服务文件"></a>1. 建立服务文件</h1><p>命令 <code>sudo vim /usr/lib/systemd/system/nginx.service</code>，进入文件，将以下代码复制进去保存即可<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx  </span><br><span class="line">After=network.target  </span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class="line">ExecReload=/bin/kill -s reload</span><br><span class="line">ExecStop=/bin/kill -s stop</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><br>参数说明：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[Unit]:服务的说明</span><br><span class="line">Description=:描述服务</span><br><span class="line">After=:描述服务类别</span><br><span class="line"></span><br><span class="line">[Service]服务运行参数的设置</span><br><span class="line">Type=forking是后台运行的形式</span><br><span class="line">ExecStart=为服务的具体运行命令所在路径</span><br><span class="line">ExecReload=为重启命令</span><br><span class="line">ExecStop=为停止命令</span><br><span class="line">PrivateTmp=True表示给服务分配独立的临时空间</span><br><span class="line">注意：启动、重启、停止命令全部要求使用绝对路径</span><br><span class="line"></span><br><span class="line">[Install]服务安装的相关设置，可设置为多用户</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></p>
<h1 id="2-设置文件权限并使文件生效"><a href="#2-设置文件权限并使文件生效" class="headerlink" title="2. 设置文件权限并使文件生效"></a>2. 设置文件权限并使文件生效</h1><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">chmod</span> 755 /usr/lib/systemd/system/nginx.service</span><br><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure></p>
<h1 id="3-设置开机启动"><a href="#3-设置开机启动" class="headerlink" title="3.设置开机启动"></a>3.设置开机启动</h1><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> nginx.service</span><br></pre></td></tr></table></figure><br>只有返回类似 <code>Created symlink from /etc/systemd/system/multi-user.target.wants/nginx.service → /etc/systemd/system/nginx.service</code>提示才能够确定设置成功。如果不是请检查上面的文件.  </p>
<h1 id="4-其他命令"><a href="#4-其他命令" class="headerlink" title="4. 其他命令"></a>4. 其他命令</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl is-enabled *.service <span class="comment">#查询服务是否开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> *.service <span class="comment">#开机运行服务</span></span><br><span class="line">systemctl <span class="built_in">disable</span> *.service <span class="comment">#取消开机运行</span></span><br><span class="line">systemctl start *.service <span class="comment">#启动服务</span></span><br><span class="line">systemctl stop *.service <span class="comment">#停止服务</span></span><br><span class="line">systemctl restart *.service <span class="comment">#重启服务</span></span><br><span class="line">systemctl reload *.service <span class="comment">#重新加载服务配置文件</span></span><br><span class="line">systemctl status *.service <span class="comment">#查询服务运行状态</span></span><br><span class="line">systemctl --failed <span class="comment">#显示启动失败的服务</span></span><br></pre></td></tr></table></figure>
<p><code>*</code>指所设置的程序名称 比如：<code>nginx.service</code>   </p>
<p>转载于<a href="https://blog.csdn.net/ren365880/article/details/103597006">nginx在systemctl方式开机自启动</a><br>参考资料：    </p>
<p>1.<a href="https://www.cnblogs.com/seasen/p/12603017.html">nginx添加service以及随开机启动:</a>  </p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Nginx</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
        <tag>Systemctl</tag>
        <tag>Debian</tag>
        <tag>启动服务</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11下Genymothion安装记录</title>
    <url>/2021/11/02/Debian11%E4%B8%8BGenymotion%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、注册用户"><a href="#1、注册用户" class="headerlink" title="1、注册用户"></a>1、注册用户</h1><p><a href="https://www-v1.genymotion.com/account/create/">注册地址</a></p>
<h1 id="2、下载安装文件"><a href="#2、下载安装文件" class="headerlink" title="2、下载安装文件"></a>2、下载安装文件</h1><p><a href="https://www.genymotion.com/download/">Genymotion下载地址</a><br><a href="https://www.virtualbox.org/wiki/Linux_Downloads">virtualbox下载地址</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-PC:~/下载$ sudo <span class="built_in">mkdir</span> -p /home/user/share</span><br><span class="line">user@user-PC:~/下载$ sudo <span class="built_in">chmod</span> 777 /home/user/share</span><br></pre></td></tr></table></figure></p>
<h1 id="3、移动到本地文件夹"><a href="#3、移动到本地文件夹" class="headerlink" title="3、移动到本地文件夹"></a>3、移动到本地文件夹</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-PC:~/下载$ <span class="built_in">mv</span> ~/下载/genymotion-3.2.1-linux_x64.bin virtualbox-6.1_6.1.28-147628~Debian~bullseye_amd64.deb ~/local/</span><br><span class="line">user@user-PC:~/下载$ <span class="built_in">cd</span> ~/local</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="4、安装"><a href="#4、安装" class="headerlink" title="4、安装"></a>4、安装</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt install ./virtualbox-6.1_6.1.28-147628~Debian~bullseye_amd64.deb  // 安装virtualbox</span><br><span class="line">$ sudo <span class="built_in">chmod</span> u+x genymotion-3.2.1-linux_x64.bin // 赋予可执行权限</span><br><span class="line">$ sudo ./genymotion-3.2.1-linux_x64.bin  // 安装Genymotion</span><br><span class="line">Installing <span class="keyword">for</span> all <span class="built_in">users</span>.</span><br><span class="line"></span><br><span class="line">Installing to folder [/opt/genymobile/genymotion]. Are you sure [y/n] ? y</span><br><span class="line"></span><br><span class="line">- Trying to find VirtualBox toolset .................... WARNING (Virtualbox was not found <span class="keyword">in</span> you PATH. Please install it manually)</span><br><span class="line">- Extracting files ..................................... OK (Extract into: [/opt/genymobile/genymotion])</span><br><span class="line">- Installing launcher icon ............................. OK</span><br><span class="line"></span><br><span class="line">Installation <span class="keyword">done</span> successfully.</span><br><span class="line">You can now use these tools from [/opt/genymobile/genymotion]:</span><br><span class="line"> - genymotion</span><br><span class="line"> - genymotion-shell</span><br><span class="line"> - gmtool</span><br></pre></td></tr></table></figure>
<h1 id="5、启动登陆"><a href="#5、启动登陆" class="headerlink" title="5、启动登陆"></a>5、启动登陆</h1><p>在系统或者开发里找到Genymotion程序,点击打开输入注册用户名和密码选择个人用户登陆即可</p>
<h1 id="6-选择机型安装"><a href="#6-选择机型安装" class="headerlink" title="6 选择机型安装"></a>6 选择机型安装</h1><p>在软件界面点击右上的<code>+</code>即可选择机型,然后安装即可</p>
<p>具体可参考：<br><a href="https://www.virtualbox.org/wiki/Linux_Downloads">virtualbox安装介绍</a><br><a href="https://docs.genymotion.com/desktop/latest/Get_started/013_Linux_install.html">Genymotion安装介绍</a><br><a href="https://www.jianshu.com/p/b18f82457345">Genymotion安装教程及踩坑解决方法</a><br><a href="https://github.com/m9rco/Genymotion_ARM_Translation">Genymotion Can’t install the APK solution:</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Genymotion</category>
      </categories>
      <tags>
        <tag>Genymotion</tag>
        <tag>Debian11</tag>
        <tag>Android</tag>
        <tag>安卓模拟器</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11下SMBShare安装</title>
    <url>/2021/10/06/Debian11%E4%B8%8BSMBShare%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、直接输入以下命令安装"><a href="#1、直接输入以下命令安装" class="headerlink" title="1、直接输入以下命令安装"></a>1、直接输入以下命令安装</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-PC:~/下载$ sudo apt  update</span><br><span class="line">user@user-PC:~/下载$ sudo apt  -y install samba</span><br></pre></td></tr></table></figure>
<h1 id="2、创建并设置共享目录"><a href="#2、创建并设置共享目录" class="headerlink" title="2、创建并设置共享目录"></a>2、创建并设置共享目录</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-PC:~/下载$ sudo <span class="built_in">mkdir</span> -p /home/user/share</span><br><span class="line">user@user-PC:~/下载$ sudo <span class="built_in">chmod</span> 777 /home/user/share</span><br></pre></td></tr></table></figure>
<h1 id="3、将用户加入组"><a href="#3、将用户加入组" class="headerlink" title="3、将用户加入组"></a>3、将用户加入组</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加当前用户</span></span><br><span class="line">user@user-PC:~/下载$ sudo smbpasswd -a user   //添加用户</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">New SMB password:</span><br><span class="line">Retype new SMB password:</span><br><span class="line">Added user user.</span><br><span class="line"><span class="comment"># 删除用户：</span></span><br><span class="line">sudo smbpasswd -x user</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果要创建用户并添加则需要如下步骤</span></span><br><span class="line">user@user-PC:~/下载$ sudo groupadd user2 -g 6000</span><br><span class="line">user@user-PC:~/下载$ sudo useradd -u 6000 -g 6000 -s /sbin/nologin -d /dev/null</span><br><span class="line"></span><br><span class="line">user@user-PC:~/下载$ sudo useradd user2 -g user2</span><br><span class="line">user@user-PC:~/下载$ <span class="built_in">cat</span>  /etc/group //查询组</span><br><span class="line">user@user-PC:~/下载$ <span class="built_in">cat</span> /etc/passwd   //查询用户</span><br><span class="line"></span><br><span class="line">user@user-PC:~/下载$ sudo smbpasswd -a user2   //添加用户</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">New SMB password:</span><br><span class="line">Retype new SMB password:</span><br><span class="line">Added user user2.</span><br><span class="line"><span class="comment"># 删除用户：</span></span><br><span class="line">sudo smbpasswd -x user2</span><br></pre></td></tr></table></figure>
<p>3、配置smb<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-PC:~/下载$ sudo vim /etc/samba/smb.conf</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[shareD]</span><br><span class="line">  comment = Share-rw</span><br><span class="line"> ;共享目录全路径</span><br><span class="line">  path = /media/yourUserName/文档/Share                </span><br><span class="line">  available = <span class="built_in">yes</span></span><br><span class="line">  browsable = <span class="built_in">yes</span></span><br><span class="line">;写入权限</span><br><span class="line">  public = <span class="built_in">yes</span></span><br><span class="line">  writable = <span class="built_in">yes</span>  </span><br><span class="line">;可访问的用户</span><br><span class="line">  valid <span class="built_in">users</span> = yourUserName</span><br><span class="line">[shareM]</span><br><span class="line">  comment = Share-rw</span><br><span class="line"> ;共享目录全路径</span><br><span class="line">  path = /media/yourUserName/娱乐/影视娱乐</span><br><span class="line">  available = <span class="built_in">yes</span></span><br><span class="line">  browsable = <span class="built_in">yes</span></span><br><span class="line">;写入权限</span><br><span class="line">  public = <span class="built_in">yes</span></span><br><span class="line">  writable = <span class="built_in">yes</span>  </span><br><span class="line">;可访问的用户</span><br><span class="line">  valid <span class="built_in">users</span> = yourUserName</span><br></pre></td></tr></table></figure><br>附其他命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo smbpasswd -d 冻结用户，就是这个用户不能在登录了</span><br><span class="line">$ sudo smbpasswd -e 恢复用户，解冻用户，让冻结的用户可以在使用</span><br><span class="line">$ sudo smbpasswd -n 把用户的密码设置成空.</span><br><span class="line">             要在global中写入 null passwords -<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">$ sudo systemctl status nmbd  // 查询SMB状态</span><br><span class="line">$ sudo systemctl status smbd</span><br><span class="line"></span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> nmbd  // 允许SMB开机启动</span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> smbd  // 允许SMB开机启动</span><br></pre></td></tr></table></figure></p>
<p>具体可参考：<br><a href="https://www.cnblogs.com/chenjiangfeng/p/10148679.html">Linux之Samba部署</a><br><a href="https://www.cnblogs.com/jwanqiang/p/12016817.html">samba服务器的搭建和用户权限，文件夹权限设置</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>SMBshare</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>Smbshare</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11安装wine</title>
    <url>/2022/01/02/Debian11%E5%AE%89%E8%A3%85wine/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装公钥"><a href="#安装公钥" class="headerlink" title="安装公钥"></a>安装公钥</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim Release.key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入以下内容：</span></span><br><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: GnuPG v1.4.5 (GNU/Linux)</span><br><span class="line"></span><br><span class="line">mQENBFu8fWQBCADM64J7qlcnI2KwxSKSdyaOi7hz44EUXDpC3+3hfFP8k28SgV3U</span><br><span class="line">4a/ydOdd2cDSne5w+yjrnJWYuS0sTiE7vQPtKfmCmQZfCStvoRe5Pt+AOy1GA/iu</span><br><span class="line">U5wHIZD+/A9CeQcu5L3PkVkmijz0LmSCq7HnnVB0SdFA5eFlV98H875EasvpJ3xU</span><br><span class="line">ziI3yvqdZ5/0LgKzOiFjk4rMXQS01a1dNpwFO7EXiq921ZjnXatdnsDQ/NAj7z8P</span><br><span class="line">3qnTAj6yvl7DtdlXXA2hiznEOZNCRLZ69vHq0hGIw+OKjpsUkCZK29AnY4wJxxzY</span><br><span class="line">frjknVW7tyZ6Hxwz6R4vaVlZ6h5WR/OiAdqlABEBAAG0NEVtdWxhdG9ycyBPQlMg</span><br><span class="line">UHJvamVjdCA8RW11bGF0b3JzQGJ1aWxkLm9wZW5zdXNlLm9yZz6JAT4EEwEIACgF</span><br><span class="line">Al/IneQCGwMFCQgq0IAGCwkIBwMCBhUIAgkKCwQWAgMBAh4BAheAAAoJEN+hdadR</span><br><span class="line">BJYObLMIAITmgANzWhIIVdnmI2be/xyHhVAwyEhWBb/omcJ0mbxJ9QuPtxJAUS9I</span><br><span class="line">ExslzbHOju37FlTLiWKZ6C/iJq4ThJYOufjrKL/PI+ynKSfyorF55ZfbV24kM3Og</span><br><span class="line">LB8piWvf6oIcBjoJpD+vnhoZW7nze4jXRP6I3DgNcMm597N/RPyZyCHLmhrOZmHS</span><br><span class="line">t2ppzWlsVEOnC8n08KPHDYYOPLbyR8Y2KvjbnS9Vip5Hr5gtbtRLz2ip7VBso7ar</span><br><span class="line">h9ZAZxzQl2u4iL5BKJ2lYjE/eJctHAK6QkWJR3FAlQsbSIHZKWGKIcZSlpKm+B5u</span><br><span class="line">7iV2zMHGPFWgjZSSeuLiGQypFJra0J2IRgQTEQIABgUCW7x9ZAAKCRA7MBG3a51l</span><br><span class="line">IwayAJ9dHmDag9nFY9GujfMr+foKquFS9wCfQlvp6Sz0N5aKdW00NGnZZ/EKHIQ=</span><br><span class="line">=2pEk</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br><span class="line"><span class="comment"># 添加</span></span><br><span class="line">sudo apt-key add Release.key</span><br></pre></td></tr></table></figure>
<h1 id="添加安装源"><a href="#添加安装源" class="headerlink" title="添加安装源"></a>添加安装源</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>输入以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb https://download.opensuse.org/repositories/Emulators:/Wine:/Debian/Debian_11 ./</span><br></pre></td></tr></table></figure><br>添加源密钥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dpkg --add-architecture i386</span><br><span class="line">wget -nc https://dl.winehq.org/wine-builds/winehq.key</span><br><span class="line">--2021-05-08 14:29:29--  https://dl.winehq.org/wine-builds/winehq.key</span><br><span class="line"></span><br><span class="line">sudo apt-key add winehq.key</span><br><span class="line">OK</span><br><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure><br>添加如下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb https://dl.winehq.org/wine-builds/debian/ bullseye main </span><br></pre></td></tr></table></figure><br>更新安装源<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install --install-recommends winehq-stable</span><br></pre></td></tr></table></figure></p>
<h1 id="初始配置"><a href="#初始配置" class="headerlink" title="初始配置"></a>初始配置</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">winecfg</span><br></pre></td></tr></table></figure>
<h1 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wine uninstaller</span><br></pre></td></tr></table></figure>
<p>附注：卸载<code>wine</code>则用：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt --purge autoremove --install-recommends winehq-stable</span><br></pre></td></tr></table></figure></p>
<h1 id="安装微信"><a href="#安装微信" class="headerlink" title="安装微信"></a>安装微信</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> Wine</span><br><span class="line"><span class="built_in">cd</span> Wine</span><br></pre></td></tr></table></figure>
<p>初始化<code>wine bottle config</code></p>
<p><strong>以下<code>/path/to</code></strong>即为用户目录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">WINARCH=win32 WINEPREFIX=/path/to/Wine/WeChat winecfg</span><br></pre></td></tr></table></figure>
<h2 id="通过winetricks添加依赖项目"><a href="#通过winetricks添加依赖项目" class="headerlink" title="通过winetricks添加依赖项目"></a>通过<code>winetricks</code>添加依赖项目</h2><h3 id="安装winetricks的gui界面"><a href="#安装winetricks的gui界面" class="headerlink" title="安装winetricks的gui界面"></a>安装<code>winetricks</code>的<code>gui界面</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install zenity</span><br><span class="line"><span class="comment"># 配置微信数据目录</span></span><br><span class="line">WINARCH=win32 WINEPREFIX=/path/to/Wine/WeChat winetricks</span><br></pre></td></tr></table></figure>
<p>选择默认的<code>Wine容器</code> -&gt; <code>OK</code> -&gt; <code>安装Windows DLL组件</code> -&gt;<code>OK</code> -&gt; <code>勾选riched20.dll（以及riched32.dll）</code>-&gt; <code>OK</code> -&gt; <code>等待安装即可</code>。</p>
<h3 id="安装微信-1"><a href="#安装微信-1" class="headerlink" title="安装微信"></a>安装微信</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">WINARCH=win32 WINEPREFIX=/path/to/Wine/WeChat wine WeChatSetup.exe</span><br></pre></td></tr></table></figure>
<h1 id="解决输入框文字输入问题"><a href="#解决输入框文字输入问题" class="headerlink" title="解决输入框文字输入问题"></a>解决输入框文字输入问题</h1><h2 id="安装winetricks"><a href="#安装winetricks" class="headerlink" title="安装winetricks"></a>安装<code>winetricks</code></h2><p><a href="https://packages.debian.org/bullseye/winetricks">下载地址：</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dpkg -i <span class="string">&quot;winetricks_0.0+20210206-2_all.deb&quot;</span></span><br><span class="line">winetricks riched20</span><br><span class="line"><span class="built_in">cat</span>: /tmp/winetricks.nTVgvhUR/stdout.tmp: 没有那个文件或目录</span><br><span class="line"><span class="built_in">rm</span>: 无法删除 <span class="string">&#x27;/tmp/winetricks.nTVgvhUR/stdout.tmp&#x27;</span>: 没有那个文件或目录</span><br><span class="line">------------------------------------------------------</span><br><span class="line">warning: Github 提供的下载？ 似乎不是个有效的版本号。</span><br><span class="line">------------------------------------------------------</span><br><span class="line">Executing <span class="built_in">mkdir</span> -p /path/to</span><br><span class="line">------------------------------------------------------</span><br><span class="line">warning: You are using a 64-bit WINEPREFIX. Note that many verbs only install 32-bit versions of packages. If you encounter problems, please retest <span class="keyword">in</span> a clean 32-bit WINEPREFIX before reporting a bug.</span><br><span class="line">------------------------------------------------------</span><br><span class="line">Using winetricks 20210206-next - <span class="built_in">sha256sum</span>: 7cc2f1a44854b8449270cb46890d6cf3c9dff190ac40729ae4eb817b290df8f5 with wine-6.0.1 and WINEARCH=win64</span><br><span class="line">Executing w_do_call riched20</span><br><span class="line">Executing <span class="built_in">mkdir</span> -p /path/to</span><br><span class="line">------------------------------------------------------</span><br><span class="line">warning: You are using a 64-bit WINEPREFIX. Note that many verbs only install 32-bit versions of packages. If you encounter problems, please retest <span class="keyword">in</span> a clean 32-bit WINEPREFIX before reporting a bug.</span><br><span class="line">------------------------------------------------------</span><br><span class="line">Executing load_riched20 </span><br><span class="line">Executing <span class="built_in">mkdir</span> -p /path/to/.cache/winetricks/win2ksp4</span><br><span class="line">Executing <span class="built_in">cd</span> /path/to/.cache/winetricks/win2ksp4</span><br><span class="line">Downloading http://x3270.bgp.nu/download/specials/W2KSP4_EN.EXE to /path/to/.cache/winetricks/win2ksp4</span><br><span class="line"></span><br><span class="line">09/22 18:31:09 [NOTICE] Downloading 1 item(s)</span><br><span class="line">[<span class="comment">#fcb5f1 127MiB/129MiB(98%) CN:1 DL:10MiB]               </span></span><br><span class="line">09/22 18:31:23 [NOTICE] 下载已完成：/path/to/.cache/winetricks/win2ksp4/W2KSP4_EN.EXE</span><br><span class="line"></span><br><span class="line">下载结果：</span><br><span class="line">gid   |<span class="built_in">stat</span>|avg speed  |path/URI</span><br><span class="line">======+====+===========+=======================================================</span><br><span class="line">fcb5f1|OK  |   9.6MiB/s|/path/to/.cache/winetricks/win2ksp4/W2KSP4_EN.EXE</span><br><span class="line"></span><br><span class="line">状态标识：</span><br><span class="line">(OK)：下载已完成。</span><br><span class="line">Executing <span class="built_in">cd</span> /path/to/下载/winetricks</span><br><span class="line">------------------------------------------------------</span><br><span class="line">warning: Cannot find cabextract.  Please install it (e.g. <span class="string">&#x27;sudo apt-get install cabextract&#x27;</span> or <span class="string">&#x27;sudo yum install cabextract&#x27;</span>).</span><br><span class="line">------------------------------------------------------</span><br></pre></td></tr></table></figure><br>按照提示输入：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install cabextract</span><br></pre></td></tr></table></figure><br>如果下载不成功，可以多试几次，也可以直接下载以上两个文件：<br>1、<a href="http://x3270.bgp.nu/download/specials/W2KSP4_EN.EXE]">W2KSP4_EN.EXE</a><br>2、<a href="https://web.archive.org/web/2000/https://ftp.hp.com/pub/softlib/software/msi/InstMsiW.exe">InstMsiW.exe</a><br>放到<code>/path/to/.cache/winetricks/win2ksp4/</code>和<code>/path/to/.cache/winetricks/msls31/</code>路径下</p>
<p>参考 :<br>1、<a href="https://wiki.winehq.org/Debian">winehq官网For Debian</a><br>2、<a href="https://wiki.winehq.org/Winetricks">Winetricks介绍</a><br>3、<a href="https://zhuanlan.zhihu.com/p/76331687">Linux下通过Wine安装微信</a><br>4、<a href="https://www.freesion.com/article/6055985563/">解决微信等有输入框的无法输入问题</a><br>5、<a href="https://www.cnblogs.com/pengdonglin137/p/3784137.html">安装字体参考{解决输入中文出现方框}</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Wine</category>
      </categories>
      <tags>
        <tag>Wine</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11用Python3和JDBC操作ACCESS</title>
    <url>/2021/12/20/Debian11%E7%94%A8Python3%E5%92%8CJDBC%E6%93%8D%E4%BD%9CACCESS/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>主要步骤如下：</p>
<h1 id="安装java环境"><a href="#安装java环境" class="headerlink" title="安装java环境"></a>安装<code>java</code>环境</h1><p><code>UCanAccess</code>需要<code>jar</code>环境，这里我们直接装<code>OpenJDK 11</code>:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install default-jdk</span><br></pre></td></tr></table></figure></p>
<h1 id="驱动下载"><a href="#驱动下载" class="headerlink" title="驱动下载"></a>驱动下载</h1><p>下载并解压<code>UCanAccess JDBC</code>驱动程序<br><code>UCanAccess JDBC</code>驱动程序<a href="https://sourceforge.net/projects/ucanaccess/files/">下载</a><br>下载解压后，可以用终端直接操作<code>access数据库</code>，运行<code>UCanAccess-5.0.1.bin/console.sh</code>，操作如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash console.sh</span><br><span class="line">/path/to/UCanAccess-5.0.1.bin</span><br><span class="line">Please, enter the full path to the access file (.mdb or .accdb): /path/to/stuTest.mdb</span><br><span class="line">Please, enter password: ******</span><br><span class="line">WARNING:Error <span class="keyword">in</span> the metadata of the table login_log: table<span class="string">&#x27;s row count in the metadata is 464 but 466 records have been found and loaded by UCanAccess. All will work fine, but it&#x27;</span>s better to repair your database.</span><br><span class="line">......</span><br><span class="line">Loaded Tables:</span><br><span class="line">&lt;你的数据表&gt;, xxx, xxx</span><br><span class="line">Loaded Queries:</span><br><span class="line">查询次数</span><br><span class="line">Loaded Procedures:</span><br><span class="line">替换(), 插入列()</span><br><span class="line">Loaded Indexes:</span><br><span class="line">......</span><br><span class="line">UCanAccess&gt;</span><br><span class="line">Copyright (c) 2021 Marco Amadei</span><br><span class="line">UCanAccess version 5.0.1</span><br><span class="line">You are connected!! </span><br><span class="line">Type quit to <span class="built_in">exit</span> </span><br><span class="line"></span><br><span class="line">Commands end with ; </span><br><span class="line"></span><br><span class="line">Use:   </span><br><span class="line">   <span class="built_in">export</span> [--<span class="built_in">help</span>] [--bom] [-d &lt;delimiter&gt;] [-t &lt;table&gt;] [--big_query_schema &lt;pathToSchemaFile&gt;] [--newlines] &lt;pathToCsv&gt;;</span><br><span class="line"><span class="keyword">for</span> exporting the result <span class="built_in">set</span> from the last executed query or a specific table into a .csv file</span><br><span class="line"></span><br><span class="line">UCanAccess&gt;select count(*) from &lt;你的数据表&gt;;</span><br><span class="line"></span><br><span class="line">·-----·</span><br><span class="line">|  C1 |</span><br><span class="line">·-----·</span><br><span class="line">| 466 |</span><br><span class="line">·-----·</span><br></pre></td></tr></table></figure></p>
<h1 id="模块安装"><a href="#模块安装" class="headerlink" title="模块安装"></a>模块安装</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install JPype1 jaydebeapi</span><br></pre></td></tr></table></figure>
<h1 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jaydebeapi</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件路径要用绝对路径</span></span><br><span class="line">db_path = <span class="string">&quot;/path/to/access数据库.mdb&quot;</span> </span><br><span class="line">psw = <span class="string">&quot;access数据库的密码&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下文件`UCanAccess-5.0.1.bin`是`UCanAccess JDBC`驱动程序下载解压后的文件路径</span></span><br><span class="line">ucanaccess_jars = [</span><br><span class="line">    <span class="string">&quot;/psth/to/UCanAccess-5.0.1.bin/ucanaccess-5.0.1.jar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/psth/to/UCanAccess-5.0.1.bin/lib/commons-lang3-3.8.1.jar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/psth/to/UCanAccess-5.0.1.bin/lib/commons-logging-1.2.jar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/psth/to/UCanAccess-5.0.1.bin/lib/hsqldb-2.5.0.jar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/psth/to/UCanAccess-5.0.1.bin/lib/jackcess-3.0.1.jar&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">classpath = <span class="string">&quot;:&quot;</span>.join(ucanaccess_jars)</span><br><span class="line">conn = jaydebeapi.connect(</span><br><span class="line">    <span class="string">&quot;net.ucanaccess.jdbc.UcanaccessDriver&quot;</span>,</span><br><span class="line">    <span class="string">f&quot;jdbc:ucanaccess://<span class="subst">&#123;db_path&#125;</span>;password=<span class="subst">&#123;psw&#125;</span>&quot;</span>,</span><br><span class="line">    [<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>],</span><br><span class="line">    classpath</span><br><span class="line">    )</span><br><span class="line"><span class="comment">## 查询</span></span><br><span class="line">cur = conn.cursor()</span><br><span class="line">cur.execute(<span class="string">&quot;select * from &lt;你的数据表&gt;&quot;</span>)</span><br><span class="line">result = cur.fetchall()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;所有数据：&quot;</span>, result)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;第二条数据：&quot;</span>, result[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line">所有数据是： [(<span class="number">1</span>, <span class="string">&#x27;赵大&#x27;</span>, <span class="number">20</span>), (<span class="number">2</span>, <span class="string">&#x27;钱二&#x27;</span>, <span class="number">30</span>), (<span class="number">3</span>, <span class="string">&#x27;sunsan&#x27;</span>, <span class="number">25</span>)]</span><br><span class="line">第二条数据是： (<span class="number">2</span>, <span class="string">&#x27;钱二&#x27;</span>, <span class="number">30</span>)</span><br></pre></td></tr></table></figure>
<p>如图：<br><img src="/pic/2021/12/Access/debian11_jdbc_access.png" alt="debian11_jdbc_access.png"><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 插入</span></span><br><span class="line">cur.execute(<span class="string">&quot;insert into tb_usr (ID,usr_name,usr_age) values (4,&#x27;李四&#x27;,32),(5,&#x27;周五&#x27;,38)&quot;</span>)</span><br><span class="line">conn.commit</span><br></pre></td></tr></table></figure><br>如图：<br><img src="/pic/2021/12/Access/debian11_jdbc_access-1.png" alt="debian11_jdbc_access-1.png"></p>
<p>参考资料：<br>1、<a href="https://cxymm.net/article/lyh03601/104040887">LINUX通过python连接ACCESS(.mdb和.accdb文件)数据库</a><br>2、<a href="https://www.linuxidc.com/Linux/2019-08/159870.htm">如何在 Debian 10 Linux 上安装 Java</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>软件应用</category>
        <category>Access</category>
        <category>UCanAccess</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Access</tag>
        <tag>Debian11</tag>
        <tag>UCanAccess</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11用Python和ODBC操作ACCESS</title>
    <url>/2021/12/21/Debian11%E7%94%A8Python3%E5%92%8CODBC%E6%93%8D%E4%BD%9CACCESS/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装系统支持包："><a href="#安装系统支持包：" class="headerlink" title="安装系统支持包："></a>安装系统支持包：</h1><h2 id="安装驱动程序管理器unixODBC或IODBC"><a href="#安装驱动程序管理器unixODBC或IODBC" class="headerlink" title="安装驱动程序管理器unixODBC或IODBC"></a>安装驱动程序管理器<code>unixODBC</code>或<code>IODBC</code></h2><p>这里以编译安装<code>unixODBC</code>为例。<br>下载并编译安装最新版本<code>unixODBC-2.3.9</code>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -P ~/下载/ http://www.unixodbc.org/unixODBC-2.3.9.tar.gz</span><br><span class="line"><span class="built_in">cd</span> ~/下载</span><br><span class="line">gunzip unixODBC-2.3.9.tar.gz</span><br><span class="line">tar xvf unixODBC-2.3.9.tar</span><br><span class="line"><span class="built_in">cd</span> unixODBC-2.3.9</span><br><span class="line">./configure --prefix=/usr/local/unixODBC --enable-inicaching --enable-drivers --enable-driver-conf --enable-gui </span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p>
<h2 id="配置odbc-ini和odbcinst-ini文件"><a href="#配置odbc-ini和odbcinst-ini文件" class="headerlink" title="配置odbc.ini和odbcinst.ini文件"></a>配置<code>odbc.ini</code>和<code>odbcinst.ini</code>文件</h2><p>其中<code>odbc.ini</code>位于<code>~/.odbc.ini</code>,同时因为安装<code>unixODBC</code>时路径配置在<code>/usr/local/unixODBC</code>，因此在<code>/usr/local/unixODBC/etc</code>路径下也存在;<br><code>odbcinst.ini</code>位于<code>/etc</code>[<strong>重要</strong>]和<code>/usr/local/unixODBC/etc</code>路径下.<br>配置内容参考如下：</p>
<h3 id="配置驱动文件odbcinst-ini："><a href="#配置驱动文件odbcinst-ini：" class="headerlink" title="配置驱动文件odbcinst.ini："></a>配置<em>驱动</em>文件<code>odbcinst.ini</code>：</h3><p>用命令<code>odbcinst -q -d</code>可查看所有<em>驱动</em> 文件<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Access]</span><br><span class="line">Description= ODBC DRIVER FOR Access</span><br><span class="line">Driver=/usr/lib/x86_64-linux-gnu/odbc/libmdbodbc.so</span><br><span class="line">Setup=</span><br><span class="line">FileUsage=1</span><br><span class="line">UsageCount=1</span><br></pre></td></tr></table></figure></p>
<p>其中<code>odbcinst.ini</code>配置中的<code>[MDBToolsODBC]</code>和<code>odbc.ini</code>中的<code>Driver = MDBToolsODBC</code>保持一致；<br><code>Driver=/usr/lib/x86_64-linux-gnu/odbc/libmdbodbc.so</code>中<code>libmdbodbc.so</code>是安装<code>odbc-mdbtools</code>后生成的文件。<br>路径参考：<br><a href="https://packages.debian.org/bullseye/amd64/odbc-mdbtools/filelist">在bullseye发行版中amd64硬件架构下的odbc-mdbtools软件包文件清单</a></p>
<h3 id="配置连接文件odbc-ini："><a href="#配置连接文件odbc-ini：" class="headerlink" title="配置连接文件odbc.ini："></a>配置<em>连接</em>文件<code>odbc.ini</code>：</h3><p>用命令<code>odbcinst -q -s</code>可查看所有 <em>连接</em> 的数据文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[test]</span><br><span class="line">Description = ODBC DRIVER FOR Access</span><br><span class="line">Driver = Access</span><br><span class="line">Database = /path/to/yourFile.mdb</span><br><span class="line">Servername = localhost</span><br><span class="line">Username =</span><br><span class="line">Password = </span><br><span class="line">port =</span><br></pre></td></tr></table></figure>
<p><strong>后面用<code>Python</code>操作测试采用以下写法：</strong><br><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[A1]</span></span><br><span class="line"><span class="attr">Driver</span>   = /usr/lib/x<span class="number">86_64</span>-linux-gnu/odbc/libmdbodbc.so</span><br><span class="line"><span class="attr">Database</span> = /path/to/test/Debian_odbc.mdb</span><br><span class="line"></span><br><span class="line"><span class="section">[A2]</span></span><br><span class="line"><span class="attr">Driver</span>     = /usr/lib/x<span class="number">86_64</span>-linux-gnu/odbc/libmdbodbc.so</span><br><span class="line"><span class="attr">Database</span>   = /path/to/Debian_odbc.accdb</span><br><span class="line"><span class="attr">Servername</span> = </span><br><span class="line"><span class="attr">Username</span>   = </span><br><span class="line"><span class="attr">Password</span>   = </span><br><span class="line"><span class="attr">port</span>       = </span><br><span class="line"></span><br><span class="line"><span class="section">[A3]</span></span><br><span class="line"><span class="attr">Driver</span>     = Access</span><br><span class="line"><span class="attr">Database</span>   = /path/to/Debian_odbc.accdb</span><br><span class="line"><span class="attr">Servername</span> = </span><br><span class="line"><span class="attr">Username</span>   = </span><br><span class="line"><span class="attr">Password</span>   = </span><br><span class="line">port       = </span><br></pre></td></tr></table></figure></p>
<p><strong>标题<code>[A1]</code>和后面<code>python</code>连接代码中<code>DSN=A1</code>语句名称要一致。</strong></p>
<h2 id="安装odbc-mdbtools和mdbtools"><a href="#安装odbc-mdbtools和mdbtools" class="headerlink" title="安装odbc-mdbtools和mdbtools"></a>安装<code>odbc-mdbtools</code>和<code>mdbtools</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install odbc-mdbtools  <span class="comment"># 老包名称为：libmdbodbc1</span></span><br><span class="line">sudo apt install mdbtools mdbtools-dev  libtool-dev <span class="comment"># 驱动</span></span><br></pre></td></tr></table></figure>
<p>或者参照下面步骤编译安装<code>mdbtools</code></p>
<h3 id="编译安装mdbtools"><a href="#编译安装mdbtools" class="headerlink" title="编译安装mdbtools"></a>编译安装<code>mdbtools</code></h3><p><a href="https://github.com/mdbtools/mdbtools/releases/download/v1.0.0/mdbtools-1.0.0.tar.gz">下载地址</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装支持</span></span><br><span class="line">sudo apt install libtool automake autoconf bison unixodbc unixodbc-dev gawk</span><br><span class="line"><span class="built_in">cd</span> /path/to/mdbtools-1.0.0</span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">auto-apt run ./configure --prefix=/usr/local/mdbtools --with-unixodbc=/usr/local/unixODBC --enable-ltdl-install --enable-iconvperdriver --with-included-ltdl</span><br><span class="line">make</span><br><span class="line"><span class="comment"># 安装并生成安装包</span></span><br><span class="line">sudo checkinstall</span><br></pre></td></tr></table></figure><br><del>错误待解决：</del> <strong>已经解决</strong><br>错误提示：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">......</span><br><span class="line">checking <span class="keyword">for</span> SQLGetPrivateProfileString <span class="keyword">in</span> -lodbcinst... no</span><br><span class="line">configure: error: Could not find SQLGetPrivateProfileString <span class="keyword">in</span> -lodbcinst</span><br></pre></td></tr></table></figure><br>解决：安装系统支持包<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install libtool automake autoconf bison unixodbc unixodbc-dev gawk</span><br></pre></td></tr></table></figure><br>参照：<a href="https://github.com/mdbtools/mdbtools">mdbtools开源项目地址</a></p>
<h1 id="安装后测试："><a href="#安装后测试：" class="headerlink" title="安装后测试："></a>安装后测试：</h1><h2 id="终端上测试："><a href="#终端上测试：" class="headerlink" title="终端上测试："></a>终端上测试：</h2><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">isql -v <span class="built_in">test</span></span><br></pre></td></tr></table></figure><br>输出：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">+---------------------------------------+</span><br><span class="line">| Connected!                            |</span><br><span class="line">|                                       |</span><br><span class="line">| sql-statement                         |</span><br><span class="line">| <span class="built_in">help</span> [tablename]                      |</span><br><span class="line">| quit                                  |</span><br><span class="line">|                                       |</span><br><span class="line">+---------------------------------------+</span><br></pre></td></tr></table></figure><br>测试<code>sql</code>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">SQL&gt; select count(*) from login_log</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| count                         |</span><br><span class="line">+-------------------------------+</span><br><span class="line">| 464                           |</span><br><span class="line">+-------------------------------+</span><br><span class="line">SQLRowCount returns 1</span><br><span class="line">1 rows fetched</span><br><span class="line">SQL&gt; </span><br></pre></td></tr></table></figure><br>如图：<br><img src="/pic/2021/12/Access/debian11_odbc_access.png" alt="debian11_odbc_access.png"></p>
<h2 id="用Python3-10测试"><a href="#用Python3-10测试" class="headerlink" title="用Python3.10测试"></a>用<code>Python3.10</code>测试</h2><h3 id="安装python3支持模块"><a href="#安装python3支持模块" class="headerlink" title="安装python3支持模块"></a>安装<code>python3</code>支持模块</h3><p><strong><code>python3.10</code>没法用<code>pip</code>安装<code>pyodbc</code>,可以安装<code>pypyodbc</code></strong>，以下用<code>python3.10</code>安装<code>pypyodbc</code>做测试<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install pypyodbc</span><br></pre></td></tr></table></figure></p>
<h3 id="操作语句"><a href="#操作语句" class="headerlink" title="操作语句"></a>操作语句</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pypyodbc</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    cnxn = pypyodbc.connect(<span class="string">&#x27;DSN=A1&#x27;</span>, unicode_results=<span class="literal">False</span>)</span><br><span class="line">    cur = cnxn.cursor()</span><br><span class="line">    <span class="comment"># 查询表的 字段长度，字段名</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(cur.description))</span><br><span class="line">    <span class="built_in">print</span>(cur.description) </span><br><span class="line">    <span class="keyword">for</span> column_name <span class="keyword">in</span> cur.description:</span><br><span class="line">        <span class="built_in">print</span>(column_name[<span class="number">0</span>])</span><br><span class="line">    cur.execute(<span class="string">&#x27;SELECT * from tb_usr&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> cur.fetchall():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这是A1：&quot;</span>, row)</span><br><span class="line">    cur.close()</span><br><span class="line">    cnxn.close()</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;链接错误：&quot;</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;#&quot;</span>*<span class="number">20</span>,<span class="string">&quot;解决乱码分割线&quot;</span>, <span class="string">&quot;#&quot;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment">### 查询  ###</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    cnxn = pypyodbc.connect(<span class="string">&#x27;DSN=A1&#x27;</span>, unicode_results=<span class="literal">False</span>) <span class="comment"># 以 bytes 类型输出</span></span><br><span class="line">    cur = cnxn.cursor()</span><br><span class="line">    cur.execute(<span class="string">&#x27;SELECT * from tb_usr&#x27;</span>)</span><br><span class="line">    <span class="comment"># for row in cur.fetchall():</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> cur:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这是A1：&quot;</span>, row[<span class="number">0</span>], row[<span class="number">1</span>].decode(<span class="string">&quot;utf-8&quot;</span>), row[<span class="number">2</span>]) <span class="comment"># 字段内容为汉字的转换为字符串</span></span><br><span class="line">    <span class="comment"># for row in cur.fetchall():</span></span><br><span class="line">    <span class="comment">#     print(&quot;这是A1：&quot;, row)</span></span><br><span class="line">    cur.close()</span><br><span class="line">    cnxn.close()</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;链接错误：&quot;</span>, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######  以下查询和修改均测试失败  ######</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###  插入  ###</span></span><br><span class="line"><span class="comment"># try:</span></span><br><span class="line">      cnxn = pypyodbc.connect(<span class="string">&#x27;DSN=A1&#x27;</span>, unicode_results=<span class="literal">False</span>) <span class="comment"># 以 bytes 类型输出</span></span><br><span class="line">      cnxn.autocommit = <span class="literal">False</span></span><br><span class="line">      cur = cnxn.cursor()  <span class="comment"># 创建游标</span></span><br><span class="line">      <span class="comment"># keys = &quot;ID,usr_name,usr_age&quot;</span></span><br><span class="line">      <span class="comment"># values = &quot;6,&#x27;吴六&#x27;,38&quot;</span></span><br><span class="line">      <span class="comment"># insert_sql = &quot;INSERT into tb_usr (ID,usr_name,usr_age) values (&#123;0&#125;)&quot;.format(values)</span></span><br><span class="line">      <span class="comment"># insert_sql = f&quot;INSERT into tb_usr (&#123;keys&#125;) values (&#123;values&#125;)&quot;</span></span><br><span class="line">      <span class="comment"># insert_sql = &quot;&quot;&quot;</span></span><br><span class="line">      <span class="comment"># INSERT INTO tb_usr([ID], usr_name, usr_age) </span></span><br><span class="line">      <span class="comment"># VALUES (6,&#x27;wl&#x27;,38)</span></span><br><span class="line">      <span class="comment"># &quot;&quot;&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># cur.execute(insert_sql)</span></span><br><span class="line">      <span class="comment"># params = (6,&#x27;吴六&#x27;,38)</span></span><br><span class="line">      <span class="comment"># insert_sql = &quot;INSERT into tb_usr(ID, usr_name, usr_age) values (?,?,?)&quot;  </span></span><br><span class="line">      <span class="comment"># cur.execute(insert_sql, params)</span></span><br><span class="line">      <span class="comment"># </span></span><br><span class="line">      insert_sql = <span class="string">&quot;INSERT Into tb_usr(ID, usr_name, usr_age) values (6,&#x27;wuliu&#x27;,33)&quot;</span></span><br><span class="line">      cur.execute(insert_sql)</span><br><span class="line"><span class="comment"># except pypyodbc.DatabaseError as err:</span></span><br><span class="line"><span class="comment">#     cnxn.rollback()</span></span><br><span class="line"><span class="comment"># else:</span></span><br><span class="line"><span class="comment">#     cnxn.commit()</span></span><br><span class="line"><span class="comment"># finally:</span></span><br><span class="line"><span class="comment">#     cnxn.autocommit = True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###  修改  ###</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    cnxn = pypyodbc.connect(<span class="string">&#x27;DSN=A1&#x27;</span>, unicode_results=<span class="literal">False</span>) <span class="comment"># 以 bytes 类型输出</span></span><br><span class="line">    cnxn.autocommit = <span class="literal">False</span></span><br><span class="line">    cur = cnxn.cursor()  <span class="comment"># 创建游标</span></span><br><span class="line">    update_sql = <span class="string">&quot;UPDATE tb_usr SET usr_name= &#x27;lisi&#x27; WHERE ID = 1&quot;</span></span><br><span class="line">    cur.executemany(update_sql)</span><br><span class="line"><span class="keyword">except</span> pypyodbc.DatabaseError <span class="keyword">as</span> err:</span><br><span class="line">    cnxn.rollback()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    cnxn.commit()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;影响&quot;</span>,cur.rowcount,<span class="string">&quot;行&quot;</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    cnxn.autocommit = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###### 插入错误提示</span></span><br><span class="line">Error at Line : syntax error</span><br><span class="line">syntax error</span><br><span class="line">Got no result <span class="keyword">for</span> <span class="string">&#x27;INSERT Into tb_usr(ID, usr_name, usr_age) values (6,&#x27;</span>wuli<span class="string">u&#x27;,33)&#x27;</span> command</span><br><span class="line"><span class="comment">###### 更新错误提示</span></span><br><span class="line">Error at Line : syntax error</span><br><span class="line">syntax error</span><br><span class="line">Got no result <span class="keyword">for</span> <span class="string">&#x27;UPDATE tb_usr SET usr_name= &#x27;</span>lisi<span class="string">&#x27; WHERE ID = 1&#x27;</span> command</span><br></pre></td></tr></table></figure>
<p>结果如图：<br><img src="/pic/2021/12/Access/debian11_odbc_access-1.png" alt="debian11_odbc_access-1.png"></p>
<p>参考资料：<br>1、<a href="http://www.unixodbc.org/download.html">unixODBC DOWNLOAD地址：</a><br>2、<a href="https://packages.debian.org/bullseye/amd64/mdbtools">JET / MS Access database (MDB) tools</a><br>3、<a href="https://packages.debian.org/bullseye/odbc-mdbtools">DB tools ODBC driver</a><br>4、<a href="https://packages.debian.org/search?keywords=MDBTools&amp;searchon=names&amp;suite=stable&amp;section=all">软件包mdbtools搜索结果</a><br>5、<a href="http://mdbtools.sourceforge.net/">MDB Tools</a><br>6、<a href="https://github.com/mdbtools/mdbtools">MDB Tools开源项目地址</a><br>7、<a href="https://www.easysoft.com/developer/interfaces/odbc/sqlstate_status_return_codes.html">错误码查询sqlstate_status_return_codes</a><br>8、<a href="https://www.jb51.net/article/65565.htm">在Linux中通过Python脚本访问mdb数据库的方法</a><br>9、<a href="https://www.easysoft.com/products/data_access/odbc-access-driver/index.html#section=tab-1">Access ODBC Driver</a><br>10、<a href="https://www.cdata.com/drivers/access/download/odbc/#unix">ODBC Driver Download: Access</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>软件应用</category>
        <category>Access</category>
        <category>odbc-mdbtools</category>
        <category>Python</category>
        <category>mdbtools</category>
        <category>unixODBC</category>
      </categories>
      <tags>
        <tag>Access</tag>
        <tag>Python</tag>
        <tag>odbc-mdbtools</tag>
        <tag>mdbtools</tag>
        <tag>unixODBC</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11系统中用update-alternatives版本管理</title>
    <url>/2022/01/27/Debian11%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%94%A8update-alternatives%E8%BF%9B%E8%A1%8C%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><code>update-alternatives</code>版本管理  </p>
<h1 id="为系统自带python2-7创建软连接"><a href="#为系统自带python2-7创建软连接" class="headerlink" title="为系统自带python2.7创建软连接"></a>为系统自带python2.7创建软连接</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1</span><br><span class="line">```  </span><br><span class="line">`// --install 选项使用了多个参数用于创建符号链接。`</span><br><span class="line"></span><br><span class="line">`update-alternatives`: 使用 /usr/bin/python2.7 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">```bash</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.9 2</span><br><span class="line">update-alternatives: 使用 /usr/bin/python3.9 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ whereis python3.10</span><br><span class="line">python3: /usr/bin/python3.9 /usr/bin/python3 /usr/lib/python3.9 /usr/lib/python3 /etc/python3.9 /etc/python3 /usr/local/bin/python3 /usr/local/bin/python3.10-config /usr/local/bin/python3.10 /usr/local/lib/python3.9 /usr/local/lib/python3.10 /usr/share/python3 /usr/share/man/man1/python3.1.gz</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/python python /usr/local/bin/python3.10 3</span><br><span class="line">update-alternatives: 使用 /usr/local/bin/python3.10 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ sudo update-alternatives --list python</span><br><span class="line">/usr/bin/python2.7</span><br><span class="line">/usr/bin/python3.9</span><br><span class="line">/usr/local/bin/python3.10</span><br><span class="line">$ sudo update-alternatives --config python</span><br><span class="line">有 3 个候选项可用于替换 python (提供 /usr/bin/python)。</span><br><span class="line"></span><br><span class="line">  选择       路径                     优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">* 0            /usr/local/bin/python3.10   3         自动模式</span><br><span class="line">  1            /usr/bin/python2.7          1         手动模式</span><br><span class="line">  2            /usr/bin/python3.9          2         手动模式</span><br><span class="line">  3            /usr/local/bin/python3.10   3         手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：</span><br></pre></td></tr></table></figure>
<h1 id="以下为切换3-9及切换为3-10实例："><a href="#以下为切换3-9及切换为3-10实例：" class="headerlink" title="以下为切换3.9及切换为3.10实例："></a>以下为切换3.9及切换为3.10实例：</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo update-alternatives --config python</span><br><span class="line">有 3 个候选项可用于替换 python (提供 /usr/bin/python)。</span><br><span class="line"></span><br><span class="line">  选择       路径                     优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">* 0            /usr/local/bin/python3.10   3         自动模式</span><br><span class="line">  1            /usr/bin/python2.7          1         手动模式</span><br><span class="line">  2            /usr/bin/python3.9          2         手动模式</span><br><span class="line">  3            /usr/local/bin/python3.10   3         手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：2</span><br><span class="line">update-alternatives: 使用 /usr/bin/python3.9 来在手动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ python</span><br><span class="line">Python 3.9.2 (default, Feb 28 2021, 17:03:44) </span><br><span class="line">[GCC 10.2.1 20210110] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">[6]+  已停止               python</span><br><span class="line">$ sudo update-alternatives --config python</span><br><span class="line">有 3 个候选项可用于替换 python (提供 /usr/bin/python)。</span><br><span class="line"></span><br><span class="line">  选择       路径                     优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">  0            /usr/local/bin/python3.10   3         自动模式</span><br><span class="line">  1            /usr/bin/python2.7          1         手动模式</span><br><span class="line">* 2            /usr/bin/python3.9          2         手动模式</span><br><span class="line">  3            /usr/local/bin/python3.10   3         手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：0</span><br><span class="line">update-alternatives: 使用 /usr/local/bin/python3.10 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ python</span><br><span class="line">Python 3.10.0 (default, Oct 17 2021, 10:46:43) [GCC 10.2.1 20210110] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; ^Z</span><br><span class="line">[7]+  已停止               python</span><br><span class="line"></span><br><span class="line">$ sudo vim pip</span><br><span class="line">	修改：<span class="comment">#!/usr/local/bin/python2.7</span></span><br><span class="line">	为： <span class="comment">#!/usr/local/bin/python3.10</span></span><br><span class="line">$ pip -V</span><br><span class="line">pip 21.3 from /home/yk/.local/lib/python3.10/site-packages/pip (python 3.10)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>Update-alternatives</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian系统安装Docker</title>
    <url>/2021/12/18/Debian11%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85Docker/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装、卸载Docker及安装软件实例"><a href="#安装、卸载Docker及安装软件实例" class="headerlink" title="安装、卸载Docker及安装软件实例"></a>安装、卸载<code>Docker</code>及安装软件实例</h1><h2 id="设置仓库源"><a href="#设置仓库源" class="headerlink" title="设置仓库源"></a>设置仓库源</h2><h3 id="更新仓库，安装仓库源的HTTPS支持。"><a href="#更新仓库，安装仓库源的HTTPS支持。" class="headerlink" title="更新仓库，安装仓库源的HTTPS支持。"></a>更新仓库，安装仓库源的<code>HTTPS</code>支持。</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg \</span><br><span class="line">    lsb-release</span><br></pre></td></tr></table></figure>
<h3 id="增加Docker官方GPG密钥"><a href="#增加Docker官方GPG密钥" class="headerlink" title="增加Docker官方GPG密钥:"></a>增加<code>Docker</code>官方<code>GPG密钥</code>:</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span><br></pre></td></tr></table></figure>
<h3 id="添加Docker仓库安装源"><a href="#添加Docker仓库安装源" class="headerlink" title="添加Docker仓库安装源"></a>添加<code>Docker</code>仓库安装源</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> \</span><br><span class="line">  <span class="string">&quot;deb [arch=<span class="subst">$(dpkg --print-architecture)</span> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian \</span></span><br><span class="line"><span class="string">  <span class="subst">$(lsb_release -cs)</span> stable&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br></pre></td></tr></table></figure>
<h2 id="安装Docker-Engine"><a href="#安装Docker-Engine" class="headerlink" title="安装Docker Engine"></a>安装<code>Docker Engine</code></h2><h3 id="安装最新版本的Docker-Engine和containerd，或者执行下一步安装特定版本"><a href="#安装最新版本的Docker-Engine和containerd，或者执行下一步安装特定版本" class="headerlink" title="安装最新版本的Docker Engine和containerd，或者执行下一步安装特定版本"></a>安装最新版本的<code>Docker Engine</code>和<code>containerd</code>，或者执行下一步安装特定版本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装最新版本</span></span><br><span class="line">sudo apt install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
<h3 id="要安装特定版本的Docker-Engine，请在repo中列出可用的版本，然后选择并安装"><a href="#要安装特定版本的Docker-Engine，请在repo中列出可用的版本，然后选择并安装" class="headerlink" title="要安装特定版本的Docker Engine，请在repo中列出可用的版本，然后选择并安装:"></a>要安装特定版本的<code>Docker Engine</code>，请在<code>repo</code>中列出可用的版本，然后选择并安装:</h3><h4 id="列出repo中可用的版本"><a href="#列出repo中可用的版本" class="headerlink" title="列出repo中可用的版本"></a>列出<code>repo</code>中可用的版本</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-cache madison docker-ce</span><br><span class="line"> docker-ce | 5:20.10.12~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br><span class="line"> docker-ce | 5:20.10.11~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br><span class="line"> docker-ce | 5:20.10.10~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br><span class="line"> docker-ce | 5:20.10.9~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br><span class="line"> docker-ce | 5:20.10.8~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br><span class="line"> docker-ce | 5:20.10.7~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br><span class="line"> docker-ce | 5:20.10.6~3-0~debian-bullseye | https://download.docker.com/linux/debian bullseye/stable amd64 Packages</span><br></pre></td></tr></table></figure>
<h4 id="例如，使用第二列中的版本字符串安装特定的版本"><a href="#例如，使用第二列中的版本字符串安装特定的版本" class="headerlink" title="例如，使用第二列中的版本字符串安装特定的版本"></a>例如，使用第二列中的版本字符串安装特定的版本</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sudo apt-get install docker-ce=&lt;VERSION_STRING&gt; docker-ce-cli=&lt;VERSION_STRING&gt; containerd.io</span></span><br><span class="line">sudo apt-get install docker-ce=5:20.10.12~3-0~debian-bullseye docker-ce-cli=5:20.10.12~3-0~debian-bullseye containerd.io</span><br></pre></td></tr></table></figure>
<h3 id="验证安装"><a href="#验证安装" class="headerlink" title="验证安装"></a>验证安装</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker run hello-world</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">Unable to find image <span class="string">&#x27;hello-world:latest&#x27;</span> locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">2db29710123e: Pull complete </span><br><span class="line">Digest: sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<h2 id="卸载Docker引擎"><a href="#卸载Docker引擎" class="headerlink" title="卸载Docker引擎"></a>卸载<code>Docker</code>引擎</h2><h3 id="卸载Docker-Engine、CLI和Containerd包"><a href="#卸载Docker-Engine、CLI和Containerd包" class="headerlink" title="卸载Docker Engine、CLI和Containerd包"></a>卸载<code>Docker Engine</code>、<code>CLI</code>和<code>Containerd</code>包</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt purge docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
<h3 id="删除主机上的所有镜像、容器和卷"><a href="#删除主机上的所有镜像、容器和卷" class="headerlink" title="删除主机上的所有镜像、容器和卷"></a>删除主机上的所有镜像、容器和卷</h3><p>主机上的映像、容器、卷或自定义配置文件不会自动删除删除所有镜像、容器和卷<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> -rf /var/lib/docker</span><br><span class="line">sudo <span class="built_in">rm</span> -rf /var/lib/containerd</span><br></pre></td></tr></table></figure><br>必须手动删除已编辑的配置文件。</p>
<h2 id="docker安装软件实例—安装微信"><a href="#docker安装软件实例—安装微信" class="headerlink" title="docker安装软件实例—安装微信"></a><code>docker</code>安装软件实例—安装微信</h2><h3 id="docker换源"><a href="#docker换源" class="headerlink" title="docker换源"></a><code>docker</code>换源</h3><p>编辑<code>daemon.json</code>(不存在就新建)<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure><br>填写以下内容：<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;http://ovfftd6p.mirror.aliyuncs.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://registry.docker-cn.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://docker.mirrors.ustc.edu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://hub-mirror.c.163.com&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data-root&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/home/你自己用户名/docker-home&quot;</span><span class="punctuation">,</span> <span class="comment">// 数据目录</span></span><br><span class="line">  <span class="attr">&quot;insecure-registries&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;registry.docker-cn.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;docker.mirrors.ustc.edu.cn&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;debug&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;experimental&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="重新加载并查看docker信息"><a href="#重新加载并查看docker信息" class="headerlink" title="重新加载并查看docker信息"></a>重新加载并查看<code>docker</code>信息</h3><p>依次输入以下命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br><span class="line">sudo docker info</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">Client:</span><br><span class="line"> Context:    default</span><br><span class="line"> Debug Mode: <span class="literal">false</span></span><br><span class="line"> Plugins:</span><br><span class="line">  app: Docker App (Docker Inc., v0.9.1-beta3)</span><br><span class="line">  buildx: Docker Buildx (Docker Inc., v0.7.1-docker)</span><br><span class="line">  scan: Docker Scan (Docker Inc., v0.12.0)</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Containers: 1</span><br><span class="line">  Running: 0</span><br><span class="line">  Paused: 0</span><br><span class="line">  Stopped: 1</span><br><span class="line"> Images: 1</span><br><span class="line"> Server Version: 20.10.12</span><br><span class="line"> Storage Driver: overlay2</span><br><span class="line">  Backing Filesystem: extfs</span><br><span class="line">  Supports d_type: <span class="literal">true</span></span><br><span class="line">  Native Overlay Diff: <span class="literal">true</span></span><br><span class="line">  userxattr: <span class="literal">false</span></span><br><span class="line"> Logging Driver: json-file</span><br><span class="line"> Cgroup Driver: systemd</span><br><span class="line"> Cgroup Version: 2</span><br><span class="line"> Plugins:</span><br><span class="line">  Volume: <span class="built_in">local</span></span><br><span class="line">  Network: bridge host ipvlan macvlan null overlay</span><br><span class="line">  Log: awslogs fluentd gcplogs gelf journald json-file <span class="built_in">local</span> logentries splunk syslog</span><br><span class="line"> Swarm: inactive</span><br><span class="line"> Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc</span><br><span class="line">......</span><br><span class="line"> runc version: v1.0.2-0-g52b36a2</span><br><span class="line"> init version: de40ad0</span><br><span class="line"> Security Options:</span><br><span class="line">  apparmor</span><br><span class="line">  seccomp</span><br><span class="line">   Profile: default</span><br><span class="line">  cgroupns</span><br><span class="line"> Kernel Version: 5.10.0-9-amd64</span><br><span class="line"> Operating System: Debian GNU/Linux 11 (bullseye)</span><br><span class="line"> OSType: linux</span><br><span class="line"> Architecture: x86_64</span><br><span class="line"> CPUs: 2</span><br><span class="line"> Total Memory: 3.743GiB</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"></span><br><span class="line"> Docker Root Dir: /home/你自己用户名/docker-home</span><br><span class="line"> Debug Mode: <span class="literal">true</span></span><br><span class="line">  File Descriptors: 24</span><br><span class="line">  Goroutines: 34</span><br><span class="line">  System Time: 2021-12-18T12:12:11.920214294+08:00</span><br><span class="line">  EventsListeners: 0</span><br><span class="line"> Registry: https://index.docker.io/v1/</span><br><span class="line"> Labels:</span><br><span class="line"> Experimental: <span class="literal">true</span></span><br><span class="line"> Insecure Registries:</span><br><span class="line">  docker.mirrors.ustc.edu.cn</span><br><span class="line">  registry.docker-cn.com</span><br><span class="line">  127.0.0.0/8</span><br><span class="line"> Registry Mirrors:</span><br><span class="line">  http://ovfftd6p.mirror.aliyuncs.com/</span><br><span class="line">  http://registry.docker-cn.com/</span><br><span class="line">  http://docker.mirrors.ustc.edu.cn/</span><br><span class="line">  http://hub-mirror.c.163.com/</span><br><span class="line"> Live Restore Enabled: <span class="literal">false</span></span><br></pre></td></tr></table></figure></p>
<h3 id="拉取微信镜像"><a href="#拉取微信镜像" class="headerlink" title="拉取微信镜像"></a>拉取微信镜像</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker pull bestwu/wechat</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from bestwu/wechat</span><br><span class="line">f21eee950c89: Pull complete </span><br><span class="line">11ce96be0dbe: Pull complete </span><br><span class="line">213b37605fda: Pull complete </span><br><span class="line">fb5f4607d644: Pull complete </span><br><span class="line">996bef3d98a0: Pull complete </span><br><span class="line">6181aef875e7: Pull complete </span><br><span class="line">892cf94c8e7a: Pull complete </span><br><span class="line">Digest: sha256:f0a3b04aae119ed2d7bb9e6f1f8e5a3cf39a435b028fd9ddd733680fd5639693</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> bestwu/wechat:latest</span><br><span class="line">docker.io/bestwu/wechat:latest</span><br></pre></td></tr></table></figure>
<h3 id="创建运行脚本wechat-sh"><a href="#创建运行脚本wechat-sh" class="headerlink" title="创建运行脚本wechat.sh"></a>创建运行脚本<code>wechat.sh</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim wechat.sh</span><br></pre></td></tr></table></figure>
<p>输入以下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker run -d --name wechat --device /dev/snd --ipc=<span class="string">&quot;host&quot;</span> \</span><br><span class="line"> -v /tmp/.X11-unix:/tmp/.X11-unix \</span><br><span class="line"> -v <span class="variable">$HOME</span>/WeChatFiles:/WeChatFiles \</span><br><span class="line"> -e DISPLAY=unix<span class="variable">$DISPLAY</span> \</span><br><span class="line"> -e XMODIFIERS=@im=fcitx \</span><br><span class="line"> -e QT_IM_MODULE=fcitx \</span><br><span class="line"> -e GTK_IM_MODULE=fcitx \</span><br><span class="line"> -e AUDIO_GID=`getent group audio | <span class="built_in">cut</span> -d: -f3` \</span><br><span class="line"> -e GID=`<span class="built_in">id</span> -g` \</span><br><span class="line"> -e UID=`<span class="built_in">id</span> -u` \</span><br><span class="line">bestwu/wechat</span><br></pre></td></tr></table></figure><br>使用脚本：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> wechat.sh</span><br></pre></td></tr></table></figure></p>
<h3 id="查看容器内容"><a href="#查看容器内容" class="headerlink" title="查看容器内容"></a>查看容器内容</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker ps -a</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line">CONTAINER ID   IMAGE           COMMAND            CREATED          STATUS                   PORTS     NAMES</span><br><span class="line">091e415c8872   bestwu/wechat   <span class="string">&quot;/entrypoint.sh&quot;</span>   13 minutes ago   Up 13 minutes                      wechat</span><br><span class="line">4eadb762084f   hello-world     <span class="string">&quot;/hello&quot;</span>           2 hours ago      Exited (0) 2 hours ago             priceless_goodall</span><br></pre></td></tr></table></figure>
<h3 id="打开-amp-关闭微信"><a href="#打开-amp-关闭微信" class="headerlink" title="打开&amp;关闭微信"></a>打开&amp;关闭微信</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 打开</span></span><br><span class="line">sudo docker start wechat</span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">sudo docker stop wechat</span><br></pre></td></tr></table></figure>
<h3 id="删除微信容器"><a href="#删除微信容器" class="headerlink" title="删除微信容器"></a>删除微信容器</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker stop $(docker ps -a -q) <span class="comment"># 停止所有运行的容器</span></span><br><span class="line">sudo docker <span class="built_in">rm</span> -f wechat</span><br></pre></td></tr></table></figure>
<h3 id="删除镜像和容器"><a href="#删除镜像和容器" class="headerlink" title="删除镜像和容器"></a>删除镜像和容器</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker rmi &lt;镜像<span class="built_in">id</span>&gt;</span><br><span class="line"><span class="comment"># 例如删除 hello-world</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除镜像</span></span><br><span class="line">sudo docker rmi -f hello-world </span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line">Untagged: hello-world:latest</span><br><span class="line">Untagged: hello-world@sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f</span><br><span class="line">Deleted: sha256:feb5d9fea6a5e9606aa995e879d862b825965ba48de054caab5ef356dc6b3412</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除容器</span></span><br><span class="line">sudo docker <span class="built_in">rm</span> 4eadb762084f  </span><br></pre></td></tr></table></figure>
<h1 id="安装、卸载docker-compose及安装软件实例"><a href="#安装、卸载docker-compose及安装软件实例" class="headerlink" title="安装、卸载docker-compose及安装软件实例"></a>安装、卸载<code>docker-compose</code>及安装软件实例</h1><h2 id="安装docker-compose"><a href="#安装docker-compose" class="headerlink" title="安装docker-compose"></a>安装<code>docker-compose</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 下载</span></span><br><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/v2.2.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="comment"># 授予可执行权限</span></span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">docker-compose -v</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">Docker Compose version v2.2.2</span><br><span class="line"><span class="comment"># 卸载</span></span><br><span class="line">sudo <span class="built_in">rm</span> /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
<p>若提示<code>XXX commend not found</code>，则建立软链接或者将<code>/user/local/bin</code>加入到环境变量(推荐)<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建软链接</span></span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span><br><span class="line"><span class="comment"># 加入路径到环境变量</span></span><br><span class="line">vim ~/.bashrc</span><br><span class="line"><span class="built_in">export</span> PATH=/usr/local/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></p>
<h2 id="安装实例—安装TIM-QQ"><a href="#安装实例—安装TIM-QQ" class="headerlink" title="安装实例—安装TIM-QQ"></a>安装实例—安装<code>TIM-QQ</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim docker-compose.yml</span><br></pre></td></tr></table></figure>
<p>输入以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">version: &#x27;2&#x27;</span><br><span class="line">services:</span><br><span class="line">  qq:</span><br><span class="line">    image: bestwu/qq:office</span><br><span class="line">    container_name: qq</span><br><span class="line">    ipc: host</span><br><span class="line">    devices:</span><br><span class="line">      - /dev/snd #声音</span><br><span class="line">    volumes:</span><br><span class="line">      - /tmp/.X11-unix:/tmp/.X11-unix</span><br><span class="line">      - /home/yk/TencentFiles:/TencentFiles #使用自己的用户路径</span><br><span class="line">    environment:</span><br><span class="line">      - DISPLAY=unix$DISPLAY</span><br><span class="line">      - XMODIFIERS=@im=fcitx # 中文输入，这里根据系统输入法类型自行输入，默认是IBus</span><br><span class="line">      - QT_IM_MODULE=fcitx</span><br><span class="line">      - GTK_IM_MODULE=fcitx</span><br><span class="line">      - AUDIO_GID=29 # 可选 默认63（fedora） 主机audio gid 解决声音设备访问权限问题</span><br><span class="line">      - GID=$GID # 可选 默认1000 主机当前用户 gid 解决挂载目录访问权限问题</span><br><span class="line">      - UID=$UID # 可选 默认1000 主机当前用户 uid 解决挂载目录访问权限问题</span><br></pre></td></tr></table></figure><br>运行：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></p>
<p>具体介绍参考：<br><a href="https://github.com/top-bettercode/docker-qq">开源项目 docker-qq</a></p>
<h1 id="更换Docker数据挂载目录"><a href="#更换Docker数据挂载目录" class="headerlink" title="更换Docker数据挂载目录"></a>更换<code>Docker</code>数据挂载目录</h1><p>默认安装<code>docker</code>将会使用<code>/var/lib/docker</code>作为数据存放目录，可以新增额外的数据盘，以减少对根分区(<code>/</code>)或者动态数据存储分区(<code>/var</code>)的空间占用。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 新建数据存储目录(也可以另外挂载数据分区)</span></span><br><span class="line"><span class="built_in">mkdir</span> -p ~/Dates/docker</span><br><span class="line"><span class="comment"># 切换到 root 并复制 docker 原始文件到新建文件夹</span></span><br><span class="line">sudo <span class="built_in">cp</span> -r /var/lib/docker/*  ~/Dates/docker</span><br><span class="line"><span class="comment"># 将新建的 docker 数据文件目录软链接到当前目录下</span></span><br><span class="line"><span class="built_in">ln</span> -s /home/你自己用户名/docker_dates/ /var/lib/docker </span><br></pre></td></tr></table></figure></p>
<p>参考资料：<br>1、<a href="https://docs.docker.com/engine/install/debian/">在Debian上安装</a><br>2、<a href="https://www.jianshu.com/p/2a603db77195">Docker安装微信</a><br>3、<a href="https://www.cnblogs.com/hellxz/p/docker-change-data-root.html">【简记】修改Docker数据目录位置，包含镜像位置</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>docker-compose</category>
        <category>docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>Docker-compose</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11编译安装PHP8.1.0版</title>
    <url>/2021/11/28/Debian11%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85PHP8.1.0%E7%89%88/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、编译安装"><a href="#一、编译安装" class="headerlink" title="一、编译安装"></a>一、编译安装</h1><h2 id="安装相关依赖"><a href="#安装相关依赖" class="headerlink" title="安装相关依赖"></a>安装相关依赖</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install gcc make zlib1g* libssl-dev libpcre+* libcurl-ocaml libcurl-ocaml-dev libcurl3-nss libcurlpp-dev libcurlpp0 libonig5 libreadline-dev libtidy-dev slapd ldap-utils libxml2-dev libpcre2 libjpeg-dev libxslt1-dev libzip-dev</span><br></pre></td></tr></table></figure>
<h2 id="下载并解压php8-1-0压缩包"><a href="#下载并解压php8-1-0压缩包" class="headerlink" title="下载并解压php8.1.0压缩包"></a>下载并解压<code>php8.1.0</code>压缩包</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://www.php.net/distributions/php-8.1.0.tar.gz</span><br><span class="line">tar -zxvf php-8.1.0.tar.gz</span><br></pre></td></tr></table></figure>
<h2 id="关于php的安装，提供两个方案，第二个方案针对Debian系统。"><a href="#关于php的安装，提供两个方案，第二个方案针对Debian系统。" class="headerlink" title="关于php的安装，提供两个方案，第二个方案针对Debian系统。"></a>关于<code>php</code>的安装，提供两个方案，第二个方案针对<code>Debian</code>系统。</h2><h3 id="一-一般编译安装"><a href="#一-一般编译安装" class="headerlink" title="(一) 一般编译安装"></a>(一) 一般编译安装</h3><h4 id="1-编译"><a href="#1-编译" class="headerlink" title="(1)编译"></a>(1)编译</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> php-8.1.0</span><br><span class="line">./configure --prefix=/usr/local/php8.1 --with-config-file-path=/usr/local/php8.1/etc --sysconfdir=/etc/php8.1 --disable-fileinfo --enable-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-config-file-scan-dir=/etc/php.d  --enable-mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --enable-mysqlnd-compression-support --disable-rpath --with-mysql-sock=/var/lib/mysql/mysql.sock --with-mhash --with-openssl --with-zlib --with-curl --enable-ftp --with-bz2 --with-libxml --enable-gd --with-jpeg --with-freetype --enable-sockets --without-iconv --with-xsl --with-zip --with-external-pcre --with-pear --enable-session --enable-xml --enable-gd-jis-conv --enable-shared --enable-sysvmsg --enable-sysvsem --enable-sysvshm --enable-mbregex --enable-pcntl --with-gettext --with-readline --with-tidy --enable-mbstring --with-pear --enable-bcmath --enable-calendar --enable-exif --enable-shmop --with-curl --enable-intl --enable-soap --enable-opcache --without-gdbm</span><br></pre></td></tr></table></figure>
<h4 id="2-安装"><a href="#2-安装" class="headerlink" title="(2)安装"></a>(2)安装</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make &gt; make.log 2&gt;&amp;1 <span class="comment"># 将输出重定向到log.txt文件中，同时将标准错误也重定向到make.log</span></span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<h4 id="3-一些问题："><a href="#3-一些问题：" class="headerlink" title="(3)一些问题："></a>(3)一些问题：</h4><p>1&gt;若提示缺依赖就安装相应依赖<br>2&gt;可以用<code>./configure –help</code>查看配置选项<br>3&gt;<code>No package &#39;oniguruma&#39; found</code>错误解决：<br><code>oniguruma是处理正则表达式的库</code><br>新开一个终端，然后输入：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/kkos/oniguruma/releases/download/v6.9.7.1/onig-6.9.7.1.tar.gz</span><br><span class="line">tar zxvf onig-6.9.7.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> onig-6.9.7</span><br><span class="line">./configure</span><br><span class="line">sudo make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure></p>
<h3 id="二-Debian系统用auto-apt及checkinstall"><a href="#二-Debian系统用auto-apt及checkinstall" class="headerlink" title="(二) Debian系统用auto-apt及checkinstall"></a>(二) Debian系统用<code>auto-apt</code>及<code>checkinstall</code></h3><h4 id="1、下载并安装auto-apt及checkinstall"><a href="#1、下载并安装auto-apt及checkinstall" class="headerlink" title="1、下载并安装auto-apt及checkinstall"></a>1、下载并安装<code>auto-apt</code>及<code>checkinstall</code></h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://mirrors.edge.kernel.org/debian/pool/main/a/auto-apt/auto-apt_0.3.24_amd64.deb</span><br><span class="line">sudo dpkg -i auto-apt_0.3.24_amd64.deb</span><br><span class="line">sudo apt install -f  <span class="comment"># 安装auto-apt依赖</span></span><br><span class="line">sudo apt install checkinstall</span><br></pre></td></tr></table></figure>
<h4 id="2、用auto-apt进行编译"><a href="#2、用auto-apt进行编译" class="headerlink" title="2、用auto-apt进行编译"></a>2、用<code>auto-apt</code>进行编译</h4><p>编译命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">auto-apt run ./configure  --prefix=/usr/local/php8.1 --with-config-file-path=/usr/local/php8.1/etc --sysconfdir=/etc/php8.1 --disable-fileinfo --enable-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-config-file-scan-dir=/etc/php.d  --enable-mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --enable-mysqlnd-compression-support --disable-rpath --with-mysql-sock=/var/lib/mysql/mysql.sock --with-mhash --with-openssl --with-zlib --with-curl --enable-ftp --with-bz2 --with-libxml --enable-gd --with-jpeg --with-freetype --enable-sockets --without-iconv --with-xsl --with-zip --with-external-pcre --with-pear --enable-session --enable-xml --enable-gd-jis-conv --enable-shared --enable-sysvmsg --enable-sysvsem --enable-sysvshm --enable-mbregex --enable-pcntl --with-gettext --with-readline --with-tidy --enable-mbstring --with-pear --enable-bcmath --enable-calendar --enable-exif --enable-shmop --with-curl --enable-intl --enable-soap --enable-opcache --without-gdbm</span><br></pre></td></tr></table></figure><br>注意:<code>--with-fpm-user=nginx --with-fpm-group=nginx</code>，<code>fpm-php</code>将属于<code>nginx</code>用户组;<br>编译完成会提示是否更改安装包信息。</p>
<h4 id="3、checkinstall安装"><a href="#3、checkinstall安装" class="headerlink" title="3、checkinstall安装"></a>3、<code>checkinstall</code>安装</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make &amp;&amp; sudo checkinstall</span><br></pre></td></tr></table></figure>
<p>其他更多命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dpkg -i packagename.deb  //下次直接用生成的`deb包`安装</span><br><span class="line">dpkg -r packagename.deb  // 卸载</span><br><span class="line"><span class="comment"># 列出包中安装的文件位置</span></span><br><span class="line">dpkg -L packagename</span><br><span class="line"><span class="comment"># 检查是否安装成功</span></span><br><span class="line">dpkg -l | grep packagename</span><br><span class="line"><span class="comment"># 同上</span></span><br><span class="line">apt list --installed | grep packagename</span><br></pre></td></tr></table></figure></p>
<h1 id="二、配置php8-1-0相关文件"><a href="#二、配置php8-1-0相关文件" class="headerlink" title="二、配置php8.1.0相关文件"></a>二、配置<code>php8.1.0</code>相关文件</h1><h2 id="1、复制php-fpm-conf和www-conf配置文件"><a href="#1、复制php-fpm-conf和www-conf配置文件" class="headerlink" title="1、复制php-fpm.conf和www.conf配置文件"></a>1、复制<code>php-fpm.conf</code>和<code>www.conf</code>配置文件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> /etc/php8.1/php-fpm.conf.default /etc/php8.1/php-fpm.conf &amp;&amp; sudo <span class="built_in">cp</span> /etc/php8.1/php-fpm.d/www.conf.default /etc/php8.1/php-fpm.d/www.conf</span><br><span class="line">sudo vim /etc/php8.1/php-fpm.conf</span><br></pre></td></tr></table></figure>
<p>将以下两个配置项目打开，即去掉前面的<code>;</code><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pid = run/php-fpm.pid</span><br><span class="line">error_log = log/php-fpm.log</span><br><span class="line">log_level = notice</span><br></pre></td></tr></table></figure></p>
<h2 id="2、创建以下文件夹和文件【根据编译时设置的软件路径】"><a href="#2、创建以下文件夹和文件【根据编译时设置的软件路径】" class="headerlink" title="2、创建以下文件夹和文件【根据编译时设置的软件路径】"></a>2、创建以下文件夹和文件【根据编译时设置的软件路径】</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p /usr/local/php8.1/var/log &amp;&amp; sudo <span class="built_in">touch</span> /usr/local/php8.1/var/log/php-fpm.log</span><br><span class="line">sudo <span class="built_in">mkdir</span> /usr/local/php8.1/etc  <span class="comment"># 放置php.ini配置文件</span></span><br></pre></td></tr></table></figure>
<p>从源码文件夹拷贝<code>php.ini-development</code>或者<code>php.ini-production</code>到<code>/usr/local/php8.1/etc</code>并命名为<code>php.ini</code>。</p>
<p>比如：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> ~/下载/软件/deb包/php-8.1.0/php.ini-production /usr/local/php8.1/etc/php.ini</span><br></pre></td></tr></table></figure></p>
<h2 id="3、启动php-fpm命令"><a href="#3、启动php-fpm命令" class="headerlink" title="3、启动php-fpm命令"></a>3、启动<code>php-fpm</code>命令</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /usr/local/php8.1/sbin/php-fpm</span><br></pre></td></tr></table></figure>
<h2 id="4、设置php-fpm开机启动及管理服务"><a href="#4、设置php-fpm开机启动及管理服务" class="headerlink" title="4、设置php-fpm开机启动及管理服务"></a>4、设置<code>php-fpm</code>开机启动及管理服务</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /usr/lib/systemd/system/php-fpm.service</span><br></pre></td></tr></table></figure>
<p>输入以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=The PHP FastCGI Process Manager</span><br><span class="line">After=syslog.target network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/usr/local/php8.1/var/run/var/run/php-fpm.pid</span><br><span class="line">ExecStart=/usr/local/php/sbin/php-fpm</span><br><span class="line">ExecReload=/bin/kill -USR2 $MAINPID</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></p>
<h2 id="5、重新加载systemctl配置"><a href="#5、重新加载systemctl配置" class="headerlink" title="5、重新加载systemctl配置"></a>5、重新加载<code>systemctl</code>配置</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure>
<h2 id="6、开机自动启动php-fpm服务"><a href="#6、开机自动启动php-fpm服务" class="headerlink" title="6、开机自动启动php-fpm服务"></a>6、开机自动启动<code>php-fpm</code>服务</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span>  php-fpm.service</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/php-fpm.service → /lib/systemd/system/php-fpm.service.</span><br></pre></td></tr></table></figure>
<h2 id="7、为PHP8-1-0设置软连接或者环境变量"><a href="#7、为PHP8-1-0设置软连接或者环境变量" class="headerlink" title="7、为PHP8.1.0设置软连接或者环境变量"></a>7、为<code>PHP8.1.0</code>设置软连接或者环境变量</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/php8.1/bin/php /usr/local/bin/php</span><br></pre></td></tr></table></figure>
<p>或者直接将<code>/usr/local/php8.1/bin</code>添加到<strong>系统环境变量[推荐]</strong>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export PATH=/usr/local/php8.1/bin/:<span class="variable">$PATH</span>&quot;</span> | sudo <span class="built_in">tee</span> -a ~/.bashrc  <span class="comment"># $PATH 保留原来变量，添加后面的新变量; tee -a 在后面追加</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加到系统环境</span></span><br><span class="line">su </span><br><span class="line">密码：******</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export PATH=/usr/local/php8.1/bin:<span class="variable">$PATH</span>&quot;</span> | sudo <span class="built_in">tee</span> -a /etc/profile</span><br><span class="line"><span class="comment"># 需要注意的是：</span></span><br><span class="line"><span class="comment"># 对/etc/profile有修改的话必须得重启你的修改才会生效</span></span><br><span class="line"><span class="comment"># 在/etc/profile里设置系统环境变量时，路径末尾不能以&quot;/&quot;结尾，否则将导致整个PATH变量出错。</span></span><br></pre></td></tr></table></figure><br>另外也可以只添加到用户环境变量，用户环境变量文件路径为：<code>~/.bashrc</code>，重新开终端即可生效。<br>重新加载使配置生效：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如果是 /etc/profile，重启生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment"># 如果是添加到用户环境变量，重启生效</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure><br>查看安装的<code>php</code>版本命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php -v</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">PHP 8.1.0 (cli) (built: Dec 16 2021 20:25:06) (NTS)</span><br><span class="line">Copyright (c) The PHP Group</span><br><span class="line">Zend Engine v4.1.0, Copyright (c) Zend Technologies</span><br></pre></td></tr></table></figure></p>
<h2 id="附：-bash-profile与-bashrc的区别"><a href="#附：-bash-profile与-bashrc的区别" class="headerlink" title="附：.bash_profile与.bashrc的区别"></a>附：<code>.bash_profile</code>与<code>.bashrc</code>的区别</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~/.bash_profile <span class="comment"># 是交互式、login 方式进入bash 运行的；</span></span><br><span class="line">~/.bashrc <span class="comment"># 是交互式 non-login 方式进入bash 运行的；</span></span><br></pre></td></tr></table></figure>
<p>通常二者设置大致相同，所以通常前者会调用后者。</p>
<p>至此，<code>php8.1.0</code>编译安装全部完成。</p>
<h1 id="三、nginx配置支持php"><a href="#三、nginx配置支持php" class="headerlink" title="三、nginx配置支持php"></a>三、<code>nginx</code>配置支持<code>php</code></h1><h2 id="修改nginx-conf配置"><a href="#修改nginx-conf配置" class="headerlink" title="修改nginx.conf配置"></a>修改<code>nginx.conf</code>配置</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>
<p>参照下面内容修改：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> server &#123;</span><br><span class="line">     listen       8088;</span><br><span class="line">     server_name  localhost;</span><br><span class="line">     #charset koi8-r;</span><br><span class="line">     #access_log  logs/host.access.log  main;</span><br><span class="line">     location / &#123;</span><br><span class="line">         root   /你的站点路径/;</span><br><span class="line">         index  index.php index.html index.htm;</span><br><span class="line">     &#125;</span><br><span class="line">     #error_page  404              /404.html;</span><br><span class="line">     location ~ \.php$ &#123;</span><br><span class="line">         root           /你的站点路径/;</span><br><span class="line">         fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">         fastcgi_index  index.php;</span><br><span class="line">        # fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">         fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;  #  注意修改为`$document_root$`</span><br><span class="line">         include        fastcgi_params;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="测试PHP网页"><a href="#测试PHP网页" class="headerlink" title="测试PHP网页"></a>测试<code>PHP</code>网页</h2><p>在<strong>设置的<code>php</code>站点路径</strong>下新建<code>info.php</code>网页，输入如下内容：<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>保存并打开浏览器，输入：<code>http://localhost:8091/info.php</code>.<br>出现<code>php</code>信息则安装完成</p>
<h1 id="四、附：PHP连接mariadb数据库"><a href="#四、附：PHP连接mariadb数据库" class="headerlink" title="四、附：PHP连接mariadb数据库"></a>四、附：<code>PHP</code>连接<code>mariadb</code>数据库</h1><h2 id="1、PDO方式"><a href="#1、PDO方式" class="headerlink" title="1、PDO方式"></a>1、<code>PDO</code>方式</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dbms</span> = <span class="string">&quot;mysql&quot;</span>;</span><br><span class="line"><span class="variable">$host</span> = <span class="string">&quot;localhost:3306&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_username</span> = <span class="string">&quot;数据库用户名&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_psw</span> = <span class="string">&quot;数据库用户密码&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;所要使用的数据库名&quot;</span>;</span><br><span class="line"><span class="variable">$dsn</span> = <span class="string">&quot;<span class="subst">$dbms</span>:host=<span class="subst">$host</span>;dbname=<span class="subst">$dbname</span>&quot;</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$PDO</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;PDO连接方式连接成功!&#x27;</span>; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$PDO</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;SELECT * from usr_table&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="variable">$row</span>); <span class="comment">//你可以用 echo($GLOBAL); 来看到这些值</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="variable">$PDO</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;已成功关闭数据库&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(PDOException <span class="variable">$e</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;连接失败：&#x27;</span>. <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">// $dbms=&#x27;mysql&#x27;;     //数据库类型</span></span><br><span class="line"><span class="comment">// $host=&#x27;localhost:3306&#x27;; //数据库主机名</span></span><br><span class="line"><span class="comment">// $dbname=&#x27;数据库&#x27;;    //使用的数据库</span></span><br><span class="line"><span class="comment">// $user=&#x27;数据库用户名&#x27;;      //数据库连接用户名</span></span><br><span class="line"><span class="comment">// $pass=&#x27;数据库用户密码&#x27;;          //对应的密码</span></span><br><span class="line"><span class="comment">// $dsn=&quot;$dbms:host=$host;dbname=$dbname&quot;;</span></span><br><span class="line"><span class="comment">// try &#123;</span></span><br><span class="line"><span class="comment">//     $PDO = new PDO($dsn,$username,$password);//初始化一个PDO对象，就是创建了数据库连接对象$PDO</span></span><br><span class="line"><span class="comment">//     echo &#x27;PDO连接方式连接成功!&#x27;; </span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;br/&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     // // 执行查询</span></span><br><span class="line"><span class="comment">//     $sql = &quot;select * from usr_table&quot;;//需要执行的sql语句</span></span><br><span class="line"><span class="comment">//     $retval=$PDO-&gt;prepare($sql);//准备查询语句</span></span><br><span class="line"><span class="comment">//     $retval-&gt;execute();//执行查询语句，并返回结果集</span></span><br><span class="line"><span class="comment">//     // $code=$retval-&gt;errorCode();</span></span><br><span class="line"><span class="comment">//     // echo $code.&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">//     //mysqli_query($conn,&quot;INSERT INTO usr_table (usr_id, usr_name, submit_time, is_vip)</span></span><br><span class="line"><span class="comment">//     //VALUES (10,&#x27;TEN&#x27;,NOW(),0)&quot;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//     // if($code != 00000)&#123;</span></span><br><span class="line"><span class="comment">//     //     die(&quot;无法读取数据：&quot;.$retval-&gt;errorInfo());</span></span><br><span class="line"><span class="comment">// // &#125; </span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;table border=&#x27;2&#x27; width=&#x27;300&#x27;&gt;</span></span><br><span class="line"><span class="comment">//         &lt;tr&gt;</span></span><br><span class="line"><span class="comment">//         &lt;th&gt;usr_id&lt;/th&gt;</span></span><br><span class="line"><span class="comment">//         &lt;th&gt;usr_name&lt;/th&gt;</span></span><br><span class="line"><span class="comment">//         &lt;th&gt;submit_time</span></span><br><span class="line"><span class="comment">//         &lt;/th&gt;&lt;th&gt;isVip&lt;/th&gt;</span></span><br><span class="line"><span class="comment">//         &lt;/tr&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     do &#123;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;tr&gt;&quot;;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;th&gt;&quot;.$row[&#x27;usr_id&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;th&gt;&quot;.$row[&#x27;usr_name&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;th&gt;&quot;.$row[&#x27;submit_time&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;th&gt;&quot;.$row[&#x27;is_vip&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;/tr&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     &#125; while($row=$retval-&gt;fetch(PDO::FETCH_ASSOC));// 循环输出查询结果集，并且设置结果集为关联数据形式。</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;/table&gt;&quot;;</span></span><br><span class="line"><span class="comment">//         $PDO = null;</span></span><br><span class="line"><span class="comment">//         echo &quot;&lt;br/&gt;已成功关闭数据库&quot;;</span></span><br><span class="line"><span class="comment">// &#125; catch (PDOException $e) &#123;</span></span><br><span class="line"><span class="comment">//     die (&quot;Error!: &quot; . $e-&gt;getMessage() . &quot;&lt;br/&gt;&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//数据库长连接，需要最后加一个参数：array(PDO::ATTR_PERSISTENT =&gt; true) 变成这样：</span></span><br><span class="line"><span class="comment">// $db = new PDO($dsn, $user, $pass, array(PDO::ATTR_PERSISTENT =&gt; true));</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2、mysqli方式"><a href="#2、mysqli方式" class="headerlink" title="2、mysqli方式"></a>2、<code>mysqli</code>方式</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$mysql_server_name</span> = <span class="string">&quot;localhost:3306&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_username</span> = <span class="string">&quot;数据库用户名&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_psw</span> = <span class="string">&quot;数据库用户密码&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_database</span> = <span class="string">&quot;要使用的数据库&quot;</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$mysql_server_name</span>,<span class="variable">$mysql_username</span>,<span class="variable">$mysql_psw</span>,<span class="variable">$mysql_database</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;mysqli连接方式连接成功!&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// if (!$conn) </span></span><br><span class="line"><span class="comment">// &#123; </span></span><br><span class="line"><span class="comment">//     echo &quot;连接 MySQL 失败: &quot; .mysqli_connect_error(); </span></span><br><span class="line"><span class="comment">// &#125; else &#123;</span></span><br><span class="line"><span class="comment">//     echo &quot;mysqli连接方式连接成功!&quot;;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>,<span class="string">&quot;set names utf8&quot;</span>); <span class="comment">// 调整数据库编码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// // 执行查询</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from usr_table&quot;</span>;</span><br><span class="line"><span class="variable">$retval</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>,<span class="variable">$sql</span>);</span><br><span class="line"><span class="comment">//mysqli_query($conn,&quot;INSERT INTO usr_table (usr_id, usr_name, submit_time, is_vip)</span></span><br><span class="line"><span class="comment">//VALUES (10,&#x27;TEN&#x27;,NOW(),0)&quot;);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$retval</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;无法读取数据：&quot;</span>. <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$conn</span>));</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;table border=&#x27;2&#x27; width=&#x27;300&#x27;&gt;</span></span><br><span class="line"><span class="string">        &lt;tr&gt;</span></span><br><span class="line"><span class="string">        &lt;th&gt;usr_id&lt;/th&gt;</span></span><br><span class="line"><span class="string">        &lt;th&gt;usr_name&lt;/th&gt;</span></span><br><span class="line"><span class="string">        &lt;th&gt;submit_time</span></span><br><span class="line"><span class="string">        &lt;/th&gt;&lt;th&gt;isVip&lt;/th&gt;</span></span><br><span class="line"><span class="string">        &lt;/tr&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;th&gt;&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;usr_id&#x27;</span>].<span class="string">&quot;&lt;/th&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;th&gt;&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;usr_name&#x27;</span>].<span class="string">&quot;&lt;/th&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;th&gt;&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;submit_time&#x27;</span>].<span class="string">&quot;&lt;/th&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;th&gt;&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;is_vip&#x27;</span>].<span class="string">&quot;&lt;/th&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$retval</span>));<span class="comment">#光标移动到下一个结果集</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// while($row=mysqli_fetch_array($retval))</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;tr&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;th&gt;&quot;.$row[&#x27;usr_id&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;th&gt;&quot;.$row[&#x27;usr_name&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;th&gt;&quot;.$row[&#x27;submit_time&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;th&gt;&quot;.$row[&#x27;is_vip&#x27;].&quot;&lt;/th&gt;&quot;;</span></span><br><span class="line"><span class="comment">//     echo &quot;&lt;/tr&gt;&quot;;</span></span><br><span class="line"><span class="comment">// &#125;#光标移动到下一个结果集</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/table&gt;&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">mysqli_free_result</span>(<span class="variable">$retval</span>);</span><br><span class="line"><span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$conn</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3、一些问题"><a href="#3、一些问题" class="headerlink" title="3、一些问题"></a>3、一些问题</h2><h3 id="若pdo连接提示Error-SQLSTATE-HY000-2002-No-such-file-or-directory，解决办法："><a href="#若pdo连接提示Error-SQLSTATE-HY000-2002-No-such-file-or-directory，解决办法：" class="headerlink" title="若pdo连接提示Error!: SQLSTATE[HY000] [2002] No such file or directory，解决办法："></a>若<code>pdo</code>连接提示<code>Error!: SQLSTATE[HY000] [2002] No such file or directory</code>，解决办法：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /usr/local/php8.1/etc/php.ini</span><br></pre></td></tr></table></figure>
<p>修改<code>pdo_mysql.default_socket=</code>为<code>pdo_mysql.default_socket=/tmp/mysql.sock</code>,重启<code>Nginx</code>即可。 </p>
<h3 id="若提示Warning-Undefined-variable-row-in-，解决办法："><a href="#若提示Warning-Undefined-variable-row-in-，解决办法：" class="headerlink" title="若提示Warning: Undefined variable $row in #####，解决办法："></a>若提示<code>Warning: Undefined variable $row in #####</code>，解决办法：</h3><p><code>php.ini</code>这个配置文件修改一行代码，解决方法如下：<br>在<code>php.ini</code>中<br><code>error_reporting = E_ALL</code><br>修改成:<br><code>error_reporting = E_ALL &amp; ~E_NOTICE</code><br>再重启<code>nginx</code>、<code>php-fpm</code>就行了。</p>
<p>关于<strong>搭建<code>LANMP</code>请参考</strong><br><a href="../../../../2020/11/15/在Debian上安装LANMP及在win下安装MariaDB的zip版本/#三、安装PHP">在Debian上安装LANMP及在win下安装MariaDB的zip版本</a>  </p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>Linux</category>
        <category>运维</category>
        <category>MySQL</category>
        <category>Update</category>
        <category>MariaDB</category>
        <category>Debian</category>
        <category>Checkinstall</category>
        <category>Auto-apt</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
        <tag>Debian11</tag>
        <tag>PHP</tag>
        <tag>更新</tag>
        <tag>MariaDB</tag>
      </tags>
  </entry>
  <entry>
    <title>linux编译安装aria2及编译时出现checking whether the C compiler works... no错误提示的解决</title>
    <url>/2022/01/27/Debian11%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85aria2%E5%8F%8A%E7%BC%96%E8%AF%91%E6%8F%90%E7%A4%BA%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://github.com/yunfile123/aria2">aria2 项目地址</a></p>
<h1 id="编译安装aria2-1-36-0"><a href="#编译安装aria2-1-36-0" class="headerlink" title="编译安装aria2-1.36.0"></a>编译安装<code>aria2-1.36.0</code></h1><h2 id="安装支持库"><a href="#安装支持库" class="headerlink" title="安装支持库"></a>安装支持库</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> <span class="comment"># sudo apt install gcc autoconf automake libcppunit-dev libgnutls-dev nettle-dev libgmp-dev libssh2-1-dev libc-ares-dev libxml2-dev zlib1g-dev libsqlite3-dev pkg-config  </span></span><br><span class="line">sudo apt install gcc autoconf automake libcppunit-dev libssl-dev libgcrypt-dev libssh2-1-dev libc-ares-dev libexpat1-dev zlib1g-dev libsqlite3-dev pkg-config </span><br><span class="line"><span class="comment"># 说明：</span></span><br><span class="line"><span class="comment"># libgnutls-dev （HTTPS， BitTorrent， Checksum 支持需要）</span></span><br><span class="line"><span class="comment"># nettle-dev （BitTorrent 需要，校验和支持）</span></span><br><span class="line"><span class="comment"># libgmp-dev （Required for BitTorrent）</span></span><br><span class="line"><span class="comment"># libssh2-1-dev （SFTP 支持需要）</span></span><br><span class="line"><span class="comment"># libc-ares-dev （异步 DNS 支持所必需的）</span></span><br><span class="line"><span class="comment"># libxml2-dev （Metalink 支持所必需的）</span></span><br><span class="line"><span class="comment"># zlib1g-dev （gzip 需要，在 HTTP 中压缩解码支持）</span></span><br><span class="line"><span class="comment"># libsqlite3-dev （Firefox3/Chromium cookie 支持所必需的）</span></span><br><span class="line"><span class="comment"># pkg-config （检测已安装的库时需要）</span></span><br><span class="line"><span class="comment"># 你可以使用libgcrypt-dev代替nettle-dev和libgmp-dev：</span></span><br><span class="line"><span class="comment"># libgpg-error-dev （BitTorrent 需要，校验和支持）</span></span><br><span class="line"><span class="comment"># libgcrypt-dev （BitTorrent 需要，校验和支持）</span></span><br><span class="line"><span class="comment"># 你可以使用libssl-dev代替libgnutls-dev，nettle-dev，libgmp-dev，libgpg-error-dev和libgcrypt-dev：</span></span><br><span class="line"><span class="comment"># libssl-dev （HTTPS、 BitTorrent， Checksum 支持是必需的）</span></span><br><span class="line"><span class="comment"># 您可以使用 libexpat1-dev 而不是 libxml2-dev：</span></span><br><span class="line"><span class="comment"># libexpat1-dev （Metalink 支持所必需的）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 若提示却少支持项则apt安装或者参照下面方法安装 </span></span><br><span class="line"><span class="comment"># 安装tcmalloc支持库</span></span><br><span class="line"><span class="comment"># 1、安装libunwind</span></span><br><span class="line"><span class="comment"># [项目地址](https://github.com/libunwind/libunwind)</span></span><br><span class="line"><span class="comment"># wget https://github.com/libunwind/libunwind/releases/download/v1.6.2/libunwind-1.6.2.tar.gz </span></span><br><span class="line"><span class="comment"># tar -zxvf libunwind-1.6.2.tar.gz</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local</span></span><br><span class="line"><span class="comment"># make &amp;&amp; sudo make install</span></span><br><span class="line"><span class="comment"># 2、安装 tcmalloc</span></span><br><span class="line"><span class="comment"># wget https://github.com/gperftools/gperftools/releases/download/gperftools-2.9.1/gperftools-2.9.1.tar.gz</span></span><br><span class="line"><span class="comment"># tar -zxvf gperftools-2.9.1.tar.gz</span></span><br><span class="line"><span class="comment"># cd gperftools-2.9.1</span></span><br><span class="line"><span class="comment"># ./configure</span></span><br><span class="line"><span class="comment"># make &amp;&amp; sudo make install</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装libssh2</span></span><br><span class="line"><span class="comment"># wget https://www.libssh2.org/download/libssh2-1.10.0.tar.gz</span></span><br><span class="line"><span class="comment"># tar -zxvf libssh2-1.10.0.tar.gz</span></span><br><span class="line"><span class="comment"># cd libssh2-1.10.0</span></span><br><span class="line"><span class="comment"># ./configure</span></span><br><span class="line"><span class="comment"># make &amp;&amp; sudo make install</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装c-ares</span></span><br><span class="line"><span class="comment"># wget https://github.com/c-ares/c-ares/releases/download/cares-1_18_1/c-ares-1.18.1.tar.gz</span></span><br><span class="line"><span class="comment"># tar -zxvf c-ares-1.18.1.tar.gz</span></span><br><span class="line"><span class="comment"># cd c-ares-1.18.1</span></span><br><span class="line"><span class="comment"># ./configure</span></span><br><span class="line"><span class="comment"># make &amp;&amp; sudo make install</span></span><br></pre></td></tr></table></figure>
<h2 id="下载并编译安装aria2-1-36-0"><a href="#下载并编译安装aria2-1-36-0" class="headerlink" title="下载并编译安装aria2-1.36.0"></a>下载并编译安装<code>aria2-1.36.0</code></h2><p>依次运行一下命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/aria2/aria2/releases/download/release-1.36.0/aria2-1.36.0.tar.bz2</span><br><span class="line">tar -xjvf aria2-1.36.0.tar.bz2</span><br><span class="line"><span class="built_in">cd</span> aria2-1.36.0</span><br><span class="line">./configure \</span><br><span class="line">  --prefix=/usr/local/aria2-1.36.0 \</span><br><span class="line">  --enable-libaria2 \</span><br><span class="line">  --enable-FEATURE \</span><br><span class="line">  --enable-threads=posix \</span><br><span class="line">  --enable-static \</span><br><span class="line">  --with-gnu-ld \</span><br><span class="line">  --with-tcmalloc </span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/aria2-1.36.0/bin/aria2c /usr/local/bin/aria2c</span><br></pre></td></tr></table></figure></p>
<h1 id="编译时出现错误"><a href="#编译时出现错误" class="headerlink" title="编译时出现错误"></a>编译时出现错误</h1><p>编译安装<code>aria2-1.36.0</code>是出现错误提示如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">checking <span class="keyword">for</span> gcc... gcc</span><br><span class="line">checking whether the C compiler works... no</span><br><span class="line">configure: error: <span class="keyword">in</span> `~/下载/软件/deb包/ApplicationSoftware/aria2-1.36.0<span class="string">&#x27;:</span></span><br><span class="line"><span class="string">configure: error: C compiler cannot create executables</span></span><br><span class="line"><span class="string">See `config.log&#x27;</span> <span class="keyword">for</span> more details</span><br></pre></td></tr></table></figure><br>解决办法：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install gobjc++</span><br></pre></td></tr></table></figure></p>
<h1 id="安装后启动出现错误"><a href="#安装后启动出现错误" class="headerlink" title="安装后启动出现错误"></a>安装后启动出现错误</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">aria2c -v</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line">aria2c: error <span class="keyword">while</span> loading shared libraries: libtcmalloc_minimal.so.4: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>
<p>支持库文件安装路径是<code>/usr/local/lib</code>，而<code>/usr/local/lib</code> 不在系统默认的<code>LD_LIBRARY_PATH</code>里，所以就找不到该<code>lib</code>。<br>解决办法：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/ld.so.conf</span><br></pre></td></tr></table></figure></p>
<h1 id="添加如下内容："><a href="#添加如下内容：" class="headerlink" title="添加如下内容："></a>添加如下内容：</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/local/lib</span><br></pre></td></tr></table></figure>
<p>使配置生效：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure><br>重新启动<code>aria2</code>即可。</p>
<p>关于<strong>其他配置</strong>请参考<br><a href="../../../../2021/08/25/Aria2在Debian11下的配置/">Aria2在Debian11下的配置</a></p>
<p>最后安装后启用的功能如图：<br><img src="/pic/2022/1/aria2-1.36/aria2-1.36.png" alt="nologoImage5.jpg"></p>
<p>参考资料：<br><a href="https://blog.51cto.com/skypegnu1/1637168">CentOS 下搭建 aria2 远程下载环境</a></p>
]]></content>
      <categories>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Aria2</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11编译安装升级Python310</title>
    <url>/2021/10/10/Debian11%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E5%8D%87%E7%BA%A7Python310/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、安装编译所需文件"><a href="#1、安装编译所需文件" class="headerlink" title="1、安装编译所需文件"></a>1、安装编译所需文件</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev libffi-dev zlib1g-dev libreadline-gplv2-dev</span><br></pre></td></tr></table></figure>
<h1 id="2、下载并解压python310"><a href="#2、下载并解压python310" class="headerlink" title="2、下载并解压python310"></a>2、下载并解压python310</h1><h2 id="①下载"><a href="#①下载" class="headerlink" title="①下载"></a>①下载</h2><p><a href="https://www.python.org/ftp/python/3.10.0/Python-3.10.0.tar.xz">Python3.10.0 XZ compressed source tarball下载网址</a></p>
<h2 id="②解压并编译安装"><a href="#②解压并编译安装" class="headerlink" title="②解压并编译安装"></a>②解压并编译安装</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ xz -dk Python-3.10.0.tar.xz  // -k保留原压缩包</span><br><span class="line">$ tar -xvf Python-3.10.0.tar</span><br><span class="line">$ <span class="built_in">cd</span> Python-3.10.0</span><br><span class="line">$ ./configure --enable-optimizations</span><br><span class="line">$ sudo make &amp;&amp; sudo make altinstall </span><br></pre></td></tr></table></figure>
<p><code>--enable-optimizations 启用优化</code><br><code>// 注意，这里要用sudo，把python3.9安装到了/usr/local/lib下面，可执行文件在/usr/local/bin下面。</code><br><code>// 如果不用altinstall，就会安装到/usr/bin/下面，可能会直接覆盖系统原来的文件。</code><br>在当前最新的<code>python3.10</code>版中，用<code>make install</code>也是会安装在<code>/usr/local/bin/</code>下。</p>
<h1 id="3、update-alternatives版本管理"><a href="#3、update-alternatives版本管理" class="headerlink" title="3、update-alternatives版本管理"></a>3、<code>update-alternatives</code>版本管理</h1><h2 id="①为系统自带python2-7创建软连接"><a href="#①为系统自带python2-7创建软连接" class="headerlink" title="①为系统自带python2.7创建软连接"></a>①为系统自带python2.7创建软连接</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1</span><br><span class="line">```  </span><br><span class="line">`// --install 选项使用了多个参数用于创建符号链接。`</span><br><span class="line"></span><br><span class="line">`update-alternatives`: 使用 /usr/bin/python2.7 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">```bash</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.9 2</span><br><span class="line">update-alternatives: 使用 /usr/bin/python3.9 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ whereis python3.10</span><br><span class="line">python3: /usr/bin/python3.9 /usr/bin/python3 /usr/lib/python3.9 /usr/lib/python3 /etc/python3.9 /etc/python3 /usr/local/bin/python3 /usr/local/bin/python3.10-config /usr/local/bin/python3.10 /usr/local/lib/python3.9 /usr/local/lib/python3.10 /usr/share/python3 /usr/share/man/man1/python3.1.gz</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/python python /usr/local/bin/python3.10 3</span><br><span class="line">update-alternatives: 使用 /usr/local/bin/python3.10 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ sudo update-alternatives --list python</span><br><span class="line">/usr/bin/python2.7</span><br><span class="line">/usr/bin/python3.9</span><br><span class="line">/usr/local/bin/python3.10</span><br><span class="line">$ sudo update-alternatives --config python</span><br><span class="line">有 3 个候选项可用于替换 python (提供 /usr/bin/python)。</span><br><span class="line"></span><br><span class="line">  选择       路径                     优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">* 0            /usr/local/bin/python3.10   3         自动模式</span><br><span class="line">  1            /usr/bin/python2.7          1         手动模式</span><br><span class="line">  2            /usr/bin/python3.9          2         手动模式</span><br><span class="line">  3            /usr/local/bin/python3.10   3         手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：</span><br></pre></td></tr></table></figure>
<h2 id="②以下为切换3-9及切换为3-10实例："><a href="#②以下为切换3-9及切换为3-10实例：" class="headerlink" title="②以下为切换3.9及切换为3.10实例："></a>②以下为切换3.9及切换为3.10实例：</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo update-alternatives --config python</span><br><span class="line">有 3 个候选项可用于替换 python (提供 /usr/bin/python)。</span><br><span class="line"></span><br><span class="line">  选择       路径                     优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">* 0            /usr/local/bin/python3.10   3         自动模式</span><br><span class="line">  1            /usr/bin/python2.7          1         手动模式</span><br><span class="line">  2            /usr/bin/python3.9          2         手动模式</span><br><span class="line">  3            /usr/local/bin/python3.10   3         手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：2</span><br><span class="line">update-alternatives: 使用 /usr/bin/python3.9 来在手动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ python</span><br><span class="line">Python 3.9.2 (default, Feb 28 2021, 17:03:44) </span><br><span class="line">[GCC 10.2.1 20210110] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">[6]+  已停止               python</span><br><span class="line">$ sudo update-alternatives --config python</span><br><span class="line">有 3 个候选项可用于替换 python (提供 /usr/bin/python)。</span><br><span class="line"></span><br><span class="line">  选择       路径                     优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">  0            /usr/local/bin/python3.10   3         自动模式</span><br><span class="line">  1            /usr/bin/python2.7          1         手动模式</span><br><span class="line">* 2            /usr/bin/python3.9          2         手动模式</span><br><span class="line">  3            /usr/local/bin/python3.10   3         手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：0</span><br><span class="line">update-alternatives: 使用 /usr/local/bin/python3.10 来在自动模式中提供 /usr/bin/python (python)</span><br><span class="line">$ python</span><br><span class="line">Python 3.10.0 (default, Oct 17 2021, 10:46:43) [GCC 10.2.1 20210110] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; ^Z</span><br><span class="line">[7]+  已停止               python</span><br><span class="line"></span><br><span class="line">$ sudo vim pip</span><br><span class="line">	修改：<span class="comment">#!/usr/local/bin/python2.7</span></span><br><span class="line">	为： <span class="comment">#!/usr/local/bin/python3.10</span></span><br><span class="line">$ pip -V</span><br><span class="line">pip 21.3 from /home/yk/.local/lib/python3.10/site-packages/pip (python 3.10)</span><br></pre></td></tr></table></figure>
<h2 id="③其他命令"><a href="#③其他命令" class="headerlink" title="③其他命令"></a>③其他命令</h2><h3 id="更换pip源"><a href="#更换pip源" class="headerlink" title="更换pip源"></a>更换pip源</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> ~/.pip</span><br><span class="line">$ vim ~/.pip/pip.conf</span><br></pre></td></tr></table></figure>
<p>添加如下内容：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host = pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure></p>
<p>临时使用安装源命令： <code>pip install wheel -i https://pypi.tuna.tsinghua.edu.cn/simple</code></p>
<h3 id="移除版本命令"><a href="#移除版本命令" class="headerlink" title="移除版本命令"></a>移除版本命令</h3><p><code>sudo update-alternatives --remove python /usr/bin/python2.7</code></p>
<h1 id="4、将模块路径添加到path环境并使其生效"><a href="#4、将模块路径添加到path环境并使其生效" class="headerlink" title="4、将模块路径添加到path环境并使其生效"></a>4、将模块路径添加到path环境并使其生效</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;export PATH=/home/yk/.local/bin:$PATH&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<h1 id="5、具体参照："><a href="#5、具体参照：" class="headerlink" title="5、具体参照："></a>5、具体参照：</h1><p><a href="https://www.cnblogs.com/fengtai/p/12865147.html">update-alternatives将Linux下python默认版本切换成替代版本</a><br><a href="https://blog.csdn.net/weixin_42651887/article/details/113972144">python升级命令debian_更改Ubuntu或者Debian默认python版本的方法</a></p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>运维</category>
        <category>Update</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian中允许免输入密码使用超级用户运行命令</title>
    <url>/2021/11/22/Debian%E4%B8%AD%E5%85%81%E8%AE%B8%E5%85%8D%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E4%BD%BF%E7%94%A8%E8%B6%85%E7%BA%A7%E7%94%A8%E6%88%B7%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>使用<code>visudo</code>编辑：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~<span class="comment"># visudo /etc/sudoers</span></span><br><span class="line">User_Alias ADMINS = user1,user2</span><br><span class="line">ADMINS  ALL = NOPASSWD:ALL</span><br><span class="line">root    ALL=(ALL:ALL) ALL</span><br><span class="line">user3   ALL=(ALL:ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure><br>上述命令赋予别名<code>ADMINS</code>里的<code>user1,user2</code>和单独用户<code>user3</code>在任何主机、任何用户身份、任何用户组运行<code>sudo</code>命令免密码。<br><code>NOPASSWD:ALL</code>表示执行任意命令不需要密码。<br><code>visudo</code>编辑<code>/etc/sudoers</code>在保存会进行语法检测。 </p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>sudo</category>
      </categories>
      <tags>
        <tag>设置</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian更新源时出现签名无法进行验证</title>
    <url>/2022/01/01/Debian%E6%9B%B4%E6%96%B0%E6%BA%90%E6%97%B6%E5%87%BA%E7%8E%B0%E7%AD%BE%E5%90%8D%E6%97%A0%E6%B3%95%E8%BF%9B%E8%A1%8C%E9%AA%8C%E8%AF%81/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>有些时候在添加软件源，更新软件源后，会提示所添加的软件源公钥无法验证，造成更新失败。<br>比如添加<code>deb https://www.deb-multimedia.org bullseye main non-free</code>源，如果不用命令<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install deb-multimedia-keyring</span><br></pre></td></tr></table></figure><br>安装密钥，那么更新源后会提示：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">W: 校验数字签名时出错。此仓库未被更新，所以仍然使用此前的索引文件。GPG 错误：https://www.deb-multimedia.org bullseye InRelease: 由于没有公钥，无法验证下列签名： NO_PUBKEY 5C808C2B65558117</span><br><span class="line">W: 无法下载 https://www.deb-multimedia.org/dists/bullseye/InRelease  由于没有公钥，无法验证下列签名： NO_PUBKEY 5C808C2B65558117</span><br><span class="line">W: 部分索引文件下载失败。如果忽略它们，那将转而使用旧的索引文件。</span><br></pre></td></tr></table></figure></p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p><strong>[推荐方法]</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 从 keyring.debian.org 下载公钥，导入密钥</span></span><br><span class="line">curl -s https://www.deb-multimedia.org | sudo gpg --no-default-keyring --keyring gnupg-ring:/etc/apt/trusted.gpg.d/deb-multimedia.gpg --import</span><br><span class="line">sudo gpg --no-default-keyring --keyring gnupg-ring:/etc/apt/trusted.gpg.d/deb-multimedia.gpg --keyserver keyring.debian.org --recv 5C808C2B65558117</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">gpg: 密钥 5C808C2B65558117：公钥 “Christian Marillat &lt;marillat@debian.org&gt;” 已导入</span><br><span class="line">gpg: 处理的总数：1</span><br><span class="line">gpg:               已导入：1</span><br><span class="line"><span class="comment"># 确保运行以下命令以设置正确的文件权限</span></span><br><span class="line">sudo <span class="built_in">chmod</span> 644 /etc/apt/trusted.gpg.d/deb-multimedia.gpg</span><br><span class="line"><span class="comment"># 其中`5C808C2B65558117`为更新源后提示无法验证的公钥字符。</span></span><br></pre></td></tr></table></figure><br>采用以下即将弃用的方法会提示警告。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo  gpg --keyserver keyring.debian.org --recv-keys 5C808C2B65558117</span><br><span class="line">gpg: /root/.gnupg/trustdb.gpg：建立了信任度数据库</span><br><span class="line">gpg: 密钥 5C808C2B65558117：公钥 “Christian Marillat &lt;marillat@debian.org&gt;” 已导入</span><br><span class="line">gpg: 处理的总数：1</span><br><span class="line">gpg:               已导入：1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到`root`用户，把下载的key添加到本地trusted数据库中。</span></span><br><span class="line"><span class="comment"># 输出65558117用户的公钥,armor参数可以将其转换为ASCII码显示</span></span><br><span class="line">su</span><br><span class="line">密码：</span><br><span class="line">sudo gpg --armor --<span class="built_in">export</span> 65558117 | apt-key add - </span><br><span class="line">Warning: apt-key is deprecated. Manage keyring files <span class="keyword">in</span> trusted.gpg.d instead (see apt-key(8)).</span><br><span class="line">OK</span><br><span class="line"><span class="comment"># 其中 65558117 为更新源后提示无法验证的公钥后八位字符。</span></span><br></pre></td></tr></table></figure></p>
<p><strong>附</strong>：如果您已经知道所需公钥的 <code>URL</code>，请使用 <code>wget</code> 或 <code>curl</code> 下载并导入它。请记住将文件权限从 <code>600</code> 更新到 <code>644</code>。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -s https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo gpg --no-default-keyring --keyring gnupg-ring:/etc/apt/trusted.gpg.d/earth.gpg --import</span><br><span class="line">sudo <span class="built_in">chmod</span> 644 /etc/apt/trusted.gpg.d/earth.gpg</span><br></pre></td></tr></table></figure></p>
<p>查询已安装的<code>key</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gpg --list-keys --keyring /etc/apt/trusted.gpg.d/deb-multimedia.gpg</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">apt-key list</span><br></pre></td></tr></table></figure><br>删除安装的<code>key</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-key del 65558117</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line"><span class="built_in">cd</span> /etc/apt/trusted.gpg.d/</span><br><span class="line">sudo <span class="built_in">rm</span> deb-multimedia.gpg</span><br></pre></td></tr></table></figure></p>
<h1 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h1><p>再更新安装源就不会出现错误了。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt upgrade</span><br></pre></td></tr></table></figure></p>
<p>参考资料<br>1、<a href="https://ulyc.github.io/2021/01/26/2021%E5%B9%B4-%E7%94%A8%E6%9B%B4%E7%8E%B0%E4%BB%A3%E7%9A%84%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8PGP-%E4%B8%8B/">2021年-用更现代的方法使用PGP-下</a><br>2、<a href="https://suay.site/?p=526">警告：apt 键已弃用</a></p>
]]></content>
      <categories>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Debian</tag>
        <tag>错误解决</tag>
        <tag>Gpg</tag>
        <tag>Apt-key</tag>
      </tags>
  </entry>
  <entry>
    <title>Excel一些函数的简单使用</title>
    <url>/2022/05/10/Excel%E4%B8%80%E4%BA%9B%E5%87%BD%E6%95%B0%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="财务常用"><a href="#财务常用" class="headerlink" title="财务常用"></a>财务常用</h1><h2 id="财务中转换数字为大写元角分"><a href="#财务中转换数字为大写元角分" class="headerlink" title="财务中转换数字为大写元角分"></a>财务中转换数字为大写元角分</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span>SUBSTITUTE(SUBSTITUTE(IF(A3<span class="operator">&gt;</span><span class="number">-0.5</span><span class="operator">%</span>,,&quot;负&quot;)<span class="operator">&amp;</span>TEXT(<span class="type">INT</span>(FIXED(<span class="built_in">ABS</span>(A3))),&quot;[dbnum2]G/通用格式元;;&quot;)<span class="operator">&amp;</span>TEXT(<span class="keyword">RIGHT</span>(FIXED(A3),<span class="number">2</span>),&quot;[dbnum2]0角0分;;&quot;<span class="operator">&amp;</span>IF(<span class="built_in">ABS</span>(A3)<span class="operator">&gt;</span><span class="number">1</span><span class="operator">%</span>,&quot;整&quot;,)),&quot;零角&quot;,IF(<span class="built_in">ABS</span>(A3)<span class="operator">&lt;</span><span class="number">1</span>,,&quot;零&quot;)),&quot;零分&quot;,&quot;整&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="将数字填到数位中"><a href="#将数字填到数位中" class="headerlink" title="将数字填到数位中"></a>将数字填到数位中</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span><span class="keyword">LEFT</span>(<span class="keyword">RIGHT</span>(TEXT($A3<span class="operator">*</span><span class="number">100</span>,&quot; ￥0;;&quot;),COLUMNS(E:$K)))</span><br><span class="line">或者</span><br><span class="line"><span class="operator">=</span><span class="keyword">LEFT</span>(<span class="keyword">RIGHT</span>(&quot; ￥&quot;<span class="operator">&amp;</span>$A3<span class="operator">*</span><span class="number">100</span>,COLUMNS(E:$K)))</span><br></pre></td></tr></table></figure>
<p>最终效果如：<br><img src="\pic\2022\5\数字到指定单元格.gif" alt="数字到指定单元格"><br><!-- <video id="video" controls="" preload="none" poster="封面">
  <source id="mp4" src="\pic\2022\5\数字到指定单元格.mp4" type="video/mp4">
</video> --></p>
<h1 id="转换大小写"><a href="#转换大小写" class="headerlink" title="转换大小写"></a>转换大小写</h1><h2 id="将时间转换为大写"><a href="#将时间转换为大写" class="headerlink" title="将时间转换为大写"></a>将时间转换为大写</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">=&quot;现在是:&quot;&amp;TEXT(NOW(),&quot;[DBNum2][$-804]&quot;&amp;&quot;h时m分s秒&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="\pic\2022\11\时间大小写样式.png" alt="时间转换为大写"></p>
<h1 id="提取内容"><a href="#提取内容" class="headerlink" title="提取内容"></a>提取内容</h1><h2 id="混排提取汉字"><a href="#混排提取汉字" class="headerlink" title="混排提取汉字"></a>混排提取汉字</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span>IFERROR(MID(MID(A2,<span class="number">19</span>,<span class="number">520</span>),<span class="keyword">MATCH</span>(<span class="number">2</span>,LENB(MID(MID(A2,<span class="number">19</span>,<span class="number">520</span>),<span class="type">ROW</span>(INDIRECT(&quot;1:&quot;<span class="operator">&amp;</span>LEN(MID(A2,<span class="number">19</span>,<span class="number">520</span>)))),<span class="number">1</span>)),<span class="number">0</span>),LENB(MID(A2,<span class="number">19</span>,<span class="number">520</span>))<span class="operator">-</span>LEN(MID(A2,<span class="number">19</span>,<span class="number">520</span>))),&quot;&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="\pic\2022\11\提取地址.gif" alt="提取地址"></p>
<h1 id="数组公式一些应用"><a href="#数组公式一些应用" class="headerlink" title="数组公式一些应用"></a><code>数组公式</code>一些应用</h1><h2 id="计算非空两列单元格两两相除后和的平均数"><a href="#计算非空两列单元格两两相除后和的平均数" class="headerlink" title="计算非空两列单元格两两相除后和的平均数"></a>计算非空两列单元格两两相除后和的平均数</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">=</span><span class="built_in">SUM</span>(INDIRECT(&quot;C3:C&quot;<span class="operator">&amp;</span><span class="built_in">MAX</span>((B3:B20<span class="operator">&lt;&gt;</span>&quot;&quot;)<span class="operator">*</span>(<span class="type">ROW</span>(B3:B20))))<span class="operator">/</span>INDIRECT(&quot;B3:B&quot;<span class="operator">&amp;</span><span class="built_in">COUNT</span>(B3:B20,&quot;&lt;&gt;&quot;)<span class="operator">+</span><span class="number">2</span>))<span class="operator">/</span><span class="built_in">COUNT</span>(B3:B20,&quot;&lt;&gt;&quot;)&#125;</span><br></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">=</span>SUMPRODUCT(INDIRECT(&quot;C3:C&quot;<span class="operator">&amp;</span><span class="built_in">MAX</span>((B3:B20<span class="operator">&lt;&gt;</span>&quot;&quot;)<span class="operator">*</span>(<span class="type">ROW</span>(B3:B20))))<span class="operator">/</span>INDIRECT(&quot;B3:B&quot;<span class="operator">&amp;</span><span class="built_in">COUNT</span>(B3:B20,&quot;&lt;&gt;&quot;)<span class="operator">+</span><span class="number">2</span>))<span class="operator">/</span><span class="built_in">COUNT</span>(B3:B20,&quot;&lt;&gt;&quot;)&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="返回非空行号"><a href="#返回非空行号" class="headerlink" title="返回非空行号"></a>返回非空行号</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">=</span><span class="built_in">MAX</span>((B3:B20<span class="operator">&lt;&gt;</span>&quot;&quot;)<span class="operator">*</span>(<span class="type">ROW</span>(B3:B20)))&#125;</span><br></pre></td></tr></table></figure>
<p>或<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">=</span><span class="built_in">MAX</span>(<span class="keyword">NOT</span>(ISBLANK(B3:B20))<span class="operator">*</span><span class="type">ROW</span>(<span class="number">3</span>:<span class="number">20</span>))”&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="返回非空坐标"><a href="#返回非空坐标" class="headerlink" title="返回非空坐标"></a>返回非空坐标</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">=</span>ADDRESS(<span class="built_in">MAX</span>((B3:B20<span class="operator">&lt;&gt;</span>&quot;&quot;)<span class="operator">*</span>(<span class="type">ROW</span>(B3:B20))),<span class="keyword">COLUMN</span>(B:B))&#125;</span><br></pre></td></tr></table></figure>
<h2 id="返回列中最后非空单元格值"><a href="#返回列中最后非空单元格值" class="headerlink" title="返回列中最后非空单元格值"></a>返回列中最后非空单元格值</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">=</span>INDIRECT(ADDRESS(<span class="built_in">MAX</span>((B3:B20<span class="operator">&lt;&gt;</span>&quot;&quot;)<span class="operator">*</span>(<span class="type">ROW</span>(B3:B20))),<span class="keyword">COLUMN</span>(B3:B20)))&#125;</span><br></pre></td></tr></table></figure>
<p><img src="\pic\2022\11\数组公式一些应用.png" alt="数组公式一些应用"></p>
<h1 id="一些应用"><a href="#一些应用" class="headerlink" title="一些应用"></a>一些应用</h1><h2 id="简易日历"><a href="#简易日历" class="headerlink" title="简易日历"></a>简易日历</h2><p>1、先做好如图大概框架<br>启用<code>excel开发工具</code>【文件==》（更多）选项==》自定义功能区==》右边<code>选中开发工具</code>】，打开控件,设置控件按钮<code>数字调节阀</code><br>设置如下：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当前：1 //可1-12任意整数</span><br><span class="line">最小：1</span><br><span class="line">最大：12</span><br><span class="line">步长：1</span><br><span class="line">控制：`$AA$1` //控制月份</span><br></pre></td></tr></table></figure><br><img src="\pic\2022\11\启用开发工具.png" alt="启用开发工具"><br>2、在第三行和第七行输入以下公式，自动变换日期范围<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 上半月</span></span><br><span class="line"><span class="operator">=</span>TEXTJOIN(,<span class="literal">TRUE</span>,$X$<span class="number">1</span>,&quot;年&quot;,$AA$<span class="number">1</span>,&quot;月&quot;,&quot;1日——&quot;,$X$<span class="number">1</span>,&quot;年&quot;,$AA$<span class="number">1</span>,&quot;月15日&quot;)</span><br><span class="line"><span class="comment">-- 下半月</span></span><br><span class="line">TEXTJOIN(,<span class="literal">TRUE</span>,$X$<span class="number">1</span>,&quot;年&quot;,$AA$<span class="number">1</span>,&quot;月&quot;,&quot;16日——&quot;,$X$<span class="number">1</span>,&quot;年&quot;,$AA$<span class="number">1</span>,&quot;月&quot;,<span class="keyword">DAY</span>(<span class="type">DATE</span>($X$<span class="number">1</span>,$AA$<span class="number">1</span><span class="operator">+</span><span class="number">1</span>,)),&quot;日&quot;)</span><br></pre></td></tr></table></figure><br>3、在上半月日期<code>第一天</code>单元格输入公式<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span><span class="type">DATE</span>($X$<span class="number">1</span>,$AA$<span class="number">1</span>,<span class="keyword">COLUMN</span>(A1)) </span><br><span class="line"><span class="comment">-- # &quot;$X$1&quot;取年份，&quot;$AA$1&quot;取月份,“COLUMN(A1)”取列号为日</span></span><br></pre></td></tr></table></figure><br>移到单元格右下角，出现黑十字<strong>+</strong>,向右填充15格，即到15日。<br>4、在上半月第一天的<code>星期</code>所在单元格输入公式<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span>TEXT(C5,&quot;AAA&quot;) </span><br><span class="line"><span class="comment">-- # &quot;AAA&quot;返回的是星期的简写，全称则为&quot;AAAA&quot;,不分大小写</span></span><br></pre></td></tr></table></figure><br>移到单元格右下角，出现黑十字<strong>+</strong>,向右填充15格，即到15日。<br>5、在下半月表第一个日期所在单元格里面，输入以下公式<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span>IF(<span class="keyword">MONTH</span>(<span class="type">DATE</span>($X$<span class="number">1</span>,$AA$<span class="number">1</span>,<span class="keyword">COLUMN</span>(P1)))<span class="operator">=</span>$AA$<span class="number">1</span>,<span class="type">DATE</span>($X$<span class="number">1</span>,$AA$<span class="number">1</span>,<span class="keyword">COLUMN</span>(P1)),&quot;&quot;)</span><br><span class="line"><span class="comment">-- # 判断“MONTH(DATE($X$1,$AA$1,COLUMN(P1)))=$AA$1”，是避免后面多的单元格里面日期不在本月之内。</span></span><br></pre></td></tr></table></figure><br>移到单元格右下角，出现黑十字<strong>+</strong>,向右扩展填充16格，即到31日。<br>6、在下半月第一天的<code>星期</code>所在单元格输入公式<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">=</span>TEXT(C9,&quot;AAA&quot;) </span><br><span class="line"><span class="comment">-- # “C9”是取日期，&quot;AAA&quot;返回的是星期的简写，全称则为&quot;AAAA&quot;,不分大小写</span></span><br></pre></td></tr></table></figure><br>移到单元格右下角，出现黑十字<strong>+</strong>,向右填充16格，即到31日。<br>用顶栏月份右边调节阀控制月份，即可自动更新日期和星期。</p>
<p><img src="\pic\2022\11\日历简单应用.gif" alt="日历简单应用"></p>
<p>后续会陆续补充不断完善……</p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Excel</category>
      </categories>
      <tags>
        <tag>Excel</tag>
      </tags>
  </entry>
  <entry>
    <title>ffmpeg在debian系统下编译安装</title>
    <url>/2022/01/22/Ffmpeg%E5%9C%A8debian%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装x264相关库"><a href="#安装x264相关库" class="headerlink" title="安装x264相关库"></a>安装<code>x264</code>相关库</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget <span class="string">&quot;http://www.nasm.us/pub/nasm/releasebuilds/2.15rc12/nasm-2.15rc12.tar.xz&quot;</span></span><br><span class="line">tar -xvf nasm-2.15rc12.tar.xz</span><br><span class="line"><span class="built_in">cd</span> nasm-2.15rc12</span><br><span class="line">./configure </span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/x264/lib/pkgconfig/x264.pc /usr/local/lib/pkgconfig/</span><br></pre></td></tr></table></figure>
<h1 id="安装x264"><a href="#安装x264" class="headerlink" title="安装x264"></a>安装<code>x264</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget <span class="string">&quot;http://download.videolan.org/pub/videolan/x264/snapshots/x264-snapshot-20191217-2245-stable.tar.bz2&quot;</span></span><br><span class="line">tar -xvf x264-snapshot-20191217-2245-stable.tar.bz2</span><br><span class="line"><span class="built_in">cd</span> x264-snapshot-20191217-2245-stable</span><br><span class="line">./configure --prefix=/usr/local/x264 --enable-shared --enable-static</span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure>
<h1 id="安装-fribidi"><a href="#安装-fribidi" class="headerlink" title="安装 fribidi"></a>安装 <code>fribidi</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/fribidi/fribidi/releases/download/v1.0.11/fribidi-1.0.11.tar.xz</span><br><span class="line">xz -d fribidi-1.0.11.tar.xz</span><br><span class="line">tar -xvf fribidi-1.0.11.tar</span><br><span class="line"><span class="built_in">cd</span> fribidi-1.0.11</span><br><span class="line">./configure --prefix=/usr/local/ --enable-shared</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<h1 id="安装-fontconfig"><a href="#安装-fontconfig" class="headerlink" title="安装 fontconfig"></a>安装 <code>fontconfig</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install gperf </span><br><span class="line">wget <span class="string">&quot;https://www.freedesktop.org/software/fontconfig/release/fontconfig-2.13.94.tar.gz&quot;</span></span><br><span class="line">tar -zxvf fontconfig-2.13.94.tar.gz  </span><br><span class="line"><span class="built_in">cd</span> fontconfig-2.13.94    </span><br><span class="line">./configure --prefix=/usr/local/ --enable-shared --enable-libxml2</span><br></pre></td></tr></table></figure>
<h1 id="安装-libass"><a href="#安装-libass" class="headerlink" title="安装 libass"></a>安装 <code>libass</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/libass/libass/releases/download/0.15.2/libass-0.15.2.tar.xz</span><br><span class="line">xz -d tar libass-0.15.2.tar.xz</span><br><span class="line">tar libass-0.15.2.tar</span><br><span class="line"><span class="built_in">cd</span> libass-0.15.2</span><br><span class="line">./configure --prefix=/usr/local/ --disable-static</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<h1 id="安装freetype-2"><a href="#安装freetype-2" class="headerlink" title="安装freetype-2"></a>安装<code>freetype-2</code></h1><p>sudo apt install libbz2-dev  libpng-dev libharfbuzz-dev<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://download.savannah.gnu.org/releases/freetype/freetype-2.11.1.tar.xz</span><br><span class="line">xz -d freetype-2.11.1.tar.xz</span><br><span class="line">tar -xvf freetype-2.11.1.tar</span><br><span class="line"><span class="built_in">cd</span> freetype-2.11.1</span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/freeType2.11 --with-bzip2 --with-png </span></span><br><span class="line">./configure --prefix=/usr/local/freeType2.11 --with-bzip2=<span class="built_in">yes</span> --with-png=<span class="built_in">yes</span>  --with-harfbuzz=<span class="built_in">yes</span></span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line"><span class="comment"># 使用到的库路径通过软链接添加至环境变量中</span></span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/freeType2.11/lib/pkgconfig/freetype2.pc /usr/local/lib/pkgconfig/ </span><br><span class="line">sudo ldconfig -v <span class="comment"># 使配置生效</span></span><br></pre></td></tr></table></figure></p>
<h1 id="PKG-CONFIG加入环境变量"><a href="#PKG-CONFIG加入环境变量" class="headerlink" title="PKG_CONFIG加入环境变量"></a><code>PKG_CONFIG</code>加入环境变量</h1><p>注意本机用到书<code>zshrc</code>,<code>bashrc</code>参照其格式<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig:\$PKG_CONFIG_PATH&quot;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure></p>
<h1 id="安装sdl2"><a href="#安装sdl2" class="headerlink" title="安装sdl2"></a>安装<code>sdl2</code></h1><p>以支持<code>ffplay</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget http://www.libsdl.org/release/SDL2-2.0.20.tar.gz</span><br><span class="line">tar -zxvf SDL2-2.0.20.tar.gz</span><br><span class="line"><span class="built_in">cd</span> SDL2-2.0.20</span><br><span class="line">./configure --prefix=/usr/local/sdl2</span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">sudo vim /etc/ld.so.conf</span><br><span class="line"><span class="comment"># 添加如下内容</span></span><br><span class="line">  /usr/local/sdl2/lib</span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/sdl2/lib/pkgconfig/sdl2.pc /usr/local/lib/pkgconfig/ </span><br><span class="line">sudo ldconfig -v <span class="comment"># 使配置生效</span></span><br></pre></td></tr></table></figure></p>
<p>解决<code>Could not initialize SDL - (Did you set the DISPLAY variable?)</code>问题<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install libx11-dev</span><br><span class="line">sudo apt install xorg-dev</span><br></pre></td></tr></table></figure><br>然后重新编译安装SDL.</p>
<h1 id="安装x265"><a href="#安装x265" class="headerlink" title="安装x265"></a>安装<code>x265</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hg <span class="built_in">clone</span> http://hg.videolan.org/x265</span><br><span class="line">bash make-Makefiles.bash</span><br><span class="line">sudo apt install cmake cmake-curses-gui</span><br><span class="line">./make-Makefiles.bash</span><br><span class="line"><span class="comment"># 修改prefix路径</span></span><br><span class="line">g</span><br><span class="line"><span class="comment"># 开始编译</span></span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<p>参考资料：<br><a href="https://www.jianshu.com/p/91d214bd1e79">CentOS下编译安装x265</a></p>
<h1 id="编译安装ffmpeg5-0"><a href="#编译安装ffmpeg5-0" class="headerlink" title="编译安装ffmpeg5.0"></a>编译安装<code>ffmpeg5.0</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget <span class="string">&quot;http://ffmpeg.org/releases/ffmpeg-5.0.tar.xz&quot;</span></span><br><span class="line">tar -zxvf ffmpeg-5.0.tar.xz</span><br><span class="line"><span class="built_in">cd</span> ffmpeg-5.0</span><br><span class="line">./configure --prefix=/usr/local/ffmpeg5.0/ --enable-shared --enable-ffplay --enable-gpl --enable-libx264 --enable-libx265 --extra-cflags=-I/usr/local/x264/include --extra-ldflags=-L/usr/local/x264/lib --enable-libass</span><br><span class="line"><span class="comment"># 不建议使用 --extra-cflags --extra-ldflags  可以使用环境变量 以及 pkg-config来自动加载</span></span><br><span class="line"><span class="comment"># 编译如下：</span></span><br><span class="line">./configure --prefix=/usr/local/ffmpeg5.0/ --enable-shared --enable-ffplay --enable-nonfree --enable-gpl --enable-libx264 --enable-libx265 --incdir=/usr/include/x86_64-linux-gnu --libdir=/usr/lib/x86_64-linux-gnu --toolchain=hardened --disable-altivec --shlibdir=/usr/lib/x86_64-linux-gnu --enable-libass</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<p>以下是源安装<code>ffmpeg4.4</code>的编译参数：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--disable-decoder=amrnb --disable-decoder=libopenjpeg --disable-gnutls --disable-liblensfun --disable-libopencv --disable-podpages --disable-sndio --disable-stripping --enable-avfilter --enable-avresample --enable-gcrypt --enable-gpl --enable-ladspa --enable-libaom --enable-libaribb24 --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libcodec2 --enable-libdav1d --enable-libdavs2 --enable-libdc1394 --enable-libfdk-aac --enable-libflite --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-libgme --enable-libgsm --enable-libiec61883 --enable-libjack --enable-libkvazaar --enable-libmp3lame --enable-libmysofa --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-libopus --enable-libpulse --enable-librabbitmq --enable-librist --enable-librsvg --enable-librubberband --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libspeex --enable-libsrt --enable-libtesseract --enable-libtheora --enable-libtwolame --enable-libvidstab --enable-libvo-amrwbenc --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libwebp --enable-libx265 --enable-libxavs2 --enable-libxml2 --enable-libxvid --enable-libzimg --enable-libzmq --enable-libzvbi --enable-lv2 --enable-nonfree --enable-openal --enable-opencl --enable-opengl --enable-openssl --enable-postproc --enable-pthreads --enable-shared --enable-version3 --enable-vulkan --incdir=/usr/include/x86_64-linux-gnu --libdir=/usr/lib/x86_64-linux-gnu --prefix=/usr --toolchain=hardened --enable-frei0r --enable-chromaprint --enable-libx264 --enable-vaapi --enable-libmfx --enable-libvmaf --enable-libsvtav1 --enable-libilbc --disable-altivec --shlibdir=/usr/lib/x86_64-linux-gnu</span><br></pre></td></tr></table></figure><br>说明：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  --prefix=PREFIX 设置的是ffmpeg安装目录</span><br><span class="line">  --enable-shared 设置允许编译共享库</span><br><span class="line">  --enable-nonfree --enable-gpl 设置对License的限制，分别为允许使用付费代码和gpl代码。</span><br><span class="line">  --disable-yasm 禁用汇编程序</span><br><span class="line">  --extra-ldflags 设置动态链接库目录</span><br><span class="line">```　　　</span><br><span class="line"></span><br><span class="line">编译完成后，在 `/etc/profile`文件下增加如下字段：</span><br><span class="line">```conf</span><br><span class="line">FFMPEG=/usr/local/ffmpeg5.0</span><br><span class="line">X264=/usr/local/x264</span><br><span class="line">X265=/usr/local/x265</span><br><span class="line">export FFMPEG X264 X265</span><br><span class="line">export PATH=$PATH:$FFMPEG/bin:$X264/bin:$X265/bin</span><br><span class="line">export LD_LIBRARY_PATH=$X264/lib:$FFMPEG/lib:$X265/lib:$LD_LIBRARY_PATH</span><br></pre></td></tr></table></figure></p>
<h1 id="让动态链接库为系统所共享"><a href="#让动态链接库为系统所共享" class="headerlink" title="让动态链接库为系统所共享"></a>让动态链接库为系统所共享</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/ld.so.conf</span><br></pre></td></tr></table></figure>
<p>填入如下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include ld.so.conf.d/*.conf</span><br><span class="line">include /usr/local/lib</span><br><span class="line">/usr/local/ffmpeg5.0/lib</span><br><span class="line">/usr/local/x264/lib</span><br><span class="line">/usr/local/x265/lib</span><br><span class="line">/usr/local/sdl2/lib</span><br></pre></td></tr></table></figure><br>加载：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure></p>
<h1 id="压制中文字幕乱码"><a href="#压制中文字幕乱码" class="headerlink" title="压制中文字幕乱码"></a>压制中文字幕乱码</h1><p>①添加<code>windows</code>系统字体<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在用户目录创建fonts文件夹</span></span><br><span class="line"><span class="built_in">mkdir</span> fonts</span><br><span class="line"><span class="comment"># 拷贝win10中的字体到fonts文件夹(双系统中)，并拷贝到debian系统/usr/share/fonts文件夹</span></span><br><span class="line"><span class="comment"># 本例fonts还有其他字体</span></span><br><span class="line"><span class="built_in">cp</span> /media/yk/Windows10/Windows/Fonts/simsun.ttc ~/fonts</span><br><span class="line">sudo <span class="built_in">cp</span> ~/fonts/*.ttc /usr/share/fonts</span><br><span class="line"><span class="comment"># 上面步骤也可以直接</span></span><br><span class="line"><span class="built_in">cp</span> /media/yk/Windows10/Windows/Fonts/simsun.ttc /usr/share/fonts</span><br><span class="line"><span class="comment"># 进入/usr/share/fonts文件夹</span></span><br><span class="line"><span class="built_in">cd</span> /usr/share/fonts</span><br><span class="line"><span class="comment"># 授权所有用户可读可写可执行</span></span><br><span class="line">sudo <span class="built_in">chmod</span> 777 *.ttc</span><br><span class="line"><span class="comment"># 建立字体索引信息，更新字体缓存       </span></span><br><span class="line">sudo mkfontscale              </span><br><span class="line">sudo mkfontdir  </span><br><span class="line">sudo fc-cache -fv</span><br><span class="line"><span class="comment"># 最后输出</span></span><br><span class="line">......</span><br><span class="line">fc-cache: succeeded</span><br></pre></td></tr></table></figure><br>安装完成后重启，完成配置.<br>查询所安装中文字体可以用如下命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fc-list :lang=zh</span><br></pre></td></tr></table></figure><br>本例是把多个字体文件已经拷贝在<code>~/fonts</code>文件夹，复制到<code>/usr/share/fonts</code>最后一起更新字体缓存。</p>
<p>②更改文件编码<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iconv -f gb18030 -t utf8 字幕.chs.srt -o 字幕.chs.utf8.srt</span><br></pre></td></tr></table></figure></p>
<p>参考资料：<br>1、<a href="https://www.jianshu.com/p/19f68c87c0ae?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">CentOS下编译安装FFmpeg+libass</a><br>2、<a href="http://www.juzi89.com/?p=216">FFmpeg&amp;libx264编译安装遇到的各种坑</a><br>3、<a href="https://www.cnblogs.com/leisure_chn/p/10035365.html">FFmpeg开发环境构建</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>运维</category>
        <category>Ffmpeg</category>
        <category>软件安装</category>
      </categories>
      <tags>
        <tag>Ffmpeg</tag>
        <tag>字体缺失</tag>
        <tag>Iconv</tag>
      </tags>
  </entry>
  <entry>
    <title>ffmpeg基本使用</title>
    <url>/2021/11/13/Ffmpeg%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://ffmpeg.org/download.html">ffmpeg下载地址</a><br>或者直接：<a href="https://www.gyan.dev/ffmpeg/builds/">选择其中essential版本下载</a>  </p>
<p>其中<code>xxx.mkv(mp4)</code>指源文件，<strong>视频中坐标位置以左上为坐标原点</strong></p>
<h1 id="1、格式转换"><a href="#1、格式转换" class="headerlink" title="1、格式转换"></a>1、格式转换</h1><h2 id="①gif2MP4"><a href="#①gif2MP4" class="headerlink" title="①gif2MP4"></a>①gif2MP4</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># gif2MP4</span></span><br><span class="line">ffmpeg -f gif -i XX.gif XX.mp4</span><br></pre></td></tr></table></figure>
<h2 id="②flv2mp4"><a href="#②flv2mp4" class="headerlink" title="②flv2mp4"></a>②flv2mp4</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加软字幕</span></span><br><span class="line">ffmpeg -i input.flv -c:v libx264 output.mp4</span><br></pre></td></tr></table></figure>
<h2 id="③图片转MP4"><a href="#③图片转MP4" class="headerlink" title="③图片转MP4"></a>③图片转MP4</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -f image2 -i %d.jpeg output.mp4</span><br></pre></td></tr></table></figure>
<p>说明：<br><code>%d ==&gt; 图片名称数字占位符</code></p>
<h1 id="2、压制字幕"><a href="#2、压制字幕" class="headerlink" title="2、压制字幕"></a>2、压制字幕</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 压制硬字幕</span></span><br><span class="line">ffmpeg -i xxx.mkv -vf ass=XXX.ass out.mkv</span><br><span class="line"><span class="comment"># 又如</span></span><br><span class="line"><span class="comment"># 添加软字幕</span></span><br><span class="line">ffmpeg -i input.mkv -i 孽杀.chseng.utf8.srt -c copy output.mkv</span><br><span class="line"><span class="comment"># 或者解决中文乱码</span></span><br><span class="line"> ffmpeg -i input.mkv -sub_charenc <span class="string">&#x27;UTF-8&#x27;</span> -f srt -i 孽杀.chs.srt  -map 0:0 -map 0:1 -map 1:0 -c:v copy -c:a copy -c:s mov_text output.mkv</span><br></pre></td></tr></table></figure>
<p>说明：<br><code>-i ==&gt; input（输入)</code><br><code>-vf ==&gt; video filter (视频滤镜)</code><br><code>ass ==&gt; ass字幕滤镜,字体颜色顺序（B-G-R）【HTML是R-G-B】</code></p>
<h2 id="其他还有命令"><a href="#其他还有命令" class="headerlink" title="其他还有命令"></a>其他还有命令</h2><h3 id="添加字幕格式"><a href="#添加字幕格式" class="headerlink" title="添加字幕格式"></a>添加字幕格式</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i xxx.mkv -vf <span class="string">&quot;subtitles=XXX.srt:force_style=&#x27;Source Han Sans CN bold, FontSize=20, PrimaryColor=&amp;H0000ffff, OutlineColor=&amp;H00fffffff, Outline=0, MarginV=50&#x27;&quot;</span> -crf 19  out.mkv</span><br></pre></td></tr></table></figure>
<p>说明：<br><code>(subtitles ==&gt; srt字幕，思源黑体，字号20，字体颜色黄色【红+绿】,   边框颜色白色，边框0像素,字幕与底边距离50像素)</code><br><code>backcolor=&amp;H00888888  ==&gt; 阴影为灰色</code><br><code>Shadow=1  ==&gt;  阴影深度为1</code><br><code>crf ==&gt; crf取值在0到51间。取值越小质量越好压缩率越低（Constant Rate Factor）</code><br><code>x264 ==&gt; 18-28, 默认23; x265默认28；libvpx：0-63，1080p视频建议31</code>   </p>
<p>例如：<code>黑底白字</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i xxx.mkv -vf <span class="string">&quot;subtitles=XXX.srt:force_style=&#x27;Source Han Sans CN bold, FontSize=20, PrimaryColor=&amp;H00ffffff, OutlineColor=&amp;H00000000, BorderStyle=3&#x27;&quot;</span> -crf 19  out.mkv</span><br></pre></td></tr></table></figure><br>说明：<br><code>BorderStyle ==&gt; 边框样式</code></p>
<h3 id="查看视频信息"><a href="#查看视频信息" class="headerlink" title="查看视频信息"></a>查看视频信息</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffprobe out.mkv</span><br></pre></td></tr></table></figure>
<h1 id="3、改分辨率"><a href="#3、改分辨率" class="headerlink" title="3、改分辨率"></a>3、改分辨率</h1><p>例子：（1920×1080（上下140的黑边） ==&gt; 1920×800，视频分辨率调整为480P）<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i xxx.mkv -vf crop=1920:800:0:140, scale=-2:480 -c:v libx265 -c:a libmp3lame -y out.mkv</span><br></pre></td></tr></table></figure><br>说明：<br><code>-crop ==&gt; 裁剪滤镜（裁剪后宽：裁剪后高：裁剪起始坐标：裁剪结束坐标【原点在左上角】）</code><br><code>-scale ==&gt; 缩放滤镜 （宽：高）</code><br><code>c:v ==&gt; 指定视频编码器 （codec video）</code><br><code>c:a ==&gt; 指定音频编码器 （codec audio）</code>  </p>
<h1 id="4、视频截取"><a href="#4、视频截取" class="headerlink" title="4、视频截取"></a>4、视频截取</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -ss 0:3.100 -to 0:5.0 -i XXX.mp4 -c:v copy -c:a copy out.mp4</span><br></pre></td></tr></table></figure>
<p>说明：<br><code>-ss ==&gt; 起始时间（分:秒.毫秒）</code><br><code>-to ==&gt; 结束时间（分:秒.毫秒）</code><br><code>copy ==&gt; 保持与源文件一致</code><br>简写<code>-c copy</code></p>
<p>截取多帧图片（导出从19秒到20秒100毫秒所有帧图片）：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -ss 19 -to 20.100 -i <span class="string">&#x27;input.mkv&#x27;</span> \%03d.png</span><br></pre></td></tr></table></figure></p>
<h1 id="5、音轨编辑"><a href="#5、音轨编辑" class="headerlink" title="5、音轨编辑"></a>5、音轨编辑</h1><p>例子：（视频：h264；音轨1：国语 dts；粤语 dts；英语 ac3 ==&gt; 视频：hevc；音轨1：国语 mp3；粤语 opus）<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i XXX.mkv -map v -map a:0 -map a:1 -c:v libx265 -c:a:0 libmp3lame -c:a:1 libopus out.mkv</span><br></pre></td></tr></table></figure><br>说明：<br><code>-map ==&gt; 选择音视频轨道</code><br><code>-map v ==&gt; 原视频视频轨道输出</code><br><code>-map a:0(1) ==&gt; 原视频第1（2）条轨道输出</code><br><code>-c:a:0  -c:a:1 ==&gt; 两种音频编码输出</code>  </p>
<h1 id="6、压缩视频"><a href="#6、压缩视频" class="headerlink" title="6、压缩视频"></a>6、压缩视频</h1><h2 id="（1）改变帧率"><a href="#（1）改变帧率" class="headerlink" title="（1）改变帧率"></a>（1）改变帧率</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i XXX.mp4  -r 20  Desktop/out.mp4</span><br></pre></td></tr></table></figure>
<p>说明：<br><code>-r 20 ==&gt; 表示帧率设置为 20fps</code>  </p>
<h2 id="2-改变分辨率"><a href="#2-改变分辨率" class="headerlink" title="(2)改变分辨率"></a>(2)改变分辨率</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i XXX.mov -s vga out.mp4</span><br></pre></td></tr></table></figure>
<p>说明：<br><code>-s vga ==&gt; 指定分辨率</code><br><code>vga 代表 640*480，也可以换成其他的值,如：1080*720</code>  </p>
<h2 id="3-改变码率"><a href="#3-改变码率" class="headerlink" title="(3)改变码率"></a>(3)改变码率</h2><p>比如：视频的原码率是 2.1Mb/s ，压缩为 1.5Mb/s<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i XXX.mkv -b:v 1.5M  out.mp4</span><br></pre></td></tr></table></figure><br>说明：<br><code>-b:v 1.5M ==&gt; 指定视频码率 1.5Mb/s</code><br>此外：<br><code>-b:a : 指定音频的码率</code>  </p>
<h1 id="7、去除水印和添加-图片-水印"><a href="#7、去除水印和添加-图片-水印" class="headerlink" title="7、去除水印和添加(图片)水印"></a>7、去除水印和添加(图片)水印</h1><h2 id="去除水印"><a href="#去除水印" class="headerlink" title="去除水印"></a>去除水印</h2><h3 id="截取图片查看水印位置"><a href="#截取图片查看水印位置" class="headerlink" title="截取图片查看水印位置"></a>截取图片查看水印位置</h3><p>在第5秒截取一张图片。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i 646684429.mp4 -y -f image2 -ss 5 -vframes 1 image5.jpg</span><br></pre></td></tr></table></figure><br><code>-y</code>:表示无需询问,直接覆盖输出文件;<br><code>-f image2</code>：表示输出格式为<code>image2</code>;<br>如图：<br><img src="/pic/2021/11/image5.jpg" alt="image5"><br>打开画图软件，确认水印位置，本例有2处水印<br>分别位于：<br>左上一处：<br>上边：5-245<br>下边：5-60<br>右下一处：<br>上边：712-952<br>下边：482-537</p>
<h3 id="去水印"><a href="#去水印" class="headerlink" title="去水印"></a>去水印</h3><p>基本命令<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i 原视频名 -vf <span class="string">&quot;delogo=x轴坐标=左上:y轴坐标=左下坐标:宽=右-左:高=下-上&quot;</span> -c:a copy 去水印后视频名</span><br></pre></td></tr></table></figure><br>这里用下面命令去水印<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i 646684429.mp4 -vf <span class="string">&quot;delogo=x=5:y=5:w=240:h=55, delogo=x=712:y=482:w=240:h=55&quot;</span> -c:a copy nologo.mp4</span><br></pre></td></tr></table></figure><br>截取一帧<strong>去水印后的视频画面</strong>验证：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i nologo.mp4 -y -f image2 -ss 5 -vframes 1 nologoImage5.jpg</span><br></pre></td></tr></table></figure><br>如图：<br><img src="/pic/2021/11/nologoImage5.jpg" alt="nologoImage5.jpg"></p>
<h2 id="给视频添加图片水印"><a href="#给视频添加图片水印" class="headerlink" title="给视频添加图片水印"></a>给视频添加图片水印</h2><p>要添加的<code>logo</code>如图：<br><img src="/pic/2021/11/logo.jpg" alt="logo.jpg"><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i nologo.mp4 -acodec copy -b:v 992k -vf <span class="string">&quot;movie=logo.jpg [logo];[in][logo] overlay=10:15 [out]&quot;</span> addLogo.mp4</span><br></pre></td></tr></table></figure><br>说明</p>
<pre><code>-i nologo.mp4:要处理的原视频文件
-acodec copy：保持音频不变
-b:v 992k：设置视频比特率，默认200k，最好设置与原视频一致，
-vf “…”：水印处理参数。其中：
movie过滤器用来把两个流组合成一个流
logo.jpg是水印图片;
overlay=10:15是图片左上角距离视频左上角的距离。
addLogo.mp4为输出文件名
</code></pre><p>结果如图：<br><img src="/pic/2021/11/addlogoImage5.jpg" alt="addlogoImage5.jpg"><br>或者<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -i nologo.mp4 -vf  <span class="string">&quot;movie=logo.jpg,scale= 10: 15[watermask]; [in] [watermask] overlay=10:15 [out]&quot;</span> addLogo-1.mp4</span><br></pre></td></tr></table></figure><br>说明</p>
<pre><code>scale = 10: 15:水印logo大小，长*宽
-acodec copy：保持音频不变
</code></pre><p>结果如图：<br><img src="/pic/2021/11/addlogoImage5-1.jpg" alt="addlogoImage5-1.jpg"><br>想要透明效果时，须先制做一张透明的PNG图片。<br>其他可参考：<br>(使用ffmpeg命令给视频添加水印)[<a href="https://www.jianshu.com/p/e4ad7e1e7ed5">https://www.jianshu.com/p/e4ad7e1e7ed5</a>]</p>
<h1 id="8、调整视频倍速"><a href="#8、调整视频倍速" class="headerlink" title="8、调整视频倍速"></a>8、调整视频倍速</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 加速4倍</span></span><br><span class="line">ffmpeg -i input.mp4 -an -r 25 -filter:v <span class="string">&quot;setpts=0.25*PTS&quot;</span> jiasu2.mp4</span><br><span class="line"><span class="comment"># 减速2倍</span></span><br><span class="line">ffmpeg -i input.mp4 -an -r 25 -filter:v <span class="string">&quot;setpts=2*PTS&quot;</span> jiasu2.mp4</span><br></pre></td></tr></table></figure>
<p><img src="/pic/2022/11/scratch_18.gif" alt="scratch_18"></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Ffmpeg</category>
      </categories>
      <tags>
        <tag>Ffmpeg</tag>
        <tag>中文乱码</tag>
      </tags>
  </entry>
  <entry>
    <title>ImageMagick一些的简单使用</title>
    <url>/2022/06/27/ImageMagick%E4%B8%80%E4%BA%9B%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="在Windows系统下的下载安装"><a href="#在Windows系统下的下载安装" class="headerlink" title="在Windows系统下的下载安装"></a>在Windows系统下的下载安装</h1><p>可在官网选择下载并安装<br><a href="https://imagemagick.org/script/download.php#windows">下载地址</a></p>
<h1 id="一些简单应用"><a href="#一些简单应用" class="headerlink" title="一些简单应用"></a>一些简单应用</h1><p><em>以下均在Windows终端下操作：</em></p>
<h2 id="图片红色部分的都会变白色-一般用于换底"><a href="#图片红色部分的都会变白色-一般用于换底" class="headerlink" title="图片红色部分的都会变白色(一般用于换底)"></a>图片红色部分的都会变白色(一般用于换底)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">magick convert 1.jpg -fuzz 30% -fill blue -opaque white -flatten 1-1.jpg</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">magick convert 1.JPG -fuzz 30% -fill none -draw <span class="string">&quot;matte 0,0 floodfill&quot;</span> -background white -flatten 1.jpg</span><br></pre></td></tr></table></figure>
<h2 id="其他几种底色变换"><a href="#其他几种底色变换" class="headerlink" title="其他几种底色变换"></a>其他几种底色变换</h2><h3 id="白色-》蓝色和白色-》红色"><a href="#白色-》蓝色和白色-》红色" class="headerlink" title="白色=》蓝色和白色=》红色"></a>白色=》蓝色和白色=》红色</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 白色==》蓝色</span></span><br><span class="line"> magick convert 1.jpg -fuzz 0.8% -fill blue -opaque white -flatten white2blue.jpg</span><br></pre></td></tr></table></figure>
<p><img src="\pic\2022\6\1.jpg" alt="白色"><br><img src="\pic\2022\6\1-white2blue.jpg" alt="蓝色"><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 白色==》红色</span></span><br><span class="line"> magick convert 1.jpg -fuzz 0.5% -fill red -opaque white -flatten 1-white2red.jpg</span><br></pre></td></tr></table></figure><br><img src="\pic\2022\6\1-white2red.jpg" alt="1-white2red"></p>
<h3 id="红色-》蓝色和红色-》白色"><a href="#红色-》蓝色和红色-》白色" class="headerlink" title="红色=》蓝色和红色=》白色"></a>红色=》蓝色和红色=》白色</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 红色==》蓝色</span></span><br><span class="line"> magick 1-white2red.jpg -fuzz 5% -fill blue -opaque red -flatten 1-red2blue.jpg</span><br></pre></td></tr></table></figure>
<p><img src="\pic\2022\6\1-red2blue.jpg" alt="red2blue.jpg"><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 红色==》白色</span></span><br><span class="line"> magick convert 1-white2red -fuzz 5% -fill white -opaque red -flatten 1-red2white.jpg</span><br></pre></td></tr></table></figure><br><img src="\pic\2022\6\1-red2white.jpg" alt="red2white.jpg"></p>
<h3 id="蓝色-》红色和蓝色-》白色"><a href="#蓝色-》红色和蓝色-》白色" class="headerlink" title="蓝色=》红色和蓝色=》白色"></a>蓝色=》红色和蓝色=》白色</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 蓝色==》红色</span></span><br><span class="line"> magick convert 2.jpg -fuzz 5% -fill red -opaque <span class="string">&#x27;rgb(83,97,132)&#x27;</span> -flatten blue2red.jpg</span><br></pre></td></tr></table></figure>
<p><img src="\pic\2022\6\2.jpg" alt="2.jpg"><br><img src="\pic\2022\6\blue2red.jpg" alt="blue2red"><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 蓝色==》白色</span></span><br><span class="line"> magick convert 2.jpg -fuzz 5% -fill white -opaque <span class="string">&#x27;rgb(83,97,132)&#x27;</span> -flatten blue2white.jpg</span><br></pre></td></tr></table></figure><br><img src="\pic\2022\6\blue2white.jpg" alt="blue2white"></p>
<h2 id="将图片压缩到指定大小"><a href="#将图片压缩到指定大小" class="headerlink" title="将图片压缩到指定大小"></a>将图片压缩到指定大小</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">magick convert 1.png -strip -define jpeg:extent=200k a1.jpg</span><br></pre></td></tr></table></figure>
<h2 id="不改变分辨率情况下，调整图片大小"><a href="#不改变分辨率情况下，调整图片大小" class="headerlink" title="不改变分辨率情况下，调整图片大小"></a>不改变分辨率情况下，调整图片大小</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">magick convert 1.jpg -strip -define jpeg:extent=20k 1-a.jpg</span><br><span class="line">magick convert -resize 178x220 1.jpg 1-1.jpg</span><br><span class="line"><span class="comment"># du -sh 1-1.jpg</span></span><br><span class="line"><span class="comment"># 44K 1-1.jpg</span></span><br></pre></td></tr></table></figure>
<h2 id="扣取公章-白底变透明"><a href="#扣取公章-白底变透明" class="headerlink" title="扣取公章(白底变透明)"></a>扣取公章(白底变透明)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># magick convert 1.webp 1-w.png</span></span><br><span class="line"><span class="comment"># magick convert 1-w.png -fuzz 20% -transparent white 1-w-1.png</span></span><br><span class="line">magick convert 2.png -fuzz 20% -transparent white 2-1.png</span><br></pre></td></tr></table></figure>
<p>有白底的原图片<br><img src="\pic\2022\6\扣章\2.png" alt="2.png"><br>扣取图章后的效果：<br><em>调到暗黑模式才看得出</em><br><img src="\pic\2022\6\扣章\2-1.png" alt="2.png"></p>
<p><em>以上图片来源于网络</em></p>
<p>后续程序使用会继续补充完善。。。</p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>ImageMagick</category>
      </categories>
      <tags>
        <tag>ImageMagick</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux检测磁盘坏道</title>
    <url>/2021/11/26/Linux%E6%A3%80%E6%B5%8B%E7%A3%81%E7%9B%98%E5%9D%8F%E9%81%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、使用badblocks命令"><a href="#一、使用badblocks命令" class="headerlink" title="一、使用badblocks命令"></a>一、使用<code>badblocks</code>命令</h1><p>语法 </p>
<pre><code>badblocks [-svw][-b &lt;区块大小&gt;][-o &lt;输出文件&gt;][磁盘装置][磁盘区块数][启始区块]  
</code></pre><p>参数说明：</p>
<pre><code>-b&lt;区块大小&gt; 指定磁盘的区块大小，单位为字节。  
-o&lt;输出文件&gt; 将检查的结果写入指定的输出文件。  
-s 在检查时显示进度。  
-v 执行时显示详细的信息。  
-w 在检查时，执行写入测试。  
[磁盘装置] 指定要检查的磁盘装置。  
[磁盘区块数] 指定磁盘装置的区块总数。  
[启始区块] 指定要从哪个区块开始检查。  
</code></pre><p>参考：<a href="https://www.runoob.com/linux/linux-comm-badblocks.html">Linux badblocks命令</a>  </p>
<h2 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h2><h3 id="1、列出磁盘信息"><a href="#1、列出磁盘信息" class="headerlink" title="1、列出磁盘信息"></a>1、列出磁盘信息</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~$ sudo fdisk -l</span><br><span class="line">Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors</span><br><span class="line">Disk model: nal USB 3.0     </span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 4096 bytes</span><br><span class="line">I/O size (minimum/optimal): 4096 bytes / 4096 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x627a0fc4</span><br><span class="line">Device     Boot      Start        End    Sectors   Size Id Type</span><br><span class="line">/dev/sda1  *          2048   41840639   41838592    20G 83 Linux</span><br><span class="line">/dev/sda2         41842686 1953523711 1911681026 911.6G  f W95 Ext<span class="string">&#x27;d (LBA)</span></span><br><span class="line"><span class="string">/dev/sda5        222707712  419434495  196726784  93.8G  7 HPFS/NTFS/exFAT</span></span><br><span class="line"><span class="string">/dev/sda6        419436544  838868991  419432448   200G  7 HPFS/NTFS/exFAT</span></span><br><span class="line"><span class="string">/dev/sda7        838871040 1187000319  348129280   166G  7 HPFS/NTFS/exFAT</span></span><br><span class="line"><span class="string">/dev/sda8       1187002368 1396715519  209713152   100G  7 HPFS/NTFS/exFAT</span></span><br><span class="line"><span class="string">/dev/sda9       1396717568 1953523711  556806144 265.5G  7 HPFS/NTFS/exFAT</span></span><br><span class="line"><span class="string">/dev/sda10        41842688   56438783   14596096     7G 83 Linux</span></span><br><span class="line"><span class="string">/dev/sda11        56440832   58439679    1998848   976M 82 Linux swap / Solaris                                                                               /dev/sda12        58441728   61046783    2605056   1.2G 83 Linux</span></span><br><span class="line"><span class="string">/dev/sda13        61048832  222693375  161644544  77.1G 83 Linux</span></span><br></pre></td></tr></table></figure>
<h3 id="2、将检测坏道信息保存到文件："><a href="#2、将检测坏道信息保存到文件：" class="headerlink" title="2、将检测坏道信息保存到文件："></a>2、将检测坏道信息保存到文件：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~$ sudo badblocks -v /dev/sda8 &gt; /tmp/badsectors.txt <span class="comment"># sudo badblocks -s -v /dev/sda8 -o badsectors.txt </span></span><br><span class="line">Checking blocks 0 to 104856575</span><br><span class="line">Checking <span class="keyword">for</span> ba  blocks (read-only <span class="built_in">test</span>): <span class="keyword">done</span>                                Pass completed, 0 bad blocks found. (0/0/0 errors)</span><br></pre></td></tr></table></figure>
<h3 id="3、修复（待验证）"><a href="#3、修复（待验证）" class="headerlink" title="3、修复（待验证）"></a>3、修复（待验证）</h3><p>(1)先用dd尽量备份坏块<br><code>dd if=/dev/sdb bs=4096 skip=扫描出的磁盘区块坏道 of=/tmp/15435904.dat count=1</code><br>(2)对这些坏块进行重写(注意! -w写测试会覆盖数据)<br><code>badblocks -w -f /dev/sdb 坏道结束编号 坏道起始编号</code><br>(3)如果前面的操作有成功的备份<code>/tmp/15435904.dat</code>, 就把它写回:<br><code>dd if=/tmp/15435904.dat of=/dev/sdb seek=15435904 bs=4096 count=1</code>  </p>
<p>参考：<a href="https://blog.51cto.com/1153604556/1643695">linux下利用badblocks程序在线修复坏道</a>  </p>
<p>也可以提示操作系统不要使用损坏区块存储<br><code># e2fsck -l /tmp/badsectors.txt  /dev/sdb</code></p>
<p><strong>备注: 执行e2fsck命令前，需要先挂载设备</strong>  </p>
<h1 id="二、使用smartmontools工具扫描："><a href="#二、使用smartmontools工具扫描：" class="headerlink" title="二、使用smartmontools工具扫描："></a>二、使用<code>smartmontools</code>工具扫描：</h1><h2 id="1、安装"><a href="#1、安装" class="headerlink" title="1、安装"></a>1、安装</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~$ sudo apt update</span><br><span class="line">命中:1 http://packages.microsoft.com/repos/code stable InRelease</span><br><span class="line">...</span><br><span class="line">命中:12 https://mirror.serverion.com/mariadb/repo/10.6/debian bullseye InRelease</span><br><span class="line">已下载 39.4 kB，耗时 7秒 (5,607 B/s)                                           </span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树... 完成</span><br><span class="line">正在读取状态信息... 完成                 </span><br><span class="line">所有软件包均为最新。</span><br><span class="line">user@user-pc:~$ sudo apt install smartmontools</span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树... 完成</span><br><span class="line">正在读取状态信息... 完成                 </span><br><span class="line">建议安装：</span><br><span class="line">  gsmartcontrol smart-notifier mailx | mailutils</span><br><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  smartmontools</span><br><span class="line">升级了 0 个软件包，新安装了 1 个软件包，要卸载 0 个软件包，有 0 个软件包未被升级。</span><br><span class="line">需要下载 565 kB 的归档。</span><br><span class="line">解压缩后会消耗 2,168 kB 的额外空间。</span><br><span class="line">获取:1 http://mirrors.tuna.tsinghua.edu.cn/debian bullseye/main amd64 smartmontools amd64 7.2-1 [565 kB]</span><br><span class="line">已下载 565 kB，耗时 0秒 (1,212 kB/s)  </span><br><span class="line">正在选中未选择的软件包 smartmontools。</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 172754 个文件和目录。)</span><br><span class="line">准备解压 .../smartmontools_7.2-1_amd64.deb  ...</span><br><span class="line">正在解压 smartmontools (7.2-1) ...</span><br><span class="line">正在设置 smartmontools (7.2-1) ...</span><br><span class="line">Created symlink /etc/systemd/system/smartd.service → /lib/systemd/system/smartmo</span><br><span class="line">ntools.service.</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/smartmontools.servic</span><br><span class="line">e → /lib/systemd/system/smartmontools.service.</span><br><span class="line">正在处理用于 man-db (2.9.4-2) 的触发器 ...</span><br></pre></td></tr></table></figure>
<h2 id="2、使用方法"><a href="#2、使用方法" class="headerlink" title="2、使用方法"></a>2、使用方法</h2><p>检测路径根据<code>$ sudo fdisk -l</code>列出的对应。<br>（1）检测磁盘某部分<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~$ sudo smartctl -H /dev/sda8 -x</span><br><span class="line">smartctl 7.2 2020-12-30 r5155 [x86_64-linux-5.10.0-9-amd64] (<span class="built_in">local</span> build)</span><br><span class="line">Copyright (C) 2002-20, Bruce Allen, Christian Franke, www.smartmontools.org</span><br><span class="line"></span><br><span class="line">=== START OF INFORMATION SECTION ===</span><br><span class="line">Vendor:               TO Exter</span><br><span class="line">Product:              nal USB 3.0</span><br><span class="line">Revision:             0104</span><br><span class="line">Compliance:           SPC-4</span><br><span class="line">User Capacity:        1,000,204,886,016 bytes [1.00 TB]</span><br><span class="line">Logical block size:   512 bytes</span><br><span class="line">Physical block size:  4096 bytes</span><br><span class="line">LU is fully provisioned</span><br><span class="line">Logical Unit <span class="built_in">id</span>:      0x3020150331000810</span><br><span class="line">Serial number:        2015033100081</span><br><span class="line">Device <span class="built_in">type</span>:          disk</span><br><span class="line">Local Time is:        Fri Nov 26 09:43:16 2021 CST</span><br><span class="line">SMART support is:     Available - device has SMART capability.</span><br><span class="line">SMART support is:     Enabled</span><br><span class="line">Temperature Warning:  Disabled or Not Supported</span><br><span class="line">Read Cache is:        Enabled</span><br><span class="line">Writeback Cache is:   Enabled</span><br><span class="line"></span><br><span class="line">=== START OF READ SMART DATA SECTION ===</span><br><span class="line">SMART Health Status: OK</span><br><span class="line">Current Drive Temperature:     0 C</span><br><span class="line">Drive Trip Temperature:        0 C</span><br><span class="line"></span><br><span class="line">Error Counter logging not supported</span><br><span class="line"></span><br><span class="line">No Self-tests have been logged</span><br><span class="line"></span><br><span class="line">Device does not support Background scan results logging</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>（2）检测挂载的某个磁盘<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~$ sudo smartctl -H /dev/sda -x</span><br><span class="line">smartctl 7.2 2020-12-30 r5155 [x86_64-linux-5.10.0-9-amd64] (<span class="built_in">local</span> build)</span><br><span class="line">Copyright (C) 2002-20, Bruce Allen, Christian Franke, www.smartmontools.org</span><br><span class="line"></span><br><span class="line">=== START OF INFORMATION SECTION ===</span><br><span class="line">Model Family:     Western Digital Blue</span><br><span class="line">Device Model:     WDC WD10EZEX-08M2NA0</span><br><span class="line">Serial Number:    WD-WCC3F5NUNC7S</span><br><span class="line">LU WWN Device Id: 5 0014ee 20bf6d4ff</span><br><span class="line">Firmware Version: 01.01A01</span><br><span class="line">User Capacity:    1,000,204,886,016 bytes [1.00 TB]</span><br><span class="line">Sector Sizes:     512 bytes logical, 4096 bytes physical</span><br><span class="line">Rotation Rate:    7200 rpm</span><br><span class="line">Device is:        In smartctl database [<span class="keyword">for</span> details use: -P show]</span><br><span class="line">ATA Version is:   ACS-2, ACS-3 T13/2161-D revision 3b</span><br><span class="line">SATA Version is:  SATA 3.1, 6.0 Gb/s (current: 6.0 Gb/s)</span><br><span class="line">Local Time is:    Fri Nov 26 09:44:39 2021 CST</span><br><span class="line">SMART support is: Available - device has SMART capability.</span><br><span class="line">SMART support is: Enabled</span><br><span class="line">AAM feature is:   Unavailable</span><br><span class="line">APM feature is:   Unavailable</span><br><span class="line">Rd look-ahead is: Enabled</span><br><span class="line">Write cache is:   Enabled</span><br><span class="line">DSN feature is:   Unavailable</span><br><span class="line">ATA Security is:  Disabled, NOT FROZEN [SEC1]</span><br><span class="line">Wt Cache Reorder: Unknown</span><br><span class="line"></span><br><span class="line">=== START OF READ SMART DATA SECTION ===</span><br><span class="line">SMART Status not supported: Incomplete response, ATA output registers missing</span><br><span class="line">SMART overall-health self-assessment <span class="built_in">test</span> result: PASSED</span><br><span class="line">Warning: This result is based on an Attribute check.</span><br><span class="line">user@user-pc:~$ sudo smartctl -H /dev/sda -a</span><br><span class="line">smartctl 7.2 2020-12-30 r5155 [x86_64-linux-5.10.0-9-amd64] (<span class="built_in">local</span> build)</span><br><span class="line">Copyright (C) 2002-20, Bruce Allen, Christian Franke, www.smartmontools.org</span><br><span class="line"></span><br><span class="line">=== START OF INFORMATION SECTION ===</span><br><span class="line">Model Family:     Western Digital Blue</span><br><span class="line">Device Model:     WDC WD10EZEX-08M2NA0</span><br><span class="line">Serial Number:    WD-WCC3F5NUNC7S</span><br><span class="line">LU WWN Device Id: 5 0014ee 20bf6d4ff</span><br><span class="line">Firmware Version: 01.01A01</span><br><span class="line">User Capacity:    1,000,204,886,016 bytes [1.00 TB]</span><br><span class="line">Sector Sizes:     512 bytes logical, 4096 bytes physical</span><br><span class="line">Rotation Rate:    7200 rpm</span><br><span class="line">Device is:        In smartctl database [<span class="keyword">for</span> details use: -P show]</span><br><span class="line">ATA Version is:   ACS-2, ACS-3 T13/2161-D revision 3b</span><br><span class="line">SATA Version is:  SATA 3.1, 6.0 Gb/s (current: 6.0 Gb/s)</span><br><span class="line">Local Time is:    Fri Nov 26 12:25:59 2021 CST</span><br><span class="line">SMART support is: Available - device has SMART capability.</span><br><span class="line">SMART support is: Enabled</span><br><span class="line"></span><br><span class="line">=== START OF READ SMART DATA SECTION ===</span><br><span class="line">SMART Status not supported: Incomplete response, ATA output registers missing</span><br><span class="line">SMART overall-health self-assessment <span class="built_in">test</span> result: PASSED</span><br><span class="line">Warning: This result is based on an Attribute check.</span><br><span class="line"></span><br><span class="line">General SMART Values:</span><br><span class="line">Offline data collection status:  (0x82)	Offline data collection activity</span><br><span class="line">					was completed without error.</span><br><span class="line">					Auto Offline Data Collection: Enabled.</span><br><span class="line">Self-<span class="built_in">test</span> execution status:      (   0)	The previous self-test routine completed</span><br><span class="line">					without error or no self-test has ever </span><br><span class="line">					been run.</span><br><span class="line">Total time to complete Offline </span><br><span class="line">data collection: 		(11580) seconds.</span><br><span class="line">Offline data collection</span><br><span class="line">capabilities: 			 (0x7b) SMART execute Offline immediate.</span><br><span class="line">					Auto Offline data collection on/off support.</span><br><span class="line">					Suspend Offline collection upon new</span><br><span class="line">					<span class="built_in">command</span>.</span><br><span class="line">					Offline surface scan supported.</span><br><span class="line">					Self-<span class="built_in">test</span> supported.</span><br><span class="line">					Conveyance Self-<span class="built_in">test</span> supported.</span><br><span class="line">					Selective Self-<span class="built_in">test</span> supported.</span><br><span class="line">SMART capabilities:            (0x0003)	Saves SMART data before entering</span><br><span class="line">					power-saving mode.</span><br><span class="line">					Supports SMART auto save timer.</span><br><span class="line">Error logging capability:        (0x01)	Error logging supported.</span><br><span class="line">					General Purpose Logging supported.</span><br><span class="line">Short self-test routine </span><br><span class="line">recommended polling time: 	 (   2) minutes.</span><br><span class="line">Extended self-test routine</span><br><span class="line">recommended polling time: 	 ( 120) minutes.</span><br><span class="line">Conveyance self-test routine</span><br><span class="line">recommended polling time: 	 (   5) minutes.</span><br><span class="line">SCT capabilities: 	       (0x3035)	SCT Status supported.</span><br><span class="line">					SCT Feature Control supported.</span><br><span class="line">					SCT Data Table supported.</span><br><span class="line"></span><br><span class="line">SMART Attributes Data Structure revision number: 16</span><br><span class="line">Vendor Specific SMART Attributes with Thresholds:</span><br><span class="line">ID<span class="comment"># ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE</span></span><br><span class="line">  1 Raw_Read_Error_Rate     0x002f   200   200   051    Pre-fail  Always       -       0</span><br><span class="line">  3 Spin_Up_Time            0x0027   173   165   021    Pre-fail  Always       -       2308</span><br><span class="line">  4 Start_Stop_Count        0x0032   094   094   000    Old_age   Always       -       6265</span><br><span class="line">  5 Reallocated_Sector_Ct   0x0033   200   200   140    Pre-fail  Always       -       0</span><br><span class="line">  7 Seek_Error_Rate         0x002e   200   200   000    Old_age   Always       -       0</span><br><span class="line">  9 Power_On_Hours          0x0032   095   095   000    Old_age   Always       -       4052</span><br><span class="line"> 10 Spin_Retry_Count        0x0032   100   100   000    Old_age   Always       -       0</span><br><span class="line"> 11 Calibration_Retry_Count 0x0032   100   100   000    Old_age   Always       -       0</span><br><span class="line"> 12 Power_Cycle_Count       0x0032   100   100   000    Old_age   Always       -       857</span><br><span class="line">192 Power-Off_Retract_Count 0x0032   200   200   000    Old_age   Always       -       106</span><br><span class="line">193 Load_Cycle_Count        0x0032   198   198   000    Old_age   Always       -       6159</span><br><span class="line">194 Temperature_Celsius     0x0022   106   085   000    Old_age   Always       -       37</span><br><span class="line">196 Reallocated_Event_Count 0x0032   200   200   000    Old_age   Always       -       0</span><br><span class="line">197 Current_Pending_Sector  0x0032   200   200   000    Old_age   Always       -       0</span><br><span class="line">198 Offline_Uncorrectable   0x0030   200   200   000    Old_age   Offline      -       0</span><br><span class="line">199 UDMA_CRC_Error_Count    0x0032   200   200   000    Old_age   Always       -       0</span><br><span class="line">200 Multi_Zone_Error_Rate   0x0008   200   200   000    Old_age   Offline      -       0</span><br><span class="line"></span><br><span class="line">SMART Error Log Version: 1</span><br><span class="line">No Errors Logged</span><br><span class="line"></span><br><span class="line">SMART Self-<span class="built_in">test</span> <span class="built_in">log</span> structure revision number 1</span><br><span class="line">No self-tests have been logged.  [To run self-tests, use: smartctl -t]</span><br><span class="line"></span><br><span class="line">SMART Selective self-test <span class="built_in">log</span> data structure revision number 1</span><br><span class="line"> SPAN  MIN_LBA  MAX_LBA  CURRENT_TEST_STATUS</span><br><span class="line">    1        0        0  Not_testing</span><br><span class="line">    2        0        0  Not_testing</span><br><span class="line">    3        0        0  Not_testing</span><br><span class="line">    4        0        0  Not_testing</span><br><span class="line">    5        0        0  Not_testing</span><br><span class="line">Selective self-test flags (0x0):</span><br><span class="line">  After scanning selected spans, <span class="keyword">do</span> NOT read-scan remainder of disk.</span><br><span class="line">If Selective self-test is pending on power-up, resume after 0 minute delay.</span><br></pre></td></tr></table></figure><br>（3）检测挂载的另一个磁盘<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~$ sudo smartctl -H /dev/sdb -a</span><br><span class="line">smartctl 7.2 2020-12-30 r5155 [x86_64-linux-5.10.0-9-amd64] (<span class="built_in">local</span> build)</span><br><span class="line">Copyright (C) 2002-20, Bruce Allen, Christian Franke, www.smartmontools.org</span><br><span class="line"></span><br><span class="line">=== START OF INFORMATION SECTION ===</span><br><span class="line">Model Family:     Seagate Barracuda 7200.14 (AF)</span><br><span class="line">Device Model:     ST500DM002-1BD142</span><br><span class="line">Serial Number:    W2AYVPQG</span><br><span class="line">LU WWN Device Id: 5 000c50 06add6856</span><br><span class="line">Firmware Version: KC65</span><br><span class="line">User Capacity:    500,107,862,016 bytes [500 GB]</span><br><span class="line">Sector Sizes:     512 bytes logical, 4096 bytes physical</span><br><span class="line">Rotation Rate:    7200 rpm</span><br><span class="line">Device is:        In smartctl database [<span class="keyword">for</span> details use: -P show]</span><br><span class="line">ATA Version is:   ATA8-ACS T13/1699-D revision 4</span><br><span class="line">SATA Version is:  SATA 3.0, 6.0 Gb/s (current: 6.0 Gb/s)</span><br><span class="line">Local Time is:    Fri Nov 26 12:32:11 2021 CST</span><br><span class="line">SMART support is: Available - device has SMART capability.</span><br><span class="line">SMART support is: Enabled</span><br><span class="line"></span><br><span class="line">=== START OF READ SMART DATA SECTION ===</span><br><span class="line">SMART overall-health self-assessment <span class="built_in">test</span> result: PASSED</span><br><span class="line">See vendor-specific Attribute list <span class="keyword">for</span> marginal Attributes.</span><br><span class="line"></span><br><span class="line">General SMART Values:</span><br><span class="line">Offline data collection status:  (0x82)	Offline data collection activity</span><br><span class="line">					was completed without error.</span><br><span class="line">					Auto Offline Data Collection: Enabled.</span><br><span class="line">Self-<span class="built_in">test</span> execution status:      (   0)	The previous self-test routine completed</span><br><span class="line">					without error or no self-test has ever </span><br><span class="line">					been run.</span><br><span class="line">Total time to complete Offline </span><br><span class="line">data collection: 		(  592) seconds.</span><br><span class="line">Offline data collection</span><br><span class="line">capabilities: 			 (0x7b) SMART execute Offline immediate.</span><br><span class="line">					Auto Offline data collection on/off support.</span><br><span class="line">					Suspend Offline collection upon new</span><br><span class="line">					<span class="built_in">command</span>.</span><br><span class="line">					Offline surface scan supported.</span><br><span class="line">					Self-<span class="built_in">test</span> supported.</span><br><span class="line">					Conveyance Self-<span class="built_in">test</span> supported.</span><br><span class="line">					Selective Self-<span class="built_in">test</span> supported.</span><br><span class="line">SMART capabilities:            (0x0003)	Saves SMART data before entering</span><br><span class="line">					power-saving mode.</span><br><span class="line">					Supports SMART auto save timer.</span><br><span class="line">Error logging capability:        (0x01)	Error logging supported.</span><br><span class="line">					General Purpose Logging supported.</span><br><span class="line">Short self-test routine </span><br><span class="line">recommended polling time: 	 (   1) minutes.</span><br><span class="line">Extended self-test routine</span><br><span class="line">recommended polling time: 	 (  79) minutes.</span><br><span class="line">Conveyance self-test routine</span><br><span class="line">recommended polling time: 	 (   2) minutes.</span><br><span class="line">SCT capabilities: 	       (0x303f)	SCT Status supported.</span><br><span class="line">					SCT Error Recovery Control supported.</span><br><span class="line">					SCT Feature Control supported.</span><br><span class="line">					SCT Data Table supported.</span><br><span class="line"></span><br><span class="line">SMART Attributes Data Structure revision number: 10</span><br><span class="line">Vendor Specific SMART Attributes with Thresholds:</span><br><span class="line">ID<span class="comment"># ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE</span></span><br><span class="line">  1 Raw_Read_Error_Rate     0x000f   101   099   006    Pre-fail  Always       -       353256</span><br><span class="line">  3 Spin_Up_Time            0x0003   100   100   000    Pre-fail  Always       -       0</span><br><span class="line">  4 Start_Stop_Count        0x0032   098   098   020    Old_age   Always       -       2889</span><br><span class="line">  5 Reallocated_Sector_Ct   0x0033   100   100   036    Pre-fail  Always       -       0</span><br><span class="line">  7 Seek_Error_Rate         0x000f   087   060   030    Pre-fail  Always       -       611100360</span><br><span class="line">  9 Power_On_Hours          0x0032   091   091   000    Old_age   Always       -       7963</span><br><span class="line"> 10 Spin_Retry_Count        0x0013   100   100   097    Pre-fail  Always       -       0</span><br><span class="line"> 12 Power_Cycle_Count       0x0032   098   098   020    Old_age   Always       -       2870</span><br><span class="line">183 Runtime_Bad_Block       0x0032   100   100   000    Old_age   Always       -       0</span><br><span class="line">184 End-to-End_Error        0x0032   100   100   099    Old_age   Always       -       0</span><br><span class="line">187 Reported_Uncorrect      0x0032   098   098   000    Old_age   Always       -       2</span><br><span class="line">188 Command_Timeout         0x0032   100   100   000    Old_age   Always       -       0 0 0</span><br><span class="line">189 High_Fly_Writes         0x003a   100   100   000    Old_age   Always       -       0</span><br><span class="line">190 Airflow_Temperature_Cel 0x0022   062   044   045    Old_age   Always   In_the_past 38 (0 59 38 13 0)</span><br><span class="line">194 Temperature_Celsius     0x0022   038   056   000    Old_age   Always       -       38 (0 8 0 0 0)</span><br><span class="line">195 Hardware_ECC_Recovered  0x001a   034   026   000    Old_age   Always       -       353256</span><br><span class="line">197 Current_Pending_Sector  0x0012   100   100   000    Old_age   Always       -       0</span><br><span class="line">198 Offline_Uncorrectable   0x0010   100   100   000    Old_age   Offline      -       0</span><br><span class="line">199 UDMA_CRC_Error_Count    0x003e   200   200   000    Old_age   Always       -       0</span><br><span class="line">240 Head_Flying_Hours       0x0000   100   253   000    Old_age   Offline      -       7949h+37m+36.458s</span><br><span class="line">241 Total_LBAs_Written      0x0000   100   253   000    Old_age   Offline      -       1573025949</span><br><span class="line">242 Total_LBAs_Read         0x0000   100   253   000    Old_age   Offline      -       3066682191</span><br><span class="line"></span><br><span class="line">SMART Error Log Version: 1</span><br><span class="line">No Errors Logged</span><br><span class="line"></span><br><span class="line">SMART Self-<span class="built_in">test</span> <span class="built_in">log</span> structure revision number 1</span><br><span class="line">No self-tests have been logged.  [To run self-tests, use: smartctl -t]</span><br><span class="line"></span><br><span class="line">SMART Selective self-test <span class="built_in">log</span> data structure revision number 1</span><br><span class="line"> SPAN  MIN_LBA  MAX_LBA  CURRENT_TEST_STATUS</span><br><span class="line">    1        0        0  Not_testing</span><br><span class="line">    2        0        0  Not_testing</span><br><span class="line">    3        0        0  Not_testing</span><br><span class="line">    4        0        0  Not_testing</span><br><span class="line">    5        0        0  Not_testing</span><br><span class="line">Selective self-test flags (0x0):</span><br><span class="line">  After scanning selected spans, <span class="keyword">do</span> NOT read-scan remainder of disk.</span><br><span class="line">If Selective self-test is pending on power-up, resume after 0 minute delay.</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>运维</category>
        <category>badblocks</category>
        <category>smartmontools</category>
      </categories>
      <tags>
        <tag>Badblocks</tag>
        <tag>Smartmontools</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux系统service服务管理方式下Nginx设置开机启动</title>
    <url>/2021/06/21/Linux%E7%B3%BB%E7%BB%9Fservice%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F%E4%B8%8BNginx%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p> <code>service</code>命令其实是去<code>/etc/init.d</code>目录下,去执行相关程序,相应脚本需要自己填写。    </p>
<h1 id="1-设置nginx启动脚本"><a href="#1-设置nginx启动脚本" class="headerlink" title="1.设置nginx启动脚本"></a>1.设置nginx启动脚本</h1><p>在<code>/etc/init.d/</code>目录下创建<code>nginx</code>的启动文件<br>命令 <code>vim /etc/init.d/nginx</code>，将以下代码复制进去保存即可<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># nginx Startup script for the Nginx HTTP Server</span></span><br><span class="line"><span class="comment"># it is v.0.0.2 version.</span></span><br><span class="line"><span class="comment"># chkconfig: - 85 15</span></span><br><span class="line"><span class="comment"># description: Nginx is a high-performance web and proxy server.</span></span><br><span class="line"><span class="comment">#              It has a lot of features, but it&#x27;s not for everyone.</span></span><br><span class="line"><span class="comment"># processname: nginx</span></span><br><span class="line"><span class="comment"># pidfile: /var/run/nginx.pid</span></span><br><span class="line"><span class="comment"># config: /usr/local/nginx/conf/nginx.conf</span></span><br><span class="line">nginx=/usr/local/nginx/sbin/nginx</span><br><span class="line">conf=/usr/local/nginx/conf/nginx.conf</span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;Starting Nginx&quot;</span></span><br><span class="line"><span class="variable">$nginx</span> -c <span class="variable">$conf</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; done.&quot;</span></span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;Stopping Nginx&quot;</span></span><br><span class="line">killall -9 nginx</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; done.&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="built_in">test</span>)</span><br><span class="line"><span class="variable">$nginx</span> -t -c <span class="variable">$conf</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Success.&quot;</span></span><br><span class="line">;;</span><br><span class="line">reload)</span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;Reloading Nginx&quot;</span></span><br><span class="line">ps auxww | grep nginx | grep master | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | xargs <span class="built_in">kill</span> -HUP</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; done.&quot;</span></span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line"><span class="variable">$nginx</span> -s reload</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;reload done.&quot;</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> &#123;start|restart|reload|stop|test|show&#125;&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure></p>
<h1 id="2-设置文件权限并启动Nginx"><a href="#2-设置文件权限并启动Nginx" class="headerlink" title="2. 设置文件权限并启动Nginx"></a>2. 设置文件权限并启动<code>Nginx</code></h1><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo chkconfig --add /etc/init.d/nginx</span><br><span class="line">sudo <span class="built_in">chmod</span> 755 /etc/init.d/nginx</span><br><span class="line">sudo chkconfig --add nginx</span><br><span class="line">sudo service nginx start </span><br></pre></td></tr></table></figure></p>
<h1 id="3-设置开机启动"><a href="#3-设置开机启动" class="headerlink" title="3.设置开机启动"></a>3.设置开机启动</h1><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/sbin/chkconfig --level 345 nginx on</span><br></pre></td></tr></table></figure></p>
<h1 id="4-其他命令介绍"><a href="#4-其他命令介绍" class="headerlink" title="4. 其他命令介绍"></a>4. 其他命令介绍</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chkconfig --list 查看全部服务状态</span><br><span class="line">例如:</span><br><span class="line">运行chkconfig --list httpd</span><br><span class="line">看自动启动状态</span><br><span class="line">httpd 0:off 1:off 2:off 3:on 4:on 5:on 6:off</span><br><span class="line">0~6是指运行级别，一般服务器都运行在3这个级别上。</span><br><span class="line"></span><br><span class="line">添加为自动启动</span><br><span class="line">chkconfig --add httpd</span><br><span class="line">或者指定运行级别</span><br><span class="line">chkconfig --level 345 httpd on</span><br><span class="line"></span><br><span class="line">停止自动启动</span><br><span class="line">chkconfig --del httpd</span><br><span class="line">或指定运行级别</span><br><span class="line">chkconfig --level 345 httpd off</span><br></pre></td></tr></table></figure>
<p>参考资料：<br>1.<a href="https://www.cnblogs.com/seasen/p/12603017.html">nginx添加service以及随开机启动:</a><br>2.<a href="https://blog.csdn.net/chuifuhuo6864/article/details/100876188">linux 命令 /sbin/chkconfig</a><br>3.<a href="https://www.cnblogs.com/donglovebobo/p/14052728.html">nginx加入到service服务 systemctl安装nginx 自启动</a></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Linux</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
        <tag>启动服务</tag>
        <tag>Service</tag>
      </tags>
  </entry>
  <entry>
    <title>linux误删libc-bin出现”dpkg warning： &#39;ldconfig&#39; not found in PATH or not executable”</title>
    <url>/2022/01/25/Linux%E8%AF%AF%E5%88%A0libc-bin%E5%87%BA%E7%8E%B0dpkg%20warning%20ldconfig%20not%20found/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在<code>debian11</code>下，误卸载<code>libc6</code>后，用<code>apt</code>安装任何软件都会报如下错误：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Preconfiguring packages …</span><br><span class="line">dpkg: warning: ‘ldconfig’ not found <span class="keyword">in</span> PATH or not executable</span><br><span class="line">dpkg: error: 1 expected program not found <span class="keyword">in</span> PATH or not executable</span><br><span class="line">Note: root’s PATH should usually contain /usr/local/sbin, /usr/sbin and /sbin</span><br><span class="line"></span><br><span class="line">E: Sub-process /usr/bin/dpkg returned an error code (2)</span><br></pre></td></tr></table></figure><br>这是因为找不到<code>/sbin</code>，目录下的<code>ldconfig</code>了。</p>
<p>解决办法：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get download libc-bin</span><br><span class="line">dpkg -x libc-bin*.deb unpackdir/</span><br><span class="line">sudo <span class="built_in">cp</span> unpackdir/sbin/ldconfig /sbin/</span><br><span class="line">sudo apt-get install --reinstall libc-bin</span><br><span class="line">sudo apt-get -f install </span><br></pre></td></tr></table></figure><br>参考<br><a href="https://www.codeleading.com/article/32744131762/">linux误删libc-bin出现dpkg: warning: ‘ldconfig’ not found in PATH or not executable</a></p>
]]></content>
      <categories>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Libc</tag>
        <tag>Ldconfig</tag>
      </tags>
  </entry>
  <entry>
    <title>MariaDB&amp;MySQL数据库的增删改查及备份和恢复</title>
    <url>/2021/08/17/MariaDB&amp;MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A2%9E%E3%80%81%E5%88%A0%E3%80%81%E6%94%B9%E3%80%81%E6%9F%A5%E3%80%81%E5%A4%87%E4%BB%BD%E5%8F%8A%E6%81%A2%E5%A4%8D/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo mysql -uroot  //进入数据库</span><br><span class="line">$ MariaDB [(none)]&gt; CREATE DATABASE study_test;</span><br><span class="line"> Query OK, 1 row affected (0.000 sec)</span><br></pre></td></tr></table></figure>
<h1 id="2、创建及删除表"><a href="#2、创建及删除表" class="headerlink" title="2、创建及删除表"></a>2、创建及删除表</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; use study_test;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; CREATE TABLE study_test(</span><br><span class="line">    -&gt; test_id INT NOT NULL AUTO_INCREMENT,</span><br><span class="line">    -&gt; test_name VARCHAR(50) NOT NULL,</span><br><span class="line">    -&gt; test_discribe VARCHAR(100) NOT NULL,</span><br><span class="line">    -&gt; submit_date DATE,</span><br><span class="line">    -&gt; PRIMARY KEY (test_id)); </span><br><span class="line">Query OK, 0 rows affected (0.089 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; show tables;</span><br><span class="line">+----------------------+</span><br><span class="line">| Tables_in_study_test |</span><br><span class="line">+----------------------+</span><br><span class="line">| study_test           |</span><br><span class="line">+----------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<p>删除表命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; DROP TABLE study_test;</span><br></pre></td></tr></table></figure></p>
<h1 id="3、修改表名"><a href="#3、修改表名" class="headerlink" title="3、修改表名"></a>3、修改表名</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ALTER TABLE study_test RENAME study_table;</span><br></pre></td></tr></table></figure>
<h1 id="4、修改字段"><a href="#4、修改字段" class="headerlink" title="4、修改字段"></a>4、修改字段</h1><h2 id="（1）删除字段"><a href="#（1）删除字段" class="headerlink" title="（1）删除字段"></a>（1）删除字段</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; ALTER TABLE study_table DROP submit_date;</span><br><span class="line">Query OK, 0 rows affected (0.041 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM study_table;</span><br><span class="line">+---------+-----------+---------------+</span><br><span class="line">| test_id | test_name | test_discribe |</span><br><span class="line">+---------+-----------+---------------+</span><br><span class="line">|       1 | ONE       | 第一条        |</span><br><span class="line">|       2 | TWO       | 第二条        |</span><br><span class="line">|       3 | THREE     | 第三条       |</span><br><span class="line">|       4 | FOUR      | 第四条        |</span><br><span class="line">|       5 | FIVE      | 第五条        |</span><br><span class="line">|       6 | SIX       | 第六条        |</span><br><span class="line">+---------+-----------+---------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>
<h2 id="（2）添加字段"><a href="#（2）添加字段" class="headerlink" title="（2）添加字段"></a>（2）添加字段</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> study_table <span class="keyword">ADD</span> submit_time <span class="type">timestamp</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>; <span class="comment">-- 该字段记录创建时间，在该条数据更新时不会更新时间</span></span><br><span class="line"><span class="comment">-- -- ALTER TABLE files ADD updateTime timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP; -- 该字段记录更新时间，在该条数据更新时更新时间值</span></span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.069</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">MariaDB [study_test]<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> study_table;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+---------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> test_id <span class="operator">|</span> test_name <span class="operator">|</span> test_discribe <span class="operator">|</span> submit_time         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+---------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> <span class="keyword">ONE</span>       <span class="operator">|</span> 第一条        <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span> TWO       <span class="operator">|</span> 第二条        <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">3</span> <span class="operator">|</span> THREE     <span class="operator">|</span> 第三条        <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">4</span> <span class="operator">|</span> FOUR      <span class="operator">|</span> 第四条        <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">5</span> <span class="operator">|</span> FIVE      <span class="operator">|</span> 第五条        <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">6</span> <span class="operator">|</span> SIX       <span class="operator">|</span> 第六条        <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+---------------+---------------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br></pre></td></tr></table></figure>
<p>又比如给表<code>files</code>新增<code>创建时间</code>字段:<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 表内数据</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> files;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------------+------------------------+------+---------+-------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> filename     <span class="operator">|</span> path                   <span class="operator">|</span> mark <span class="operator">|</span> scale   <span class="operator">|</span> info  <span class="operator">|</span> updateTime          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------------+------------------------+------+---------+-------+---------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">1</span><span class="operator">-</span>a.jpg      <span class="operator">|</span> .<span class="operator">/</span>uploads<span class="operator">/</span><span class="number">1</span><span class="operator">-</span>a.jpg      <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> <span class="number">800</span><span class="operator">*</span><span class="number">600</span> <span class="operator">|</span> HGMM  <span class="operator">|</span> <span class="number">2022</span><span class="number">-11</span><span class="number">-03</span> <span class="number">13</span>:<span class="number">35</span>:<span class="number">53</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> blue2red.jpg <span class="operator">|</span> .<span class="operator">/</span>uploads<span class="operator">/</span>blue2red.jpg <span class="operator">|</span>    <span class="number">0</span> <span class="operator">|</span> <span class="number">400</span><span class="operator">*</span><span class="number">300</span> <span class="operator">|</span> HGMM2 <span class="operator">|</span> <span class="number">2022</span><span class="number">-11</span><span class="number">-03</span> <span class="number">15</span>:<span class="number">01</span>:<span class="number">58</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------------+------------------------+------+---------+-------+---------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.495</span> sec)</span><br><span class="line"><span class="comment">-- 查询表结构</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">DESC</span> files;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Field      <span class="operator">|</span> Type             <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span>             <span class="operator">|</span> Extra                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id         <span class="operator">|</span> <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span> auto_increment                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> filename   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">30</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> path       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mark       <span class="operator">|</span> tinyint(<span class="number">3</span>)       <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> scale      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> info       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> updateTime <span class="operator">|</span> <span class="type">timestamp</span>        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.186</span> sec)</span><br><span class="line"><span class="comment">-- 新增 createTime 字段</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> files <span class="keyword">ADD</span> creatTime <span class="type">timestamp</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.510</span> sec)</span><br><span class="line">Records: <span class="number">2</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"><span class="comment">-- 表内新数据</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> files;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------------+------------------------+------+---------+-------+---------------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> filename     <span class="operator">|</span> path                   <span class="operator">|</span> mark <span class="operator">|</span> scale   <span class="operator">|</span> info  <span class="operator">|</span> updateTime          <span class="operator">|</span> creatTime           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------------+------------------------+------+---------+-------+---------------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">1</span><span class="operator">-</span>a.jpg      <span class="operator">|</span> .<span class="operator">/</span>uploads<span class="operator">/</span><span class="number">1</span><span class="operator">-</span>a.jpg      <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> <span class="number">800</span><span class="operator">*</span><span class="number">600</span> <span class="operator">|</span> HGMM  <span class="operator">|</span> <span class="number">2022</span><span class="number">-11</span><span class="number">-03</span> <span class="number">13</span>:<span class="number">35</span>:<span class="number">53</span> <span class="operator">|</span> <span class="number">2022</span><span class="number">-11</span><span class="number">-05</span> <span class="number">13</span>:<span class="number">24</span>:<span class="number">58</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> blue2red.jpg <span class="operator">|</span> .<span class="operator">/</span>uploads<span class="operator">/</span>blue2red.jpg <span class="operator">|</span>    <span class="number">0</span> <span class="operator">|</span> <span class="number">400</span><span class="operator">*</span><span class="number">300</span> <span class="operator">|</span> HGMM2 <span class="operator">|</span> <span class="number">2022</span><span class="number">-11</span><span class="number">-03</span> <span class="number">15</span>:<span class="number">01</span>:<span class="number">58</span> <span class="operator">|</span> <span class="number">2022</span><span class="number">-11</span><span class="number">-05</span> <span class="number">13</span>:<span class="number">24</span>:<span class="number">58</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------------+------------------------+------+---------+-------+---------------------+---------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.022</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>注意更新时间字段和创建时间字段区别：<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">DESC</span> files;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Field      <span class="operator">|</span> Type             <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span>             <span class="operator">|</span> Extra                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id         <span class="operator">|</span> <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span> auto_increment                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> filename   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">30</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> path       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mark       <span class="operator">|</span> tinyint(<span class="number">3</span>)       <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> scale      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> info       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> updateTime <span class="operator">|</span> <span class="type">timestamp</span>        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> creatTime  <span class="operator">|</span> <span class="type">timestamp</span>        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.152</span> sec)</span><br></pre></td></tr></table></figure></p>
<h2 id="（2）修改字段"><a href="#（2）修改字段" class="headerlink" title="（2）修改字段"></a>（2）修改字段</h2><h3 id="①修改字段名"><a href="#①修改字段名" class="headerlink" title="①修改字段名"></a>①修改字段名</h3><p>语法如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ALTER TABLE &lt;表名&gt; CHANGE &lt;旧字段名&gt; &lt;新字段名&gt; &lt;新数据类型&gt;；</span><br></pre></td></tr></table></figure><br>比如改表<code>study_table</code>的结构，将 <code>test_discribe</code> 字段名称改为 <code>test_disc</code>，同时将数据类型变为<code>CHAR(30)</code>：<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> study_table CHANGE test_discribe test_disc <span class="type">CHAR</span>(<span class="number">30</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+---------------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> test_id <span class="operator">|</span> test_name <span class="operator">|</span> test_disc  <span class="operator">|</span> submit_time         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+---------------+-------------------+</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> <span class="keyword">ONE</span>       <span class="operator">|</span> 第一条      <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span> TWO       <span class="operator">|</span> 第二条      <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">3</span> <span class="operator">|</span> THREE     <span class="operator">|</span> 第三条      <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">4</span> <span class="operator">|</span> FOUR      <span class="operator">|</span> 第四条      <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">5</span> <span class="operator">|</span> FIVE      <span class="operator">|</span> 第五条      <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">6</span> <span class="operator">|</span> SIX       <span class="operator">|</span> 第六条      <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-17</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">41</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+---------------+-------------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br></pre></td></tr></table></figure></p>
<h3 id="②修改字段数据类型"><a href="#②修改字段数据类型" class="headerlink" title="②修改字段数据类型"></a>②修改字段数据类型</h3><p>语法如下：<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> MODIFY <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>;</span><br><span class="line"><span class="comment">-- ALTER TABLE files MODIFY updateTime timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;  修改更新时间类型</span></span><br></pre></td></tr></table></figure><br>比如修改表<code>files</code>的结构，将 <code>filename</code> 字段数据类型称改为变为<code>VARCHAR(30)</code>：<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 原来数据结构</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">DESC</span> files;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Field      <span class="operator">|</span> Type             <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span>             <span class="operator">|</span> Extra                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id         <span class="operator">|</span> <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span> auto_increment                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> filename   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> path       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mark       <span class="operator">|</span> tinyint(<span class="number">3</span>)       <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> scale      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> info       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> updateTime <span class="operator">|</span> <span class="type">timestamp</span>        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.017</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 变更数据类型</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> files MODIFY filename <span class="type">VARCHAR</span>(<span class="number">30</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.235</span> sec)</span><br><span class="line">Records: <span class="number">1</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 变更后：</span></span><br><span class="line">MariaDB [development]<span class="operator">&gt;</span> <span class="keyword">DESC</span> files;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Field      <span class="operator">|</span> Type             <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span>             <span class="operator">|</span> Extra                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id         <span class="operator">|</span> <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span> auto_increment                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> filename   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">30</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> path       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mark       <span class="operator">|</span> tinyint(<span class="number">3</span>)       <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> scale      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> info       <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> updateTime <span class="operator">|</span> <span class="type">timestamp</span>        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">current_timestamp</span>() <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+------------------+------+-----+---------------------+-------------------------------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.013</span> sec)</span><br></pre></td></tr></table></figure></p>
<h1 id="5、插入数据"><a href="#5、插入数据" class="headerlink" title="5、插入数据"></a>5、插入数据</h1><h2 id="（1）插入单条"><a href="#（1）插入单条" class="headerlink" title="（1）插入单条"></a>（1）插入单条</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; INSERT INTO study_table (test_name, test_discribe) VALUES (<span class="string">&quot;ONE&quot;</span>, <span class="string">&quot;第一条&quot;</span>);</span><br><span class="line">Query OK, 1 row affected (0.018 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; select * from study_table;</span><br><span class="line">+---------+-----------+---------------+-------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_date |</span><br><span class="line">+---------+-----------+---------------+-------------+</span><br><span class="line">|       1 | ONE       | 第一条        | NULL        |</span><br><span class="line">+---------+-----------+---------------+-------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; INSERT INTO study_table values (6, <span class="string">&#x27;SIX&#x27;</span>,<span class="string">&#x27;第六条&#x27;</span>, now()); </span><br><span class="line">Query OK, 1 row affected (0.018 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM study_table;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       1 | ONE       | 第一条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       2 | TWO       | 第二条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       3 | THREE     | 第三条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       4 | FOUR      | 第四条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       5 | FIVE      | 第五条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       6 | SIX       | 第六条        | 2021-08-17 12:34:07 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<h2 id="（2）插入多条"><a href="#（2）插入多条" class="headerlink" title="（2）插入多条"></a>（2）插入多条</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; INSERT INTO study_table (test_name, test_discribe) VALUES (<span class="string">&quot;TWO&quot;</span>, <span class="string">&quot;第二条&quot;</span>), (<span class="string">&quot;THREE&quot;</span>, <span class="string">&quot;第三条&quot;</span>);</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; INSERT INTO study_table values (4, <span class="string">&#x27;FOUR&#x27;</span>,<span class="string">&#x27;第四条&#x27;</span>, null),(5, <span class="string">&#x27;FIVE&#x27;</span>,<span class="string">&#x27;第五条&#x27;</span>, null),(6, <span class="string">&#x27;SIX&#x27;</span>,<span class="string">&#x27;第六条&#x27;</span>, null);</span><br><span class="line">Query OK, 2 rows affected (0.012 sec)</span><br><span class="line">Records: 2  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; select * from study_test;</span><br><span class="line">+---------+-----------+---------------+-------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_date |</span><br><span class="line">+---------+-----------+---------------+-------------+</span><br><span class="line">|       1 | ONE       | 第一条        | NULL        |</span><br><span class="line">|       2 | TWO       | 第二条        | NULL        |</span><br><span class="line">|       3 | THREE     |  第三条       | NULL        |</span><br><span class="line">|       4 | FOUR      | 第四条        | NULL        |</span><br><span class="line">|       5 | FIVE      | 第五条        | NULL        |</span><br><span class="line">|       6 | SIX       | 第六条        | NULL        |</span><br><span class="line">+---------+-----------+---------------+-------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<h1 id="6、修改数据"><a href="#6、修改数据" class="headerlink" title="6、修改数据"></a>6、修改数据</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; UPDATE study_table SET test_discribe=<span class="string">&quot;第三条&quot;</span> WHERE test_id=3;  //删除“第三条”前面的 空格</span><br><span class="line">Query OK, 1 row affected (0.019 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM study_table;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       1 | ONE       | 第一条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       2 | TWO       | 第二条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       3 | THREE     | 第三条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       4 | FOUR      | 第四条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       5 | FIVE      | 第五条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       6 | SIX       | 第六条        | 2021-08-17 12:21:41 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<h1 id="7、删除数据"><a href="#7、删除数据" class="headerlink" title="7、删除数据"></a>7、删除数据</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; DELETE FROM study_table WHERE test_id=6;  //删除第6条</span><br><span class="line">Query OK, 1 row affected (0.022 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM study_table;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       1 | ONE       | 第一条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       2 | TWO       | 第二条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       3 | THREE     | 第三条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       4 | FOUR      | 第四条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       5 | FIVE      | 第五条        | 2021-08-17 12:21:41 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>
<h1 id="8、查询数据"><a href="#8、查询数据" class="headerlink" title="8、查询数据"></a>8、查询数据</h1><h2 id="（1）一般查询"><a href="#（1）一般查询" class="headerlink" title="（1）一般查询"></a>（1）一般查询</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt;  SELECT test_id, test_name FROM study_table WHERE test_discribe=<span class="string">&quot;第六条&quot;</span>;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| test_id | test_name |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|       6 | SIX       |</span><br><span class="line">+---------+-----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<p>使用<code>LOCATE(检索条件,字段)</code>查询（以下实例对应study_test数据库下<code>usr_score_table</code>表）：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 表内数据如下：</span></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table ORDER BY usr_id;</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      72 |      71 |</span><br><span class="line">|      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      3 | 2021-11-17 12:03:22 |      77 |      80 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      5 | 2021-11-17 12:03:22 |      80 |      82 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      6 | 2021-11-17 12:03:22 |      88 |      82 |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.372 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table WHERE LOCATE(<span class="string">&#x27;6&#x27;</span>,y_score) ORDER BY usr_id;</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure><br>使用<code>INSTR(字段,检索条件)</code>查询：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table WHERE INSTR(y_score,<span class="string">&#x27;6&#x27;</span>) ORDER BY usr_id;</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.008 sec)</span><br></pre></td></tr></table></figure><br>此外还可以用<code>POSITION(检索条件 IN 字段)</code>及<code>REGEXP 检索条件</code>查询：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table WHERE y_score REGEXP <span class="string">&#x27;6&#x27;</span> ORDER BY usr_id;</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.136 sec)</span><br></pre></td></tr></table></figure></p>
<h2 id="（2）通配符-查询"><a href="#（2）通配符-查询" class="headerlink" title="（2）通配符%查询"></a>（2）通配符<code>%</code>查询</h2><p><code>%</code>表示任何字符出现任意次数;<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt;  SELECT * FROM study_table WHERE test_name LIKE <span class="string">&#x27;F%&#x27;</span>;  </span><br><span class="line"></span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       4 | FOUR      | 第四条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       5 | FIVE      | 第五条        | 2021-08-17 12:21:41 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt;  SELECT * FROM study_table WHERE test_name LIKE <span class="string">&#x27;T%&#x27;</span>;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       2 | TWO       | 第二条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       3 | THREE     | 第三条        | 2021-08-17 12:21:41 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt;  SELECT * FROM study_table WHERE test_discribe LIKE <span class="string">&#x27;%条%&#x27;</span>;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       1 | ONE       | 第一条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       2 | TWO       | 第二条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       3 | THREE     | 第三条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       4 | FOUR      | 第四条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       5 | FIVE      | 第五条        | 2021-08-17 12:21:41 |</span><br><span class="line">|       6 | SIX       | 第六条        | 2021-08-17 12:34:07 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure><br>其中对<code>int</code>字段的可以先进行转换为<code>CHAR</code>再查询（以下实例对应study_test数据库下<code>usr_score_table</code>表），如：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table WHERE CAST(y_score AS CHAR) LIKE <span class="string">&#x27;6%&#x27;</span>  ORDER BY usr_id;</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure></p>
<h2 id="（3）通配符-查询"><a href="#（3）通配符-查询" class="headerlink" title="（3）通配符_查询"></a>（3）通配符<code>_</code>查询</h2><p><code>_</code>只匹配单个字符<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt;  SELECT * FROM study_table WHERE test_name LIKE <span class="string">&#x27;T__&#x27;</span>;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       2 | TWO       | 第二条        | 2021-08-17 12:21:41 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt;  SELECT * FROM study_table WHERE test_name LIKE <span class="string">&#x27;T___&#x27;</span>;</span><br><span class="line">Empty <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt;  SELECT * FROM study_table WHERE test_name LIKE <span class="string">&#x27;T____&#x27;</span>;</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">| test_id | test_name | test_discribe | submit_time         |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">|       3 | THREE     | 第三条        | 2021-08-17 12:21:41 |</span><br><span class="line">+---------+-----------+---------------+---------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure><br><a name="div9"></a></p>
<h1 id="9、备份与恢复数据库"><a href="#9、备份与恢复数据库" class="headerlink" title="9、备份与恢复数据库;"></a>9、备份与恢复数据库;</h1><h2 id="（1）利用mysqldump备份与恢复命令："><a href="#（1）利用mysqldump备份与恢复命令：" class="headerlink" title="（1）利用mysqldump备份与恢复命令："></a>（1）利用<code>mysqldump</code>备份与恢复命令：</h2><h3 id="①在Linux下备份和恢复"><a href="#①在Linux下备份和恢复" class="headerlink" title="①在Linux下备份和恢复"></a>①在Linux下备份和恢复</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo mysqldump -uroot -p wpDB &gt; ~/mysql-wpDB.dump  //备份数据库名及保存路径</span><br><span class="line"><span class="comment"># $ sudo mysqldump -uroot -p study_db --default-character-set=utf8mb4 &gt; ~/win10-study_db.dump  // 以`utf8mb4`编码导出</span></span><br><span class="line">$ sudo mysql -uroot  //进入数据库</span><br><span class="line">  MariaDB [(none)]&gt; create database wpDBtest; //创建测试恢复数据库,单库备份需先创建该数据库</span><br><span class="line">$ mysql -uroot -p yourpassword wpDBtest &lt; ~/mysql-wpDB.dump;  //恢复数据库</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 备份整个数据库[无需进入数据库]</span></span><br><span class="line">mysqldump -u用户名 -h localhost -p --all-databases &gt; backmariadb_debian11.sql</span><br><span class="line"><span class="comment"># 恢复整个数据库[需要先进入数据库]</span></span><br><span class="line">MariaDB [(none)]&gt; <span class="built_in">source</span> /你的备份路径/debian11_Backup/backmariadb_debian11.sql</span><br></pre></td></tr></table></figure>
<h3 id="②win10下备份"><a href="#②win10下备份" class="headerlink" title="②win10下备份"></a>②win10下备份</h3><p><strong>运行<code>cmd</code>模式</strong><br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysqldump -u root -P3307 -p wpDBtest &gt; E:\数据备份\Linux\mysql-wpDB.dump</span><br><span class="line">yourpassword:******</span><br></pre></td></tr></table></figure><br>其中<code>-P3307</code>如果没改数据库端口可不输入。   </p>
<p><strong>运行<code>Powershell</code>模式</strong><br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysqldump -uroot -P3307 -p yourpassword --default-character-set=gbk wpDBtest &gt; E:\数据备份\Linux\mysql-wpDB.dump</span><br></pre></td></tr></table></figure><br>其中<code>--default-character-set=gbk</code>解决备份后中文数据可能会出现的乱码，默认<code>utf8</code>。 </p>
<h3 id="③win10下恢复"><a href="#③win10下恢复" class="headerlink" title="③win10下恢复"></a>③win10下恢复</h3><p><strong>运行<code>cmd</code>管理员模式</strong><br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -u root -P3307 -p yourpassword --default-character-set=utf8  wpDBtest &lt; E:\数据备份\Linux\mysql-wpDB.dump</span><br></pre></td></tr></table></figure><br><strong>运行<code>Powershell</code>管理员模式</strong><br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Get-Content E:\数据备份\Linux\mysql-wpDB.dump | .\mysql -uroot -P3307 -p yourpassword --default-character-set=utf8 wpDBtest</span><br></pre></td></tr></table></figure><br>问题：<br><code>Powershell</code>下命令出现错误如下：<br><code>ERROR at line 224: Unknown command &#39;\&#39;&#39;.</code><br>提示此错误<code>--default-character-set=utf8</code>也无法解决 </p>
<h3 id="④在Windows-lt-gt-Linux互相备份恢复时可能遇到的编码问题解决："><a href="#④在Windows-lt-gt-Linux互相备份恢复时可能遇到的编码问题解决：" class="headerlink" title="④在Windows&lt;==&gt;Linux互相备份恢复时可能遇到的编码问题解决："></a>④在<code>Windows</code>&lt;==&gt;<code>Linux</code>互相备份恢复时可能遇到的编码问题解决：</h3><p>1&gt; <strong>可尝试用<code>iconv -c -f UTF-8 -t UTF-16LE win10-study_db_UTF8.dump &gt; win10-study_db_UTF-16LE.dump</code>进行转码【此命令为<code>UTF-8</code>到<code>UTF-16LE</code>】</strong>   </p>
<p>2&gt; <strong>Debian系统可用<code>iconv -f UTF-16LE -t UTF-8 win10-study_db_UTF-16LE.dump &gt; win10-study_db_UTF8.dump</code>进行转码</strong>  </p>
<p>3&gt; <strong><code>ERROR 1273 (HY000) at line 25: Unknown collation: &#39;utf8mb4_0900_ai_ci&#39;</code>错误解决：</strong><br>  • 把文件中的所有的<code>utf8mb4_0900_ai_ci</code>替换为<code>utf8_general_ci</code>。<br>  • 以及<code>utf8mb4</code>替换为<code>utf8</code>。  </p>
<h3 id="⑤注意事项"><a href="#⑤注意事项" class="headerlink" title="⑤注意事项"></a>⑤注意事项</h3><p>上诉备份方案存在一定的弊端如：用户正在执行数据操作时，数据则会丢失等情况。<br>解决方案：在备份是给库表加上锁，保证数据的完整性。<br><code>--lock-all-tables</code>:请求锁定所有表<br>实例：<br><code>mysqldump --databases wpDBtest --lock-all-tables &gt;/tmp/testdb.sql</code><br><code>--single-transaction:单事务，能够对innodb存储引擎做热备</code><br><code>--events:备份事件调度器代码</code><br><code>--routines:备份存储过程和存储函数</code><br><code>--triggers:备份触发器</code><br>备份时请求锁之后滚动日志：<code>--flush-logs</code><br>复制时同步位置标记：<code>--master-data=[0|1|2]</code><br>注意：恢复时需关闭二进制文件，恢复成功后则开启<br>关闭二进制日志：<code>set session sql_log_bin=0</code><br>开启二进制日志：<code>set session sql_log_bin=1</code>  </p>
<h2 id="（2）锁表备份步骤："><a href="#（2）锁表备份步骤：" class="headerlink" title="（2）锁表备份步骤："></a>（2）锁表备份步骤：</h2><p>1)锁表并且给只读权限<br><code>flush tables with read lock;</code><br>2)滚动日志<br><code>flush logs;</code><br>3)查看二进制日志信息<br><code>show master status;</code><br>4)使用<code>mysqldump</code>进行数据备份<br><code>mysqldump --databases wpDBtest &gt;/tmp/wpDBtest.sql</code><br>5)备份完成之后则需解锁<br><code>unlock tables;</code><br>命令行备份实例如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysqldump -p --databases wpDBtest --lock-all-tables --flush-logs &gt;/tmp/testdb2.sql   </span><br><span class="line">mysqldump -p --databases wpDBtest --single-trasaction --flush-logs &gt;/tmp/testdb3.sql  </span><br><span class="line">mysqldump -p --databases wpDBtest --lock-all-tables --flush-logs --master-data=2 &gt;/tmp/testdb4.sql</span><br><span class="line">```  </span><br><span class="line"><span class="comment">## （3）查看恢复的数据</span></span><br><span class="line">```bash</span><br><span class="line">$ sudo mysql -uroot  //进入数据库`   </span><br><span class="line">$ use wpDBtest;   //选择查看数据库`  </span><br><span class="line">  MariaDB [wpDBtest]&gt; select * from wp_options <span class="built_in">where</span> option_name <span class="keyword">in</span>(<span class="string">&quot;siteurl&quot;</span>,<span class="string">&quot;home&quot;</span>); <span class="comment"># 查看恢复信息</span></span><br></pre></td></tr></table></figure></p>
<h2 id="（4）用二进制日志恢复命令："><a href="#（4）用二进制日志恢复命令：" class="headerlink" title="（4）用二进制日志恢复命令："></a>（4）用二进制日志恢复命令：</h2><h3 id="1》修改my-cnf配置文件-开启binlog"><a href="#1》修改my-cnf配置文件-开启binlog" class="headerlink" title="1》修改my.cnf配置文件,开启binlog"></a>1》修改<code>my.cnf</code>配置文件,开启<code>binlog</code></h3><p><code>$ sudo vim /etc/alternatives/my.cnf</code> //添加如下内容，开启<code>binlog</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">log_bin=mysql-bin</span><br><span class="line">binlog_format=ROW</span><br><span class="line">expire_logs_days=7 <span class="comment">#7天滚动</span></span><br><span class="line">max_binlog_size=100M <span class="comment">#每个日志最大100M</span></span><br><span class="line">binlog_cache_size=4M</span><br><span class="line">max_binlog_cache_size=256M <span class="comment">#binlog最大缓存</span></span><br></pre></td></tr></table></figure><br>添加完后重启。  </p>
<h3 id="2》查看log-bin是否开启"><a href="#2》查看log-bin是否开启" class="headerlink" title="2》查看log_bin是否开启"></a>2》查看<code>log_bin</code>是否开启</h3><p><code>MariaDB [(none)]&gt;  show variables like &#39;log_bin&#39;;</code><br>查看二进制log<br><code>$ sudo mysqlbinlog --no-defaults /var/lib/mysql/mysql-bin.000001;</code><br><code>--no-defaults</code>避免出现字符问题错误<br>默认二进制文件存于<code>/var/lib/mysql/</code>下，文件名为一系列<code>mysql-bin.00000*</code>。  </p>
<h3 id="3》测试过程"><a href="#3》测试过程" class="headerlink" title="3》测试过程"></a>3》测试过程</h3><p>1、创建测试数据库并新增表和记录<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [wpDBtest]&gt; create database testDB;</span><br><span class="line">MariaDB [testDB]&gt; create table testtable (<span class="built_in">id</span> int null, name varchar(255) null);</span><br><span class="line">MariaDB [(none)]&gt; <span class="built_in">source</span> ~/wpDBtest-re.sql</span><br><span class="line">MariaDB [testDB]&gt; insert into testtable values(1,<span class="string">&quot;xiaoming&quot;</span>);</span><br><span class="line">MariaDB [testDB]&gt; insert into testtable values(2,<span class="string">&quot;wang&quot;</span>);</span><br><span class="line">MariaDB [testDB]&gt; insert into testtable values(3,<span class="string">&quot;王&quot;</span>);</span><br></pre></td></tr></table></figure><br>2、删除一条测试数据<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [testDB]&gt; delete from testtable <span class="built_in">where</span> <span class="built_in">id</span> =2;`</span><br><span class="line"><span class="comment">##MariaDB [testDB]&gt; delete from testtable;</span></span><br><span class="line">  <span class="comment">##Query OK, 5 rows affected (0.027 sec)</span></span><br></pre></td></tr></table></figure><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [testDB]&gt; select * from testtable;</span><br><span class="line">+------+----------+</span><br><span class="line">| <span class="built_in">id</span>   | name     |</span><br><span class="line">+------+----------+</span><br><span class="line">|    1 | xiaoming |</span><br><span class="line">|    3 | 王       |</span><br><span class="line">+------+----------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure><br>3、导出二进制<code>log</code>为<code>sql</code>,<code>--database=testDB</code> 指定导出数据库<code>testDB</code>的数据<br><code>$ sudo  mysqlbinlog --no-defaults --database=testDB /var/lib/mysql/mysql-bin.000001&gt;~/testDB.sql;</code><br>4、进入<code>~/</code>文件夹，复制原数据并另存<code>testDB-re.sql</code><br><code>$ cp testDB.sql testDB-re.sql</code><br><code>$ sudo vim testDB-re.sql</code>  //打开<code>sql</code>文件，删除其中“<code>delete from testtable where id =2</code>”语句<br>5、进入<code>mariadb</code>，恢复数据<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [testDB]&gt; <span class="built_in">source</span> ~/testDB-re.sql</span><br><span class="line">MariaDB [testDB]&gt; select * from testtable;</span><br><span class="line">+------+----------+</span><br><span class="line">| <span class="built_in">id</span>   | name     |</span><br><span class="line">+------+----------+</span><br><span class="line">|    1 | xiaoming |</span><br><span class="line">|    3 | 王       |</span><br><span class="line">|    1 | xiaoming |</span><br><span class="line">|    2 | wang     |</span><br><span class="line">|    3 | 王       |</span><br><span class="line">+------+----------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure></p>
<h2 id="mysqldump其他常用命令"><a href="#mysqldump其他常用命令" class="headerlink" title="mysqldump其他常用命令"></a><strong><em><code>mysqldump</code>其他常用命令</em></strong></h2><h3 id="①备份多个数据库结构和数据-databases或者-B"><a href="#①备份多个数据库结构和数据-databases或者-B" class="headerlink" title="①备份多个数据库结构和数据(--databases或者-B)"></a>①备份多个数据库结构和数据(<code>--databases</code>或者<code>-B</code>)</h3><p><code>$ mysqldump -uyk -p --databases study_test study_db &gt; /media/yk/文档1/Backup/Debian11_study_db_study_test_UTF8.dump</code>  </p>
<h3 id="②备份所有数据库结构-d"><a href="#②备份所有数据库结构-d" class="headerlink" title="②备份所有数据库结构(-d)"></a>②备份所有数据库结构(<code>-d</code>)</h3><p><code>$ mysqldump -uyk -p -A-d &gt; /media/yk/文档1/Backup/Debian11_db.dump</code>  </p>
<h3 id="③备份所有数据库数据-t"><a href="#③备份所有数据库数据-t" class="headerlink" title="③备份所有数据库数据(-t)"></a>③备份所有数据库数据(<code>-t</code>)</h3><p><code>$ mysqldump -uyk -p -A-t &gt; /media/yk/文档1/Backup/Debian11_db.dump</code><br>恢复<code>XXX.dump</code>见<a href="#div9">9、备份与恢复数据库</a>  </p>
<h3 id="④备份某库中某表-并导出为xml格式-xml-或-X-库名-表名"><a href="#④备份某库中某表-并导出为xml格式-xml-或-X-库名-表名" class="headerlink" title="④备份某库中某表,并导出为xml格式( --xml(或-X) 库名 表名  )"></a>④备份某库中某表,并导出为<code>xml</code>格式( <code>--xml(或-X)</code> <code>库名 表名</code>  )</h3><p><code>$ mysqldump -uyk -p --xml study_test usr_table &gt; /media/yk/文档1/Backup/Debian11_study_test_usr_table.xml</code>  </p>
<h3 id="⑤还原单个数据库-需指定数据库"><a href="#⑤还原单个数据库-需指定数据库" class="headerlink" title="⑤还原单个数据库(需指定数据库)"></a>⑤还原单个数据库(需指定数据库)</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt;use mydb  </span><br><span class="line">mysql&gt;<span class="built_in">source</span> f:\mydb.sql</span><br></pre></td></tr></table></figure>
<p>或者：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mysql -uroot -p123456 mydb &lt; f:\mydb.sql</span><br></pre></td></tr></table></figure></p>
<h3 id="⑥还原单个数据库的多个表-需指定数据库"><a href="#⑥还原单个数据库的多个表-需指定数据库" class="headerlink" title="⑥还原单个数据库的多个表(需指定数据库)"></a>⑥还原单个数据库的多个表(需指定数据库)</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt;use mydb</span><br><span class="line">mysql&gt;<span class="built_in">source</span> f:\multables.sql</span><br></pre></td></tr></table></figure>
<p>或者：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mysql -uroot -p123456 mydb&lt;f:\multables.sql</span><br></pre></td></tr></table></figure></p>
<p>参考资料：<a href="https://blog.51cto.com/purify/1860516">mariadb二进制日志和备份恢复</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>运维</category>
        <category>MySQL</category>
        <category>MariaDB</category>
        <category>备份和恢复</category>
      </categories>
      <tags>
        <tag>数据库</tag>
        <tag>MySQL</tag>
        <tag>MariaDB</tag>
        <tag>Iconv</tag>
      </tags>
  </entry>
  <entry>
    <title>Mariadb10.6版本基本使用</title>
    <url>/2021/11/15/Mariadb10.6%E7%89%88%E6%9C%AC%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a name="div0"></a></p>
<h1 id="写在前面的："><a href="#写在前面的：" class="headerlink" title="写在前面的："></a>写在前面的：</h1><h2 id="一、安装及初始化"><a href="#一、安装及初始化" class="headerlink" title="一、安装及初始化"></a>一、安装及初始化</h2><p>Debian11下数据源安装10.6版本<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install software-properties-common dirmngr apt-transport-https</span><br><span class="line">$ sudo apt-key adv --fetch-keys <span class="string">&#x27;https://mariadb.org/mariadb_release_signing_key.asc&#x27;</span></span><br><span class="line">$ sudo add-apt-repository <span class="string">&#x27;deb [arch=amd64,i386,arm64,ppc64el] https://mirrors.inet.vn/mariadb/repo/10.6/debian bullseye main&#x27;</span></span><br><span class="line">$ sudo apt update</span><br><span class="line">$ sudo apt install mariadb-server mariadb-common</span><br></pre></td></tr></table></figure><br>初始化：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo mysql_secure_installation</span><br><span class="line"></span><br><span class="line">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class="line">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class="line"></span><br><span class="line">In order to <span class="built_in">log</span> into MariaDB to secure it, we<span class="string">&#x27;ll need the current</span></span><br><span class="line"><span class="string">password for the root user. If you&#x27;</span>ve just installed MariaDB, and</span><br><span class="line">haven<span class="string">&#x27;t set the root password yet, you should just press enter here.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Enter current password for root (enter for none):   //设置数据库root密码</span></span><br><span class="line"><span class="string">OK, successfully used password, moving on...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Setting the root password or using the unix_socket ensures that nobody</span></span><br><span class="line"><span class="string">can log into the MariaDB root user without the proper authorisation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You already have your root account protected, so you can safely answer &#x27;</span>n<span class="string">&#x27;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Switch to unix_socket authentication [Y/n] n  //切换到unix套接字身份验证</span></span><br><span class="line"><span class="string"> ... skipping.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You already have your root account protected, so you can safely answer &#x27;</span>n<span class="string">&#x27;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Change the root password? [Y/n] n</span></span><br><span class="line"><span class="string"> ... skipping.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">By default, a MariaDB installation has an anonymous user, allowing anyone</span></span><br><span class="line"><span class="string">to log into MariaDB without having to have a user account created for</span></span><br><span class="line"><span class="string">them.  This is intended only for testing, and to make the installation</span></span><br><span class="line"><span class="string">go a bit smoother.  You should remove them before moving into a</span></span><br><span class="line"><span class="string">production environment.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Remove anonymous users? [Y/n] y  //移除匿名账户</span></span><br><span class="line"><span class="string"> ... Success!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Normally, root should only be allowed to connect from &#x27;</span>localhost<span class="string">&#x27;.  This</span></span><br><span class="line"><span class="string">ensures that someone cannot guess at the root password from the network.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Disallow root login remotely? [Y/n] y  //禁止root账户远程登陆</span></span><br><span class="line"><span class="string"> ... Success!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">By default, MariaDB comes with a database named &#x27;</span><span class="built_in">test</span><span class="string">&#x27; that anyone can</span></span><br><span class="line"><span class="string">access.  This is also intended only for testing, and should be removed</span></span><br><span class="line"><span class="string">before moving into a production environment.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Remove test database and access to it? [Y/n] y  //删除test数据库和对此数据库访问权限</span></span><br><span class="line"><span class="string"> - Dropping test database...</span></span><br><span class="line"><span class="string"> ... Success!</span></span><br><span class="line"><span class="string"> - Removing privileges on test database...</span></span><br><span class="line"><span class="string"> ... Success!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Reloading the privilege tables will ensure that all changes made so far</span></span><br><span class="line"><span class="string">will take effect immediately.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Reload privilege tables now? [Y/n] y  // 刷新权限</span></span><br><span class="line"><span class="string"> ... Success!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Cleaning up...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">All done!  If you&#x27;</span>ve completed all of the above steps, your MariaDB</span><br><span class="line">installation should now be secure.</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> using MariaDB!</span><br></pre></td></tr></table></figure></p>
<p>切换到<code>root</code>账户登陆mariadb<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ su</span><br><span class="line">密码：</span><br><span class="line">root@yourUserName-pc:<span class="comment"># mariadb -uroot -p</span></span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 40</span><br><span class="line">Server version: 10.6.5-MariaDB-1:10.6.5+maria~bullseye mariadb.org binary distribution</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure></p>
<h2 id="二、设置权限相关"><a href="#二、设置权限相关" class="headerlink" title="二、设置权限相关"></a>二、设置权限相关</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mariadb -uroot -p</span><br><span class="line">Enter password: </span><br><span class="line">ERROR 1698 (28000): Access denied <span class="keyword">for</span> user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span></span><br></pre></td></tr></table></figure>
<p>解决办法如下：<br>跳过安全规则<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo mysqld_safe --skip-grant-tables</span><br><span class="line">$ mysql -u root -p</span><br><span class="line">Enter password:   //无密码，直接回车</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 3</span><br><span class="line">Server version: 10.6.5-MariaDB-1:10.6.5+maria~bullseye mariadb.org binary distribution</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br></pre></td></tr></table></figure><br>此时<code>root</code>权限如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show grants <span class="keyword">for</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">+-----------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> root@localhost                                                                                                               |</span><br><span class="line">+-----------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT ALL PRIVILEGES ON *.* TO `root`@`localhost` IDENTIFIED VIA mysql_native_password USING <span class="string">&#x27;invalid&#x27;</span> OR unix_socket WITH GRANT OPTION |</span><br><span class="line">| GRANT PROXY ON <span class="string">&#x27;&#x27;</span>@<span class="string">&#x27;%&#x27;</span> TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> WITH GRANT OPTION                                                                           |</span><br><span class="line">+-----------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.147 sec)</span><br><span class="line">MariaDB [(none)]&gt; ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;you password&#x27;</span>; // 重新设置密码</span><br><span class="line">Query OK, 0 rows affected (0.022 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; \q</span><br><span class="line">Bye</span><br></pre></td></tr></table></figure><br>重新登陆：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mariadb -u root -p</span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 4</span><br><span class="line">Server version: 10.6.5-MariaDB-1:10.6.5+maria~bullseye mariadb.org binary distribution</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure></p>
<h3 id="（1）查看权限"><a href="#（1）查看权限" class="headerlink" title="（1）查看权限"></a>（1）查看权限</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show grants <span class="keyword">for</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> root@localhost                                                                                                              |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT ALL PRIVILEGES ON *.* TO `root`@`localhost` IDENTIFIED BY PASSWORD <span class="string">&#x27;*0F57*******&#x27;</span> WITH GRANT OPTION |</span><br><span class="line">| GRANT PROXY ON <span class="string">&#x27;&#x27;</span>@<span class="string">&#x27;%&#x27;</span> TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> WITH GRANT OPTION                                                                          |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show grants <span class="keyword">for</span> <span class="string">&#x27;yourUserName&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> yourUserName@localhost                                                                                            |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT ALL PRIVILEGES ON *.* TO `yourUserName`@`localhost` IDENTIFIED BY PASSWORD <span class="string">&#x27;*0F571********&#x27;</span> |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<h3 id="（2）授予权限"><a href="#（2）授予权限" class="headerlink" title="（2）授予权限"></a>（2）授予权限</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt;  GRANT ALL PRIVILEGES ON *.* TO `yourUserName`@`localhost` IDENTIFIED BY <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line">/* 其中`*.*`表示所有数据库中所有表； <span class="string">&#x27;password&#x27;</span> 表示密码；*/</span><br><span class="line">MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON `novel_plus`.* TO `yourUserName`@`localhost`;</span><br><span class="line">Query OK, 0 rows affected (0.011 sec)</span><br><span class="line">MariaDB [(none)]&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.147 sec) </span><br><span class="line">MariaDB [(none)]&gt; show grants <span class="keyword">for</span> <span class="string">&#x27;yourUserName&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> yourUserName@localhost                                                                                            |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT ALL PRIVILEGES ON *.* TO `yourUserName`@`localhost` IDENTIFIED BY PASSWORD <span class="string">&#x27;*0F571A639A45A10D51B1F0F65FF29E5D3*******&#x27;</span> |</span><br><span class="line">| GRANT ALL PRIVILEGES ON `novel_plus`.* TO `yourUserName`@`localhost`                                                         |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<h3 id="（3）取消权限"><a href="#（3）取消权限" class="headerlink" title="（3）取消权限"></a>（3）取消权限</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; REVOKE ALL PRIVILEGES ON `novel_plus`.* FROM `yourUserName`@`localhost`; </span><br><span class="line">Query OK, 0 rows affected (0.026 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show grants <span class="keyword">for</span> <span class="string">&#x27;yourUserName&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> yourUserName@localhost                                                                                            |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT ALL PRIVILEGES ON *.* TO `yourUserName`@`localhost` IDENTIFIED BY PASSWORD <span class="string">&#x27;*0F571A639A45A10D51B1F0F65FF29E5D3736C4E0&#x27;</span> |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<p>注意：在<strong><code>mysql8.0</code></strong>以上版本中，需先授予<code>root</code>用户<code>system_user</code>帐户权限才能进行后续操作：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; GRANT system_user ON *.* to <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.07 sec)</span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO <span class="string">&#x27;yourUserName&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.62 sec)</span><br><span class="line">mysql&gt; REVOKE ALL PRIVILEGES ON *.* FROM <span class="string">&#x27;yourUserName&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.16 sec)]</span><br><span class="line">mysql&gt; SET PASSWORD FOR <span class="string">&#x27;yourUserName&#x27;</span>@<span class="string">&#x27;%&#x27;</span>=<span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.20 sec)</span><br></pre></td></tr></table></figure></p>
<h1 id="1、创建新库及新表"><a href="#1、创建新库及新表" class="headerlink" title="1、创建新库及新表"></a>1、创建新库及新表</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mariadb -uyourUserName -p</span><br><span class="line">Enter password: </span><br><span class="line"><span class="comment">## 创建新数据库`study_test`</span></span><br><span class="line">MariaDB [(none)]&gt; CREATE DATABASE study_test;</span><br><span class="line">Query OK, 1 row affected (0.021 sec)</span><br><span class="line"><span class="comment">## 创建新数据表`usr_table`</span></span><br><span class="line">MariaDB [study_test]&gt; CREATE TABLE usr_table(</span><br><span class="line">    -&gt; usr_id INT NOT NULL,</span><br><span class="line">    -&gt; usr_name VARCHAR(20) NOT NULL,</span><br><span class="line">    -&gt; submit_time DATE,</span><br><span class="line">    -&gt; PRIMARY KEY(usr_id)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.107 sec)</span><br></pre></td></tr></table></figure>
<p><a href="#div6">若根据已有表创建新表参见第6部分</a></p>
<h1 id="2、修改表中字段属性"><a href="#2、修改表中字段属性" class="headerlink" title="2、修改表中字段属性"></a>2、修改表中字段属性</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; ALTER TABLE test_table MODIFY submit_time DATETIME;</span><br><span class="line">Query OK, 5 rows affected (0.287 sec)              </span><br><span class="line">Records: 5  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure>
<h1 id="3、增加-删除字段"><a href="#3、增加-删除字段" class="headerlink" title="3、增加/删除字段"></a>3、增加/删除字段</h1><h2 id="（1）增加"><a href="#（1）增加" class="headerlink" title="（1）增加"></a>（1）增加</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; ALTER TABLE usr_table ADD COLUMN IF NOT EXISTS (is_vip INT);</span><br><span class="line">Query OK, 0 rows affected (0.154 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure>
<h2 id="（2）删除"><a href="#（2）删除" class="headerlink" title="（2）删除"></a>（2）删除</h2><p>先增加待删除的字段<code>is_vip1</code>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; ALTER TABLE usr_table ADD COLUMN IF NOT EXISTS (is_vip1 INT);</span><br><span class="line">Query OK, 0 rows affected (0.044 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; SELECT * FROM test_table;</span><br><span class="line">+---------+-----------+---------------------+--------+--------+---------+</span><br><span class="line">| test_id | test_name | submit_time         | is_vip | usr_id | is_vip1 |</span><br><span class="line">+---------+-----------+---------------------+--------+--------+---------+</span><br><span class="line">|       1 | one       | 2021-11-14 10:39:28 |      0 |      1 |    NULL |</span><br><span class="line">|       2 | two       | 2021-11-14 10:39:31 |      0 |      2 |    NULL |</span><br><span class="line">|       3 | three     | 2021-11-14 10:43:13 |      1 |      3 |    NULL |</span><br><span class="line">|       4 | four      | 2021-11-14 10:43:13 |      0 |      4 |    NULL |</span><br><span class="line">|       5 | five      | 2021-11-14 10:43:13 |      1 |      5 |    NULL |</span><br><span class="line">+---------+-----------+---------------------+--------+--------+---------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure><br>删除<code>is_vip1</code>字段:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; ALTER TABLE test_table DROP COLUMN is_vip1;</span><br><span class="line">Query OK, 0 rows affected (0.036 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM test_table;</span><br><span class="line">+---------+-----------+---------------------+--------+--------+</span><br><span class="line">| test_id | test_name | submit_time         | is_vip | usr_id |</span><br><span class="line">+---------+-----------+---------------------+--------+--------+</span><br><span class="line">|       1 | one       | 2021-11-14 10:39:28 |      0 |      1 |</span><br><span class="line">|       2 | two       | 2021-11-14 10:39:31 |      0 |      2 |</span><br><span class="line">|       3 | three     | 2021-11-14 10:43:13 |      1 |      3 |</span><br><span class="line">|       4 | four      | 2021-11-14 10:43:13 |      0 |      4 |</span><br><span class="line">|       5 | five      | 2021-11-14 10:43:13 |      1 |      5 |</span><br><span class="line">+---------+-----------+---------------------+--------+--------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure></p>
<h1 id="4、插入数据"><a href="#4、插入数据" class="headerlink" title="4、插入数据"></a>4、插入数据</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; INSERT INTO usr_table (usr_id,usr_name,submit_time) VALUES (1,<span class="string">&#x27;ONE&#x27;</span>,NOW()),(2,<span class="string">&#x27;TWO&#x27;</span>,NOW()),(3,<span class="string">&#x27;THREE&#x27;</span>,NOW()),(4,<span class="string">&#x27;FOUR&#x27;</span>,NOW()),(5,<span class="string">&#x27;FIVE&#x27;</span>,NOW()),(6,<span class="string">&#x27;SIX&#x27;</span>,NOW());</span><br><span class="line">Query OK, 6 rows affected (0.023 sec)</span><br><span class="line">Records: 6  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; select * from usr_table;</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">| usr_id | usr_name | submit_time         | is_vip |</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |   NULL |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |   NULL |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:06:43 |   NULL |</span><br><span class="line">|      4 | FOUR     | 2021-11-17 11:06:43 |   NULL |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:06:43 |   NULL |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |   NULL |</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<h1 id="5、更新表中数据"><a href="#5、更新表中数据" class="headerlink" title="5、更新表中数据"></a>5、更新表中数据</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 更新某区间 （BETWEEN） </span></span><br><span class="line">MariaDB [study_test]&gt; UPDATE usr_table SET is_vip = 1 WHERE usr_id BETWEEN 3 AND 5;</span><br><span class="line">Query OK, 3 rows affected (0.041 sec)</span><br><span class="line">Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class="line"><span class="comment"># 更新某给定范围 （IN）</span></span><br><span class="line">MariaDB [study_test]&gt; UPDATE usr_table SET submit_time = NOW() WHERE usr_id IN (3,5);</span><br><span class="line">Query OK, 2 rows affected (0.015 sec)</span><br><span class="line">Rows matched: 2  Changed: 2  Warnings: 0</span><br><span class="line">MariaDB [study_test]&gt; select * from usr_table;</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">| usr_id | usr_name | submit_time         | is_vip |</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |</span><br><span class="line">|      4 | FOUR     | 2021-11-17 11:06:43 |      1 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>
<p><a href="#div8">更复杂查询更新参见第8部分</a>  </p>
<p><a name="div6"></a></p>
<h1 id="6、从老表中选择字段创建新表"><a href="#6、从老表中选择字段创建新表" class="headerlink" title="6、从老表中选择字段创建新表"></a>6、从老表中选择字段创建新表</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; CREATE TABLE usr_score_table SELECT usr_id,submit_time FROM usr_table;</span><br><span class="line">Query OK, 6 rows affected (0.116 sec)</span><br><span class="line">Records: 6  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table;</span><br><span class="line">+--------+---------------------+</span><br><span class="line">| usr_id | submit_time         |</span><br><span class="line">+--------+---------------------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 |</span><br><span class="line">+--------+---------------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>
<h1 id="7、查询数据及分组"><a href="#7、查询数据及分组" class="headerlink" title="7、查询数据及分组"></a>7、查询数据及分组</h1><h2 id="（1）查询数据出现次数"><a href="#（1）查询数据出现次数" class="headerlink" title="（1）查询数据出现次数"></a>（1）查询数据出现次数</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 给表usr_score_table新增俩字段y_score和s_score</span></span><br><span class="line">MariaDB [study_test]&gt; ALTER TABLE usr_score_table ADD COLUMN IF NOT EXISTS (y_score INT NOT NULL,s_score INT NOT NULL);</span><br><span class="line">Query OK, 0 rows affected (0.129 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"><span class="comment"># 更新部分数据并插入更多数据</span></span><br><span class="line">MariaDB [study_test]&gt; UPDATE usr_score_table SET y_score = 68,s_score=66 WHERE usr_id IN(1,3,5);</span><br><span class="line">Query OK, 3 rows affected (0.039 sec)</span><br><span class="line">Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; UPDATE usr_score_table SET y_score = 86,s_score=88 WHERE usr_id IN(2,4,6);</span><br><span class="line">Query OK, 3 rows affected (0.023 sec)</span><br><span class="line">Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; INSERT INTO usr_score_table (usr_id,submit_time,y_score,s_score) VALUES (1,NOW(),72,71),(2,NOW(),68,73),(3,NOW(),77,80),(1,NOW(),76,78),(5,NOW(),80,82),(6,NOW(),88,82);</span><br><span class="line">Query OK, 6 rows affected (0.015 sec)</span><br><span class="line">Records: 6  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_score_table;</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      72 |      71 |</span><br><span class="line">|      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | 2021-11-17 12:03:22 |      77 |      80 |</span><br><span class="line">|      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      5 | 2021-11-17 12:03:22 |      80 |      82 |</span><br><span class="line">|      6 | 2021-11-17 12:03:22 |      88 |      82 |</span><br><span class="line">+--------+---------------------+---------+---------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table WHERE usr_id IN (SELECT usr_id FROM usr_score_table GROUP BY usr_id</span><br><span class="line"> HAVING COUNT(usr_id) &gt;= 2);</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">| usr_id | usr_name | submit_time         | is_vip |</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |</span><br><span class="line">+--------+----------+---------------------+--------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.033 sec)</span><br></pre></td></tr></table></figure>
<h2 id="（2）查询数据并分组-GROUP-BY"><a href="#（2）查询数据并分组-GROUP-BY" class="headerlink" title="（2）查询数据并分组(GROUP BY)"></a>（2）查询数据并分组(GROUP BY)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; SELECT usr_id, count(*) AS counts from usr_score_table GROUP BY usr_id;</span><br><span class="line">+--------+--------+</span><br><span class="line">| usr_id | counts |</span><br><span class="line">+--------+--------+</span><br><span class="line">|      1 |      3 |</span><br><span class="line">|      2 |      2 |</span><br><span class="line">|      3 |      2 |</span><br><span class="line">|      4 |      1 |</span><br><span class="line">|      5 |      2 |</span><br><span class="line">|      6 |      2 |</span><br><span class="line">+--------+--------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.018 sec)</span><br></pre></td></tr></table></figure>
<h2 id="（3）两表联合查询-JOIN"><a href="#（3）两表联合查询-JOIN" class="headerlink" title="（3）两表联合查询(JOIN)"></a>（3）两表联合查询(JOIN)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># INNER JOIN 返回两个表中联结字段相等的行</span></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table INNER JOIN usr_score_table ON usr_table.usr_id=usr_score_table.usr_i</span><br><span class="line">d;</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | usr_name | submit_time         | is_vip | usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | FOUR     | 2021-11-17 11:06:43 |      1 |      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 12:03:22 |      72 |      71 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |      3 | 2021-11-17 12:03:22 |      77 |      80 |</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |      5 | 2021-11-17 12:03:22 |      80 |      82 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |      6 | 2021-11-17 12:03:22 |      88 |      82 |</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.019 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">#left join 左表中的所有记录和右表中联结字段相等的记录，以左表为准</span></span><br><span class="line"><span class="comment"># 给usr_table新增一行数据</span></span><br><span class="line">MariaDB [study_test]&gt; INSERT INTO usr_table (usr_id,usr_name,submit_time,is_vip) VALUES (7,<span class="string">&#x27;SEVEN&#x27;</span>,NOW(),1);</span><br><span class="line">Query OK, 1 row affected (0.016 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table LEFT JOIN usr_score_table ON usr_table.usr_id=usr_score_table.usr_id</span><br><span class="line">;</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | usr_name | submit_time         | is_vip | usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | FOUR     | 2021-11-17 11:06:43 |      1 |      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 12:03:22 |      72 |      71 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |      3 | 2021-11-17 12:03:22 |      77 |      80 |</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |      5 | 2021-11-17 12:03:22 |      80 |      82 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |      6 | 2021-11-17 12:03:22 |      88 |      82 |</span><br><span class="line">|      7 | SEVEN    | 2021-11-17 12:37:48 |      1 |   NULL | NULL                |    NULL |    NULL |</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">13 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.012 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># RIGHT JOIN 右表中的所有记录和左表中联结字段相等的记录，以右表为准</span></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table RIGHT JOIN usr_score_table ON usr_table.usr_id=usr_score_table.usr_i</span><br><span class="line">d;</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">| usr_id | usr_name | submit_time         | is_vip | usr_id | submit_time         | y_score | s_score |</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 11:06:43 |      68 |      66 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |      2 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |      3 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      4 | FOUR     | 2021-11-17 11:06:43 |      1 |      4 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |      5 | 2021-11-17 11:17:46 |      68 |      66 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |      6 | 2021-11-17 11:06:43 |      86 |      88 |</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 12:03:22 |      72 |      71 |</span><br><span class="line">|      2 | TWO      | 2021-11-17 11:06:43 |      0 |      2 | 2021-11-17 12:03:22 |      68 |      73 |</span><br><span class="line">|      3 | THREE    | 2021-11-17 11:17:46 |      1 |      3 | 2021-11-17 12:03:22 |      77 |      80 |</span><br><span class="line">|      1 | ONE      | 2021-11-17 11:06:43 |      0 |      1 | 2021-11-17 12:03:22 |      76 |      78 |</span><br><span class="line">|      5 | FIVE     | 2021-11-17 11:17:46 |      1 |      5 | 2021-11-17 12:03:22 |      80 |      82 |</span><br><span class="line">|      6 | SIX      | 2021-11-17 11:06:43 |      0 |      6 | 2021-11-17 12:03:22 |      88 |      82 |</span><br><span class="line">+--------+----------+---------------------+--------+--------+---------------------+---------+---------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NATURAL JOIN 从右表添加左表没有的字段并根据左表内容输出</span></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table NATURAL JOIN usr_score_table;</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | usr_name | is_vip | y_score | s_score |</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 | ONE      |      0 |      68 |      66 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 | TWO      |      0 |      86 |      88 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 | THREE    |      1 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 | FOUR     |      1 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 | FIVE     |      1 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 | SIX      |      0 |      86 |      88 |</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.012 sec)</span><br></pre></td></tr></table></figure>
<p><a name="div8"></a></p>
<h1 id="8、根据查询结果更新某字段值"><a href="#8、根据查询结果更新某字段值" class="headerlink" title="8、根据查询结果更新某字段值"></a>8、根据查询结果更新某字段值</h1><h2 id="（1）在某条件下单个更新"><a href="#（1）在某条件下单个更新" class="headerlink" title="（1）在某条件下单个更新"></a>（1）在某条件下单个更新</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; UPDATE usr_table SET is_vip = 1 WHERE usr_id=(SELECT usr_id FROM usr_table WHERE usr_id IN (SELECT usr_id FROM usr_score_table GROUP BY usr_id  HAVING COUNT(usr_id) &gt;= 3));</span><br><span class="line">Query OK, 1 rows affected (0.014 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table NATURAL JOIN usr_score_table;</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | usr_name | is_vip | y_score | s_score |</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 | ONE      |      1 |      68 |      66 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 | TWO      |      0 |      86 |      88 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 | THREE    |      1 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 | FOUR     |      1 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 | FIVE     |      1 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 | SIX      |      0 |      86 |      88 |</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>
<h2 id="（2）更新范围内的值"><a href="#（2）更新范围内的值" class="headerlink" title="（2）更新范围内的值"></a>（2）更新范围内的值</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [study_test]&gt; UPDATE usr_table SET is_vip = 1 WHERE usr_id IN (SELECT usr_id FROM usr_table WHERE usr_id I</span><br><span class="line">N (SELECT usr_id FROM usr_score_table GROUP BY usr_id  HAVING COUNT(usr_id) &gt;= 2));</span><br><span class="line">Query OK, 2 rows affected (0.014 sec)</span><br><span class="line">Rows matched: 5  Changed: 2  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [study_test]&gt; SELECT * FROM usr_table NATURAL JOIN usr_score_table;</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">| usr_id | submit_time         | usr_name | is_vip | y_score | s_score |</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">|      1 | 2021-11-17 11:06:43 | ONE      |      1 |      68 |      66 |</span><br><span class="line">|      2 | 2021-11-17 11:06:43 | TWO      |      1 |      86 |      88 |</span><br><span class="line">|      3 | 2021-11-17 11:17:46 | THREE    |      1 |      68 |      66 |</span><br><span class="line">|      4 | 2021-11-17 11:06:43 | FOUR     |      1 |      86 |      88 |</span><br><span class="line">|      5 | 2021-11-17 11:17:46 | FIVE     |      1 |      68 |      66 |</span><br><span class="line">|      6 | 2021-11-17 11:06:43 | SIX      |      1 |      86 |      88 |</span><br><span class="line">+--------+---------------------+----------+--------+---------+---------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>
<h1 id="9、Debian11下mariadb升级10-5-》10-6"><a href="#9、Debian11下mariadb升级10-5-》10-6" class="headerlink" title="9、Debian11下mariadb升级10.5 ==》10.6"></a>9、Debian11下mariadb升级10.5 ==》10.6</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mariadb --<span class="built_in">help</span></span><br><span class="line">mariadb  Ver 15.1 Distrib 10.5.12-MariaDB, <span class="keyword">for</span> debian-linux-gnu (x86_64) using  EditLine wrapper</span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line">Usage: mariadb [OPTIONS] [database]</span><br><span class="line"></span><br><span class="line">Default options are <span class="built_in">read</span> from the following files <span class="keyword">in</span> the given order:</span><br><span class="line">/etc/my.cnf /etc/mysql/my.cnf ~/.my.cnf </span><br><span class="line"></span><br><span class="line">root@yourUserName-pc:/etc<span class="comment"># sudo apt install software-properties-common dirmngr apt-transport-https</span></span><br><span class="line">root@yourUserName-pc:/etc<span class="comment"># sudo apt-key adv --fetch-keys &#x27;https://mariadb.org/mariadb_release_signing_key.asc&#x27;</span></span><br><span class="line">root@yourUserName-pc:/etc<span class="comment"># sudo add-apt-repository &#x27;deb [arch=amd64,i386,arm64,ppc64el] https://mirror.serverion.com/mariadb/repo/10.6/debian bullseye main&#x27;</span></span><br><span class="line"></span><br><span class="line">$ sudo apt dist-upgrade</span><br><span class="line"></span><br><span class="line">$ mariadb --<span class="built_in">help</span></span><br><span class="line">mariadb  Ver 15.1 Distrib 10.6.5-MariaDB, <span class="keyword">for</span> debian-linux-gnu (x86_64) using readline EditLine wrapper</span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Usage: mariadb [OPTIONS] [database]</span><br><span class="line"></span><br><span class="line">Default options are <span class="built_in">read</span> from the following files <span class="keyword">in</span> the given order:</span><br><span class="line">/etc/my.cnf /etc/mysql/my.cnf ~/.my.cnf </span><br></pre></td></tr></table></figure>
<p>如果升级后出现登陆不了问题，参考本文<a href="#div0">写在前面的部分</a></p>
<h1 id="10、卸载命令"><a href="#10、卸载命令" class="headerlink" title="10、卸载命令"></a>10、卸载命令</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt remove mysql-server</span><br><span class="line">sudo apt autoremove mysql-server</span><br><span class="line">sudo apt remove mysql-common</span><br><span class="line">sudo <span class="built_in">rm</span> /var/lib/mysql/ -R</span><br><span class="line">sudo <span class="built_in">rm</span> /etc/mysql/ -R</span><br><span class="line">sudo apt autoremove mysql* --purge</span><br><span class="line">sudo apt remove apparmor</span><br></pre></td></tr></table></figure>
<p>关于<strong>备份请参考</strong><br><a href="../../../../2019/12/29/Debian10备份与恢复mariaDB数据库/">Debian10备份与恢复mariaDB数据库</a>  </p>
<p>关于<strong>前期基础介绍请参考</strong><br><a href="../../../../2021/08/17/Mariadb数据库增、删、改、查、备份及恢复/">Debian10下MariaDB/MySQL数据库增、删、改、查、备份及恢复</a></p>
<p>参考资料：<br><a href="https://mariadb.org/download/?t=repo-config&amp;d=Debian+11+%22Bullseye%22&amp;v=10.6&amp;r_m=serverion">Download MariaDB Server</a><br><a href="https://mariadb.org/download/?t=mariadb&amp;p=mariadb&amp;r=10.6.5&amp;os=Linux&amp;cpu=x86_64&amp;pkg=tar_gz&amp;i=systemd&amp;m=rackspace">10.6.5tar包</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>运维</category>
        <category>MariaDB</category>
      </categories>
      <tags>
        <tag>数据库</tag>
        <tag>Debian11</tag>
        <tag>MariaDB</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown写一些latex符号和符号用法</title>
    <url>/2020/12/26/Markdown%E5%86%99%E4%B8%80%E4%BA%9Blatex%E7%AC%A6%E5%8F%B7%E5%92%8C%E7%AC%A6%E5%8F%B7%E7%94%A8%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1、上下标"><a href="#1、上下标" class="headerlink" title="1、上下标"></a>1、上下标</h2><p>1、上标符号，符号：^，如：$x^4$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x^4$</span><br></pre></td></tr></table></figure>
<p>2、下标符号，符号：_，如：$x_1$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x<span class="emphasis">_1$</span></span><br></pre></td></tr></table></figure>
<p>3、组合符号，符号：{}，如：${16}_{8}O{2+}_{2}$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$&#123;16&#125;<span class="emphasis">_&#123;8&#125;O&#123;2+&#125;_</span>&#123;2&#125;$</span><br></pre></td></tr></table></figure>
<h2 id="2、其他上面带符号类型"><a href="#2、其他上面带符号类型" class="headerlink" title="2、其他上面带符号类型"></a>2、其他上面带符号类型</h2><p>1、$\mathring{a}$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\mathring&#123;a&#125;$</span><br></pre></td></tr></table></figure>
<p>2、$\bar{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\bar&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>3、$\acute{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\acute&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>$\check{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\check&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>4、$\grave{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\grave&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>5、$\breve{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\breve&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>6、$\dot{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\dot&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>7、$\tilde{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\tilde&#123;a&#125;$</span><br></pre></td></tr></table></figure><br>8、向量<br>$\vec{a}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\vec&#123;a&#125;$</span><br></pre></td></tr></table></figure></p>
<p>9、上箭头<br>$\uparrow$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\uparrow$</span><br></pre></td></tr></table></figure></p>
<h2 id="3、省略号："><a href="#3、省略号：" class="headerlink" title="3、省略号："></a>3、省略号：</h2><p>1、横向<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\cdots$</span><br></pre></td></tr></table></figure><br>$\cdots$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\dots$ </span><br></pre></td></tr></table></figure>
<p>$\dots$<br>（纵向位置稍低，一般用于有下标的序列）<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$ \dots \cdots$</span><br></pre></td></tr></table></figure><br>${x_1,\dots,x_n}$和${x_1,\cdots,x_n}$ (对比)</p>
<p>2、竖向<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\vdots$</span><br></pre></td></tr></table></figure><br>$\vdots$</p>
<p>3、斜向：<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\ddots$</span><br></pre></td></tr></table></figure><br>$\ddots$</p>
<p>4、分数：<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\frac&#123;x+y&#125;&#123;y+z&#125;$</span><br></pre></td></tr></table></figure><br>$\frac{x+y}{y+z}$</p>
<p>或者<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$&#123;x+y&#125;\over&#123;y+z&#125;$</span><br></pre></td></tr></table></figure><br>${x+y}\over{y+z}$</p>
<h2 id="4、汉字、字体与格式"><a href="#4、汉字、字体与格式" class="headerlink" title="4、汉字、字体与格式"></a><strong>4、汉字、字体与格式</strong></h2><p>1、字体控制，符号：\\displaystyle，<br>如：$\displaystyle \frac{x+y}{y+z}$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\displaystyle \frac&#123;x+y&#125;&#123;y+z&#125;$</span><br></pre></td></tr></table></figure>
<p>【注意和上面分数区别】</p>
<p>2、下划线符号，符号：\\underline，如：$\underline{x+y}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\underline&#123;x+y&#125;$</span><br></pre></td></tr></table></figure></p>
<p>3、上大括号，符号：\\overbrace{算式}，<br>如：$\overbrace {a+b+c+d}^{2.0}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\overbrace &#123;a+b+c+d&#125;^&#123;2.0&#125;$</span><br></pre></td></tr></table></figure></p>
<p>4、下大括号，符号：\\underbrace {算式}，如：</p>
<p>$a+\underbrace{b+c}_{1.0}+d$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$a+\underbrace&#123;b+c&#125;<span class="emphasis">_&#123;1.0&#125;+d$</span></span><br></pre></td></tr></table></figure>
<p>5、上位符号，符号：\stacrel{上位符号}{基位符号},如：<br>$\vec {x}\stackrel {\mathrm {def}}{=}{x_1,\dots,x_n}$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\vec &#123;x&#125;\stackrel &#123;\mathrm &#123;def&#125;&#125;&#123;=&#125;&#123;x<span class="emphasis">_1,\dots,x_</span>n&#125;$</span><br></pre></td></tr></table></figure>
<p>6、标签，符号\tag{数字}，如：</p>
<p>$x + y = 1 \tag {1.2}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x + y = 1 \tag &#123;1.2&#125;$</span><br></pre></td></tr></table></figure></p>
<h2 id="5、数学运算"><a href="#5、数学运算" class="headerlink" title="5、数学运算"></a>5、数学运算</h2><h3 id="1-四则运算"><a href="#1-四则运算" class="headerlink" title="(1)四则运算"></a>(1)四则运算</h3><p>1.加法运算，符号：+，$x+y=z$ </p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y=z$</span><br></pre></td></tr></table></figure>
<p>2.加减运算，符号：\pm，$x \pm y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \pm y=z$</span><br></pre></td></tr></table></figure><br>3.减加运算，符号：\mp，$x \mp y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \mp y=z$</span><br></pre></td></tr></table></figure></p>
<p>4.乘法运算，符号：\times，$x \times y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \times y=z$</span><br></pre></td></tr></table></figure></p>
<p>5.点乘运算，符号：\cdot，$x \cdot y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \cdot y=z$</span><br></pre></td></tr></table></figure></p>
<p>6.星乘运算，符号：\ast，$x \ast y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \ast y=z$</span><br></pre></td></tr></table></figure></p>
<p>7.除法运算，符号：\div，$x \div y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \div y=z$</span><br></pre></td></tr></table></figure></p>
<p>8.斜除运算，符号：/，$x / y=z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x / y=z$</span><br></pre></td></tr></table></figure></p>
<p>9.分式表示，符号：\frac{分子}{分母}，如：$\frac{x+y}{y+z}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\frac&#123;x+y&#125;&#123;y+z&#125;$</span><br></pre></td></tr></table></figure></p>
<p>分式表示，符号：{分子} \voer {分母}，如：${x+y} \over {y+z}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$&#123;x+y&#125; \over &#123;y+z&#125;$</span><br></pre></td></tr></table></figure></p>
<p>10.绝对值表示，符号：||，如：$|x+y|$</p>
<p>(2)高级运算</p>
<p>1、平均数运算，符号：\overline{算式}，如：$\overline{xyz}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\overline&#123;xyz&#125;$</span><br></pre></td></tr></table></figure><br>2、开二次方运算，符号：\sqrt，如：$\sqrt x$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\sqrt x$</span><br></pre></td></tr></table></figure><br>开多次方运算，符号：\sqrt[开方数]{被开方数}，如：$\sqrt[3]{x+y}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\sqrt[3]&#123;x+y&#125;$</span><br></pre></td></tr></table></figure><br>3、对数运算，符号：\log，如：$\log_2 x$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\log<span class="emphasis">_2\ x$</span></span><br></pre></td></tr></table></figure><br>4、求和运算，符号：\sum，如：<br>$\sum^n_{i=1}(x_i-\bar x)(y_i-\bar y)$</p>
<p>或者，符号：\displaystyle \sum，如：<br>$\displaystyle \sum^n_{i=1}(x_i-\bar x)(y_i-\bar y)$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\sum^n<span class="emphasis">_&#123;i=1&#125;(x_</span>i-\bar x)(y<span class="emphasis">_i-\bar y)$</span></span><br><span class="line"><span class="emphasis">$\displaystyle \sum^n_</span>&#123;i=1&#125;(x<span class="emphasis">_i-\bar x)(y_</span>i-\bar y)$</span><br></pre></td></tr></table></figure>
<p>5、微分运算，符号：\partial，如：$\frac{\partial x}{\partial y}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\frac&#123;\partial x&#125;&#123;\partial y&#125;$</span><br></pre></td></tr></table></figure></p>
<p>6、积分运算，符号：\int，如：$\int^\infty_{0}{xdx}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\int^&#123;\infty&#125;<span class="emphasis">_&#123;0&#125;&#123;xdx&#125;$</span></span><br></pre></td></tr></table></figure></p>
<p>7、矩阵表示，符号：\begin{matrix} \end{matrix}，如：</p>
<script type="math/tex; mode=display">
\left [
\begin{matrix}
a & b & c & d  \\
e & f & g & h  \\
i & j & k & l  \\
m & n & o & p
\end{matrix}
\right ]
\tag{1}</script><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$</span><br><span class="line">\left [</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">a &amp; b &amp; c &amp; d  \\</span><br><span class="line">e &amp; f &amp; g &amp; h  \\</span><br><span class="line">i &amp; j &amp; k &amp; l  \\</span><br><span class="line">m &amp; n &amp; o &amp; p</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right ]</span><br><span class="line">\tag&#123;2&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="6、逻辑运算与集合运算"><a href="#6、逻辑运算与集合运算" class="headerlink" title="6、逻辑运算与集合运算"></a>6、逻辑运算与集合运算</h2><p>(1)逻辑运算<br>1、大于等于运算，符号：\geq，如：$x+y \geq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \geq z$</span><br></pre></td></tr></table></figure><br>2、小于等于运算，符号：\leq，如：$x+y \leq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \leq z$</span><br></pre></td></tr></table></figure><br>3、不等于运算，符号：\neq，如：$x+y \neq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \neq z$</span><br></pre></td></tr></table></figure><br>4、不大于等于运算，符号：\ngeq，如：$x+y \ngeq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \ngeq z$</span><br></pre></td></tr></table></figure><br>或者，符号：\not\geq，如：$x+y \not\geq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \not\geq z$</span><br></pre></td></tr></table></figure><br>6、不小于等于运算，符号：\nleq，如：$x+y \nleq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \nleq z$</span><br></pre></td></tr></table></figure><br>或者，符号：\not\leq，如：$x+y \not\leq z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \not\leq z$</span><br></pre></td></tr></table></figure><br>7、约等于运算，符号：\approx，如：$x+y \approx z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \approx z$</span><br></pre></td></tr></table></figure><br>8、恒定等于运算，符号：\equiv，如：$x+y \equiv z$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x+y \equiv z$</span><br></pre></td></tr></table></figure><br>(2)集合运算<br>1、属于运算，符号：\in，如：$x \in y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \in y$</span><br></pre></td></tr></table></figure><br>2、不属于运算，符号：\notin，如：$x \notin y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \notin y$</span><br></pre></td></tr></table></figure><br>3、不属于运算，符号：\not\in，如：$x \not\in y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \not\in y$</span><br></pre></td></tr></table></figure><br>4、子集运算，符号：\subset，如：$x \subset y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \subset y$</span><br></pre></td></tr></table></figure><br>5、非子集运算，符号：\not\subset，如：$x \not\subset y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \not\subset y$</span><br></pre></td></tr></table></figure><br>6、真子集运算，符号：\subseteq，如：$x \subseteq y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \subseteq y$</span><br></pre></td></tr></table></figure><br>7、非真子集运算，符号：\subsetneq，如：$x \subsetneq y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \subsetneq y$</span><br></pre></td></tr></table></figure><br>8、并集运算，符号：\cup，如：$x \cup y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \cup y$</span><br></pre></td></tr></table></figure><br>9、交集运算，符号：\cap，如：$x \cap y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \cap y$</span><br></pre></td></tr></table></figure><br>10、差集运算，符号：\setminus，如：$x \setminus y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \setminus y$</span><br></pre></td></tr></table></figure><br>11、同或运算，符号：\bigodot，如：$x \bigodot y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \bigodot y$</span><br></pre></td></tr></table></figure><br>12、同与运算，符号：\bigotimes，如：$x \bigotimes y$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$x \bigotimes y$</span><br></pre></td></tr></table></figure><br>13、实数集合，符号：\mathbb{R}，如：$\mathbb{R}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\mathbb&#123;R&#125;$</span><br></pre></td></tr></table></figure><br>14、自然数集合，符号：\mathbb{Z}，如：$\mathbb{Z}$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\mathbb&#123;Z&#125;$</span><br></pre></td></tr></table></figure><br>15、空集，符号：\emptyset，如：$\emptyset$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\emptyset$</span><br></pre></td></tr></table></figure></p>
<h2 id="7、方程组"><a href="#7、方程组" class="headerlink" title="7、方程组"></a>7、方程组</h2><p>1、一般方程组<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\begin&#123;cases&#125;</span><br><span class="line">a<span class="emphasis">_1x+b_</span>1y+c<span class="emphasis">_1z=d_</span>1\\\</span><br><span class="line">a<span class="emphasis">_2x+b_</span>2y+c<span class="emphasis">_2z=d_</span>2\\\</span><br><span class="line">a<span class="emphasis">_3x+b_</span>3y+c<span class="emphasis">_3z=d_</span>3</span><br><span class="line">\end&#123;cases&#125;$</span><br></pre></td></tr></table></figure></p>
<p>$<br>\begin{cases}<br>a_1x+b_1y+c_1z=d_1\\\<br>a_2x+b_2y+c_2z=d_2\\\<br>a_3x+b_3y+c_3z=d_3<br>\end{cases}<br>$</p>
<p>2、带表达式形式<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$</span><br><span class="line">f(n) =</span><br><span class="line">\begin&#123;cases&#125;</span><br><span class="line">n/2,  &amp;\text&#123;如果:&#125; n\neq 0 \\\\</span><br><span class="line">3n+1, &amp;\text&#123;如果:&#125; n \geq 2 \\\\</span><br><span class="line">2n\over5(n-1), &amp;\text&#123;如果:&#125; \text&#123;-&#125;\infty &lt; n &lt; 2</span><br><span class="line">\end&#123;cases&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p>
<p>$<br>f(n) =<br>\begin{cases}<br>n/2,  &amp;\text{如果:} n\neq 0 \\\\<br>3n+1, &amp;\text{如果:} n \geq 2 \\\\<br>2n\over5(n-1), &amp;\text{如果:} \text{-}\infty &lt; n &lt; 2<br>\end{cases}<br>$</p>
<h2 id="8、表格"><a href="#8、表格" class="headerlink" title="8、表格"></a>8、表格</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$</span><br><span class="line">\begin&#123;array&#125;</span><br><span class="line">&#123;|c|l|r|&#125;</span><br><span class="line">\hline 782&amp;789&amp;123 \\\\</span><br><span class="line">\hline 67&amp;56&amp;37 \\\\</span><br><span class="line">\hline 6&amp;1&amp;8 \\\\</span><br><span class="line">\hline</span><br><span class="line">\end&#123;array&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>$<br>\begin{array}<br>{|c|l|r|}<br>\hline 782&amp;789&amp;123 \\\\<br>\hline 67&amp;56&amp;37 \\\\<br>\hline 6&amp;1&amp;8 \\\\<br>\hline<br>\end{array}<br>$</p>
<h2 id="9、流程图"><a href="#9、流程图" class="headerlink" title="9、流程图"></a>9、流程图</h2><p><strong>需安装插件：<code>flowchart</code></strong><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm i hexo-filter-flowchart --save </span><br></pre></td></tr></table></figure><br>在根目录：_config.yml加入<code>flowchart</code>支持:<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">flowchart:</span><br><span class="line">  # raphael:   # optional, the source url of raphael.js</span><br><span class="line">  # flowchart: # optional, the source url of flowchart.js</span><br><span class="line">  options: # options used for <span class="code">`drawSVG`</span></span><br></pre></td></tr></table></figure></p>
<p>1、官方例子：<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">st=&gt;start: Start|past:&gt;http://www.google.com[blank]</span><br><span class="line">e=&gt;end: End:&gt;http://www.google.com</span><br><span class="line">op1=&gt;operation: My Operation|past</span><br><span class="line">op2=&gt;operation: Stuff|current</span><br><span class="line">sub1=&gt;subroutine: My Subroutine|invalid</span><br><span class="line">cond=&gt;condition: Yes</span><br><span class="line">or No?|approved:&gt;http://www.google.com</span><br><span class="line">c2=&gt;condition: Good idea|rejected</span><br><span class="line">io=&gt;inputoutput: catch something...|request</span><br><span class="line"></span><br><span class="line">st-&gt;op1(right)-&gt;cond</span><br><span class="line">cond(yes, right)-&gt;c2</span><br><span class="line">cond(no)-&gt;sub1(left)-&gt;op1</span><br><span class="line">c2(yes)-&gt;io-&gt;e</span><br><span class="line">c2(no)-&gt;op2-&gt;e</span><br></pre></td></tr></table></figure></p>
<div id="flowchart-0" class="flow-chart"></div>


<p>2、演示<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">st=&gt;start: 开始节点</span><br><span class="line">in=&gt;inputoutput: 输入i</span><br><span class="line">e=&gt;end: 结束节点</span><br><span class="line">cond=&gt;condition: i被2整除</span><br><span class="line">out1=&gt;inputoutput: 输出i是奇数</span><br><span class="line">out2=&gt;inputoutput: 输出i是偶数</span><br><span class="line">st(right)-&gt;in-&gt;cond</span><br><span class="line">cond(yes,right)-&gt;out2-&gt;e</span><br><span class="line">cond(no)-&gt;out1-&gt;e</span><br></pre></td></tr></table></figure></p>
<div id="flowchart-1" class="flow-chart"></div>



<h2 id="10、其他一些符号"><a href="#10、其他一些符号" class="headerlink" title="10、其他一些符号"></a>10、其他一些符号</h2><p>1、虚数<br>$\imath$,$\jmath$<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$\imath$</span><br><span class="line">$\jmath$</span><br></pre></td></tr></table></figure></p>
<p>2、其他组合<br>$2H_2O\stackrel {\mathrm {点燃}}{==}2H_2 + O_2$</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$2H<span class="emphasis">_2O\stackrel &#123;\mathrm &#123;点燃&#125;&#125;&#123;=&#125;H_</span>2 + O<span class="emphasis">_2$</span></span><br></pre></td></tr></table></figure>
<p>希腊字母</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字母</th>
<th>实现</th>
<th>字母</th>
<th>实现</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>A</td>
<td>α</td>
<td>\alhpa</td>
</tr>
<tr>
<td>B</td>
<td>B</td>
<td>β</td>
<td>\beta</td>
</tr>
<tr>
<td>Γ</td>
<td>\Gamma</td>
<td>γ</td>
<td>\gamma</td>
</tr>
<tr>
<td>Δ</td>
<td>\Delta</td>
<td>δ</td>
<td>\delta</td>
</tr>
<tr>
<td>E</td>
<td>E</td>
<td>ϵ</td>
<td>\epsilon</td>
</tr>
<tr>
<td>Z</td>
<td>Z</td>
<td>ζ</td>
<td>\zeta</td>
</tr>
<tr>
<td>H</td>
<td>H</td>
<td>η</td>
<td>\eta</td>
</tr>
<tr>
<td>Θ</td>
<td>\Theta</td>
<td>θ</td>
<td>\theta</td>
</tr>
<tr>
<td>I</td>
<td>I</td>
<td>ι</td>
<td>\iota</td>
</tr>
<tr>
<td>K</td>
<td>K</td>
<td>κ</td>
<td>\kappa</td>
</tr>
<tr>
<td>Λ</td>
<td>\Lambda</td>
<td>λ</td>
<td>\lambda</td>
</tr>
<tr>
<td>M</td>
<td>M</td>
<td>μ</td>
<td>\mu</td>
</tr>
<tr>
<td>N</td>
<td>N</td>
<td>ν</td>
<td>\nu</td>
</tr>
<tr>
<td>Ξ</td>
<td>\Xi</td>
<td>ξ</td>
<td>\xi</td>
</tr>
<tr>
<td>O</td>
<td>O</td>
<td>ο</td>
<td>\omicron</td>
</tr>
<tr>
<td>Π</td>
<td>\Pi</td>
<td>π</td>
<td>\pi</td>
</tr>
<tr>
<td>P</td>
<td>P</td>
<td>ρ</td>
<td>\rho</td>
</tr>
<tr>
<td>Σ</td>
<td>\Sigma</td>
<td>σ</td>
<td>\sigma</td>
</tr>
<tr>
<td>T</td>
<td>T</td>
<td>τ</td>
<td>\tau</td>
</tr>
<tr>
<td>Υ</td>
<td>\Upsilon</td>
<td>υ</td>
<td>\upsilon</td>
</tr>
<tr>
<td>Φ</td>
<td>\Phi</td>
<td>ϕ</td>
<td>\phi</td>
</tr>
<tr>
<td>X</td>
<td>X</td>
<td>χ</td>
<td>\chi</td>
</tr>
<tr>
<td>Ψ</td>
<td>\Psi</td>
<td>ψ</td>
<td>\psi</td>
</tr>
<tr>
<td>Ω</td>
<td>\v</td>
<td>ω</td>
<td>\omega</td>
</tr>
</tbody>
</table>
</div>
<p>参考：<br>①<a href="https://www.cnblogs.com/Lo3prs/p/14021997.html">MarkDown数学公式</a><br>②<a href="https://www.jianshu.com/p/e74eb43960a1">Markdown数学公式语法</a><br>③<a href="https://github.com/bubkoo/hexo-filter-flowchart">flowchart项目</a><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">st=>start: Start|past:>http://www.google.com[blank]
e=>end: End:>http://www.google.com
op1=>operation: My Operation|past
op2=>operation: Stuff|current
sub1=>subroutine: My Subroutine|invalid
cond=>condition: Yes
or No?|approved:>http://www.google.com
c2=>condition: Good idea|rejected
io=>inputoutput: catch something...|request

st->op1(right)->cond
cond(yes, right)->c2
cond(no)->sub1(left)->op1
c2(yes)->io->e
c2(no)->op2->e</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script><textarea id="flowchart-1-code" style="display: none">st=>start: 开始节点
in=>inputoutput: 输入i
e=>end: 结束节点
op1=>operation: xx
op2=>operation: xx
cond=>condition: i被2整除
sub=>subroutine: xx
out1=>inputoutput: 输出i是奇数
out2=>inputoutput: 输出i是偶数
st->in->cond
cond(yes,right)->out2->e
cond(no)->out1->e</textarea><textarea id="flowchart-1-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-1-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-1-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-1", options);</script></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Markdown</category>
        <category>Latex</category>
      </categories>
      <tags>
        <tag>Math</tag>
        <tag>Mathjax</tag>
        <tag>Latex</tag>
        <tag>Flowchart</tag>
      </tags>
  </entry>
  <entry>
    <title>MsSQL简单使用</title>
    <url>/2022/03/22/MsSQL%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><h2 id="查询所有数据库"><a href="#查询所有数据库" class="headerlink" title="查询所有数据库"></a>查询所有数据库</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sqlcmd</span><br><span class="line"><span class="number">1</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sysdatabases</span><br><span class="line"><span class="number">2</span><span class="operator">&gt;</span> go</span><br></pre></td></tr></table></figure>
<h1 id="使用数据库"><a href="#使用数据库" class="headerlink" title="使用数据库"></a>使用数据库</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"> use master</span><br><span class="line"> go</span><br><span class="line">已将数据库上下文更改为 &quot;master&quot;。</span><br></pre></td></tr></table></figure>
<h1 id="创建数据库-sqlTest，并使用"><a href="#创建数据库-sqlTest，并使用" class="headerlink" title="创建数据库 sqlTest，并使用"></a>创建数据库 sqlTest，并使用</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE sqlTest</span><br><span class="line">go</span><br><span class="line">use sqlTest</span><br><span class="line">go</span><br><span class="line">已将数据库上下文更改为 &quot;sqlTest&quot;。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">## 判断当前数据库是否存在`user_table`表</span><br><span class="line">if object_id(N<span class="string">&#x27;user_table&#x27;</span>,N<span class="string">&#x27;U&#x27;</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">print <span class="string">&#x27;存在&#x27;</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">print <span class="string">&#x27;不存在&#x27;</span></span><br><span class="line">go</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user_table (</span><br><span class="line">用户ID <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">姓名 <span class="type">varchar</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">性别 <span class="type">char</span>(<span class="number">2</span>)  <span class="keyword">CHECK</span>(性别 <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">OR</span> 性别 <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">成绩 <span class="type">numeric</span>(<span class="number">4</span>,<span class="number">1</span>) <span class="keyword">CHECK</span>(成绩 <span class="operator">&gt;=</span> <span class="number">0</span> <span class="keyword">AND</span> 成绩 <span class="operator">&lt;=</span> <span class="number">100</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h1 id="复制一个数据库中表到另一个数据库"><a href="#复制一个数据库中表到另一个数据库" class="headerlink" title="复制一个数据库中表到另一个数据库"></a>复制一个数据库中表到另一个数据库</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> ( <span class="keyword">SELECT</span>  <span class="operator">*</span></span><br><span class="line">                <span class="keyword">FROM</span>    sysobjects</span><br><span class="line">                <span class="keyword">WHERE</span>   id <span class="operator">=</span> OBJECT_ID(N<span class="string">&#x27;user_table&#x27;</span>)</span><br><span class="line">                        <span class="keyword">AND</span> OBJECTPROPERTY(id, N<span class="string">&#x27;IsUserTable&#x27;</span>) <span class="operator">=</span> <span class="number">1</span> ) </span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">INTO</span> sqlTest.dbo.user_table <span class="keyword">From</span> master.dbo.user_table</span><br><span class="line">go</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 增加数据</span><br><span class="line">## 追加字段</span><br><span class="line">```<span class="keyword">sql</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> user_table <span class="keyword">ADD</span></span><br><span class="line">cID <span class="type">INT</span> <span class="keyword">IDENTITY</span> (<span class="number">1</span>,<span class="number">1</span>),</span><br><span class="line">telNumber <span class="type">varchar</span>(<span class="number">11</span>)</span><br><span class="line"># 查询结果</span><br><span class="line"><span class="keyword">SELECT</span> TOP (<span class="number">10</span>) <span class="operator">*</span></span><br><span class="line">  <span class="keyword">FROM</span> [sqlTest].[dbo].[user_table]</span><br></pre></td></tr></table></figure>
<h1 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 单行</span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> user_table <span class="keyword">VALUES</span> (<span class="number">100001</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">98</span>)</span><br><span class="line"># 多行</span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> user_table <span class="keyword">VALUES</span> (<span class="number">100002</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">89</span>),(<span class="number">100003</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">58</span>),(<span class="number">100004</span>,<span class="string">&#x27;侯六&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">77</span>),(<span class="number">100005</span>,<span class="string">&#x27;小七&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<h1 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h1><h2 id="删除数据库中某一表"><a href="#删除数据库中某一表" class="headerlink" title="删除数据库中某一表"></a>删除数据库中某一表</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> user_table</span><br></pre></td></tr></table></figure>
<h2 id="删除某个字段"><a href="#删除某个字段" class="headerlink" title="删除某个字段"></a>删除某个字段</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> user_table</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> 字段名</span><br></pre></td></tr></table></figure>
<h1 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h1><h2 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> user_table <span class="keyword">SET</span> telNumber <span class="operator">=</span> <span class="string">&#x27;13987654321&#x27;</span> <span class="keyword">WHERE</span> cID <span class="operator">=</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h2 id="更新字段"><a href="#更新字段" class="headerlink" title="更新字段"></a>更新字段</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> SP_RENAME <span class="string">&#x27;user_table.电话号码&#x27;</span>,<span class="string">&#x27;联系方式&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TOP (<span class="number">1000</span>) [用户ID]</span><br><span class="line">      ,[姓名]</span><br><span class="line">      ,[性别]</span><br><span class="line">      ,[成绩]</span><br><span class="line">  <span class="keyword">FROM</span> [master].[dbo].[user_table]</span><br></pre></td></tr></table></figure>
<h2 id="查询数据库中的所有数据库名"><a href="#查询数据库中的所有数据库名" class="headerlink" title="查询数据库中的所有数据库名"></a>查询数据库中的所有数据库名</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Master..SysDatabases <span class="keyword">ORDER</span> <span class="keyword">BY</span> Name</span><br></pre></td></tr></table></figure>
<h1 id="查询当前数据库中所有表名"><a href="#查询当前数据库中所有表名" class="headerlink" title="查询当前数据库中所有表名"></a>查询当前数据库中所有表名</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> SysObjects <span class="keyword">Where</span> XType<span class="operator">=</span><span class="string">&#x27;U&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Name</span><br><span class="line"># 或者</span><br><span class="line"><span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Sys.Objects <span class="keyword">Where</span> XType<span class="operator">=</span><span class="string">&#x27;U&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Name</span><br><span class="line"># 或者</span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> Sys.tables</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xtype char(2) 对象类型。可以是下列对象类型中的一种： </span><br><span class="line">C = CHECK 约束 </span><br><span class="line">D = 默认值或 DEFAULT 约束 </span><br><span class="line">F = FOREIGN KEY 约束 </span><br><span class="line">L = 日志 </span><br><span class="line">FN = 标量函数 </span><br><span class="line">IF = 内嵌表函数 </span><br><span class="line">P = 存储过程 </span><br><span class="line">PK = PRIMARY KEY 约束（类型是 K） </span><br><span class="line">RF = 复制筛选存储过程 </span><br><span class="line">S = 系统表 </span><br><span class="line">TF = 表函数 </span><br><span class="line">TR = 触发器 </span><br><span class="line">U = 用户表 </span><br><span class="line">UQ = UNIQUE 约束（类型是 K） </span><br><span class="line">V = 视图 </span><br><span class="line">X = 扩展存储过程 </span><br></pre></td></tr></table></figure>
<h1 id="查询某表中的字段名"><a href="#查询某表中的字段名" class="headerlink" title="查询某表中的字段名"></a>查询某表中的字段名</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">select</span> name <span class="keyword">from</span> syscolumns <span class="keyword">where</span> id<span class="operator">=</span>object_id(N<span class="string">&#x27;表名&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 其他</span></span><br><span class="line"><span class="string">`MySql`</span></span><br><span class="line"><span class="string">查询表的所有字段名：</span></span><br><span class="line"><span class="string">```mysql</span></span><br><span class="line"><span class="string">select *</span></span><br><span class="line"><span class="string">from information_schema.columns </span></span><br><span class="line"><span class="string">where table_name=&#x27;</span>table_name<span class="string">&#x27; </span></span><br><span class="line"><span class="string">and table_schema=&#x27;</span>table_schema<span class="string">&#x27;</span></span><br><span class="line"><span class="string">ORDER BY ORDINAL_POSITION</span></span><br></pre></td></tr></table></figure>
<p><code>ACCESS</code><br>查看所有表名：<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> MSysObjects <span class="keyword">where</span> type<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> flags<span class="operator">=</span><span class="number">0</span></span><br></pre></td></tr></table></figure><br><code>MSysObjects</code>是系统对象，默认情况是隐藏的。通过工具、选项、视图、显示、系统对象可以使之显示出来。<br><code>Oracle</code><br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> cname <span class="keyword">from</span> col <span class="keyword">where</span> tname<span class="operator">=</span><span class="string">&#x27;ZW_YINGYEZ&#x27;</span></span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> user_tab_columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;ZW_YINGYEZ&#x27;</span></span><br></pre></td></tr></table></figure><br>查询表字段数<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> user_tab_columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;表名&#x27;</span>;</span><br></pre></td></tr></table></figure></p>
<p>Sql中获取表结构<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.COLUMN_NAME,a.DATA_TYPE,a.CHARACTER_MAXIMUM_LENGTH,b.value <span class="keyword">from</span> information_schema.COLUMNS <span class="keyword">as</span> a  <span class="keyword">left</span> <span class="keyword">join</span> sys.extended_properties <span class="keyword">as</span> b <span class="keyword">on</span> a.TABLE_NAME<span class="operator">=</span>OBJECT_NAME(b.major_id) <span class="keyword">and</span> a.ORDINAL_POSITION<span class="operator">=</span>b.minor_id <span class="keyword">where</span> a.TABLE_NAME<span class="operator">=</span><span class="string">&#x27;user_table&#x27;</span></span><br></pre></td></tr></table></figure><br>SQL语句查询某表中所有字段的名称、类型、长度等属性信息<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">字段名<span class="operator">=</span>a.name,</span><br><span class="line">标识<span class="operator">=</span><span class="keyword">case</span> <span class="keyword">when</span> COLUMNPROPERTY(a.id,a.name,<span class="string">&#x27;IsIdentity&#x27;</span>)<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span> <span class="string">&#x27;√&#x27;</span><span class="keyword">else</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">end</span>,</span><br><span class="line">主键<span class="operator">=</span><span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">exists</span>(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> sysobjects <span class="keyword">where</span> xtype<span class="operator">=</span><span class="string">&#x27;PK&#x27;</span> <span class="keyword">and</span> name <span class="keyword">in</span> (<span class="keyword">SELECT</span> name <span class="keyword">FROM</span> sysindexes <span class="keyword">WHERE</span> indid <span class="keyword">in</span>(<span class="keyword">SELECT</span> indid <span class="keyword">FROM</span> sysindexkeys <span class="keyword">WHERE</span> id <span class="operator">=</span> a.id <span class="keyword">AND</span> colid<span class="operator">=</span>a.colid))) <span class="keyword">then</span> <span class="string">&#x27;√&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">end</span>,</span><br><span class="line">类型<span class="operator">=</span>b.name,</span><br><span class="line">占用字节数<span class="operator">=</span>a.length,</span><br><span class="line">长度<span class="operator">=</span>COLUMNPROPERTY(a.id,a.name,<span class="string">&#x27;PRECISION&#x27;</span>),</span><br><span class="line">小数位数<span class="operator">=</span>isnull(COLUMNPROPERTY(a.id,a.name,<span class="string">&#x27;Scale&#x27;</span>),<span class="number">0</span>),</span><br><span class="line">允许空<span class="operator">=</span><span class="keyword">case</span> <span class="keyword">when</span> a.isnullable<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span> <span class="string">&#x27;√&#x27;</span><span class="keyword">else</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">end</span>,</span><br><span class="line">默认值<span class="operator">=</span>isnull(e.text,<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">字段说明<span class="operator">=</span>isnull(g.[<span class="keyword">value</span>],<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> syscolumns a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> systypes b <span class="keyword">on</span> a.xtype<span class="operator">=</span>b.xusertype </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> sysobjects d <span class="keyword">on</span> a.id<span class="operator">=</span>d.id <span class="keyword">and</span> d.xtype<span class="operator">=</span><span class="string">&#x27;U&#x27;</span> <span class="keyword">and</span> d.name<span class="operator">&lt;&gt;</span><span class="string">&#x27;dtproperties&#x27;</span> </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> syscomments e <span class="keyword">on</span> a.cdefault<span class="operator">=</span>e.id </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> sys.extended_properties g <span class="keyword">on</span> a.id<span class="operator">=</span>g.major_id <span class="keyword">and</span> a.colid<span class="operator">=</span>g.minor_id </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> sys.extended_properties f <span class="keyword">on</span> d.id<span class="operator">=</span>f.major_id <span class="keyword">and</span> f.minor_id <span class="operator">=</span><span class="number">0</span> </span><br><span class="line"><span class="keyword">Where</span> d.name<span class="operator">=</span><span class="string">&#x27;user_table&#x27;</span></span><br><span class="line"><span class="keyword">Order</span> <span class="keyword">by</span> a.name</span><br></pre></td></tr></table></figure><br>参考资料<br><a href="https://www.cnblogs.com/beeone/p/5131479.html">SQL]复制数据库某一个表到另一个数据库中</a><br><a href="http://www.pythontip.com/bigdata/post/8904">SqlServer判断表是否存在</a><br><a href="https://www.cnblogs.com/cnwhm/p/4314107.html#final">Sql中获取表结构（字段名称，类型，长度，说明）</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>软件应用</category>
        <category>Mssql</category>
        <category>MsSQL</category>
      </categories>
      <tags>
        <tag>MsSQL</tag>
        <tag>Sql Server</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11系统MySQL Connector/ODBC下载及安装</title>
    <url>/2021/12/21/MySQL%20ConnectorODBC%E4%B8%8B%E8%BD%BD%E5%8F%8A%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="下载Connector-ODBC"><a href="#下载Connector-ODBC" class="headerlink" title="下载Connector/ODBC"></a>下载<code>Connector/ODBC</code></h1><p><a href="https://dev.mysql.com/downloads/connector/odbc/">Connector/ODBC 8.0.27 </a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf mysql-connector-odbc-8.0.27-linux-glibc2.12-x86-64bit.tar.gz</span><br><span class="line"><span class="built_in">mkdir</span> -p ~/local/MySQL_OBDC_Connect &amp;&amp; <span class="built_in">mv</span> ~/下载/软件/deb包/DatabaseTools/Mysql/mysql-connector-odbc-8.0.27-linux-glibc2.12-x86-64bit  ~/local/MySQL_OBDC_Connect</span><br></pre></td></tr></table></figure>
<h1 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h1><p>用户用环境变量中添加：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><br>添加如下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/&lt;your username&gt;/local/MySQL_OBDC_Connect/lib</span><br></pre></td></tr></table></figure></p>
<h1 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明"></a>其他说明</h1><p><code>lib</code>中一般有以下三种格式，区别为：<br><code>Libmyodbc8a.so</code>是<code>ASCII</code>编码格式<br><code>Libmyodbc8w.so</code>是<code>UNICODE</code>编码格式<br><code>Libmyodbc8s.so</code>是程序开发中配置数据源提供界面的动态链接库</p>
<p>参考资料：<br>(MySQL Connector/ODBC下载及安装的具体方法)[<a href="https://baijiahao.baidu.com/s?id=1714100791494795213&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1714100791494795213&amp;wfr=spider&amp;for=pc</a>]</p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>软件应用</category>
        <category>MySQL</category>
        <category>ODBC</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
        <tag>Debian11</tag>
        <tag>ODBC</tag>
        <tag>Connector</tag>
      </tags>
  </entry>
  <entry>
    <title>Php8.1连接Mariadb数据库及简单查、插、更、删</title>
    <url>/2022/10/29/PHP8.1%E8%BF%9E%E6%8E%A5Mariadb10%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8A%E7%AE%80%E5%8D%95%E6%9F%A5%E3%80%81%E6%8F%92%E3%80%81%E6%9B%B4%E3%80%81%E5%88%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="连接Mariadb数据库"><a href="#连接Mariadb数据库" class="headerlink" title="连接Mariadb数据库"></a>连接Mariadb数据库</h1><p>创建数据库<code>filesStation</code>并新建<code>pic</code>表<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> database  development;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `pic`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `files` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `filename` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `path` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `mark` tinyint(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `scale` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `info` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>MyISAM AUTO_INCREMENT<span class="operator">=</span><span class="number">3</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure><br>连接文件<code>conn.php</code><br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$dsn</span> = <span class="string">&quot;mysql:host=localhost;dbname=filesStation;charset=utf8mb4&quot;</span>;</span><br><span class="line"><span class="comment">//$dsn = &quot;mysql:host=localhost;dbname=filesStation&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$options</span> = [</span><br><span class="line">  PDO::<span class="variable constant_">ATTR_EMULATE_PREPARES</span>   =&gt; <span class="literal">false</span>, <span class="comment">// Disable emulation mode for &quot;real&quot; prepared statements</span></span><br><span class="line">  PDO::<span class="variable constant_">ATTR_ERRMODE</span>            =&gt; PDO::<span class="variable constant_">ERRMODE_EXCEPTION</span>, <span class="comment">// Disable errors in the form of exceptions</span></span><br><span class="line">  PDO::<span class="variable constant_">ATTR_DEFAULT_FETCH_MODE</span> =&gt; PDO::<span class="variable constant_">FETCH_ASSOC</span>, <span class="comment">// Make the default fetch be an associative array</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="variable">$pdo</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>, <span class="string">&quot;数据库用户名&quot;</span>, <span class="string">&quot;数据库密码&quot;</span>, <span class="variable">$options</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">error_log</span>(<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>());</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$e</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">&#x27;数据库连接失败&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="操作数据库"><a href="#操作数据库" class="headerlink" title="操作数据库"></a>操作数据库</h1><p>操作文件<code>op.php</code><br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// Include the database connection file</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;conn.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PHP class</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Contact</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$mark</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$scale</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$info</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fetch contacts (in descending order)</span></span><br><span class="line"><span class="variable">$contacts</span> = <span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">query</span>( <span class="string">&quot;SELECT * FROM pic ORDER BY id DESC&quot;</span>)-&gt;<span class="title function_ invoke__">fetchAll</span>(PDO::<span class="variable constant_">FETCH_CLASS</span>, <span class="string">&#x27;Contact&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span> = <span class="title function_ invoke__">http_build_query</span>(<span class="variable">$contacts</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$query</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入数据</span></span><br><span class="line"><span class="comment">//使用 PDO::prepare 插入 pic</span></span><br><span class="line"><span class="comment">//$stmt = $pdo-&gt;prepare(&quot;INSERT INTO pic (path, mark, info) VALUES(?, ?, ?)&quot;);</span></span><br><span class="line"><span class="comment">//$stmt-&gt;execute([$path, $mark, $info]);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//更新数据</span></span><br><span class="line"><span class="comment">//使用 PDO::prepare 更新 contacts</span></span><br><span class="line"><span class="comment">//$stmt = $pdo-&gt;prepare(&quot;UPDATE pic SET path = ?, mark = ?, info = ? WHERE id = ?&quot;);</span></span><br><span class="line"><span class="comment">//$stmt-&gt;execute([$path, $mark, $info, $id]);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//删除数据</span></span><br><span class="line"><span class="comment">//使用 PDO::prepare 删除 contacts</span></span><br><span class="line"><span class="comment">//$stmt = $pdo-&gt;prepare(&quot;DELETE FROM pic WHERE id = ?&quot;);</span></span><br><span class="line"><span class="comment">//$stmt-&gt;execute([$id]);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>Linux</category>
        <category>运维</category>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>数据库</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>Python3中import pandas后提示错误</title>
    <url>/2021/12/21/Python3%E4%B8%ADimport%20pandas%E5%90%8E%E6%8F%90%E7%A4%BA%E9%94%99%E8%AF%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p><code>import pandas</code>后提示：<br><code>Warning: Could not import the lzma module. Your installed Python is incomplete. Attempting to use lzma compression will result in a RuntimeError.
  warnings.warn(msg)</code></p>
<h1 id="解决："><a href="#解决：" class="headerlink" title="解决："></a>解决：</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install liblzma-dev</span><br><span class="line">pip install backports-lzma</span><br></pre></td></tr></table></figure>
<p>修改<code>/usr/local/lib/python3.10/lzma.py</code>第27行，改成如下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">try:</span><br><span class="line">    from _lzma import *</span><br><span class="line">    from _lzma import _encode_filter_properties, _decode_filter_properties</span><br><span class="line">except ImportError:</span><br><span class="line">    from backports.lzma import *</span><br><span class="line">    from backports.lzma import _encode_filter_properties, _decode_filter_properties</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>运维</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>问题解决</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Python合并PDF</title>
    <url>/2019/03/25/Python%E5%90%88%E5%B9%B6PDF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>具体代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2019-03-25 15:23:25</span></span><br><span class="line"><span class="comment"># @Author  : KK</span></span><br><span class="line"><span class="comment"># @Link    : http://default.com</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###For Debian10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># find all the pdf files in current directory.</span></span><br><span class="line">    mypath = os.getcwd()</span><br><span class="line">    <span class="built_in">print</span>(mypath)</span><br><span class="line">    pattern = <span class="string">r&quot;\.pdf$&quot;</span></span><br><span class="line">    <span class="comment">#以下文件路径在debian10中适用</span></span><br><span class="line">    file_names_lst = [mypath + <span class="string">&#x27;/&#x27;</span>+f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(mypath) <span class="keyword">if</span> re.search(pattern, f, re.IGNORECASE) </span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> re.search(<span class="string">r&#x27;Merged.pdf&#x27;</span>,f)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># merge the file.</span></span><br><span class="line">    opened_file = [<span class="built_in">open</span>(file_name,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names_lst]</span><br><span class="line">    pdfFM = PyPDF2.PdfFileMerger()</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> opened_file:</span><br><span class="line">        pdfFM.append(file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># output the file.</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(mypath + <span class="string">&#x27;/&#x27;</span> +<span class="string">&quot;Merged.pdf&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> write_out_file:</span><br><span class="line">        pdfFM.write(write_out_file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># close all the input files.</span></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> opened_file:</span><br><span class="line">        file.close()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Python将PDF文件转成图片</title>
    <url>/2021/07/04/Python%E5%B0%86PDF%E6%96%87%E4%BB%B6%E8%BD%AC%E6%88%90%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2021-01-08 12:49:52</span></span><br><span class="line"><span class="comment"># @Author  : KY (owenyk@q.com)</span></span><br><span class="line"><span class="comment"># @Link    : http://example.org</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#安装fitz</span></span><br><span class="line"><span class="comment">#pip install fitz</span></span><br><span class="line"><span class="comment">#安装依赖PyMuPDF</span></span><br><span class="line"><span class="comment">#pip install PyMuPDF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> fitz</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pdf2png</span>(<span class="params">file_path, pic_path</span>):</span><br><span class="line">	doc = fitz.<span class="built_in">open</span>(file_path)  <span class="comment">#  打开PDF文件，生成一个对象</span></span><br><span class="line">	<span class="keyword">for</span> pg <span class="keyword">in</span> <span class="built_in">range</span>(doc.pageCount):  <span class="comment">#遍历pdf每一个页面</span></span><br><span class="line">	    page = doc[pg]</span><br><span class="line">	    rotate = <span class="built_in">int</span>(<span class="number">0</span>)   <span class="comment">#图片计数</span></span><br><span class="line"></span><br><span class="line">	   <span class="comment"># 每个尺寸的缩放系数为2，这将为我们生成分辨率提高四倍的图像。</span></span><br><span class="line">	    zoom_x = <span class="number">2.0</span>    <span class="comment">#x轴方向</span></span><br><span class="line">	    zoom_y = <span class="number">2.0</span>	<span class="comment">#y轴方向</span></span><br><span class="line">	    trans = fitz.Matrix(zoom_x, zoom_y).preRotate(rotate)</span><br><span class="line">	    pm = page.getPixmap(matrix=trans, alpha=<span class="literal">False</span>)  <span class="comment">#获取缩放后的图片</span></span><br><span class="line">	    <span class="comment">#pm.writePNG(&#x27;%s.png&#x27; % pg)</span></span><br><span class="line">	    img_name = <span class="string">&quot;img&#123;&#125;.png&quot;</span>.<span class="built_in">format</span>(rotate)         <span class="comment">#生成图片文件名</span></span><br><span class="line">	    pm.writePNG(os.path.join(pic_path,img_name))  <span class="comment">#写入图片文件</span></span><br><span class="line">	    <span class="built_in">print</span>(<span class="string">&#x27;%s.png 完成&#x27;</span> % pg)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:	</span><br><span class="line">	file_path = <span class="string">r&#x27;###.pdf&#x27;</span>  <span class="comment">#pdf文档路径</span></span><br><span class="line">	pic_path = <span class="string">&#x27;M:\\pic&#x27;</span>   <span class="comment">#图片路径</span></span><br><span class="line">	pdf2png(file_path, pic_path)</span><br></pre></td></tr></table></figure></p>
<p>如果不使用函数简化写法:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fitz</span><br><span class="line"></span><br><span class="line">file_path = <span class="string">r&#x27;###.pdf&#x27;</span>  <span class="comment">#pdf文档路径</span></span><br><span class="line">doc = fitz.<span class="built_in">open</span>(file_path)  <span class="comment">#  打开PDF文件，生成一个对象</span></span><br><span class="line"><span class="keyword">for</span> pg <span class="keyword">in</span> <span class="built_in">range</span>(doc.pageCount):  <span class="comment">#遍历pdf每一个页面</span></span><br><span class="line">    page = doc[pg]</span><br><span class="line">    rotate = <span class="built_in">int</span>(<span class="number">0</span>)   <span class="comment">#图片计数</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 每个尺寸的缩放系数为2，这将为我们生成分辨率提高四倍的图像。</span></span><br><span class="line">    zoom_x = <span class="number">2.0</span>    <span class="comment">#x轴方向</span></span><br><span class="line">    zoom_y = <span class="number">2.0</span>	<span class="comment">#y轴方向</span></span><br><span class="line">    trans = fitz.Matrix(zoom_x, zoom_y).preRotate(rotate)</span><br><span class="line">    pm = page.getPixmap(matrix=trans, alpha=<span class="literal">False</span>)  <span class="comment">#获取缩放后的图片</span></span><br><span class="line">    pm.writePNG(<span class="string">&#x27;%s.png&#x27;</span> % pg)</span><br><span class="line">    <span class="comment">#img_name = &quot;img&#123;&#125;.png&quot;.format(rotate)         #生成图片文件名</span></span><br><span class="line">    <span class="comment">#pm.writePNG(os.path.join(pic_path,img_name))  #写入图片文件</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%s.png 完成&#x27;</span> % pg)</span><br></pre></td></tr></table></figure></p>
<p>这样转换是会将整个pdf页面转成PNG图片，如需将页面中的部分转换图片可参照下面代码:  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fitz</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pdf2pic</span>(<span class="params">path, pic_path</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    # 从pdf中提取图片</span></span><br><span class="line"><span class="string">    :param path: pdf的路径</span></span><br><span class="line"><span class="string">    :param pic_path: 图片保存的路径</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 打开pdf</span></span><br><span class="line">    doc = fitz.<span class="built_in">open</span>(path)</span><br><span class="line">    nums = doc._getXrefLength()</span><br><span class="line">    imgcount = <span class="number">0</span> <span class="comment"># 图像计数</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment"># 遍历每一个对象</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, nums):</span><br><span class="line">        text = doc._getXrefString(i)</span><br><span class="line">        <span class="comment"># print(i, text)</span></span><br><span class="line">        <span class="comment"># 过滤无用图片</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;Width 2550&#x27;</span> <span class="keyword">in</span> text) <span class="keyword">and</span> (<span class="string">&#x27;Height 3300&#x27;</span> <span class="keyword">in</span> text) <span class="keyword">or</span> (<span class="string">&#x27;thumbnail&#x27;</span> <span class="keyword">in</span> text):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">	    <span class="comment"># 使用正则表达式来查找图片</span></span><br><span class="line">	    checkXO = <span class="string">r&quot;/Type(?= */XObject)&quot;</span></span><br><span class="line">	    checkIM = <span class="string">r&quot;/Subtype(?= */Image)&quot;</span></span><br><span class="line">	    </span><br><span class="line">        isXObject = re.search(checkXO, text)</span><br><span class="line">        isImage = re.search(checkIM, text)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 不符合条件, continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> isXObject <span class="keyword">or</span> <span class="keyword">not</span> isImage:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">		imgcount += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 生成图像</span></span><br><span class="line">        pix = fitz.Pixmap(doc, i)</span><br><span class="line">		</span><br><span class="line">		<span class="comment"># 保存图像名</span></span><br><span class="line">        img_name = <span class="string">&quot;img&#123;&#125;.png&quot;</span>.<span class="built_in">format</span>(imgcount)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果pix.n&lt;5,可以直接存为PNG</span></span><br><span class="line">        <span class="keyword">if</span> pix.n &lt; <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                pix.writePNG(os.path.join(pic_path, img_name))</span><br><span class="line">                pix = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                pix0 = fitz.Pixmap(fitz.csRGB, pix)</span><br><span class="line">                pix0.writePNG(os.path.join(pic_path, img_name))</span><br><span class="line">                pix0 = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># pdf路径</span></span><br><span class="line">    path = <span class="string">r&#x27;test.pdf&#x27;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment"># 保存的图片路径</span></span><br><span class="line">    pic_path = <span class="string">&#x27;img&#x27;</span></span><br><span class="line">    </span><br><span class="line">    pdf2pic(path, pic_path)</span><br></pre></td></tr></table></figure>
<p>转载于<a href="https://www.pythonf.cn/read/149123?ivk_sa=1024320u">Python使用Fitz库提取PDF格式的图像（适用于各种类型的PDF）,利用,fitz,pdf,中,图片,针对,多种类型
</a>   </p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Pdf</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian11下SublimeText3配置C语言环境</title>
    <url>/2021/11/09/Debian11%E4%B8%8BSublime%20Text%203%E9%85%8D%E7%BD%AEC%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、新建C语言编译系统"><a href="#1、新建C语言编译系统" class="headerlink" title="1、新建C语言编译系统"></a>1、新建<code>C语言编译系统</code></h1><p>依次打开：<code>工具</code>==&gt;<code>编译系统</code>==&gt;<code>新编译系统</code>(<code>Tools</code>-&gt;<code>Build System</code>-&gt;<code>New build System</code>)，输入一下内容<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> </span><br><span class="line">    <span class="attr">&quot;shell_cmd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gcc &#x27;$&#123;file&#125;&#x27; -o &#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27;&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;file_regex&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;working_dir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;file_path&#125;&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;source.c, source.c++&quot;</span><span class="punctuation">,</span> </span><br><span class="line">   </span><br><span class="line">    <span class="attr">&quot;variants&quot;</span><span class="punctuation">:</span> </span><br><span class="line">    <span class="punctuation">[</span> </span><br><span class="line">        <span class="punctuation">&#123;</span> </span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Build &amp; Run&quot;</span><span class="punctuation">,</span> </span><br><span class="line">            <span class="attr">&quot;shell_cmd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;x-terminal-emulator  -e bash -c \&quot;gcc &#x27;$&#123;file&#125;&#x27; -o &#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27; -lm; &#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27; ; read -p &#x27;\nPress ENTER or type command to continue...&#x27;\&quot;&quot;</span> </span><br><span class="line">            <span class="comment">// &quot;shell_cmd&quot;: &quot;g++ &#x27;$&#123;file&#125;&#x27; -o &#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27;; &#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27;&quot;   // 不打开终端直接输出结果</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span> </span><br><span class="line">   </span><br><span class="line">        <span class="punctuation">&#123;</span> </span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Build Only&quot;</span><span class="punctuation">,</span> </span><br><span class="line">            <span class="attr">&quot;shell_cmd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gcc &#x27;$&#123;file&#125;&#x27; -o &#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27;&quot;</span> </span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span> </span><br><span class="line">   </span><br><span class="line">        <span class="punctuation">&#123;</span> </span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Run Only&quot;</span><span class="punctuation">,</span> </span><br><span class="line">            <span class="attr">&quot;shell_cmd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;x-terminal-emulator  -e bash -c \&quot;&#x27;$&#123;file_path&#125;/$&#123;file_base_name&#125;&#x27; ; read -p &#x27;\nPress ENTER or type command to continue...&#x27;\&quot;&quot;</span> </span><br><span class="line">        <span class="punctuation">&#125;</span> </span><br><span class="line">    <span class="punctuation">]</span> </span><br><span class="line"><span class="punctuation">&#125;</span> </span><br></pre></td></tr></table></figure></p>
<h1 id="2、设置快捷键"><a href="#2、设置快捷键" class="headerlink" title="2、设置快捷键"></a>2、设置快捷键</h1><p>依次点击：<code>首选项</code>==&gt;<code>快捷键设置</code> ==&gt; <code>用户</code>（<code>Preferences</code>-&gt;<code>Key Buildings</code> -&gt; <code>User</code>）<br>添加以下内容：(一键编译并运行)<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> </span><br><span class="line">    <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f9&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> </span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;variant&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Build &amp; Run&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><br> 不设置快捷键，直接<code>ctrl+b</code>也可以输出。</p>
<h1 id="3、格式化插件coolformat"><a href="#3、格式化插件coolformat" class="headerlink" title="3、格式化插件coolformat"></a>3、格式化插件<code>coolformat</code></h1><p><code>CoolFormat</code>：简单好用的代码格式化工具，相当于简化版的Astyle，<br>快捷键<code>ctrl+shift+p</code>==&gt;<code>install package</code>安装<br>默认操作快捷键：<br><code>ctrl+alt+shift+q</code>格式化当前文件<br><code>ctrl+alt+shift+s</code>格式化当前选中。  </p>
<p>参考：<br>1、<a href="https://www.cnblogs.com/kearon/p/7354888.html">Ubuntu / Debian / Deepin等 Sublime Text 3 配置C++环境(一键编译&amp;运行，格式化代码</a><br>2、<a href="https://www.jianshu.com/p/b16800c4772f">使用SublimeTemp自定义C文件模板</a></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>软件应用</category>
        <category>Linux</category>
        <category>SublimeText3</category>
        <category>C语言</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>SublimeText3</tag>
        <tag>C语言环境</tag>
      </tags>
  </entry>
  <entry>
    <title>Python批量重命名</title>
    <url>/2020/12/20/Python%E6%89%B9%E9%87%8F%E9%87%8D%E5%91%BD%E5%90%8D/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2020-12-19 15:02:56</span></span><br><span class="line"><span class="comment"># @Author  : KY (xxxxxx@g.com)</span></span><br><span class="line"><span class="comment"># @Link    : http://example.org</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rename</span>():</span><br><span class="line">    name = <span class="string">&quot;p&quot;</span>;</span><br><span class="line">    count = <span class="number">0</span>;</span><br><span class="line">    path = <span class="string">&quot;F:\Pictures\Assets&quot;</span> <span class="comment">#文件所在路径</span></span><br><span class="line"></span><br><span class="line">    filelist = os.listdir(path) <span class="comment">#该文件夹下所有的文件（包括文件夹）</span></span><br><span class="line">    <span class="keyword">for</span> files <span class="keyword">in</span> filelist: <span class="comment">#遍历所有文件</span></span><br><span class="line">        Olddir = os.path.join(path,files) <span class="comment">#原来的文件路径</span></span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(Olddir): <span class="comment">#如果是文件夹就跳过</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        filename = os.path.splitext(files)[<span class="number">0</span>] <span class="comment">#文件名</span></span><br><span class="line">        filetype = os.path.splitext(files)[<span class="number">1</span>] <span class="comment">#扩展名</span></span><br><span class="line">        Newdir = os.path.join(path,<span class="built_in">str</span>(name)+<span class="built_in">str</span>(count)+filetype) <span class="comment">#新文件路径</span></span><br><span class="line">        os.rename(Olddir,Newdir) <span class="comment">#重新命名</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">rename()</span><br></pre></td></tr></table></figure>
<p>最终效果如图： <img src="/pic/2020/12/Python批量重命名.jpg" alt="重命名"></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>重命名</tag>
      </tags>
  </entry>
  <entry>
    <title>Python用request下载金庸小说</title>
    <url>/2019/12/12/Python%E7%94%A8request%E4%B8%8B%E8%BD%BD%E9%87%91%E5%BA%B8%E5%B0%8F%E8%AF%B4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2019-03-18 13:02:32</span></span><br><span class="line"><span class="comment"># @Author  : KK (xxxxx@xxxxx.com)</span></span><br><span class="line"><span class="comment"># @Link    : http://default.com</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> urllib.request  </span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment">#get book&#x27;s chapter</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_chapter</span>(<span class="params">url</span>):</span><br><span class="line">    html = urllib.request.urlopen(url)  </span><br><span class="line">    content = html.read().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    html.close()</span><br><span class="line">    soup = BeautifulSoup(content, <span class="string">&quot;lxml&quot;</span>)</span><br><span class="line">    title = soup.find(<span class="string">&#x27;h1&#x27;</span>).text    <span class="comment">#chapter title</span></span><br><span class="line">    text = soup.find(<span class="string">&#x27;div&#x27;</span>, <span class="built_in">id</span>=<span class="string">&#x27;htmlContent&#x27;</span>)    <span class="comment">#chapter content</span></span><br><span class="line">    <span class="comment">#processing the content to get nice style</span></span><br><span class="line">    content = text.get_text(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;br/&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\n    &#x27;</span>)</span><br><span class="line">    content = content.replace(<span class="string">&#x27;　　&#x27;</span>, <span class="string">&#x27;\n　　&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> title, <span class="string">&#x27;    &#x27;</span>+content</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    books = [<span class="string">&#x27;射雕英雄传&#x27;</span>,<span class="string">&#x27;天龙八部&#x27;</span>,<span class="string">&#x27;鹿鼎记&#x27;</span>,<span class="string">&#x27;神雕侠侣&#x27;</span>,<span class="string">&#x27;笑傲江湖&#x27;</span>,<span class="string">&#x27;碧血剑&#x27;</span>,<span class="string">&#x27;倚天屠龙记&#x27;</span>,\</span><br><span class="line">              <span class="string">&#x27;飞狐外传&#x27;</span>,<span class="string">&#x27;书剑恩仇录&#x27;</span>,<span class="string">&#x27;连城诀&#x27;</span>,<span class="string">&#x27;侠客行&#x27;</span>,<span class="string">&#x27;越女剑&#x27;</span>,<span class="string">&#x27;鸳鸯刀&#x27;</span>,<span class="string">&#x27;白马啸西风&#x27;</span>,\</span><br><span class="line">              <span class="string">&#x27;雪山飞狐&#x27;</span>]</span><br><span class="line">    order = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">9</span>]  <span class="comment">#order of books to scrapy</span></span><br><span class="line">     <span class="comment">#list to store each book&#x27;s scrapying range</span></span><br><span class="line">    page_range = [<span class="number">1</span>,<span class="number">43</span>,<span class="number">94</span>,<span class="number">145</span>,<span class="number">185</span>,<span class="number">225</span>,<span class="number">248</span>,<span class="number">289</span>,<span class="number">309</span>,<span class="number">329</span>,<span class="number">341</span>,<span class="number">362</span>,<span class="number">363</span>,<span class="number">364</span>,<span class="number">375</span>,<span class="number">385</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i,book <span class="keyword">in</span> <span class="built_in">enumerate</span>(books):</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(page_range[i],page_range[i+<span class="number">1</span>]):</span><br><span class="line">            url = <span class="string">&quot;http://jinyong.zuopinj.com/%s/%s.html&quot;</span>%(order[i],num)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                title, chapter = get_chapter(url)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;F://%s.txt&#x27;</span>%book, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;gb18030&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="built_in">print</span>(book+<span class="string">&#x27;:&#x27;</span>+title+<span class="string">&#x27;--&gt;写入成功！&#x27;</span>)</span><br><span class="line">                    f.write(title+<span class="string">&#x27;\n\n\n&#x27;</span>)</span><br><span class="line">                    f.write(chapter+<span class="string">&#x27;\n\n\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(e) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;全部写入完毕!&#x27;</span>) </span><br><span class="line">main()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Request</tag>
        <tag>BeautifulSoup</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian10备份与恢复MariaDB数据库</title>
    <url>/2019/12/29/Debian10%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8DMariaDB%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="一、利用mysqldump备份与恢复命令："><a href="#一、利用mysqldump备份与恢复命令：" class="headerlink" title="一、利用mysqldump备份与恢复命令："></a>一、利用<code>mysqldump</code>备份与恢复命令：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo mysqldump -uroot -p wpDB &gt; ~/mysql-wpDB.dump  //备份数据库名及保存路径</span><br><span class="line"></span><br><span class="line">$ sudo mysql -uroot  //进入数据库</span><br><span class="line">MariaDB [(none)]&gt; create database wpDBtest; //创建测试恢复数据库,单库备份需先创建该数据库</span><br><span class="line">$ mysql -uroot -p wpDBtest &lt; ~/mysql-wpDB.dump;  //恢复数据库</span><br></pre></td></tr></table></figure>
<p>注意：上诉备份方案存在一定的弊端如：用户正在执行数据操作时，数据则会丢失等情况。 </p>
<p>解决方案：  </p>
<h4 id="1》在备份数据库表加上锁，保证数据的完整性。"><a href="#1》在备份数据库表加上锁，保证数据的完整性。" class="headerlink" title="1》在备份数据库表加上锁，保证数据的完整性。"></a>1》在备份数据库表加上锁，保证数据的完整性。</h4><p><code>--lock-all-tables</code>:请求锁定所有表<br>实例：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ mysqldump --databases wpDBtest --lock-all-tables &gt;~/wpDBtest .sql </span><br></pre></td></tr></table></figure></p>
<p><code>--single-transaction</code>:单事务，能够对<code>innodb</code>存储引擎做热备 </p>
<p><code>--events</code>:备份事件调度器代码</p>
<p><code>--routines</code>:备份存储过程和存储函数</p>
<p><code>--triggers</code>:备份触发器 </p>
<p>备份时请求锁之后滚动日志：<code>--flush-logs</code></p>
<p>复制时同步位置标记：<code>--master-data=[0|1|2]</code></p>
<p>注意：恢复时需关闭二进制文件，恢复成功后则开启</p>
<p>关闭二进制日志：<code>set session sql_log_bin=0</code></p>
<p>开启二进制日志：<code>set session sql_log_bin=1</code></p>
<h4 id="2》锁表备份步骤："><a href="#2》锁表备份步骤：" class="headerlink" title="2》锁表备份步骤："></a>2》锁表备份步骤：</h4><h5 id="1-锁表并且给只读权限"><a href="#1-锁表并且给只读权限" class="headerlink" title="1)锁表并且给只读权限"></a>1)锁表并且给只读权限</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt;flush tables with read lock;</span><br></pre></td></tr></table></figure>
<h5 id="2-滚动日志"><a href="#2-滚动日志" class="headerlink" title="2)滚动日志"></a>2)滚动日志</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt;flush logs;</span><br></pre></td></tr></table></figure>
<h5 id="3-查看二进制日志信息"><a href="#3-查看二进制日志信息" class="headerlink" title="3)查看二进制日志信息"></a>3)查看二进制日志信息</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt;show master status; </span><br></pre></td></tr></table></figure>
<h5 id="4-使用mysqldump进行数据备份"><a href="#4-使用mysqldump进行数据备份" class="headerlink" title="4)使用mysqldump进行数据备份"></a>4)使用<code>mysqldump</code>进行数据备份</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ mysqldump --databases wpDBtest &gt;/tmp/wpDBtest.sql</span><br></pre></td></tr></table></figure>
<h5 id="5-备份完成之后则需解锁"><a href="#5-备份完成之后则需解锁" class="headerlink" title="5)备份完成之后则需解锁"></a>5)备份完成之后则需解锁</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt;unlock tables; </span><br></pre></td></tr></table></figure>
<p>命令行备份实例如下：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqldump -p --databases wpDBtest --lock-all-tables --flush-logs &gt;/home/yk/wpDBtest2.sql </span><br><span class="line">mysqldump -p --databases wpDBtest --single-trasaction --flush-logs &gt;~/wpDBtest3.sql </span><br><span class="line">mysqldump -p --databases wpDBtest --lock-all-tables --flush-logs --master-data=2 &gt;~/wpDBtest4.sql</span><br></pre></td></tr></table></figure></p>
<h3 id="2》查看恢复的数据"><a href="#2》查看恢复的数据" class="headerlink" title="2》查看恢复的数据"></a>2》查看恢复的数据</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo mysql -uroot  //进入数据库 </span><br><span class="line">$ use wpDBtest;   /选择查看数据库</span><br><span class="line">MariaDB [wpDBtest]&gt; select * from wp_options where option_name in(&quot;siteurl&quot;,&quot;home&quot;); //查看恢复信息</span><br></pre></td></tr></table></figure>
<h2 id="二、用二进制日志恢复命令："><a href="#二、用二进制日志恢复命令：" class="headerlink" title="二、用二进制日志恢复命令："></a>二、用二进制日志恢复命令：</h2><h3 id="1》开启binlog"><a href="#1》开启binlog" class="headerlink" title="1》开启binlog"></a>1》开启<code>binlog</code></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo vim /etc/alternatives/my.cnf  //添加如下内容，开启binlog</span><br><span class="line">[mysqld]</span><br><span class="line">log_bin=mysql-bin</span><br></pre></td></tr></table></figure>
<h3 id="2》-查看log-bin是否开启"><a href="#2》-查看log-bin是否开启" class="headerlink" title="2》//查看log_bin是否开启"></a>2》//查看<code>log_bin</code>是否开启</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt;  show variables like &#x27;log_bin&#x27;;</span><br></pre></td></tr></table></figure>
<p>//查看二进制<code>log</code>，<code>--no-defaults</code>避免出现字符问题错误<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo mysqlbinlog --no-defaults /var/lib/mysql/mysql-bin.000001;</span><br></pre></td></tr></table></figure></p>
<h3 id="3》测试过程"><a href="#3》测试过程" class="headerlink" title="3》测试过程"></a>3》测试过程</h3><h4 id="1、创建测试数据库并新增表和记录"><a href="#1、创建测试数据库并新增表和记录" class="headerlink" title="1、创建测试数据库并新增表和记录"></a>1、创建测试数据库并新增表和记录</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [wpDBtest]&gt; create database testDB;</span><br><span class="line">MariaDB [testDB]&gt; create table testtable (id int null, name varchar(255) null);</span><br><span class="line">MariaDB [(none)]&gt; source ~/wpDBtest-re.sql</span><br><span class="line">MariaDB [testDB]&gt; insert into testtable values(1,&quot;xiaoming&quot;);</span><br><span class="line">MariaDB [testDB]&gt; insert into testtable values(2,&quot;wang&quot;);</span><br><span class="line">MariaDB [testDB]&gt; insert into testtable values(3,&quot;王&quot;);</span><br></pre></td></tr></table></figure>
<h4 id="2、删除一条测试数据"><a href="#2、删除一条测试数据" class="headerlink" title="2、删除一条测试数据"></a>2、删除一条测试数据</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [testDB]&gt; delete from testtable where id =2;</span><br><span class="line">##MariaDB [testDB]&gt; delete from testtable;</span><br><span class="line">##Query OK, 5 rows affected (0.027 sec)</span><br><span class="line">MariaDB [testDB]&gt; select * from testtable; //显示如下：</span><br><span class="line">+------+----------+</span><br><span class="line">| id   | name     |</span><br><span class="line">+------+----------+</span><br><span class="line">|    1 | xiaoming |</span><br><span class="line">|    3 | 王       |</span><br><span class="line">+------+----------+</span><br><span class="line">2 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure>
<h4 id="3、导出二进制log为sql-database-testDB-指定导出数据库testDB的数据"><a href="#3、导出二进制log为sql-database-testDB-指定导出数据库testDB的数据" class="headerlink" title="3、导出二进制log为sql,--database=testDB 指定导出数据库testDB的数据"></a>3、导出二进制<code>log</code>为<code>sql</code>,<code>--database=testDB</code> 指定导出数据库<code>testDB</code>的数据</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo  mysqlbinlog --no-defaults --database=testDB /var/lib/mysql/mysql-bin.000001&gt;~/testDB.sql;</span><br></pre></td></tr></table></figure>
<h4 id="4、进入-文件夹，复制原数据并另存testDB-re-sql"><a href="#4、进入-文件夹，复制原数据并另存testDB-re-sql" class="headerlink" title="4、进入~/文件夹，复制原数据并另存testDB-re.sql"></a>4、进入<code>~/</code>文件夹，复制原数据并另存<code>testDB-re.sql</code></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ cp testDB.sql testDB-re.sql</span><br><span class="line">$ sudo vim testDB-re.sql  //打开sql文件，删除其中“delete from testtable where id =2”语句</span><br></pre></td></tr></table></figure>
<h4 id="5、进入mariadb，恢复数据"><a href="#5、进入mariadb，恢复数据" class="headerlink" title="5、进入mariadb，恢复数据"></a>5、进入<code>mariadb</code>，恢复数据</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MariaDB [testDB]&gt; source ~/testDB-re.sql</span><br><span class="line">MariaDB [testDB]&gt; select * from testtable;</span><br><span class="line">+------+----------+</span><br><span class="line">| id   | name     |</span><br><span class="line">+------+----------+</span><br><span class="line">|    1 | xiaoming |</span><br><span class="line">|    3 | 王       |</span><br><span class="line">|    1 | xiaoming |</span><br><span class="line">|    2 | wang     |</span><br><span class="line">|    3 | 王       |</span><br><span class="line">+------+----------+</span><br><span class="line">5 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure>
<p>关于<strong>前期基础介绍请参考</strong><br><a href="../../../../2021/08/17/Mariadb数据库增、删、改、查、备份及恢复/">Debian10下MariaDB/MySQL数据库增、删、改、查、备份及恢复</a></p>
<p>参考资料：<br><a href="https://blog.51cto.com/purify/1860516">mariadb二进制日志和备份恢复</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>运维</category>
        <category>MariaDB</category>
        <category>备份和恢复</category>
      </categories>
      <tags>
        <tag>Debian</tag>
        <tag>MariaDB</tag>
        <tag>备份</tag>
      </tags>
  </entry>
  <entry>
    <title>在Windows10上安装scoop</title>
    <url>/2022/03/07/Scoop%E5%AE%89%E8%A3%85%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="scoop安装"><a href="#scoop安装" class="headerlink" title="scoop安装"></a><code>scoop</code>安装</h1><p>设置<code>scoop</code>环境变量<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$env</span>:SCOOP=<span class="string">&#x27;D:\Applications\Scoop&#x27;</span></span><br><span class="line">[Environment]::SetEnvironmentVariable(<span class="string">&#x27;SCOOP&#x27;</span>,<span class="variable">$env</span>:SCOOP,<span class="string">&#x27;User&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<p>或者设置<code>scoop global</code> 环境变量<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$env</span>:SCOOP_GLOBAL=<span class="string">&#x27;D:\Applications\Scoop&#x27;</span></span><br><span class="line">[Environment]::SetEnvironmentVariable(<span class="string">&#x27;SCOOP_GLOBAL&#x27;</span>,<span class="variable">$env</span>:SCOOP_GLOBAL,<span class="string">&#x27;User&#x27;</span>)</span><br><span class="line">这个目录也是Scoop安装目录的默认目录（安装到当前用户），还可以修改全局安装的目录：</span><br><span class="line"><span class="variable">$env</span>:SCOOP_GLOBAL=<span class="string">&#x27;D:\GLOBALApplications\Scoop&#x27;</span></span><br><span class="line">[Environment]::SetEnvironmentVariable(<span class="string">&#x27;SCOOP_GLOBAL&#x27;</span>, <span class="variable">$env</span>:SCOOP_GLOBAL, <span class="string">&#x27;Machine&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<h1 id="安装命令"><a href="#安装命令" class="headerlink" title="安装命令"></a>安装命令</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> Invoke-Expression (New-Object System.Net.WebClient).DownloadString(<span class="string">&#x27;https://get.scoop.sh&#x27;</span>)</span><br><span class="line">Initializing...</span><br><span class="line">Downloading scoop...</span><br><span class="line">Extracting...</span><br><span class="line">Creating shim...</span><br><span class="line">Downloading main bucket...</span><br><span class="line">Extracting...</span><br><span class="line">Adding D:\Applications\Scoop\shims to your path.</span><br><span class="line"><span class="string">&#x27;lastupdate&#x27;</span> has been <span class="built_in">set</span> to <span class="string">&#x27;2022-03-07T17:56:17.3046949+08:00&#x27;</span></span><br><span class="line">Scoop was installed successfully!</span><br><span class="line">Type <span class="string">&#x27;scoop help&#x27;</span> <span class="keyword">for</span> instructions.</span><br><span class="line"><span class="comment">## 或者</span></span><br><span class="line">iwr -useb get.scoop.sh|iex</span><br></pre></td></tr></table></figure>
<h1 id="添加bucket"><a href="#添加bucket" class="headerlink" title="添加bucket"></a>添加<code>bucket</code></h1><p>本身的<code>main bucket</code>源很少，故增加新的一个较多的<code>bucket</code></p>
<h2 id="列出已知的bucket"><a href="#列出已知的bucket" class="headerlink" title="列出已知的bucket"></a>列出已知的<code>bucket</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop bucket known</span><br><span class="line">main</span><br><span class="line">extras</span><br><span class="line">versions</span><br><span class="line">nirsoft</span><br><span class="line">php</span><br><span class="line">nerd-fonts</span><br><span class="line">nonportable</span><br><span class="line">java</span><br><span class="line">games</span><br></pre></td></tr></table></figure>
<p>添加额外的<code>安装源</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop bucket add extras</span><br><span class="line">　　执行成功展示：</span><br><span class="line"></span><br><span class="line">Checking repo... ok</span><br><span class="line">The extras bucket was added successfully.</span><br></pre></td></tr></table></figure></p>
<h1 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h1><h2 id="安装软件-1"><a href="#安装软件-1" class="headerlink" title="安装软件"></a>安装软件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop install -g [app的名称]</span><br><span class="line"><span class="comment">## 我这里-g 需要admin权限，取消-g可安装</span></span><br></pre></td></tr></table></figure>
<p>如：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop install 7zip</span><br><span class="line">WARN  Purging previous failed installation of 7zip.</span><br><span class="line">Uninstalling <span class="string">&#x27;7zip&#x27;</span> ().</span><br><span class="line"><span class="string">&#x27;7zip&#x27;</span> was uninstalled.</span><br><span class="line">Installing <span class="string">&#x27;7zip&#x27;</span> (21.07) [64bit]</span><br><span class="line">7z2107-x64.msi (1.8 MB) [===================================] 100%</span><br><span class="line">Checking <span class="built_in">hash</span> of 7z2107-x64.msi ... ok.</span><br><span class="line">Extracting 7z2107-x64.msi ... <span class="keyword">done</span>.</span><br><span class="line">Running pre-install script...</span><br><span class="line">op\apps\7zip\21.07</span><br><span class="line">Creating shortcut <span class="keyword">for</span> 7-Zip (7zFM.exe)</span><br><span class="line">Persisting Codecs</span><br><span class="line">Persisting Formats</span><br><span class="line"><span class="string">&#x27;7zip&#x27;</span> (21.07) was installed successfully!</span><br><span class="line">Notes</span><br><span class="line"><span class="string">&quot;D:\Applications\Scoop\apps\7zip\current\install-context.reg&quot;</span></span><br><span class="line">输入以下命令可将7zip添加到右键</span><br><span class="line">D:\Applications\Scoop\apps\7zip\current\install-context.reg</span><br><span class="line">也可以打开“D:\Applications\Scoop\apps\7zip\21.07”文件夹里面的</span><br><span class="line">7zFM.exe</span><br></pre></td></tr></table></figure><br>在<code>工具--&gt;选项--&gt;7-zip</code>选中添加到”<code>右键</code>“</p>
]]></content>
      <categories>
        <category>运维</category>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Scoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Aria2在Debian11下的配置</title>
    <url>/2021/08/25/Aria2%E5%9C%A8Debian11%E4%B8%8B%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、aria2的安装"><a href="#一、aria2的安装" class="headerlink" title="一、aria2的安装"></a>一、<code>aria2</code>的安装</h1><h2 id="（一）安装aria2命令："><a href="#（一）安装aria2命令：" class="headerlink" title="（一）安装aria2命令："></a>（一）安装<code>aria2</code>命令：</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt update</span><br><span class="line">$ sudo apt upgrade</span><br><span class="line">$ sudo apt install aria2</span><br></pre></td></tr></table></figure>
<h2 id="（二）配置aria2命令："><a href="#（二）配置aria2命令：" class="headerlink" title="（二）配置aria2命令："></a>（二）配置<code>aria2</code>命令：</h2><h3 id="1、设置aria2c配置文件"><a href="#1、设置aria2c配置文件" class="headerlink" title="1、设置aria2c配置文件"></a>1、设置<code>aria2c</code>配置文件</h3><p><code>sudo vim /root/aria2/aria2.conf</code></p>
<p>输入以下基本配置：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dir=~/下载/aria2Download </span><br><span class="line">disable-ipv6=true </span><br><span class="line">enable-rpc=true </span><br><span class="line">rpc-allow-origin-all=true </span><br><span class="line">rpc-listen-all=true </span><br><span class="line">rpc-listen-port=9800 </span><br><span class="line">rpc-secret=123456 </span><br><span class="line">continue=true </span><br><span class="line">input-file=~/文档/aria2/aria2.session </span><br><span class="line">save-session=~/文档/aria2/aria2.session </span><br><span class="line">max-concurrent-downloads=5 </span><br><span class="line">max-connection-per-server=16</span><br></pre></td></tr></table></figure></p>
<p>其中 <code>dir</code> 为下载目录；<br><code>rpc-listen-port</code> 为监听端口，随后配置 <code>WebUI</code>  时需要用到，可以任意设置；<br><code>rpc-secret</code> 为口令，同样用于 <code>WebUI</code> 中；<br>而 <code>input-file</code> 和 <code>save-session</code> 分别用于读取和保存断点续传信息。<br>在第一次安装后需要手动创建这个自动保存文件。</p>
<h2 id="2、设置aria2c开机启动"><a href="#2、设置aria2c开机启动" class="headerlink" title="2、设置aria2c开机启动"></a>2、设置<code>aria2c</code>开机启动</h2><h3 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h3><p>保存好之后，我们打开 <code>/etc/rc.local</code> ，在 <code>exit 0</code> 之前添加一行命令用于开机启动 <code>Aria2</code>（<strong>-D参数后台运行</strong>）：</p>
<h4 id="（1）手工添加一个-etc-rc-local-文件"><a href="#（1）手工添加一个-etc-rc-local-文件" class="headerlink" title="（1）手工添加一个 /etc/rc.local 文件"></a>（1）手工添加一个 <code>/etc/rc.local</code> 文件</h4><p>因为<code>debian11</code>没有这项目录需要新建并运行，参考以下内容：<br>由于某些软件并没有增加开启启动的服务，很多时候需要手工添加，一般我们都是推荐添加命令到 <code>/etc/rc.local</code>文件，<br>但是<code>Debian 9</code>默认不带<code>/etc/rc.local</code>文件，而<code>rc.local</code>服务却还是自带的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cat</span> /lib/systemd/system/rc.local.service` </span><br></pre></td></tr></table></figure>
<p>//查看<code>rc.local</code>服务，会显示存在</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl status rc-local`   </span><br></pre></td></tr></table></figure>
<p>//查询状态看到默认关闭的</p>
<p>为了解决这个问题，我们需要手工添加一个 <code>/etc/rc.local</code> 文件,输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;/etc/rc.local</span></span><br></pre></td></tr></table></figure><br>输入以下内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh -e</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># rc.local</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This script is executed at the end of each multiuser runlevel.</span></span><br><span class="line"><span class="comment"># Make sure that the script will &quot;exit 0&quot; on success or any other</span></span><br><span class="line"><span class="comment"># value on error.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># In order to enable or disable this script just change the execution</span></span><br><span class="line"><span class="comment"># bits.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># By default this script does nothing.</span></span><br><span class="line"></span><br><span class="line">/usr/bin/aria2c --conf-path=/root/aria2/aria2.conf -D</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<h4 id="（2）保存后，赋权限，命令："><a href="#（2）保存后，赋权限，命令：" class="headerlink" title="（2）保存后，赋权限，命令："></a>（2）保存后，赋权限，命令：</h4><p><code># chmod +x /etc/rc.local</code></p>
<h4 id="（3）接着启动-rc-local-服务"><a href="#（3）接着启动-rc-local-服务" class="headerlink" title="（3）接着启动 rc-local 服务"></a>（3）接着启动 <code>rc-local</code> 服务</h4><p><code># systemctl start rc-local    //启动</code></p>
<p><code># systemctl status rc-local   //查询状态</code></p>
<p>以上内容参考：[<a href="https://www.cnblogs.com/flymeng/p/7901062.html">Debian 9.x “stretch” 解决 /etc/rc.local 开机启动问题</a>]:</p>
<h3 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h3><p>设置开机启动并通过脚本控制<code>aria2c</code>重启/停止/查看状态</p>
<h4 id="（1）建立脚本文件，路径是-etc-init-d-aria2c"><a href="#（1）建立脚本文件，路径是-etc-init-d-aria2c" class="headerlink" title="（1）建立脚本文件，路径是/etc/init.d/aria2c"></a>（1）建立脚本文件，路径是<code>/etc/init.d/aria2c</code></h4><p>命令：<br><code>$ sudo vim /etc/init.d/aria2c</code><br>输入以下内容并保存[<code>aria2</code>配置的路径根据自己文件路径配置]：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">### BEGIN INIT INFO</span></span><br><span class="line"><span class="comment"># Provides: aria2</span></span><br><span class="line"><span class="comment"># Required-Start: $remote_fs $network</span></span><br><span class="line"><span class="comment"># Required-Stop: $remote_fs $network</span></span><br><span class="line"><span class="comment"># Default-Start: 2 3 4 5</span></span><br><span class="line"><span class="comment"># Default-Stop: 0 1 6</span></span><br><span class="line"><span class="comment"># Short-Description: Aria2 Downloader</span></span><br><span class="line"><span class="comment">### END INIT INFO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line"></span><br><span class="line"> <span class="built_in">echo</span> -n <span class="string">&quot;已开启Aria2c&quot;</span></span><br><span class="line"> aria2c --conf-path=/root/aria2/aria2.conf -D</span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line"></span><br><span class="line"> <span class="built_in">echo</span> -n <span class="string">&quot;已关闭Aria2c&quot;</span></span><br><span class="line"> killall aria2c</span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line"></span><br><span class="line"> killall aria2c</span><br><span class="line">sudo -u pi aria2c --conf-path=/root/aria2/aria2.conf -D</span><br><span class="line"><span class="comment">#sudo -u后面的是你正在使用的用户名，用debian的是pi（没改用户的话）</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<h4 id="（2）授权："><a href="#（2）授权：" class="headerlink" title="（2）授权："></a>（2）授权：</h4><p>命令：<br>  <code>$ sudo chmod 755 /etc/init.d/aria2c</code></p>
<h4 id="（3）将aria2c服务添加到开机启动"><a href="#（3）将aria2c服务添加到开机启动" class="headerlink" title="（3）将aria2c服务添加到开机启动"></a>（3）将<code>aria2c</code>服务添加到开机启动</h4><p>更新启动脚本命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-rc.d aria2c defaults</span><br></pre></td></tr></table></figure><br>启动、停止、查询状态命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ systemctl start/stop aria2c   <span class="comment">##启动/停止aria2c</span></span><br><span class="line">$ systemctl status aria2c       <span class="comment">##查询程序运行情况</span></span><br></pre></td></tr></table></figure></p>
<h3 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /lib/systemd/system/aria2@.service</span><br></pre></td></tr></table></figure>
<p>输入以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">    Description=Aria2 Service for %i.</span><br><span class="line">    After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">    #PIDFile=/run/aria2.pid</span><br><span class="line">    User=%i</span><br><span class="line">    ExecStart=/usr/bin/aria2c -c --conf-path=/home/%i/.aria2/aria2/aria2.conf # 注意使用自己的路径和文件名</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">    WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><br>然后输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> aria2@.service</span><br></pre></td></tr></table></figure><br>即可开机启动。<br>其他命令：<br><strong><code>user</code></strong>是登录的用户名<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl start/stop aria2@user  <span class="comment">##启动/停止aria2</span></span><br><span class="line">sudo systemctl status aria2@user       <span class="comment">##查询程序运行情况</span></span><br></pre></td></tr></table></figure></p>
<h2 id="（三）安装aria2-WebUI"><a href="#（三）安装aria2-WebUI" class="headerlink" title="（三）安装aria2 WebUI"></a>（三）安装<code>aria2 WebUI</code></h2><h3 id="1、安装nodejs，git。"><a href="#1、安装nodejs，git。" class="headerlink" title="1、安装nodejs，git。"></a>1、安装<code>nodejs</code>，<code>git</code>。</h3><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install nodejs npm</span><br></pre></td></tr></table></figure><br>或者参照<a href="https://github.com/nodesource/distributions#debinstall">安装说明</a>:安装 <code>Node.js v16.x:</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Using Ubuntu</span></span><br><span class="line">curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -</span><br><span class="line">sudo apt-get install -y nodejs</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using Debian, as root</span></span><br><span class="line">curl -fsSL https://deb.nodesource.com/setup_16.x | bash -</span><br><span class="line">apt-get install -y nodejs</span><br></pre></td></tr></table></figure></p>
<h4 id="2、-安装n模块"><a href="#2、-安装n模块" class="headerlink" title="2、 安装n模块"></a>2、 安装<code>n</code>模块</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo npm install -g n</span><br><span class="line">added 1 package, and audited 2 packages <span class="keyword">in</span> 6s</span><br><span class="line"></span><br><span class="line">found 0 vulnerabilities</span><br><span class="line">npm notice </span><br><span class="line">npm notice New minor version of npm available! 7.20.3 -&gt; 7.21.0</span><br><span class="line">npm notice Changelog: https://github.com/npm/cli/releases/tag/v7.21.0</span><br><span class="line">npm notice Run npm install -g npm@7.21.0 to update!</span><br><span class="line">npm notice </span><br><span class="line">$ sudo n stable</span><br><span class="line">  installing : node-v14.17.5</span><br><span class="line">       <span class="built_in">mkdir</span> : /usr/local/n/versions/node/14.17.5</span><br><span class="line">       fetch : https://nodejs.org/dist/v14.17.5/node-v14.17.5-linux-x64.tar.xz</span><br><span class="line">   installed : v14.17.5 (with npm 6.14.14)</span><br><span class="line"></span><br><span class="line">Note: the node <span class="built_in">command</span> changed location and the old location may be remembered <span class="keyword">in</span> your current shell.</span><br><span class="line">	 old : /usr/bin/node</span><br><span class="line">	 new : /usr/local/bin/node</span><br><span class="line">To reset the <span class="built_in">command</span> location <span class="built_in">hash</span> either start a new shell, or execute PATH=<span class="string">&quot;<span class="variable">$PATH</span>&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="3、接着安装git："><a href="#3、接着安装git：" class="headerlink" title="3、接着安装git："></a>3、接着安装<code>git</code>：</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install git`</span><br></pre></td></tr></table></figure>
<h4 id="4、新建WebUI网站目录"><a href="#4、新建WebUI网站目录" class="headerlink" title="4、新建WebUI网站目录"></a>4、新建<code>WebUI</code>网站目录</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/www/html/nginx-web/aira2  </span><br></pre></td></tr></table></figure>
<p>进入目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/www/html/nginx-web/aira2`</span><br></pre></td></tr></table></figure>
<p>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/ziahamza/webui-aria2.git</span><br><span class="line"><span class="built_in">cd</span> webui-aria2</span><br><span class="line"><span class="built_in">mv</span> * ..</span><br></pre></td></tr></table></figure></p>
<p>文件下载下来并移动到<code>aria2</code>目录后，<br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/www/html/nginx-web/aira2</span><br><span class="line">sudo node node-server.js</span><br></pre></td></tr></table></figure></p>
<p>提示以下语句：<br>  <code>WebUI Aria2 Server is running on http://localhost:8888</code><br><strong>[启动WebUI路径：<code>~/www/html/nginx-web/aira2/node-server.js</code>]</strong></p>
<h4 id="5、-完成安装"><a href="#5、-完成安装" class="headerlink" title="5、 完成安装"></a>5、 完成安装</h4><p>打开浏览器，输入以上网址：<code>http://localhost:8888</code><br><code>设置</code>—&gt;<code>连接设置</code>—&gt;<code>PRC端口：6800</code>—&gt;<code>密码令牌（可选）:123456</code><br>安装完成。</p>
<h1 id="二、aria2的配置"><a href="#二、aria2的配置" class="headerlink" title="二、aria2的配置"></a>二、<code>aria2</code>的配置</h1><p>修改<code>aria2.conf</code>内容,输入以下命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /opt/aria2/aria2.conf </span><br></pre></td></tr></table></figure><br>替换为以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">##aria2.conf设置###</span><br><span class="line"># 下载文件默认保存路径</span><br><span class="line">dir=~/下载/aria2/</span><br><span class="line"></span><br><span class="line"># 日志文件保存路径及级别</span><br><span class="line">log=~/文档/aria2/aria2.log</span><br><span class="line">log-level=error</span><br><span class="line"></span><br><span class="line"># 从会话中读取任务</span><br><span class="line">input-file=~/文档/aria2/aria2.session</span><br><span class="line"></span><br><span class="line"># 在Aria2退出时保存`错误/未完成`的下载任务到会话文件</span><br><span class="line">save-session=~/文档/aria2/aria2.session</span><br><span class="line">#配置dht.dat文件存放位置</span><br><span class="line">dht-file-path=~/文档/aria2/dht.dat</span><br><span class="line"># 定时保存会话, 0为退出时才保存, 需1.16.1以上版本, 默认:0</span><br><span class="line">save-session-interval=60</span><br><span class="line"># 强制保存会话, 即使任务已经完成, 默认:false</span><br><span class="line"># 较新的版本开启后会在任务完成后依然保留.aria2文件</span><br><span class="line">force-save=true</span><br><span class="line"></span><br><span class="line"># 下载选项</span><br><span class="line"># 最大同时下载任务数, 运行时可修改, 默认:5</span><br><span class="line">max-concurrent-downloads=5</span><br><span class="line"># 断点续传</span><br><span class="line">continue=true</span><br><span class="line"># 整体下载速度限制, 运行时可修改, 默认:0 </span><br><span class="line">max-overall-download-limit=5M</span><br><span class="line"># 单个任务下载速度限制, 默认:0</span><br><span class="line">max-download-limit=10M</span><br><span class="line"># 整体上传速度限制, 运行时可修改, 默认:0</span><br><span class="line">max-overall-upload-limit=1K</span><br><span class="line"># 单个任务上传速度限制, 默认:0</span><br><span class="line">max-upload-limit=1K</span><br><span class="line"></span><br><span class="line"># Http/FTP 选项</span><br><span class="line"># 连接超时，建立链接后失效</span><br><span class="line">connect-timeout=120</span><br><span class="line"># 最小速度限制</span><br><span class="line"># 当下载速度低于此选项设置的值(B/s) 时将会关闭连接. 0 表示不设置最小速度限制. </span><br><span class="line">lowest-speed-limit=1K</span><br><span class="line"># 同一服务器连接数, 添加时可指定, 默认:1,范围1-16</span><br><span class="line">max-connection-per-server=15</span><br><span class="line"># 文件未找到重试次数</span><br><span class="line"># 设置为 0 将会禁用此选项</span><br><span class="line">max-file-not-found=0</span><br><span class="line"># 最小文件分片大小, 添加时可指定, 取值范围1M -1024M, 默认:20M</span><br><span class="line"># 假定size=10M, 文件为20MiB 则使用两个来源下载; 文件为15MiB 则使用一个来源下载</span><br><span class="line">min-split-size=10M</span><br><span class="line"># 单个任务最大线程数, 添加时可指定, 默认:5</span><br><span class="line">split=5</span><br><span class="line"># 检查证书</span><br><span class="line">check-certificate=false</span><br><span class="line"># 禁用缓存</span><br><span class="line">http-no-cache=true</span><br><span class="line"># 磁盘缓存</span><br><span class="line"># 如果设置为 0, 将禁用磁盘缓存. 此功能将下载的数据缓存在内存中</span><br><span class="line"># 最多占用此选项设置的字节数. </span><br><span class="line">disk-cache=32M</span><br><span class="line"></span><br><span class="line"># FTP Specific Options</span><br><span class="line"># BT/PT Setting</span><br><span class="line"># 本地节点查找, PT需要禁用, 默认:false</span><br><span class="line">bt-enable-lpd=false</span><br><span class="line">#最大连接节点数</span><br><span class="line">#设置每个BT下载的最大连接节点数. 0 表示不限制.</span><br><span class="line">bt-max-peers=100</span><br><span class="line"># 自动BT任务</span><br><span class="line">follow-torrent=true</span><br><span class="line"># 启用 DHT (IPv6)</span><br><span class="line"># 启用 IPv6 DHT 功能. 如果种子设置为私有, 即使此选项设置为&quot;是&quot;, aria2 也不会启用</span><br><span class="line">enable-dht6=true</span><br><span class="line">enable-dht=true</span><br><span class="line">dht-listen-port=6881-6999</span><br><span class="line"></span><br><span class="line"># 不检查已经下载的文件</span><br><span class="line"># 不检查之前下载文件中每个分片的哈希值.</span><br><span class="line">bt-seed-unverified=false</span><br><span class="line"># 做种前检查文件哈希</span><br><span class="line"># 如果设置为&quot;是&quot;, 当使用 --check-integrity 选项完成哈希检查及文件完成后才继续做种. 如果您希望仅当文件损坏或未完成时检查文件, 请设置为&quot;否&quot;. 此选项仅对 BT 下载有效</span><br><span class="line">bt-hash-check-seed=false</span><br><span class="line"></span><br><span class="line"># 保存上传的种子文件</span><br><span class="line">rpc-save-upload-metadata=true</span><br><span class="line"># 删除未选择的文件</span><br><span class="line"># 当 BT 任务完成后删除未选择的文件. 要选择需要下载的文件, 请使用 --select-file选项. </span><br><span class="line"># 如果没有选择, 则所有文件都默认为需要下载. 此选项会从磁盘上直接删除文件, </span><br><span class="line"># 请谨慎使用此选项.</span><br><span class="line">bt-remove-unselected-file=false</span><br><span class="line"></span><br><span class="line"># 每个种子限速, 对少种的PT很有用, 默认:50K</span><br><span class="line">bt-request-peer-speed-limit=2M</span><br><span class="line">#做种时间</span><br><span class="line">seed-time=0</span><br><span class="line">#优先下载</span><br><span class="line">bt-prioritize-piece=head=10M</span><br><span class="line"># 当种子的分享率达到这个数时, 自动停止做种, 0为一直做种, 默认:1.0</span><br><span class="line">seed-ratio=1.0</span><br><span class="line"></span><br><span class="line"># Metalink Specific Options</span><br><span class="line"></span><br><span class="line"># RPC Options</span><br><span class="line"># 启用RPC, 默认:false</span><br><span class="line">enable-rpc=true</span><br><span class="line"># 种子文件下载完后暂停</span><br><span class="line">pause-metadata=false</span><br><span class="line">#种子交换, PT需要禁用, 默认:true</span><br><span class="line">enable-peer-exchange=false</span><br><span class="line"># 允许所有来源, 默认:false</span><br><span class="line">rpc-allow-origin-all=true</span><br><span class="line"># 允许非外部访问, 默认:false</span><br><span class="line">rpc-listen-all=true</span><br><span class="line">#保存上传的种子文件</span><br><span class="line">rpc-save-upload-metadata=true</span><br><span class="line"># 启用加密后 RPC 服务需要使用 https 或者 wss 协议连接</span><br><span class="line">rpc-secure=false</span><br><span class="line"></span><br><span class="line"># Advanced Options</span><br><span class="line">#启用后台进程</span><br><span class="line">daemon=true</span><br><span class="line"># 禁用IPV6，默认：false</span><br><span class="line">disable-ipv6=true</span><br><span class="line"># 启用 MMap</span><br><span class="line"># 内存中存放映射文件. 当文件空间没有预先分配至, 此选项无效. 参见 --file-allocation.</span><br><span class="line">enable-mmap=true</span><br><span class="line"># 文件分配方法  </span><br><span class="line"># &quot;prealloc&quot;会在下载开始前预先分配空间.</span><br><span class="line"># ext4 (带扩展支持), btrfs, xfs 或 NTFS (仅 MinGW 构建), &quot;falloc&quot; 是最好的选择</span><br><span class="line">file-allocation=falloc </span><br><span class="line">#最多下载结果 下载结果包括已完成/错误/已删除的下载</span><br><span class="line">max-download-result=30</span><br><span class="line"># 文件分配限制</span><br><span class="line"># 不对比此参数设置大小小的分配文件. 您可以增加数值的单位 K 或 M </span><br><span class="line">#no-file-allocation-limit=32M</span><br><span class="line"># 强制顺序</span><br><span class="line">force-sequential=true</span><br><span class="line"># 启用参数化 URI 支持</span><br><span class="line"># 您可以指定部分的集合: http://&#123;sv1,sv2,sv3&#125;/foo.iso. </span><br><span class="line"># 同时您也可以使用步进计数器指定数字化的序列: http://host/image[000-100:2].img. </span><br><span class="line"># [需使用 -z 选项]</span><br><span class="line"># 步进计数器可以省略.</span><br><span class="line">parameterized-uri=true</span><br><span class="line">#延迟加载</span><br><span class="line">deferred-input=true</span><br><span class="line"># bt-tracker=BT服务器（多个服务器之间用,分开）</span><br><span class="line">bt-tracker=udp://tracker.coppersurfer.tk:6969/announc,udp://tracker.leechers-paradise.org:6969/announc,udp://tracker.opentrackr.org:1337/announc,udp://p4p.arenabg.com:1337/announc,udp://9.rarbg.to:2710/announc,udp://9.rarbg.me:2710/announc,udp://exodus.desync.com:6969/announc,udp://tracker.pomf.se:80/announc,udp://tracker.openbittorrent.com:80/announc,udp://tracker.tiny-vps.com:6969/announc,udp://open.stealth.si:80/announc,udp://denis.stalker.upeer.me:6969/announc,udp://tracker.torrent.eu.org:451/announc,udp://tracker.moeking.me:6969/announc,udp://tracker.cyberia.is:6969/announc,udp://ipv4.tracker.harry.lu:80/announc,udp://tracker3.itzmx.com:6961/announc,udp://open.demonii.si:1337/announc,udp://explodie.org:6969/announc,udp://valakas.rollo.dnsabr.com:2710/announe</span><br></pre></td></tr></table></figure></p>
<h1 id="三、一些脚本处理"><a href="#三、一些脚本处理" class="headerlink" title="三、一些脚本处理"></a>三、一些脚本处理</h1><h2 id="1、新建tracker-sh更新脚本"><a href="#1、新建tracker-sh更新脚本" class="headerlink" title="1、新建tracker.sh更新脚本"></a>1、新建<code>tracker.sh</code>更新脚本</h2><p>更新配置文件<code>aria2.conf</code>里的<code>tracker</code>.  </p>
<p>输入命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /opt/aria2/tracker.sh</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2018-2020 P3TERX &lt;https://p3terx.com&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is free software, licensed under the MIT License.</span></span><br><span class="line"><span class="comment"># See /LICENSE for more information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># https://github.com/P3TERX/aria2.conf</span></span><br><span class="line"><span class="comment"># File name：tracker.sh</span></span><br><span class="line"><span class="comment"># Description: Get BT trackers and add to Aria2</span></span><br><span class="line"><span class="comment"># Version: 3.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># BT tracker is provided by the following project.</span></span><br><span class="line"><span class="comment"># https://github.com/XIU2/TrackersListCollection</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Fallback URLs provided by jsDelivr</span></span><br><span class="line"><span class="comment"># https://www.jsdelivr.com</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">RED_FONT_PREFIX=<span class="string">&quot;\033[31m&quot;</span></span><br><span class="line">GREEN_FONT_PREFIX=<span class="string">&quot;\033[32m&quot;</span></span><br><span class="line">YELLOW_FONT_PREFIX=<span class="string">&quot;\033[1;33m&quot;</span></span><br><span class="line">LIGHT_PURPLE_FONT_PREFIX=<span class="string">&quot;\033[1;35m&quot;</span></span><br><span class="line">FONT_COLOR_SUFFIX=<span class="string">&quot;\033[0m&quot;</span></span><br><span class="line">INFO=<span class="string">&quot;[<span class="variable">$&#123;GREEN_FONT_PREFIX&#125;</span>INFO<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>]&quot;</span></span><br><span class="line">ERROR=<span class="string">&quot;[<span class="variable">$&#123;RED_FONT_PREFIX&#125;</span>ERROR<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>]&quot;</span></span><br><span class="line">ARIA2_CONF=<span class="variable">$&#123;1:-aria2.conf&#125;</span></span><br><span class="line">DOWNLOADER=<span class="string">&quot;curl -fsSL --connect-timeout 3 --max-time 3 --retry 2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DATE_TIME</span></span>() &#123;</span><br><span class="line">    <span class="built_in">date</span> +<span class="string">&quot;%m/%d %H:%M:%S&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">GET_TRACKERS</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Get BT trackers ...&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -z <span class="string">&quot;<span class="variable">$&#123;CUSTOM_TRACKER_URL&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        TRACKER=$(</span><br><span class="line">            <span class="variable">$&#123;DOWNLOADER&#125;</span> https://trackerslist.com/all_aria2.txt ||</span><br><span class="line">                <span class="variable">$&#123;DOWNLOADER&#125;</span> https://cdn.jsdelivr.net/gh/XIU2/TrackersListCollection@master/all_aria2.txt ||</span><br><span class="line">                <span class="variable">$&#123;DOWNLOADER&#125;</span> https://trackers.p3terx.com/all_aria2.txt</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        TRACKER=$(<span class="variable">$&#123;DOWNLOADER&#125;</span> <span class="variable">$&#123;CUSTOM_TRACKER_URL&#125;</span> | awk NF | sed <span class="string">&quot;:a;N;s/\n/,/g;ta&quot;</span>)</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    [[ -z <span class="string">&quot;<span class="variable">$&#123;TRACKER&#125;</span>&quot;</span> ]] &amp;&amp; &#123;</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Unable to get trackers, network failure or invalid links.&quot;</span> &amp;&amp; <span class="built_in">exit</span> 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ECHO_TRACKERS</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;</span></span><br><span class="line"><span class="string">--------------------[BitTorrent Trackers]--------------------</span></span><br><span class="line"><span class="string"><span class="variable">$&#123;TRACKER&#125;</span></span></span><br><span class="line"><span class="string">--------------------[BitTorrent Trackers]--------------------</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ADD_TRACKERS</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Adding BT trackers to Aria2 configuration file <span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span><span class="variable">$&#123;ARIA2_CONF&#125;</span><span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> ...&quot;</span> &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -f <span class="variable">$&#123;ARIA2_CONF&#125;</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> &#x27;<span class="variable">$&#123;ARIA2_CONF&#125;</span>&#x27; does not exist.&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        [ -z $(grep <span class="string">&quot;bt-tracker=&quot;</span> <span class="variable">$&#123;ARIA2_CONF&#125;</span>) ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;bt-tracker=&quot;</span> &gt;&gt;<span class="variable">$&#123;ARIA2_CONF&#125;</span></span><br><span class="line">        sed -i <span class="string">&quot;s@^\(bt-tracker=\).*@\1<span class="variable">$&#123;TRACKER&#125;</span>@&quot;</span> <span class="variable">$&#123;ARIA2_CONF&#125;</span> &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> BT trackers successfully added to Aria2 configuration file !&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ADD_TRACKERS_RPC</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;RPC_SECRET&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        RPC_PAYLOAD=<span class="string">&#x27;&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.changeGlobalOption&quot;,&quot;id&quot;:&quot;P3TERX&quot;,&quot;params&quot;:[&quot;token:&#x27;</span><span class="variable">$&#123;RPC_SECRET&#125;</span><span class="string">&#x27;&quot;,&#123;&quot;bt-tracker&quot;:&quot;&#x27;</span><span class="variable">$&#123;TRACKER&#125;</span><span class="string">&#x27;&quot;&#125;]&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        RPC_PAYLOAD=<span class="string">&#x27;&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.changeGlobalOption&quot;,&quot;id&quot;:&quot;P3TERX&quot;,&quot;params&quot;:[&#123;&quot;bt-tracker&quot;:&quot;&#x27;</span><span class="variable">$&#123;TRACKER&#125;</span><span class="string">&#x27;&quot;&#125;]&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    curl <span class="string">&quot;<span class="variable">$&#123;RPC_ADDRESS&#125;</span>&quot;</span> -fsSd <span class="string">&quot;<span class="variable">$&#123;RPC_PAYLOAD&#125;</span>&quot;</span> || curl <span class="string">&quot;https://<span class="variable">$&#123;RPC_ADDRESS&#125;</span>&quot;</span> -kfsSd <span class="string">&quot;<span class="variable">$&#123;RPC_PAYLOAD&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ADD_TRACKERS_RPC_STATUS</span></span>() &#123;</span><br><span class="line">    RPC_RESULT=$(ADD_TRACKERS_RPC)</span><br><span class="line">    [[ $(<span class="built_in">echo</span> <span class="variable">$&#123;RPC_RESULT&#125;</span> | grep OK) ]] &amp;&amp;</span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> BT trackers successfully added to Aria2 !&quot;</span> ||</span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Network failure or Aria2 RPC interface error!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ADD_TRACKERS_REMOTE_RPC</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Adding BT trackers to remote Aria2: <span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span><span class="variable">$&#123;RPC_ADDRESS%/*&#125;</span><span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> ...&quot;</span> &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    ADD_TRACKERS_RPC_STATUS</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ADD_TRACKERS_LOCAL_RPC</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [ ! -f <span class="variable">$&#123;ARIA2_CONF&#125;</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> &#x27;<span class="variable">$&#123;ARIA2_CONF&#125;</span>&#x27; does not exist.&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        RPC_PORT=$(grep ^rpc-listen-port <span class="variable">$&#123;ARIA2_CONF&#125;</span> | <span class="built_in">cut</span> -d= -f2-)</span><br><span class="line">        RPC_SECRET=$(grep ^rpc-secret <span class="variable">$&#123;ARIA2_CONF&#125;</span> | <span class="built_in">cut</span> -d= -f2-)</span><br><span class="line">        [[ <span class="variable">$&#123;RPC_PORT&#125;</span> ]] || &#123;</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Aria2 configuration file incomplete.&quot;</span></span><br><span class="line">            <span class="built_in">exit</span> 1</span><br><span class="line">        &#125;</span><br><span class="line">        RPC_ADDRESS=<span class="string">&quot;localhost:<span class="variable">$&#123;RPC_PORT&#125;</span>/jsonrpc&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Adding BT trackers to Aria2 ...&quot;</span> &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">        ADD_TRACKERS_RPC_STATUS</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[ $(<span class="built_in">command</span> -v curl) ] || &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> curl is not installed.&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> = <span class="string">&quot;cat&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    GET_TRACKERS</span><br><span class="line">    ECHO_TRACKERS</span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> = <span class="string">&quot;RPC&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    RPC_ADDRESS=<span class="string">&quot;<span class="variable">$2</span>/jsonrpc&quot;</span></span><br><span class="line">    RPC_SECRET=<span class="string">&quot;<span class="variable">$3</span>&quot;</span></span><br><span class="line">    GET_TRACKERS</span><br><span class="line">    ECHO_TRACKERS</span><br><span class="line">    ADD_TRACKERS_REMOTE_RPC</span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$2</span>&quot;</span> = <span class="string">&quot;RPC&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    GET_TRACKERS</span><br><span class="line">    ECHO_TRACKERS</span><br><span class="line">    ADD_TRACKERS</span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    ADD_TRACKERS_LOCAL_RPC</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    GET_TRACKERS</span><br><span class="line">    ECHO_TRACKERS</span><br><span class="line">    ADD_TRACKERS</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="2、新建clean-sh更新脚本"><a href="#2、新建clean-sh更新脚本" class="headerlink" title="2、新建clean.sh更新脚本"></a>2、新建<code>clean.sh</code>更新脚本</h2><p><code>Aria2</code>下载完成后删除冗余文件.  </p>
<p>输入命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /opt/aria2/clean.sh</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2018-2020 P3TERX &lt;https://p3terx.com&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is free software, licensed under the MIT License.</span></span><br><span class="line"><span class="comment"># See /LICENSE for more information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># https://github.com/P3TERX/aria2.conf</span></span><br><span class="line"><span class="comment"># File name：clean.sh</span></span><br><span class="line"><span class="comment"># Description: Remove redundant files after Aria2 download is complete</span></span><br><span class="line"><span class="comment"># Version: 3.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">CHECK_CORE_FILE</span></span>() &#123;</span><br><span class="line">    CORE_FILE=<span class="string">&quot;<span class="subst">$(dirname $0)</span>/core&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        . <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;!!! core file does not exist !!!&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CHECK_CORE_FILE <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_PARAMETER <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_FILE_NUM</span><br><span class="line">CHECK_SCRIPT_CONF</span><br><span class="line">GET_TASK_INFO</span><br><span class="line">GET_DOWNLOAD_DIR</span><br><span class="line">CONVERSION_PATH</span><br><span class="line">CLEAN_UP</span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="3、新建delete-sh更新脚本"><a href="#3、新建delete-sh更新脚本" class="headerlink" title="3、新建delete.sh更新脚本"></a>3、新建<code>delete.sh</code>更新脚本</h2><p>在<code>Aria2</code>下载错误或任务删除后删除文件.</p>
<p>输入命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /opt/aria2/delete.sh</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2018-2020 P3TERX &lt;https://p3terx.com&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is free software, licensed under the MIT License.</span></span><br><span class="line"><span class="comment"># See /LICENSE for more information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># https://github.com/P3TERX/aria2.conf</span></span><br><span class="line"><span class="comment"># File name：delete.sh</span></span><br><span class="line"><span class="comment"># Description: Delete files after Aria2 download error or task removed</span></span><br><span class="line"><span class="comment"># Version: 3.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">CHECK_CORE_FILE</span></span>() &#123;</span><br><span class="line">    CORE_FILE=<span class="string">&quot;<span class="subst">$(dirname $0)</span>/core&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        . <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;!!! core file does not exist !!!&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">CHECK_RPC_CONECTION</span></span>() &#123;</span><br><span class="line">    READ_ARIA2_CONF</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;RPC_SECRET&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        RPC_PAYLOAD=<span class="string">&#x27;&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.getVersion&quot;,&quot;id&quot;:&quot;P3TERX&quot;,&quot;params&quot;:[&quot;token:&#x27;</span><span class="variable">$&#123;RPC_SECRET&#125;</span><span class="string">&#x27;&quot;]&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        RPC_PAYLOAD=<span class="string">&#x27;&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.getVersion&quot;,&quot;id&quot;:&quot;P3TERX&quot;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    (curl <span class="string">&quot;<span class="variable">$&#123;RPC_ADDRESS&#125;</span>&quot;</span> -fsSd <span class="string">&quot;<span class="variable">$&#123;RPC_PAYLOAD&#125;</span>&quot;</span> || curl <span class="string">&quot;https://<span class="variable">$&#123;RPC_ADDRESS&#125;</span>&quot;</span> -kfsSd <span class="string">&quot;<span class="variable">$&#123;RPC_PAYLOAD&#125;</span>&quot;</span>) &gt;/dev/null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DELETE_ON_STOP</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;TASK_STATUS&#125;</span>&quot;</span> = <span class="string">&quot;error&quot;</span> &amp;&amp; <span class="string">&quot;<span class="variable">$&#123;DELETE_ON_ERROR&#125;</span>&quot;</span> = <span class="string">&quot;true&quot;</span> ]] || [[ <span class="string">&quot;<span class="variable">$&#123;TASK_STATUS&#125;</span>&quot;</span> = <span class="string">&quot;removed&quot;</span> &amp;&amp; <span class="string">&quot;<span class="variable">$&#123;DELETE_ON_REMOVED&#125;</span>&quot;</span> = <span class="string">&quot;true&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>.aria2&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Download task <span class="variable">$&#123;TASK_STATUS&#125;</span>, deleting files...&quot;</span></span><br><span class="line">            <span class="built_in">rm</span> -vrf <span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>.aria2&quot;</span> <span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            [[ -e <span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span> ]] &amp;&amp;</span><br><span class="line">                <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;WARRING&#125;</span> Skip delete. Download completed files: <span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span> ||</span><br><span class="line">                <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;WARRING&#125;</span> Skip delete. File does not exist: <span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;WARRING&#125;</span> Skip delete. Task status invalid: <span class="variable">$&#123;TASK_STATUS&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DELETE_ON_UNKNOWN</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;FILE_PATH&#125;</span>.aria2&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Download task force removed, deleting files...&quot;</span></span><br><span class="line">        <span class="built_in">rm</span> -vrf <span class="string">&quot;<span class="variable">$&#123;FILE_PATH&#125;</span>.aria2&quot;</span> <span class="string">&quot;<span class="variable">$&#123;FILE_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        [[ -e <span class="string">&quot;<span class="variable">$&#123;FILE_PATH&#125;</span>&quot;</span> ]] &amp;&amp;</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;WARRING&#125;</span> Skip delete. Download completed files: <span class="variable">$&#123;FILE_PATH&#125;</span>&quot;</span> ||</span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;WARRING&#125;</span> Skip delete. File does not exist: <span class="variable">$&#123;FILE_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DELETE_FILE</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> GET_TASK_INFO; <span class="keyword">then</span></span><br><span class="line">        GET_DOWNLOAD_DIR</span><br><span class="line">        GET_TASK_STATUS</span><br><span class="line">        CONVERSION_PATH</span><br><span class="line">        DELETE_ON_STOP</span><br><span class="line">        DELETE_DOT_TORRENT</span><br><span class="line">        DELETE_EMPTY_DIR</span><br><span class="line">    <span class="keyword">elif</span> CHECK_RPC_CONECTION &amp;&amp; [[ <span class="string">&quot;<span class="variable">$&#123;DELETE_ON_UNKNOWN&#125;</span>&quot;</span> = <span class="string">&quot;true&quot;</span> &amp;&amp; <span class="variable">$&#123;FILE_NUM&#125;</span> -eq 1 ]]; <span class="keyword">then</span></span><br><span class="line">        DELETE_ON_UNKNOWN</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Aria2 RPC interface error!&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CHECK_CORE_FILE <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_PARAMETER <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_FILE_NUM</span><br><span class="line">CHECK_SCRIPT_CONF</span><br><span class="line">DELETE_FILE</span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="4、新建move-sh更新脚本"><a href="#4、新建move-sh更新脚本" class="headerlink" title="4、新建move.sh更新脚本"></a>4、新建<code>move.sh</code>更新脚本</h2><p><code>Aria2</code> 下载完成后移动文件.  </p>
<p>输入命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /opt/aria2/move.sh</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2018-2020 P3TERX &lt;https://p3terx.com&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is free software, licensed under the MIT License.</span></span><br><span class="line"><span class="comment"># See /LICENSE for more information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># https://github.com/P3TERX/aria2.conf</span></span><br><span class="line"><span class="comment"># File name：move.sh</span></span><br><span class="line"><span class="comment"># Description: Move files after Aria2 download is complete</span></span><br><span class="line"><span class="comment"># Version: 3.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">CHECK_CORE_FILE</span></span>() &#123;</span><br><span class="line">    CORE_FILE=<span class="string">&quot;<span class="subst">$(dirname $0)</span>/core&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        . <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;!!! core file does not exist !!!&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">TASK_INFO</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;</span></span><br><span class="line"><span class="string">-------------------------- [<span class="variable">$&#123;YELLOW_FONT_PREFIX&#125;</span>Task Infomation<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>] --------------------------</span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Task GID:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;TASK_GID&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Number of Files:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;FILE_NUM&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>First File Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;FILE_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Task File Name:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;TASK_FILE_NAME&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Task Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;TASK_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Aria2 Download Directory:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;ARIA2_DOWNLOAD_DIR&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Custom Download Directory:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;DOWNLOAD_DIR&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Source Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;SOURCE_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Destination Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;DEST_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>.aria2 File Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;DOT_ARIA2_FILE&#125;</span></span></span><br><span class="line"><span class="string">-------------------------- [<span class="variable">$&#123;YELLOW_FONT_PREFIX&#125;</span>Task Infomation<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>] --------------------------</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">OUTPUT_MOVE_LOG</span></span>() &#123;</span><br><span class="line">    LOG=<span class="string">&quot;<span class="variable">$&#123;MOVE_LOG&#125;</span>&quot;</span></span><br><span class="line">    LOG_PATH=<span class="string">&quot;<span class="variable">$&#123;MOVE_LOG_PATH&#125;</span>&quot;</span></span><br><span class="line">    OUTPUT_LOG</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DEFINITION_PATH</span></span>() &#123;</span><br><span class="line">    SOURCE_PATH=<span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;DOWNLOAD_DIR&#125;</span>&quot;</span> != <span class="string">&quot;<span class="variable">$&#123;ARIA2_DOWNLOAD_DIR&#125;</span>&quot;</span> &amp;&amp; <span class="string">&quot;<span class="variable">$&#123;DOWNLOAD_DIR&#125;</span>&quot;</span> =~ <span class="string">&quot;<span class="variable">$&#123;ARIA2_DOWNLOAD_DIR&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        DEST_PATH=<span class="string">&quot;<span class="variable">$&#123;DEST_DIR&#125;</span><span class="variable">$&#123;DEST_PATH_SUFFIX%/*&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        DEST_PATH=<span class="string">&quot;<span class="variable">$&#123;DEST_DIR&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">MOVE_FILE</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Start move files ...&quot;</span></span><br><span class="line">    TASK_INFO</span><br><span class="line">    <span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$&#123;DEST_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">mv</span> -vf <span class="string">&quot;<span class="variable">$&#123;SOURCE_PATH&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;DEST_PATH&#125;</span>&quot;</span></span><br><span class="line">    MOVE_EXIT_CODE=$?</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$&#123;MOVE_EXIT_CODE&#125;</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">        MOVE_LOG=<span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Move done: <span class="variable">$&#123;SOURCE_PATH&#125;</span> -&gt; <span class="variable">$&#123;DEST_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        MOVE_LOG=<span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Move failed: <span class="variable">$&#123;SOURCE_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    OUTPUT_MOVE_LOG</span><br><span class="line">    DELETE_EMPTY_DIR</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CHECK_CORE_FILE <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_PARAMETER <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_FILE_NUM</span><br><span class="line">CHECK_SCRIPT_CONF</span><br><span class="line">GET_TASK_INFO</span><br><span class="line">GET_DOWNLOAD_DIR</span><br><span class="line">CONVERSION_PATH</span><br><span class="line">DEFINITION_PATH</span><br><span class="line">CLEAN_UP</span><br><span class="line">MOVE_FILE</span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure></p>
<h2 id="5、新建upload-sh脚本"><a href="#5、新建upload-sh脚本" class="headerlink" title="5、新建upload.sh脚本"></a>5、新建<code>upload.sh</code>脚本</h2><p><code>Aria2</code>下载完成后使用<code>Rclone</code>上传文件.<br>输入命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /opt/aria2/upload.sh</span><br></pre></td></tr></table></figure><br>输入以下内容：  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2018-2020 P3TERX &lt;https://p3terx.com&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is free software, licensed under the MIT License.</span></span><br><span class="line"><span class="comment"># See /LICENSE for more information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># https://github.com/P3TERX/aria2.conf</span></span><br><span class="line"><span class="comment"># File name：upload.sh</span></span><br><span class="line"><span class="comment"># Description: Use Rclone to upload files after Aria2 download is complete</span></span><br><span class="line"><span class="comment"># Version: 3.1</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">CHECK_CORE_FILE</span></span>() &#123;</span><br><span class="line">    CORE_FILE=<span class="string">&quot;<span class="subst">$(dirname $0)</span>/core&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        . <span class="string">&quot;<span class="variable">$&#123;CORE_FILE&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;!!! core file does not exist !!!&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">CHECK_RCLONE</span></span>() &#123;</span><br><span class="line">    [[ <span class="variable">$#</span> -eq 0 ]] &amp;&amp; &#123;</span><br><span class="line">        <span class="built_in">echo</span> &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;Checking RCLONE connection ...&quot;</span></span><br><span class="line">        rclone <span class="built_in">mkdir</span> <span class="string">&quot;<span class="variable">$&#123;DRIVE_NAME&#125;</span>:<span class="variable">$&#123;DRIVE_DIR&#125;</span>/P3TERX.COM&quot;</span></span><br><span class="line">        <span class="keyword">if</span> [[ $? -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line">            rclone <span class="built_in">rmdir</span> <span class="string">&quot;<span class="variable">$&#123;DRIVE_NAME&#125;</span>:<span class="variable">$&#123;DRIVE_DIR&#125;</span>/P3TERX.COM&quot;</span></span><br><span class="line">            <span class="built_in">echo</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;LIGHT_GREEN_FONT_PREFIX&#125;</span>success<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>&quot;</span></span><br><span class="line">            <span class="built_in">exit</span> 0</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">echo</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;RED_FONT_PREFIX&#125;</span>failure<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>&quot;</span></span><br><span class="line">            <span class="built_in">exit</span> 1</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">TASK_INFO</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;</span></span><br><span class="line"><span class="string">-------------------------- [<span class="variable">$&#123;YELLOW_FONT_PREFIX&#125;</span>Task Infomation<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>] --------------------------</span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Task GID:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;TASK_GID&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Number of Files:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;FILE_NUM&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>First File Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;FILE_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Task File Name:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;TASK_FILE_NAME&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Task Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;TASK_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Aria2 Download Directory:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;ARIA2_DOWNLOAD_DIR&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Custom Download Directory:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;DOWNLOAD_DIR&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Local Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;LOCAL_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>Remote Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;REMOTE_PATH&#125;</span></span></span><br><span class="line"><span class="string"><span class="variable">$&#123;LIGHT_PURPLE_FONT_PREFIX&#125;</span>.aria2 File Path:<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span> <span class="variable">$&#123;DOT_ARIA2_FILE&#125;</span></span></span><br><span class="line"><span class="string">-------------------------- [<span class="variable">$&#123;YELLOW_FONT_PREFIX&#125;</span>Task Infomation<span class="variable">$&#123;FONT_COLOR_SUFFIX&#125;</span>] --------------------------</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">OUTPUT_UPLOAD_LOG</span></span>() &#123;</span><br><span class="line">    LOG=<span class="string">&quot;<span class="variable">$&#123;UPLOAD_LOG&#125;</span>&quot;</span></span><br><span class="line">    LOG_PATH=<span class="string">&quot;<span class="variable">$&#123;UPLOAD_LOG_PATH&#125;</span>&quot;</span></span><br><span class="line">    OUTPUT_LOG</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">DEFINITION_PATH</span></span>() &#123;</span><br><span class="line">    LOCAL_PATH=<span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$&#123;TASK_PATH&#125;</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        REMOTE_PATH=<span class="string">&quot;<span class="variable">$&#123;DRIVE_NAME&#125;</span>:<span class="variable">$&#123;DRIVE_DIR&#125;</span><span class="variable">$&#123;DEST_PATH_SUFFIX%/*&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        REMOTE_PATH=<span class="string">&quot;<span class="variable">$&#123;DRIVE_NAME&#125;</span>:<span class="variable">$&#123;DRIVE_DIR&#125;</span><span class="variable">$&#123;DEST_PATH_SUFFIX&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">LOAD_RCLONE_ENV</span></span>() &#123;</span><br><span class="line">    RCLONE_ENV_FILE=<span class="string">&quot;<span class="variable">$&#123;ARIA2_CONF_DIR&#125;</span>/rclone.env&quot;</span></span><br><span class="line">    [[ -f <span class="variable">$&#123;RCLONE_ENV_FILE&#125;</span> ]] &amp;&amp; <span class="built_in">export</span> $(grep -Ev <span class="string">&quot;^#|^$&quot;</span> <span class="variable">$&#123;RCLONE_ENV_FILE&#125;</span> | xargs -0)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">UPLOAD_FILE</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Start upload files...&quot;</span></span><br><span class="line">    TASK_INFO</span><br><span class="line">    RETRY=0</span><br><span class="line">    RETRY_NUM=3</span><br><span class="line">    <span class="keyword">while</span> [ <span class="variable">$&#123;RETRY&#125;</span> -le <span class="variable">$&#123;RETRY_NUM&#125;</span> ]; <span class="keyword">do</span></span><br><span class="line">        [ <span class="variable">$&#123;RETRY&#125;</span> != 0 ] &amp;&amp; (</span><br><span class="line">            <span class="built_in">echo</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Upload failed! Retry <span class="variable">$&#123;RETRY&#125;</span>/<span class="variable">$&#123;RETRY_NUM&#125;</span> ...&quot;</span></span><br><span class="line">            <span class="built_in">echo</span></span><br><span class="line">        )</span><br><span class="line">        rclone move -v <span class="string">&quot;<span class="variable">$&#123;LOCAL_PATH&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;REMOTE_PATH&#125;</span>&quot;</span></span><br><span class="line">        RCLONE_EXIT_CODE=$?</span><br><span class="line">        <span class="keyword">if</span> [ <span class="variable">$&#123;RCLONE_EXIT_CODE&#125;</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">            UPLOAD_LOG=<span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;INFO&#125;</span> Upload done: <span class="variable">$&#123;LOCAL_PATH&#125;</span> -&gt; <span class="variable">$&#123;REMOTE_PATH&#125;</span>&quot;</span></span><br><span class="line">            OUTPUT_UPLOAD_LOG</span><br><span class="line">            DELETE_EMPTY_DIR</span><br><span class="line">            <span class="built_in">break</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            RETRY=$((<span class="variable">$&#123;RETRY&#125;</span> + <span class="number">1</span>))</span><br><span class="line">            [ <span class="variable">$&#123;RETRY&#125;</span> -gt <span class="variable">$&#123;RETRY_NUM&#125;</span> ] &amp;&amp; (</span><br><span class="line">                <span class="built_in">echo</span></span><br><span class="line">                UPLOAD_LOG=<span class="string">&quot;<span class="subst">$(DATE_TIME)</span> <span class="variable">$&#123;ERROR&#125;</span> Upload failed: <span class="variable">$&#123;LOCAL_PATH&#125;</span>&quot;</span></span><br><span class="line">                OUTPUT_UPLOAD_LOG</span><br><span class="line">            )</span><br><span class="line">            <span class="built_in">sleep</span> 3</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CHECK_CORE_FILE <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_SCRIPT_CONF</span><br><span class="line">CHECK_RCLONE <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">CHECK_FILE_NUM</span><br><span class="line">GET_TASK_INFO</span><br><span class="line">GET_DOWNLOAD_DIR</span><br><span class="line">CONVERSION_PATH</span><br><span class="line">DEFINITION_PATH</span><br><span class="line">CLEAN_UP</span><br><span class="line">LOAD_RCLONE_ENV</span><br><span class="line">UPLOAD_FILE</span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>
<h2 id="6、定时更新tracker信息"><a href="#6、定时更新tracker信息" class="headerlink" title="6、定时更新tracker信息"></a>6、定时更新<code>tracker</code>信息</h2><p>终端输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo crontab -e`  </span><br></pre></td></tr></table></figure><br>添加以下内容:<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 9 * * * /opt/aria2/tracker.sh  // 每天9点执行更新脚本</span><br></pre></td></tr></table></figure></p>
<p>参考资料：  </p>
<p>1、<a href="https://www.10bests.com/deploy-aria2-webui-on-ubuntu-and-debian/">Ubuntu/Debian系统安装配置aria2和WebUI</a></p>
<p>2、<a href="https://www.cnblogs.com/flymeng/p/7901062.html">Debian 9.x “stretch” 解决 /etc/rc.local 开机启动问题</a>]:</p>
<p>3、<a href="https://github.com/P3TERX/aria2.conf">一键安装及配置开源项目地址：</a></p>
<p>4、<a href="https://blog.csdn.net/weixin_33728708/article/details/92560318">Debian上Crontab的使用</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Aria2</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Aria2</tag>
        <tag>Debian</tag>
      </tags>
  </entry>
  <entry>
    <title>tar进行文件备份和恢复操作</title>
    <url>/2021/12/30/Tar%E8%BF%9B%E8%A1%8C%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="全量备份"><a href="#全量备份" class="headerlink" title="全量备份"></a>全量备份</h1><h2 id="创建测试文件夹和文件"><a href="#创建测试文件夹和文件" class="headerlink" title="创建测试文件夹和文件"></a>创建测试文件夹和文件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> backupTest</span><br><span class="line"><span class="built_in">cd</span> backupTest</span><br><span class="line"><span class="built_in">touch</span> a.txt b.txt c.txt</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxrwx 1 yk yk  336 12月 30 12:46 .</span><br><span class="line">drwxrwxrwx 1 yk yk 4096 12月 30 12:46 ..</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 a.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 b.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 c.txt</span><br></pre></td></tr></table></figure>
<h2 id="全量备份-1"><a href="#全量备份-1" class="headerlink" title="全量备份"></a>全量备份</h2><p>语法：<code>tar -g 备份存放目录/snapshot -czvf  备份存放目录/备份文件名称 被备份目录</code><br><strong>第一次运行为全量备份，此后为增量备份。</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -g /media/yk/备用/debian11_Backup/backupTest/snapshot -zcvf /media/yk/备用/debian11_Backup/2021-12-30-full.tar.gz ./</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">tar: .：目录是新的</span><br><span class="line">./</span><br><span class="line">./a.txt</span><br><span class="line">./b.txt</span><br><span class="line">./c.txt</span><br><span class="line">./snapshot</span><br></pre></td></tr></table></figure></p>
<p>复制全量备份文件并重命名为<code>2021-12-30-add.tar.gz</code>，后面测试增量备份时用到此<code>备份文件名称</code>.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cp</span> ../2021-12-30-full.tar.gz ../2021-12-30-add.tar.gz</span><br></pre></td></tr></table></figure></p>
<h2 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h2><p>删除<strong>测试文件夹</strong>所有文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> ./*</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxrwx 1 yk yk   48 12月 30 13:36 .</span><br><span class="line">drwxrwxrwx 1 yk yk 4096 12月 30 12:46 ..</span><br></pre></td></tr></table></figure></p>
<h2 id="恢复命令"><a href="#恢复命令" class="headerlink" title="恢复命令"></a>恢复命令</h2><p>语法：<code>tar -zxvf 备份存放目录/备份文件名称 (恢复备份目录)</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf /media/yk/备用/debian11_Backup/2021-12-30-full.tar.gz ./</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">./</span><br><span class="line">./a.txt</span><br><span class="line">./b.txt</span><br><span class="line">./c.txt</span><br><span class="line">./snapshot</span><br></pre></td></tr></table></figure></p>
<h1 id="增量备份"><a href="#增量备份" class="headerlink" title="增量备份"></a>增量备份</h1><h2 id="执行一次备份"><a href="#执行一次备份" class="headerlink" title="执行一次备份"></a>执行一次备份</h2><p><strong>注意</strong>备份文件名，用前面<code>全量备份</code>时复制的新文件<code>2021-12-30-add.tar.gz</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -g /media/yk/备用/debian11_Backup/backupTest/snapshot -zcvf /media/yk/备用/debian11_Backup/2021-12-30-add.tar.gz ./</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">tar: .：目录是新的</span><br><span class="line">./</span><br><span class="line">./a.txt</span><br><span class="line">./b.txt</span><br><span class="line">./c.txt</span><br><span class="line">./snapshot</span><br></pre></td></tr></table></figure></p>
<h2 id="改变已有文件内容"><a href="#改变已有文件内容" class="headerlink" title="改变已有文件内容"></a>改变已有文件内容</h2><p>给<code>a.txt</code>新增内容，并新建文件<code>d.txt</code>、<code>e.txt</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> &gt;&gt; a.txt &amp;&amp; <span class="built_in">touch</span> d.txt e.txt</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">总用量 5</span><br><span class="line">drwxrwxrwx 1 yk yk  440 12月 30 13:44 .</span><br><span class="line">drwxrwxrwx 1 yk yk 4096 12月 30 12:46 ..</span><br><span class="line">-rwxrwxrwx 1 yk yk   12 12月 30 13:44 a.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 b.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 c.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 13:44 d.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 13:44 e.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 13:32 snapshot</span><br></pre></td></tr></table></figure></p>
<h2 id="增量备份-1"><a href="#增量备份-1" class="headerlink" title="增量备份"></a>增量备份</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -g /media/yk/备用/debian11_Backup/backupTest/snapshot -zcvf /media/yk/备用/debian11_Backup/2021-12-30-add.tar.gz ./</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">./</span><br><span class="line">./a.txt</span><br><span class="line">./d.txt</span><br><span class="line">./e.txt</span><br><span class="line">./snapshot</span><br></pre></td></tr></table></figure>
<h1 id="恢复文件"><a href="#恢复文件" class="headerlink" title="恢复文件"></a>恢复文件</h1><h2 id="删除文件-1"><a href="#删除文件-1" class="headerlink" title="删除文件"></a>删除文件</h2><p>删除<strong>测试文件夹</strong>所有文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> ./*</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxrwx 1 yk yk   48 12月 30 13:56 .</span><br><span class="line">drwxrwxrwx 1 yk yk 4096 12月 30 12:46 ..</span><br></pre></td></tr></table></figure></p>
<h2 id="执行全量恢复"><a href="#执行全量恢复" class="headerlink" title="执行全量恢复"></a>执行全量恢复</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf /media/yk/备用/debian11_Backup/2021-12-30-full.tar.gz ./</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">./</span><br><span class="line">./a.txt</span><br><span class="line">./b.txt</span><br><span class="line">./c.txt</span><br><span class="line">./snapshot</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxrwx 1 yk yk  336 12月 30 13:32 .</span><br><span class="line">drwxrwxrwx 1 yk yk 4096 12月 30 12:46 ..</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 a.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 b.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 c.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 13:32 snapshot</span><br></pre></td></tr></table></figure>
<h2 id="执行增量恢复"><a href="#执行增量恢复" class="headerlink" title="执行增量恢复"></a>执行增量恢复</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf /media/yk/备用/debian11_Backup/2021-12-30-add.tar.gz ./</span><br><span class="line">./</span><br><span class="line">./a.txt</span><br><span class="line">./d.txt</span><br><span class="line">./e.txt</span><br><span class="line">./snapshot</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">总用量 5</span><br><span class="line">drwxrwxrwx 1 yk yk  336 12月 30 13:49 .</span><br><span class="line">drwxrwxrwx 1 yk yk 4096 12月 30 12:46 ..</span><br><span class="line">-rwxrwxrwx 1 yk yk   12 12月 30 13:49 a.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 b.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 12:46 c.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 13:49 d.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk    0 12月 30 13:49 e.txt</span><br><span class="line">-rwxrwxrwx 1 yk yk  120 12月 30 13:48 snapshot</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>运维</category>
        <category>备份和恢复</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>备份和恢复</tag>
        <tag>Tar</tag>
      </tags>
  </entry>
  <entry>
    <title>Ventoy+WePE2.1做启动盘</title>
    <url>/2020/06/21/Ventoy+WePE2.1%E5%81%9A%E5%90%AF%E5%8A%A8%E7%9B%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、Dell的BIOS设置"><a href="#一、Dell的BIOS设置" class="headerlink" title="一、Dell的BIOS设置"></a>一、<code>Dell</code>的<code>BIOS</code>设置</h1><h2 id="1、电脑开机，按F2，进入BIOS"><a href="#1、电脑开机，按F2，进入BIOS" class="headerlink" title="1、电脑开机，按F2，进入BIOS"></a>1、电脑开机，按<code>F2</code>，进入BIOS</h2><h2 id="2、选择Secure-Boot-Enable-关闭Disabled"><a href="#2、选择Secure-Boot-Enable-关闭Disabled" class="headerlink" title="2、选择Secure Boot Enable,关闭Disabled"></a>2、选择<code>Secure Boot Enable</code>,关闭<code>Disabled</code></h2><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8vuVrHb8AisLyeLjAqBKCK.KnVU6UfCNMUduYVQJeHQjvn50E9SjkLYWSNSustEtTA!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0211501698&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="Secure Boot Enable"></p>
<h2 id="3、设置硬盘模式为AHCI"><a href="#3、设置硬盘模式为AHCI" class="headerlink" title="3、设置硬盘模式为AHCI"></a>3、设置硬盘模式为<code>AHCI</code></h2><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8q5JqDJRaxmMPCYpJGjoHhzrp1PF*hWQcACMqjIqqq4CJZsQ1YNOYGjleztVzYBOwQ!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=049455234&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="SATA Operation"></p>
<h2 id="4、修改BIOS引导顺序"><a href="#4、修改BIOS引导顺序" class="headerlink" title="4、修改BIOS引导顺序"></a>4、修改<code>BIOS</code>引导顺序</h2><p> <code>Boot List Option</code>选择UEFI，<code>Boot Sequence</code>添加装好Ventoy的U盘。</p>
<p> <img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8nqhZkU.rjx9uX.D7RSoD*5WpPyVTQh1nAkrb6WKgkwm27KbfvTmrDBtQJBunq92VQ!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=074209938&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="Boot List Option"></p>
<h1 id="二、Ventoy装系统"><a href="#二、Ventoy装系统" class="headerlink" title="二、Ventoy装系统"></a>二、Ventoy装系统</h1><h2 id="1、开机按F12-进入引导界面"><a href="#1、开机按F12-进入引导界面" class="headerlink" title="1、开机按F12,进入引导界面"></a>1、开机按<code>F12</code>,进入引导界面</h2><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8gvcZJhdaXo7zzl*y.Rj2nv5NeOj.dnnWZt8cGlXP0OWXuQUnNr*RCB5R59FKOOlkw!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0206014546&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="Boot List"></p>
<h2 id="2、安装win10"><a href="#2、安装win10" class="headerlink" title="2、安装win10"></a>2、安装win10</h2><h3 id="1-gt-进入Ventoy界面，选择win10系统ISO文件-安装win10"><a href="#1-gt-进入Ventoy界面，选择win10系统ISO文件-安装win10" class="headerlink" title="1&gt; 进入Ventoy界面，选择win10系统ISO文件,安装win10"></a>1&gt; 进入Ventoy界面，选择win10系统ISO文件,安装win10</h3><p>win10系统ISO文件下载方法：</p>
<p>进入<a href="https://www.microsoft.com/zh-cn/software-download/windows10ISO">win10系统ISO地址</a>,<code>开启浏览器调试</code>，<code>刷新</code>，即可出现ISO文件选择下载界面,关掉调试，选择需要的ISO文件下载即可。</p>
<p><img src="\pic\2020\12\win10系统ISO.png" alt="win10系统ISO"></p>
<p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8gghMFD.tJ2tFrmHjBiRaQixkRHd4DdL8rgOaqb*W8Om82l.7KfJs6Rstr.wE*fj4g!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0222155314&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="win10系统ISO文件"></p>
<h3 id="2-gt-32或者64系统选择"><a href="#2-gt-32或者64系统选择" class="headerlink" title="2&gt; 32或者64系统选择"></a>2&gt; 32或者64系统选择</h3><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8hNUrg6v9JUKjsrt4gJjaw1gvhMu0DySB5pdnXJvw8PQjxHmk*vmlELNhN6SFrAxWw!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0224711266&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="32或者64系统"></p>
<h3 id="3-gt-加载程序"><a href="#3-gt-加载程序" class="headerlink" title="3&gt; 加载程序"></a>3&gt; 加载程序</h3><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8gbIeAwdhyU6kdd6.uqbu6RUDdQ4xytu0*ShBZ6AMHuRRurBX9X6gSpdmwjlr8ZVEA!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0265058578&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="32或者64系统"></p>
<h3 id="4-gt-程序安装"><a href="#4-gt-程序安装" class="headerlink" title="4&gt; 程序安装"></a>4&gt; 程序安装</h3><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8hL.UVWAhiaikAhsH52KJQxnmIdrsoRryicUXXXOn*kVxzm8LREqUU5gswEhw4p*kA!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0130022610&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="32或者64系统"></p>
<h2 id="3、安装win7"><a href="#3、安装win7" class="headerlink" title="3、安装win7"></a>3、安装win7</h2><p>【注意：32位启动不支持UEFI】</p>
<h3 id="1-gt-需配合wepe安装微pe地址，"><a href="#1-gt-需配合wepe安装微pe地址，" class="headerlink" title="1&gt; 需配合wepe安装微pe地址，"></a>1&gt; 需配合wepe安装<a href="http://www.wepe.com.cn/download.html">微pe地址</a>，</h3><h3 id="2-gt-将工具箱制作成IOS镜像制作方法地址"><a href="#2-gt-将工具箱制作成IOS镜像制作方法地址" class="headerlink" title="2&gt; 将工具箱制作成IOS镜像制作方法地址"></a>2&gt; 将工具箱制作成IOS镜像<a href="http://www.wepe.com.cn/ubook/installwepe.html">制作方法地址</a></h3><p>【在下面制作中注意选择右下角<code>**光盘**</code>图标】<br><img src="http://www.wepe.com.cn/ubook/assets/img/PE2.d658a63d.png" alt="Wepe工具箱安装到U盘"></p>
<h3 id="3-gt-放进装好Ventoy的U盘，选择Wepe-64-v2-1-iso-根据前面安装工具箱版本不一样名称也会不一样"><a href="#3-gt-放进装好Ventoy的U盘，选择Wepe-64-v2-1-iso-根据前面安装工具箱版本不一样名称也会不一样" class="headerlink" title="3&gt; 放进装好Ventoy的U盘，选择Wepe_64_v2.1.iso(根据前面安装工具箱版本不一样名称也会不一样)"></a>3&gt; 放进装好<code>Ventoy</code>的U盘，选择<code>Wepe_64_v2.1.iso</code>(根据前面安装工具箱版本不一样名称也会不一样)</h3><h3 id="4-gt-进入桌面，选择DiskGenius格式需要安装的影片盘符，退出"><a href="#4-gt-进入桌面，选择DiskGenius格式需要安装的影片盘符，退出" class="headerlink" title="4&gt; 进入桌面，选择DiskGenius格式需要安装的影片盘符，退出"></a>4&gt; 进入桌面，选择<code>DiskGenius</code>格式需要安装的影片盘符，退出</h3><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8m.SS64jkSwYiDNdIh5PYDv3lDI0H9nyONLgFhaNyPFii7Z.D5FRjvN15Ko3DUd3cw!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0224512754&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="Wepe界面"></p>
<p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8jAzlgT5ednp7ZHcGhpK23B0xRSz3Lb1RyDzjDYF*9gHFL.u1kl5v2.JqVuTrsGHYQ!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0268258098&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="DiskGenius"></p>
<h3 id="5-gt-选择WinNTSetp安装器进行安装"><a href="#5-gt-选择WinNTSetp安装器进行安装" class="headerlink" title="5&gt; 选择WinNTSetp安装器进行安装"></a>5&gt; 选择<code>WinNTSetp</code>安装器进行安装</h3><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8gO5ou.Xocae1wB*mnzfYeQO*Xc7VdY7oDlqmnm2Cw43eBTl5mklUdSxA4951FdtHw!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0215562530&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="WinNTSetp"></p>
<h2 id="4、安装Fedora"><a href="#4、安装Fedora" class="headerlink" title="4、安装Fedora"></a>4、安装Fedora</h2><h3 id="1-gt-下载Fedora"><a href="#1-gt-下载Fedora" class="headerlink" title="1&gt;下载Fedora"></a>1&gt;下载Fedora</h3><p> Fedora 的下载地址是:<a href="https://getfedora.org/en/workstation/download/">下载地址</a>,<code>For x86_64:Fedora 33: x86_64 DVD ISO</code></p>
<h3 id="2-gt-放进装好Ventoy的U盘，选择Fedora-Workstation-Live-x86-64-33-1-2-iso"><a href="#2-gt-放进装好Ventoy的U盘，选择Fedora-Workstation-Live-x86-64-33-1-2-iso" class="headerlink" title="2&gt; 放进装好Ventoy的U盘，选择Fedora-Workstation-Live-x86_64-33-1.2.iso"></a>2&gt; 放进装好<code>Ventoy</code>的U盘，选择<code>Fedora-Workstation-Live-x86_64-33-1.2.iso</code></h3><p>具体安装步骤方法参照<a href="https://ywnz.com/linuxaz/6764.html">云网牛站：Fedora 32系统安装</a>。</p>
<h3 id="3-gt-安装完成后桌面展示："><a href="#3-gt-安装完成后桌面展示：" class="headerlink" title="3&gt;安装完成后桌面展示："></a>3&gt;安装完成后桌面展示：</h3><p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8sOUtS9YZ238uG9WnyfTD4Xmb1bhBW5XcMTzJLwyyKOyUmYgBtTfgb88hFhFA8xetg!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=078690962&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="Fedora桌面"></p>
<p><img src="http://a1.qpic.cn/psc?/a96e2443-01e2-41c2-bab7-ebe84a7aa1d2/*PxJIR*kzvuHPyw9DCAb8hs6Yp5CdfbjTSeeJ7FKz0cfGmg.TZFC8NJGzFl3qiuUZycDyWXa4*LB3Q2dRr2*Dw!!/b&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=IAMrBCADKwQRECc!&amp;tl=3&amp;su=0223784754&amp;tm=1609052400&amp;sce=0-12-12&amp;rf=2-9" alt="Fedora一些程序"></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Windows</category>
        <category>Ventoy</category>
        <category>WePE</category>
      </categories>
      <tags>
        <tag>启动盘</tag>
        <tag>系统</tag>
        <tag>Windows</tag>
        <tag>Ventoy</tag>
        <tag>WePE</tag>
        <tag>Fedora</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows10系统SublimeText3安装及一些常用插件安装配置</title>
    <url>/2020/11/05/Window10%E7%B3%BB%E7%BB%9F%E4%B8%8BSublimeText3%E5%AE%89%E8%A3%85%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>千万注意配置文件中勿用中文标点符号</strong></p>
<p>3211版本注册码：<br><code>请自寻搜索</code></p>
<h1 id="一、安装插件安装控制View—-gt-Show-Console"><a href="#一、安装插件安装控制View—-gt-Show-Console" class="headerlink" title="一、安装插件安装控制View—&gt;Show Console"></a>一、安装插件安装控制<code>View</code>—&gt;<code>Show Console</code></h1><p>输入以下内容：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request,os,hashlib; h = <span class="string">&#x27;6f4c264a24d933ce70df5dedcf1dcaee&#x27;</span> + <span class="string">&#x27;ebe013ee18cced0ef93d5f746d80ef60&#x27;</span>; pf = <span class="string">&#x27;Package Control.sublime-package&#x27;</span>; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( <span class="string">&#x27;http://packagecontrol.io/&#x27;</span> + pf.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;%20&#x27;</span>)).read(); dh = hashlib.sha256(by).hexdigest(); <span class="built_in">print</span>(<span class="string">&#x27;Error validating download (got %s instead of %s), please try manual install&#x27;</span> % (dh, h)) <span class="keyword">if</span> dh != h <span class="keyword">else</span> <span class="built_in">open</span>(os.path.join( ipp, pf), <span class="string">&#x27;wb&#x27;</span> ).write(by)</span><br></pre></td></tr></table></figure></p>
<h1 id="二、安装SublimeTmpl模板插件"><a href="#二、安装SublimeTmpl模板插件" class="headerlink" title="二、安装SublimeTmpl模板插件"></a>二、安装<code>SublimeTmpl</code>模板插件</h1><ol>
<li><code>ctrl+alt+h</code> html5模板  </li>
<li><code>ctrl+alt+j</code> js模板  </li>
<li><code>ctrl+alt+c</code> css模板  </li>
<li><code>ctrl+alt+p</code> php模板  </li>
<li><code>ctrl+alt+r</code> ruby模板  </li>
<li><code>ctrl+alt+shift+p</code> python模板   </li>
</ol>
<h1 id="三、sublimeSideBar插件"><a href="#三、sublimeSideBar插件" class="headerlink" title="三、sublimeSideBar插件"></a>三、<code>sublimeSideBar</code>插件</h1><p><code>sublime text 3 localhost</code> 配置    </p>
<h2 id="1-安装侧边栏增强插件"><a href="#1-安装侧边栏增强插件" class="headerlink" title="1. 安装侧边栏增强插件"></a>1. 安装侧边栏增强插件</h2><p>在<code>Sublime Text 3</code>中，安装 <code>SideBarEnhancements</code> 侧边栏增强插件。 </p>
<h2 id="2-配置SideBarEnhancements-插件"><a href="#2-配置SideBarEnhancements-插件" class="headerlink" title="2. 配置SideBarEnhancements 插件"></a>2. 配置<code>SideBarEnhancements</code> 插件</h2><p><code>SideBarEnhancements</code> 插件安装完成后，首先为 <code>SideBarEnhancements</code> 指定默认浏览器。【见4.指定默认浏览器】</p>
<h2 id="3-配置php环境"><a href="#3-配置php环境" class="headerlink" title="3. 配置php环境"></a>3. 配置php环境</h2><p><code>工具</code>—&gt;<code>系统编译</code>—&gt;<code>新编译系统</code>替换内容为:<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;php&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$file&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;file_regex&quot;</span><span class="punctuation">:</span> <span class="string">&quot;php$&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;source.php&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p><code>另存文件</code>—&gt;<code>文件夹默认</code>—&gt;文件名<code>php.sublime-build</code>   </p>
<h2 id="4-指定默认浏览器"><a href="#4-指定默认浏览器" class="headerlink" title="4. 指定默认浏览器"></a>4. 指定默认浏览器</h2><p>打开<code>Preference</code>—&gt;<code>Package Settings</code>—&gt;<code>Side Bar</code>—&gt;<code>Settings User-User</code><br>【如果在热键绑定<code>browser: chrome</code>中设置，在此可以不设置，即省略此步】<br>//单浏览器预览本地服务器url<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;default_browser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chrome&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="comment">//多浏览器预览本地服务器url</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;open_all_browsers&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;firefox&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;firefox-developer-edition&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;chrome&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;opera&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;safari&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;ie&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;edge&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-指定默认localhsot目录"><a href="#5-指定默认localhsot目录" class="headerlink" title="5. 指定默认localhsot目录"></a>5. 指定默认localhsot目录</h2><p>为<code>SideBarEnhancements</code>指定默认<code>localhsot</code>目录。 在侧边栏任意文档上点击鼠标右键，选择<code>Project</code>—&gt;<code>Edit Preview URLs</code> 【多站点配置】【文件名<code>SideBarEnhancements.json</code>】<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;F:\\php&quot;</span><span class="punctuation">:</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;url_testing&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8090/&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;url_production&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8090/&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;J:\\WebSite\\SSCMS&quot;</span><span class="punctuation">:</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;url_testing&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8080/&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;url_production&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8080/&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;E:\\WebSites\\gdjy_test&quot;</span><span class="punctuation">:</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;url_testing&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8081/&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;url_production&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8081/&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;E:\\WebSites\\test&quot;</span><span class="punctuation">:</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;url_testing&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8082/&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;url_production&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:8082/&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="6-热键绑定"><a href="#6-热键绑定" class="headerlink" title="6. 热键绑定"></a>6. 热键绑定</h2><p>打开<code>Preference</code>—&gt;<code>Package Settings</code>—&gt;<code>Side Bar</code>—&gt;<code>key Bindings-User</code><br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span> </span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;alt+m&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;markdown_preview&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> </span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;browser&quot;</span><span class="punctuation">,</span> </span><br><span class="line">            <span class="attr">&quot;parser&quot;</span><span class="punctuation">:</span><span class="string">&quot;markdown&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span>  </span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f1&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;caption&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Python&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_open&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;subprocess&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf8&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;py&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-i&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-u&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$file_path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;syntax&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Packages/Python/Python.tmLanguage&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;external_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;python&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;extend_env&quot;</span><span class="punctuation">:</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;PYTHONIOENCODING&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f2&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;caption&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Py2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_open&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;subprocess&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf8&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;py2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-i&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-u&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$file_path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;syntax&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Packages/Python/Python.tmLanguage&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;external_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;python&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;extend_env&quot;</span><span class="punctuation">:</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;PYTHONIOENCODING&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f3&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_open&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;caption&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Python - RUN current file&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_python_run&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mnemonic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;R&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;subprocess&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf8&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;py&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-u&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$file_basename&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$file_path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;syntax&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Packages/Python/Python.tmLanguage&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;external_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;python&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;extend_env&quot;</span><span class="punctuation">:</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;PYTHONIOENCODING&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f4&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_open&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;caption&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Python - RUN current file&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_python_run&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mnemonic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;R&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;subprocess&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf8&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;py2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-u&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$file_basename&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$file_path&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;syntax&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Packages/Python/Python.tmLanguage&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;external_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;python&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;extend_env&quot;</span><span class="punctuation">:</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;PYTHONIOENCODING&quot;</span><span class="punctuation">:</span> <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ctrl+f5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;side_bar_open_in_browser&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;testing&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;browser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ie&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;side_bar_open_in_browser&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;testing&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;browser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;firefox&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;f6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;side_bar_open_in_browser&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment">//&quot;application&quot;: &quot;C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe&quot;,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;testing&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;browser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;keys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ctrl+shift+c&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;copy_path&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure></p>
<h1 id="四、安装SublimeREPL模板插件"><a href="#四、安装SublimeREPL模板插件" class="headerlink" title="四、安装SublimeREPL模板插件"></a>四、安装<code>SublimeREPL</code>模板插件</h1><p>为<code>CTRL + B</code>绑定<code>python</code><br>1、打开<code>Preference</code>—&gt;<code>Package Settings</code>—&gt;<code>REPL user</code><br>输入以下内容：<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;default_extend_env&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;PATH&quot;</span><span class="punctuation">:</span><span class="string">&quot;&#123;PATH&#125;;&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;show_transferred_text&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>命名并保存,如：<code>replPy.sublime-settings</code><br>2、打开<code>Tools</code>—&gt;<code>Bulid System</code>—&gt;<code>New System</code><br>输入以下内容：<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;run_existing_window_command&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;repl_python_run&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;config/python/Main.sublime-menu&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>命名并保存,如：<code>ReplPy.sublime-build</code>  </p>
<h1 id="五、Anaconda-python语法自动填充插件"><a href="#五、Anaconda-python语法自动填充插件" class="headerlink" title="五、Anaconda python语法自动填充插件"></a>五、<code>Anaconda python</code>语法自动填充插件</h1><p>打开<code>Preference</code>—&gt;<code>Package Settings</code>—&gt;<code>Anaconda user</code><br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;python_interpreter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;E:/Program Files/Python3/python.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;suppress_word_completions&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;suppress_explicit_completions&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;complete_parameters&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span>     <span class="comment">//解决自动填充参数过多</span></span><br><span class="line">    <span class="attr">&quot;swallow_startup_errors&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">//解决启动错误</span></span><br><span class="line">    <span class="attr">&quot;anaconda_linting&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> <span class="comment">//解决白框</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>其他插件<br>前端<br>极速生成html代码插件 <code>Emmet</code><br>代码自动补全插件     <code>SublimeCodeIntel</code><br>资源查看器插件       <code>PackageResourceViewer</code><br>可修改插件配置<br><strong>【【【【千万注意勿用中文标点符号】】】】</strong></p>
<p><a name="div6"></a></p>
<h1 id="六、IIS配置PHP环境"><a href="#六、IIS配置PHP环境" class="headerlink" title="六、IIS配置PHP环境"></a>六、<code>IIS</code>配置<code>PHP</code>环境</h1><h2 id="一-安装配置PHP"><a href="#一-安装配置PHP" class="headerlink" title="(一)安装配置PHP"></a>(一)安装配置<code>PHP</code></h2><p>1、首先到<code>php</code>上下载<code>php</code><a href="http://php.net/downloads.php">Php官网链接</a>,<code>windows download</code>  （版本根据自己的需要定)<br>2、下载<code>php-7.3.6-nts-Win32-VC15-x86</code>(根据情况自行选择32/64位)<br>3、解压进入解压目录，找到<code>php.ini-development</code>这个文件，可以直接改名为<code>php.ini</code>文件,修改配置将需要配置的去掉前面的<code>;</code>启用配置：<br>如：<code>On windows: extension_dir = E:\\Program Files\\PHP\\php-7.3.6-nts-VC15\\ext</code>（放置扩展的目录）<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">extension=odbc</span><br><span class="line">extension=openssl</span><br><span class="line">extension=pdo_firebird</span><br><span class="line">extension=pdo_mysql</span><br><span class="line">extension=pdo_oci</span><br><span class="line">extension=pdo_odbcs</span><br><span class="line">extension=pdo_pgsql</span><br><span class="line">extension=pdo_sqlite</span><br><span class="line">extension=pgsql ;配置支持MSSQL</span><br><span class="line">extension=php_sqlsrv_73_nts_x86 extension=php_sqlsrv_73_ts_x86 extension=php_pdo_sqlsrv_73_nts_x86 extension=php_pdo_sqlsrv_73_ts_x86</span><br></pre></td></tr></table></figure></p>
<p>最后不要忘了设置<code>session</code>文件的存储目录配置：<br>文件里的默认设置是：<code>; session.save_path=/tmp</code><br>目录要改一下，改成自己用来存放<code>session</code>文件的目录。 如:<code>session.save_path=F:\\tmp</code>.  配置完后保存退出，还要设置一下<code>F:\\tmp</code>文件夹的权限，不然会提示错误。<br><code>文件夹</code>→<code>属性</code>→<code>安全给IIS_IUSRS</code>用户授权  </p>
<h2 id="二-安装配置IIS"><a href="#二-安装配置IIS" class="headerlink" title="(二)安装配置IIS"></a>(二)安装配置<code>IIS</code></h2><p>1、<code>控制面板</code>-→<code>程序</code>-→<code>打开或关闭Windows功能</code>-→<code>Internet信息服务</code> 【确保勾选<code>IIS管理控制台</code>和<code>万维网服务</code>中的<code>应用程序开发功能</code>-→<code>CGI</code>】<br>2、配置PHP运行环境： 启动<code>IIS信息管理器</code>-→<code>处理程序映射</code>-→<code>添加模块映射</code>-→请求路径：<code>*.php</code>;模块：<code>FastCgiModule</code>;<br>可执行文件：解压的<code>PHP</code>目录下<code>php-cgi.exe</code>”;名称：<code>PHP</code> </p>
<h1 id="七、PHP配置连接MSSQL扩展"><a href="#七、PHP配置连接MSSQL扩展" class="headerlink" title="七、PHP配置连接MSSQL扩展"></a>七、PHP配置连接MSSQL扩展</h1><p>1、下载<code>SQL Server</code>驱动<code>4.0</code> <a href="https://docs.microsoft.com/en-us/sql/connect/php/download-drivers-php-sql-server?view=sql-server-2017">SQL Server驱动4.0下载地址</a>放到<code>php</code>安装目录下的<code>ext</code>目录下,并给<code>php.ini</code>添加配置.<a href="#div6">在前面第六部分<code>IIS配置PHP环境</code></a>  </p>
<p>2、安装<code>ODBC</code>驱动<code>11</code> <a href="https://www.microsoft.com/en-us/download/details.aspx?id=36434">ODBC驱动下载地址</a>  </p>
<p>3、测试数据库连接  </p>
<p>①<code>sqlsrv_connect</code><br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$serverName</span> = localhost, <span class="number">1433</span>; <span class="comment">//serverName\instanceName, portNumber (default is 1433)</span></span><br><span class="line"><span class="variable">$connectionInfo</span> = <span class="keyword">array</span>( Database=&gt;PHP, UID=&gt;sa, PWD=&gt;xxxxx);</span><br><span class="line"><span class="variable">$conn</span> = <span class="title function_ invoke__">sqlsrv_connect</span>( <span class="variable">$serverName</span>, <span class="variable">$connectionInfo</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$conn</span> ) &#123;</span><br><span class="line">     <span class="keyword">echo</span> 连接成功.&lt;br /&gt;;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> 连接出现错误.&lt;br /&gt;;</span><br><span class="line">     <span class="keyword">die</span>( <span class="title function_ invoke__">print_r</span>( <span class="title function_ invoke__">sqlsrv_errors</span>(), <span class="literal">true</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>②<code>PDO</code>连接</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$servername</span> = localhost;</span><br><span class="line"><span class="variable">$username</span> = sa;</span><br><span class="line"><span class="variable">$password</span> = XXXXXX;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="attr">sqlsrv</span>:Server=<span class="variable">$servername</span>;, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">    <span class="keyword">echo</span> PDO连接方式连接成功; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException <span class="variable">$e</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;连接失败：&#x27;</span>. <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③、<code>odbc_connect</code> 测试连接<code>access</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// Microsoft SQL Server using the SQL Native Client 10.0 ODBC Driver - allows connection to SQL 7, 2000, 2005 and 2008</span></span><br><span class="line"><span class="comment">// $db=f:/asp/siteserver_install/gdjy/students.mdb;</span></span><br><span class="line"><span class="variable">$mdbFilename</span>=f:/asp/siteserver_install/gdjy/students.mdb;</span><br><span class="line"><span class="variable">$username</span> = oooooo;  <span class="comment">//用户名</span></span><br><span class="line"><span class="variable">$password</span> = xxxxx;   <span class="comment">//密码</span></span><br><span class="line"><span class="variable">$connection</span> = <span class="title function_ invoke__">odbc_connect</span>(Driver=&#123;Microsoft Access <span class="title function_ invoke__">Driver</span> (*.mdb)&#125;;Dbq=<span class="variable">$mdbFilename</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line"><span class="comment">// try &#123;</span></span><br><span class="line"><span class="comment">//  $connection = odbc_connect(Driver=&#123;Microsoft Access Driver (*.mdb)&#125;;Dbq=$mdbFilename, $username, $password);</span></span><br><span class="line"><span class="comment">//  echo 连接成功;</span></span><br><span class="line"><span class="comment">// &#125;catch(odbc_connect $e)</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     echo &#x27;连接失败：&#x27;. $e-&gt;getMessage();</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$connection</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> 连接成功.;</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(Connection could not be established.);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>数据库</category>
        <category>软件应用</category>
        <category>Access</category>
        <category>SublimeText3</category>
        <category>MsSQL</category>
      </categories>
      <tags>
        <tag>Access</tag>
        <tag>MsSQL</tag>
        <tag>PHP</tag>
        <tag>SublimeText3</tag>
        <tag>Windows10</tag>
        <tag>IIS</tag>
      </tags>
  </entry>
  <entry>
    <title>you-get的安装和使用</title>
    <url>/2022/01/03/You-get%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装you-get"><a href="#安装you-get" class="headerlink" title="安装you-get"></a>安装<code>you-get</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install you-get</span><br><span class="line"><span class="comment"># 最好安装ffmpeg依赖，否则很多网站视频是获取不了，目前最新稳定版是4.4</span></span><br><span class="line">sudo apt install ffmpeg</span><br></pre></td></tr></table></figure>
<h1 id="you-get的基本使用"><a href="#you-get的基本使用" class="headerlink" title="you-get的基本使用"></a><code>you-get</code>的基本使用</h1><h2 id="查询视频所有格式和清晰度等信息"><a href="#查询视频所有格式和清晰度等信息" class="headerlink" title="查询视频所有格式和清晰度等信息"></a>查询视频所有格式和清晰度等信息</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">you-get -i 视频网址</span><br><span class="line"><span class="comment"># 比如：</span></span><br><span class="line">you-get  -x 127.0.0.1:7890  -i https://www.youtube.com/watch\?v=省略</span><br><span class="line"></span><br><span class="line">site:                YouTube</span><br><span class="line">title:               ......Relaxing Relax Music,Study music</span><br><span class="line">streams:             <span class="comment"># Available quality and codecs</span></span><br><span class="line">    [ DASH ] ____________________________________</span><br><span class="line">    - itag:          247</span><br><span class="line">      container:     webm</span><br><span class="line">      quality:       1280x720 (720p)</span><br><span class="line">      size:          1565.2 MiB (1641238562 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=247 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          136</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       1280x720 (720p)</span><br><span class="line">      size:          1397.6 MiB (1465484796 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=136 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          398</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       1280x720 (720p)</span><br><span class="line">      size:          1353.9 MiB (1419679674 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=398 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          244</span><br><span class="line">      container:     webm</span><br><span class="line">      quality:       854x480 (480p)</span><br><span class="line">      size:          862.5 MiB (904344987 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=244 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          135</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       854x480 (480p)</span><br><span class="line">      size:          800.1 MiB (838937810 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=135 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          397</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       854x480 (480p)</span><br><span class="line">      size:          737.8 MiB (773592988 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=397 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          243</span><br><span class="line">      container:     webm</span><br><span class="line">      quality:       640x360 (360p)</span><br><span class="line">      size:          599.1 MiB (628161660 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=243 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          396</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       640x360 (360p)</span><br><span class="line">      size:          513.1 MiB (538023785 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=396 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          134</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       640x360 (360p)</span><br><span class="line">      size:          485.7 MiB (509248710 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=134 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          242</span><br><span class="line">      container:     webm</span><br><span class="line">      quality:       426x240 (240p)</span><br><span class="line">      size:          418.4 MiB (438695050 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=242 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          278</span><br><span class="line">      container:     webm</span><br><span class="line">      quality:       256x144 (144p)</span><br><span class="line">      size:          402.5 MiB (422045631 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=278 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          133</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       426x240 (240p)</span><br><span class="line">      size:          376.9 MiB (395192598 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=133 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          395</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       426x240 (240p)</span><br><span class="line">      size:          369.4 MiB (387382024 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=395 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          394</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       256x144 (144p)</span><br><span class="line">      size:          322.8 MiB (338492890 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=394 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          160</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       256x144 (144p)</span><br><span class="line">      size:          276.3 MiB (289669585 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=160 [URL]</span></span><br><span class="line"></span><br><span class="line">    [ DEFAULT ] _________________________________</span><br><span class="line">    - itag:          22</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       hd720</span><br><span class="line">      size:          1396.8 MiB (1464679967 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=22 [URL]</span></span><br><span class="line"></span><br><span class="line">    - itag:          18</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       medium</span><br><span class="line">    <span class="comment"># download-with: you-get --itag=18 [URL]</span></span><br></pre></td></tr></table></figure>
<p>注意下面提示的下载方法.<strong><code>download-with: you-get --itag=18 [URL]</code></strong></p>
<h2 id="下载指定格式"><a href="#下载指定格式" class="headerlink" title="下载指定格式"></a>下载指定格式</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 比如 B站</span></span><br><span class="line"><span class="comment"># 查询</span></span><br><span class="line">you-get -i https://www.bilibili.com/video/xxxxxxxxx    </span><br><span class="line">you-get: This is a multipart video. (use --playlist to download all parts.)</span><br><span class="line">site:                Bilibili</span><br><span class="line">title:               XXXXXXXXX</span><br><span class="line">streams:             <span class="comment"># Available quality and codecs</span></span><br><span class="line">    [ DASH ] ____________________________________</span><br><span class="line">    - format:        dash-flv720</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       高清 720P</span><br><span class="line">      size:          495.5 MiB (519523605 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=dash-flv720 [URL]</span></span><br><span class="line"></span><br><span class="line">    - format:        dash-flv</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       高清 1080P</span><br><span class="line">      size:          495.4 MiB (519418344 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=dash-flv [URL]</span></span><br><span class="line"></span><br><span class="line">    - format:        dash-flv480</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       清晰 480P</span><br><span class="line">      size:          270.7 MiB (283870193 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=dash-flv480 [URL]</span></span><br><span class="line"></span><br><span class="line">    - format:        dash-flv360</span><br><span class="line">      container:     mp4</span><br><span class="line">      quality:       流畅 360P</span><br><span class="line">      size:          102.5 MiB (107469058 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=dash-flv360 [URL]</span></span><br><span class="line"></span><br><span class="line">    [ DEFAULT ] _________________________________</span><br><span class="line">    - format:        flv</span><br><span class="line">      container:     flv</span><br><span class="line">      quality:       高清 1080P</span><br><span class="line">      size:          497.1 MiB (521198741 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=flv [URL]</span></span><br><span class="line"></span><br><span class="line">    - format:        flv720</span><br><span class="line">      container:     flv</span><br><span class="line">      quality:       高清 720P</span><br><span class="line">      size:          497.2 MiB (521304002 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=flv720 [URL]</span></span><br><span class="line"></span><br><span class="line">    - format:        flv480</span><br><span class="line">      container:     flv</span><br><span class="line">      quality:       清晰 480P</span><br><span class="line">      size:          226.9 MiB (237943337 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=flv480 [URL]</span></span><br><span class="line"></span><br><span class="line">    - format:        flv360</span><br><span class="line">      container:     flv</span><br><span class="line">      quality:       流畅 360P</span><br><span class="line">      size:          103.1 MiB (108137452 bytes)</span><br><span class="line">    <span class="comment"># download-with: you-get --format=flv360 [URL]</span></span><br><span class="line"><span class="comment"># 下载flv 1080p的视频 </span></span><br><span class="line">you-get -F=flv 视频网址</span><br><span class="line"><span class="comment"># 其中 -F和--format可互换</span></span><br></pre></td></tr></table></figure>
<h3 id="下载到指定目录并重命名"><a href="#下载到指定目录并重命名" class="headerlink" title="下载到指定目录并重命名"></a>下载到指定目录并重命名</h3><p>下载不指定名称和保存路径的话，<code>you-get</code>会以查到的名称来命名，并保存到当前路径。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">you-get -o 保存的路径  -O 保存的名称 -F=视频格式 视频网址</span><br><span class="line"><span class="comment"># -O 等同于 --output-filename；-o 等同于 --output-dir；-F等同于--format</span></span><br></pre></td></tr></table></figure></p>
<h3 id="列表下载"><a href="#列表下载" class="headerlink" title="列表下载"></a>列表下载</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">you-get -o 保存的路径  -O 保存的名称 -F=视频格式 -l  视频网址</span><br><span class="line"><span class="comment"># 其中</span></span><br><span class="line"><span class="comment"># -l等同于--playlist</span></span><br></pre></td></tr></table></figure>
<h3 id="带代理下载"><a href="#带代理下载" class="headerlink" title="带代理下载"></a>带代理下载</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">you-get  -x 代理ip：端口 -o 保存的路径  -O 保存的名称 -F=根据个人选择 视频网址</span><br></pre></td></tr></table></figure>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>可以用命令查看帮助信息<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">you-get -h</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">you-get --<span class="built_in">help</span></span><br></pre></td></tr></table></figure></p>
<h1 id="python批量下载"><a href="#python批量下载" class="headerlink" title="python批量下载"></a><code>python</code>批量下载</h1><h2 id="os模块"><a href="#os模块" class="headerlink" title="os模块"></a><code>os</code>模块</h2><p>下面以下载B站视频为例：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># os 模块 ##</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>,<span class="number">68</span>):</span><br><span class="line">  save_path = <span class="string">r&#x27;/save/video/path&#x27;</span></span><br><span class="line">  v_format = <span class="string">&#x27;flv&#x27;</span></span><br><span class="line">  v_url = <span class="string">f&#x27;https://www.bilibili.com/video/xxxxxxxxxx\?p\=<span class="subst">&#123;i&#125;</span>&#x27;</span></span><br><span class="line">  os.system(<span class="string">f&quot;you-get -o &#x27;<span class="subst">&#123;save_path&#125;</span>&#x27; -F=<span class="subst">&#123;v_format&#125;</span> <span class="subst">&#123;v_url&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;第 <span class="subst">&#123;i&#125;</span> 下载成功&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="you-get模块"><a href="#you-get模块" class="headerlink" title="you-get模块"></a><code>you-get</code>模块</h2><h3 id="安装you-get模块"><a href="#安装you-get模块" class="headerlink" title="安装you-get模块"></a>安装<code>you-get</code>模块</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install you-get</span><br></pre></td></tr></table></figure>
<h3 id="实例（在linux终端上测试不成功）"><a href="#实例（在linux终端上测试不成功）" class="headerlink" title="实例（在linux终端上测试不成功）"></a>实例（在<code>linux</code>终端上测试不成功）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> you_get <span class="keyword">import</span> common <span class="keyword">as</span> you_get</span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.argv=[&#x27;you-get&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line"><span class="comment"># you_get.main()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># you_get 模块 ##</span></span><br><span class="line"><span class="comment"># for i in range(1,11):</span></span><br><span class="line"><span class="comment">#   save_path = r&#x27;/save/video/path&#x27;</span></span><br><span class="line"><span class="comment">#   v_url = f&#x27;https://www.bilibili.com/video/###########\?p\=&#123;i&#125;&#x27;</span></span><br><span class="line"><span class="comment">#   v_format = &#x27;flv&#x27;</span></span><br><span class="line"><span class="comment">#   you_get.any_download(url=v_url,stream_id=v_format,info_only=False,output_dir=save_path,merge=True)</span></span><br><span class="line"><span class="comment">#   print(f&#x27;第 &#123;i&#125; 下载成功&#x27;)</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Python</category>
        <category>you-get</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>You-get</tag>
      </tags>
  </entry>
  <entry>
    <title>youtube-dl调用aria2和ffmpeg下载合并视频</title>
    <url>/2021/01/11/Youtube-dl%E8%B0%83%E7%94%A8aria2%E5%92%8Cffmpeg%E4%B8%8B%E8%BD%BD%E5%B9%B6%E5%90%88%E5%B9%B6%E8%A7%86%E9%A2%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p><a href="https://www.youtube-dl.org/">youtube-dl官网：</a><br><a href="https://github.com/ytdl-org/youtube-dl/releases">youtube-dl最新发布版本下载地址：</a><br><a href="https://github.com/aria2/aria2">aria2项目：</a><br><a href="https://github.com/aria2/aria2">aria2最新发布版本下载地址：</a>  </p>
<h1 id="1、基本用法"><a href="#1、基本用法" class="headerlink" title="1、基本用法"></a>1、基本用法</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl <span class="string">&quot;视频文件网络路径&quot;</span>  --external-downloader aria2c --external-downloader-args <span class="string">&quot;-x 16 -k 1M&quot;</span> -o f:/yz3.mp4</span><br></pre></td></tr></table></figure>
<p>参数说明：<br><code>--external-downloader aria2c</code> //调用外部下载工具<br><code>--external-downloader-args</code> //外部下载工具指定参数<br><code>-x 16</code> //启用aria2 16个线程，最多就支持16线程<br><code>-k 1M</code> //指定块的大小<br>代理<br><code>--proxy &quot;https://127.0.0.1:1080&quot;</code><br>  //或者直接这样<br>  <code>--proxy 127.0.0.1:1080</code></p>
<p>附：【单独aria2的代理下载命令】<br>例如下载<code>potplayer</code>播放器：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">aria2c  --https-proxy=<span class="string">&quot;http://127.0.0.1:7890&quot;</span> -o /path/to/save/ https://t1.daumcdn.net/potplayer/PotPlayer/Version/Latest/PotPlayerSetup64.exe</span><br><span class="line"><span class="comment">#  --https-proxy=&quot;填写自己代理信息&quot;</span></span><br></pre></td></tr></table></figure><br>具体参见：<br><a href="https://aria2.github.io/manual/en/html/aria2c.html#http-ftp-sftp-options">HTTP/FTP/SFTP Options</a></p>
<h1 id="2、下载视频列表"><a href="#2、下载视频列表" class="headerlink" title="2、下载视频列表"></a>2、下载视频列表</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl [playlist_url] //下载视频列表,这种方式下载的视频可能是mkv格式或者webm格式</span><br><span class="line">youtube-dl -cit [playlist_url] //下载视频列表,这种方式下载的视频可能是mkv格式或者webm格式</span><br><span class="line">youtube-dl --yes-playlist [url] //当链接为视频列表,则下载该列表视频,跟上面的一样,可能是mkv或者webm格式</span><br></pre></td></tr></table></figure>
<h1 id="3、下载字幕"><a href="#3、下载字幕" class="headerlink" title="3、下载字幕"></a>3、下载字幕</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl --write-sub --skip-download [url] //下载单独的vtt字幕文件,而不会下载视频</span><br><span class="line">youtube-dl --write-sub --all-subs [url] //下载所有语言的字幕(如果有的话)</span><br><span class="line">youtube-dl --write-auto-sub [url] //下载自动生成的字幕(YouTube only)</span><br></pre></td></tr></table></figure>
<h1 id="4、查看视频所有类型-只看不下载"><a href="#4、查看视频所有类型-只看不下载" class="headerlink" title="4、查看视频所有类型,只看不下载"></a>4、查看视频所有类型,只看不下载</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl -F <span class="string">&quot;视频文件网络路径&quot;</span>  </span><br></pre></td></tr></table></figure>
<h1 id="5、下载指定质量的视频和音频并自动合并"><a href="#5、下载指定质量的视频和音频并自动合并" class="headerlink" title="5、下载指定质量的视频和音频并自动合并"></a>5、下载指定质量的视频和音频并自动合并</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl -f [format code] [url]   //format code :视频+音频如：137+140</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">format code  extension  resolution note</span><br><span class="line">249          webm       audio only tiny   67k , opus @ 50k (48000Hz), 9.10MiB</span><br><span class="line">250          webm       audio only tiny   86k , opus @ 70k (48000Hz), 11.77MiB</span><br><span class="line">140          m4a        audio only tiny  131k , m4a_dash container, mp4a.40.2@128k (44100Hz), 22.87MiB</span><br><span class="line">251          webm       audio only tiny  157k , opus @160k (48000Hz), 22.30MiB</span><br><span class="line">394          mp4        256x144    144p   84k , av01.0.00M.08, 25fps, video only, 11.84MiB</span><br><span class="line">278          webm       256x144    144p   97k , webm container, vp9, 25fps, video only, 14.93MiB</span><br><span class="line">160          mp4        256x144    144p  124k , avc1.4d400c, 25fps, video only, 13.26MiB</span><br><span class="line">395          mp4        426x240    240p  182k , av01.0.00M.08, 25fps, video only, 22.28MiB</span><br><span class="line">242          webm       426x240    240p  225k , vp9, 25fps, video only, 25.68MiB</span><br><span class="line">133          mp4        426x240    240p  275k , avc1.4d4015, 25fps, video only, 21.26MiB</span><br><span class="line">396          mp4        640x360    360p  379k , av01.0.01M.08, 25fps, video only, 41.58MiB</span><br><span class="line">243          webm       640x360    360p  411k , vp9, 25fps, video only, 42.61MiB</span><br><span class="line">134          mp4        640x360    360p  521k , avc1.4d401e, 25fps, video only, 36.68MiB</span><br><span class="line">397          mp4        854x480    480p  661k , av01.0.04M.08, 25fps, video only, 68.76MiB</span><br><span class="line">244          webm       854x480    480p  759k , vp9, 25fps, video only, 61.26MiB</span><br><span class="line">135          mp4        854x480    480p  922k , avc1.4d401e, 25fps, video only, 52.38MiB</span><br><span class="line">398          mp4        1280x720   720p 1255k , av01.0.05M.08, 25fps, video only, 123.54MiB</span><br><span class="line">247          webm       1280x720   720p 1432k , vp9, 25fps, video only, 97.51MiB</span><br><span class="line">136          mp4        1280x720   720p 1561k , avc1.4d401f, 25fps, video only, 86.93MiB</span><br><span class="line">399          mp4        1920x1080  1080p 2244k , av01.0.08M.08, 25fps, video only, 212.73MiB</span><br><span class="line">248          webm       1920x1080  1080p 2645k , vp9, 25fps, video only, 244.97MiB</span><br><span class="line">137          mp4        1920x1080  1080p 4023k , avc1.640028, 25fps, video only, 253.08MiB</span><br><span class="line">18           mp4        640x360    360p  503k , avc1.42001E, 25fps, mp4a.40.2@ 96k (44100Hz), 88.99MiB</span><br><span class="line">22           mp4        1280x720   720p  621k , avc1.64001F, 25fps, mp4a.40.2@192k (44100Hz) (best)</span><br></pre></td></tr></table></figure>
<h1 id="6、批量下载"><a href="#6、批量下载" class="headerlink" title="6、批量下载"></a>6、批量下载</h1><h2 id="①各个视频地址列表下载"><a href="#①各个视频地址列表下载" class="headerlink" title="①各个视频地址列表下载"></a>①各个视频地址列表下载</h2><p>命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl -f 22 -a list.txt</span><br></pre></td></tr></table></figure><br>其中<code>list.txt</code> 的 <code>text</code>文件格式<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.youtube.com/watch?v=*****</span><br><span class="line">https://www.youtube.com/watch?v=*****</span><br><span class="line">https://www.youtube.com/watch?v=*****</span><br></pre></td></tr></table></figure></p>
<h2 id="②批量下载“播放列表”的视频"><a href="#②批量下载“播放列表”的视频" class="headerlink" title="②批量下载“播放列表”的视频"></a>②批量下载“播放列表”的视频</h2><p>格式:<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">https://www.youtube.com/playlist?list=</span><br></pre></td></tr></table></figure><br>Ⅰ&gt;下载列表中指定连续的内容(比如：<code>--playlist-start 1 --playlist-end 27</code>)<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl -f 22 -ci --playlist-start 1 --playlist-end 24 <span class="string">&quot;https://www.youtube.com/playlist?list=*****&quot;</span></span><br></pre></td></tr></table></figure><br>Ⅱ&gt;下载列表中指定的不连续内容(比如：<code>--playlist-items 1,3-5,7, 21-27</code>)<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">youtube-dl -f 22 -ci --playlist-items 1,3-5,7, 21-27 <span class="string">&quot;https://www.youtube.com/playlist?list=*******&quot;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="7、ffmpeg-合并视频"><a href="#7、ffmpeg-合并视频" class="headerlink" title="7、ffmpeg 合并视频"></a>7、ffmpeg 合并视频</h1><h2 id="①命令1："><a href="#①命令1：" class="headerlink" title="①命令1："></a>①命令1：</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ffmpeg -i <span class="string">&quot;concat:yz1.mp4|yz2.mp4|yz3.mp4|yz4.mp4|yz5.mp4|yz6.mp4|yz7.mp4|yz8.mp4|yz9.mp4|yz10.mp4|&quot;</span> -c copy output.mp4</span><br></pre></td></tr></table></figure>
<h2 id="②命令2："><a href="#②命令2：" class="headerlink" title="②命令2："></a>②命令2：</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ffmpeg -f concat -safe 0 -i filelist.txt -c copy output.mp4</span><br></pre></td></tr></table></figure>
<p>其中：<code>filelist.txt</code><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file  &#x27;F:\yz1.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz2.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz3.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz4.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz5.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz6.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz7.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz8.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz9.mp4&#x27;</span><br><span class="line">file  &#x27;F:\yz10.mp4&#x27;</span><br></pre></td></tr></table></figure></p>
<h2 id="8、ffmpeg操作字幕"><a href="#8、ffmpeg操作字幕" class="headerlink" title="8、ffmpeg操作字幕"></a>8、ffmpeg操作字幕</h2><h3 id="1-gt-字幕相互转换"><a href="#1-gt-字幕相互转换" class="headerlink" title="1&gt;字幕相互转换"></a>1&gt;字幕相互转换</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ffmpeg -i input.vtt output.srt</span><br><span class="line">ffmpeg -i input.srt output.ass</span><br></pre></td></tr></table></figure>
<h3 id="2-gt-把字幕压制到视频"><a href="#2-gt-把字幕压制到视频" class="headerlink" title="2&gt;把字幕压制到视频"></a>2&gt;把字幕压制到视频</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -vf ass=subtitle.ass output.mp4  </span><br></pre></td></tr></table></figure>
<p><em>注意<code>win</code>下<code>ass=subtitle.ass</code>不能使用盘符，可使用相对路径</em></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Aria2</category>
        <category>Youtube-dl</category>
      </categories>
      <tags>
        <tag>Aria2</tag>
        <tag>Ffmpeg</tag>
        <tag>Youtube-dl</tag>
      </tags>
  </entry>
  <entry>
    <title>zsh配置和使用</title>
    <url>/2022/01/03/Zsh%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装zsh和oh-my-zsh"><a href="#安装zsh和oh-my-zsh" class="headerlink" title="安装zsh和oh-my-zsh"></a>安装<code>zsh</code>和<code>oh-my-zsh</code></h1><h2 id="安装zsh"><a href="#安装zsh" class="headerlink" title="安装zsh"></a>安装<code>zsh</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install zsh</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树... 完成</span><br><span class="line">正在读取状态信息... 完成                 </span><br><span class="line">将会同时安装下列软件：</span><br><span class="line">  zsh-common</span><br><span class="line">建议安装：</span><br><span class="line">  zsh-doc</span><br><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  zsh zsh-common</span><br><span class="line">升级了 0 个软件包，新安装了 2 个软件包，要卸载 0 个软件包，有 0 个软件包未被升级。</span><br><span class="line">需要下载 4,847 kB 的归档。</span><br><span class="line">解压缩后会消耗 18.3 MB 的额外空间。</span><br><span class="line">您希望继续执行吗？ [Y/n] y</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<h2 id="安装oh-my-zsh"><a href="#安装oh-my-zsh" class="headerlink" title="安装oh-my-zsh"></a>安装<code>oh-my-zsh</code></h2><p><code>oh-my-zsh</code>是很不错的一个<code>zsh</code>配置的开源项目<a href="https://github.com/ohmyzsh/ohmyzsh">地址</a>，整理了常用的zsh扩展和主题。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(wget -O- https://raw.fastgit.org/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">sh -c <span class="string">&quot;<span class="subst">$(wget -e https_proxy=你的_proxy_ip:端口 -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="一些其他配置"><a href="#一些其他配置" class="headerlink" title="一些其他配置"></a>一些其他配置</h1><h2 id="修改主题"><a href="#修改主题" class="headerlink" title="修改主题"></a>修改主题</h2><h3 id="安装主题所需字体"><a href="#安装主题所需字体" class="headerlink" title="安装主题所需字体"></a>安装主题所需字体</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install fonts-powerline</span><br></pre></td></tr></table></figure>
<p>或者安装<code>Meslo-Font</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/powerline/fonts.git </span><br><span class="line"><span class="built_in">cd</span> fonts </span><br><span class="line">./install.sh </span><br><span class="line"><span class="comment"># http://github.com/andreberg/Meslo-Font/archive/master.zip</span></span><br></pre></td></tr></table></figure></p>
<p>测试字体能否正常输出：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;\ue0b0 \u00b1 \ue0a0 \u27a6 \u2718 \u26a1 \u2699&quot;</span> </span><br><span class="line"><span class="comment"># 输出 </span></span><br><span class="line">  ±  ➦ ✘ ⚡ ⚙</span><br></pre></td></tr></table></figure><br>设置终端中字体为<code>Meslo LG S DZ for Powerline Regular 12</code>.<br>主题如图：<br><img src="/pic/2022/1/zsh/theme.png" alt="theme"><br><code>agnoster</code>主题所需字体如图：<br><img src="/pic/2022/1/zsh/agnoster.png" alt="agnoster"></p>
<h3 id="修改主题配置-可选"><a href="#修改主题配置-可选" class="headerlink" title="修改主题配置(可选)"></a>修改主题配置(可选)</h3><p>主题在<code>~/.oh-my-zsh/themes/</code>文件夹下。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 找到并修改为如下内容：</span></span><br><span class="line">ZSH_THEME=<span class="string">&quot;ys&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他</span></span><br><span class="line"><span class="comment"># 修改为 random 则每次启动zsh都会随机主题</span></span><br><span class="line">ZSH_THEME=<span class="string">&quot;random&quot;</span></span><br></pre></td></tr></table></figure><br><a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes">各种主题预览</a></p>
<h2 id="配置语法高亮"><a href="#配置语法高亮" class="headerlink" title="配置语法高亮"></a>配置语法高亮</h2><p><a href="https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/INSTALL.md">项目地址</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install zsh-syntax-highlighting</span><br><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 找到并修改为如下内容：</span></span><br><span class="line"><span class="built_in">source</span> /path/to/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh <span class="comment"># 注意修改/path/to/为自己文件所在路径</span></span><br><span class="line"><span class="comment"># 源安装的路径一般为：/usr/share/zsh-syntax-highlighting/highlighters/brackets/zsh-syntax-highlighting.zsh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者用插件方法</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 找到并修改为如下内容：</span></span><br><span class="line">plugins=(其他插件 zsh-syntax-highlighting)</span><br></pre></td></tr></table></figure><br><img src="/pic/2022/1/zsh/highlighting.png" alt="highlighting"></p>
<h2 id="安装autosuggestions命令提示"><a href="#安装autosuggestions命令提示" class="headerlink" title="安装autosuggestions命令提示"></a>安装<code>autosuggestions</code>命令提示</h2><p>对输入的命令进行自动提示：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 进入插件目录</span></span><br><span class="line"><span class="built_in">cd</span> ~/.oh-my-zsh/plugins/</span><br><span class="line"><span class="comment"># 下载插件到插件目录</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions.git</span><br><span class="line"><span class="comment"># 修改配置</span></span><br><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 添加插件配置</span></span><br><span class="line">  plugins=(其他插件 zsh-syntax-highlighting zsh-autosuggestions)</span><br><span class="line"><span class="comment"># 重新加载</span></span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure></p>
<h2 id="配置autojump"><a href="#配置autojump" class="headerlink" title="配置autojump"></a>配置<code>autojump</code></h2><p>能够根据用户平时使用路径的频繁程度，根据输入的关键词，直接跳到路径下去，关键词是路径其中一段即可.此插件已在<code>oh-my-zsh项目</code>插件文件夹，只需要添加启用即可<br><a href="https://github.com/wting/autojump">项目地址</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 或者用插件方法</span></span><br><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 找到并修改为如下内容：</span></span><br><span class="line">plugins=(其他插件 zsh-syntax-highlighting zsh-autosuggestions autojump)</span><br></pre></td></tr></table></figure></p>
<h1 id="将zsh设置为系统默认终端"><a href="#将zsh设置为系统默认终端" class="headerlink" title="将zsh设置为系统默认终端"></a>将zsh设置为系统默认终端</h1><p>执行这条语句:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chsh -s `<span class="built_in">which</span> zsh`</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">chsh -s /usr/bin/zsh</span><br><span class="line"><span class="comment"># 或者修改</span></span><br><span class="line">/etc/passwd,将root和用户后面的命令修改为zsh</span><br></pre></td></tr></table></figure><br>然后重新登录系统即可。</p>
<h1 id="关于环境变量"><a href="#关于环境变量" class="headerlink" title="关于环境变量"></a>关于环境变量</h1><p>如果以前用<code>.bashrc</code>配置环境变量，可能有些命令无法执行，需要拷贝里面<code>~/.bashrc</code>里面需要的内容放在<code>~/.zshrc</code>中。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> `~/.zshrc`</span><br></pre></td></tr></table></figure><br>重新加载即可。</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Zsh</tag>
      </tags>
  </entry>
  <entry>
    <title>中州韻輸入法的安装、配置和使用</title>
    <url>/2022/01/06/%E4%B8%AD%E5%B7%9E%E9%9F%BB%E8%BC%B8%E5%85%A5%E6%B3%95%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://rime.im/download/">中州韻輸入法官网</a></p>
<h1 id="安装fcitx-rime"><a href="#安装fcitx-rime" class="headerlink" title="安装fcitx-rime"></a>安装<code>fcitx-rime</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install fcitx-rime</span><br><span class="line">curl -x <span class="string">&quot;socks5://127.0.0.1:7890&quot;</span>  -fsSL https://git.io/rime-install | bash</span><br><span class="line">bash rime-install emoji</span><br></pre></td></tr></table></figure>
<p>参考资料：<br><a href="https://github.com/rime/rime-emoji">rime-emoji</a></p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>輸入法</tag>
        <tag>Rime</tag>
      </tags>
  </entry>
  <entry>
    <title>公历及农历和24节气转换</title>
    <url>/2021/06/27/%E5%85%AC%E5%8E%86%E5%8F%8A%E5%86%9C%E5%8E%86%E5%92%8C24%E8%8A%82%E6%B0%94%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、换算的js代码"><a href="#一、换算的js代码" class="headerlink" title="一、换算的js代码"></a>一、换算的<code>js</code>代码</h1><p>js文件名为：<code>date_new.js</code><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// JavaScript Document</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">RunGLNLJQ</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">/* 阳历部分 */</span></span><br><span class="line"><span class="keyword">var</span> today=<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">var</span> d=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;星期日&quot;</span>,<span class="string">&quot;星期一&quot;</span>,<span class="string">&quot;星期二&quot;</span>,<span class="string">&quot;星期三&quot;</span>,<span class="string">&quot;星期四&quot;</span>,<span class="string">&quot;星期五&quot;</span>,<span class="string">&quot;星期六&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">DDDD</span>=today.<span class="title function_">getFullYear</span>()+<span class="string">&quot;年&quot;</span>+[today.<span class="title function_">getMonth</span>()+<span class="number">1</span>]+<span class="string">&quot;月&quot;</span>+today.<span class="title function_">getDate</span>()+<span class="string">&quot;日&quot;</span>;</span><br><span class="line"><span class="comment">//intHours = today.getHours();</span></span><br><span class="line"><span class="comment">//intMinutes = today.getMinutes();</span></span><br><span class="line"><span class="comment">//intSeconds = today.getSeconds();</span></span><br><span class="line"><span class="comment">//if (intHours == 0) &#123;</span></span><br><span class="line"><span class="comment">//hours = &quot;12:&quot;;</span></span><br><span class="line"><span class="comment">//xfile = &quot;午夜&quot;;</span></span><br><span class="line"><span class="comment">//&#125; else if (intHours &lt; 12) &#123;</span></span><br><span class="line"><span class="comment">//hours = intHours+&quot;:&quot;;</span></span><br><span class="line"><span class="comment">//xfile = &quot;上午&quot;;</span></span><br><span class="line"><span class="comment">//&#125; else if (intHours == 12) &#123;</span></span><br><span class="line"><span class="comment">//hours = &quot;12:&quot;;</span></span><br><span class="line"><span class="comment">//xfile = &quot;正午&quot;;</span></span><br><span class="line"><span class="comment">//&#125; else &#123;</span></span><br><span class="line"><span class="comment">//intHours = intHours - 12</span></span><br><span class="line"><span class="comment">//hours = intHours + &quot;:&quot;;</span></span><br><span class="line"><span class="comment">//xfile = &quot;下午&quot;;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//if (intMinutes &lt; 10) &#123;</span></span><br><span class="line"><span class="comment">//minutes = &quot;0&quot;+intMinutes+&quot;:&quot;;</span></span><br><span class="line"><span class="comment">//&#125; else &#123;</span></span><br><span class="line"><span class="comment">//minutes = intMinutes+&quot;:&quot;;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//if (intSeconds &lt; 10) &#123;</span></span><br><span class="line"><span class="comment">//seconds = &quot;0&quot;+intSeconds+&quot; &quot;;</span></span><br><span class="line"><span class="comment">//&#125; else &#123;</span></span><br><span class="line"><span class="comment">//seconds = intSeconds+&quot; &quot;;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//DDDD=DDDD+xfile+hours+minutes+seconds;</span></span><br><span class="line"> <span class="variable constant_">DDDD</span>=<span class="variable constant_">DDDD</span>+<span class="string">&quot; &quot;</span>+ d[today.<span class="title function_">getDay</span>()];</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">DDDD</span> = <span class="variable constant_">DDDD</span>+ <span class="string">&quot; &quot;</span> + (<span class="title class_">CnDateofDateStr</span>(today)); <span class="comment">//显示农历</span></span><br><span class="line"><span class="variable constant_">DDDD</span> = <span class="variable constant_">DDDD</span>+<span class="title class_">SolarTerm</span>(today); <span class="comment">//显示二十四节气</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="variable constant_">DDDD</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">DaysNumberofDate</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parseInt</span>((<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="title class_">DateGL</span>)-<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="title class_">DateGL</span>.<span class="title function_">getFullYear</span>()+<span class="string">&quot;/1/1&quot;</span>))/<span class="number">86400000</span>)+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CnDateofDate</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnData</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(</span><br><span class="line"><span class="number">0x16</span>,<span class="number">0x2a</span>,<span class="number">0xda</span>,<span class="number">0x00</span>,<span class="number">0x83</span>,<span class="number">0x49</span>,<span class="number">0xb6</span>,<span class="number">0x05</span>,<span class="number">0x0e</span>,<span class="number">0x64</span>,<span class="number">0xbb</span>,<span class="number">0x00</span>,<span class="number">0x19</span>,<span class="number">0xb2</span>,<span class="number">0x5b</span>,<span class="number">0x00</span>, <span class="comment">//1997~2000</span></span><br><span class="line"><span class="number">0x87</span>,<span class="number">0x6a</span>,<span class="number">0x57</span>,<span class="number">0x04</span>,<span class="number">0x12</span>,<span class="number">0x75</span>,<span class="number">0x2b</span>,<span class="number">0x00</span>,<span class="number">0x1d</span>,<span class="number">0xb6</span>,<span class="number">0x95</span>,<span class="number">0x00</span>,<span class="number">0x8a</span>,<span class="number">0xad</span>,<span class="number">0x55</span>,<span class="number">0x02</span>, <span class="comment">//2001~2004</span></span><br><span class="line"><span class="number">0x15</span>,<span class="number">0x55</span>,<span class="number">0xaa</span>,<span class="number">0x00</span>,<span class="number">0x82</span>,<span class="number">0x55</span>,<span class="number">0x6c</span>,<span class="number">0x07</span>,<span class="number">0x0d</span>,<span class="number">0xc9</span>,<span class="number">0x76</span>,<span class="number">0x00</span>,<span class="number">0x17</span>,<span class="number">0x64</span>,<span class="number">0xb7</span>,<span class="number">0x00</span>, <span class="comment">//2005~2008</span></span><br><span class="line"><span class="number">0x86</span>,<span class="number">0xe4</span>,<span class="number">0xae</span>,<span class="number">0x05</span>,<span class="number">0x11</span>,<span class="number">0xea</span>,<span class="number">0x56</span>,<span class="number">0x00</span>,<span class="number">0x1b</span>,<span class="number">0x6d</span>,<span class="number">0x2a</span>,<span class="number">0x00</span>,<span class="number">0x88</span>,<span class="number">0x5a</span>,<span class="number">0xaa</span>,<span class="number">0x04</span>, <span class="comment">//2009~2012</span></span><br><span class="line"><span class="number">0x14</span>,<span class="number">0xad</span>,<span class="number">0x55</span>,<span class="number">0x00</span>,<span class="number">0x81</span>,<span class="number">0xaa</span>,<span class="number">0xd5</span>,<span class="number">0x09</span>,<span class="number">0x0b</span>,<span class="number">0x52</span>,<span class="number">0xea</span>,<span class="number">0x00</span>,<span class="number">0x16</span>,<span class="number">0xa9</span>,<span class="number">0x6d</span>,<span class="number">0x00</span>, <span class="comment">//2013~2016</span></span><br><span class="line"><span class="number">0x84</span>,<span class="number">0xa9</span>,<span class="number">0x5d</span>,<span class="number">0x06</span>,<span class="number">0x0f</span>,<span class="number">0xd4</span>,<span class="number">0xae</span>,<span class="number">0x00</span>,<span class="number">0x1a</span>,<span class="number">0xea</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,<span class="number">0x87</span>,<span class="number">0xba</span>,<span class="number">0x55</span>,<span class="number">0x04</span>, <span class="comment">//2017~2020</span></span><br><span class="line"><span class="number">0x12</span>,<span class="number">0x5a</span>,<span class="number">0xaa</span>,<span class="number">0x00</span>,<span class="number">0x16</span>,<span class="number">0xa9</span>,<span class="number">0x6d</span>,<span class="number">0x00</span>,<span class="number">0x8a</span>,<span class="number">0xa6</span>,<span class="number">0xd5</span>,<span class="number">0x02</span>,<span class="number">0x14</span>,<span class="number">0x52</span>,<span class="number">0xda</span>,<span class="number">0x00</span>, <span class="comment">//2021~2024</span></span><br><span class="line"><span class="number">0x82</span>,<span class="number">0x52</span>,<span class="number">0xba</span>,<span class="number">0x06</span>,<span class="number">0x8d</span>,<span class="number">0xa9</span>,<span class="number">0x3b</span>,<span class="number">0x00</span>,<span class="number">0x98</span>,<span class="number">0xb4</span>,<span class="number">0x9b</span>,<span class="number">0x00</span>,<span class="number">0x85</span>,<span class="number">0x74</span>,<span class="number">0x9b</span>,<span class="number">0x05</span>, <span class="comment">//2025~2028</span></span><br><span class="line"><span class="number">0x11</span>,<span class="number">0xb5</span>,<span class="number">0x4d</span>,<span class="number">0x00</span>,  <span class="comment">//2029年；另外2030年第一天冬月28，0x1c</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnMonth</span>=<span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnMonthDays</span>=<span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnBeginDay</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">LeapMonth</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Bytes</span>=<span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">var</span> I;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnMonthData</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">DaysCount</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnDaysCount</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ResultMonth</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ResultDay</span>;</span><br><span class="line"><span class="keyword">var</span> yyyy=<span class="title class_">DateGL</span>.<span class="title function_">getFullYear</span>();</span><br><span class="line"><span class="keyword">var</span> mm=<span class="title class_">DateGL</span>.<span class="title function_">getMonth</span>()+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> dd=<span class="title class_">DateGL</span>.<span class="title function_">getDate</span>();</span><br><span class="line"><span class="keyword">if</span>(yyyy&lt;<span class="number">100</span>) yyyy+=<span class="number">1900</span>;</span><br><span class="line">  <span class="keyword">if</span> ((yyyy &lt; <span class="number">1997</span>) || (yyyy &gt; <span class="number">2029</span>))&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="title class_">Bytes</span>[<span class="number">0</span>] = <span class="title class_">CnData</span>[(yyyy - <span class="number">1997</span>) * <span class="number">4</span>];</span><br><span class="line">  <span class="title class_">Bytes</span>[<span class="number">1</span>] = <span class="title class_">CnData</span>[(yyyy - <span class="number">1997</span>) * <span class="number">4</span> + <span class="number">1</span>];</span><br><span class="line">  <span class="title class_">Bytes</span>[<span class="number">2</span>] = <span class="title class_">CnData</span>[(yyyy - <span class="number">1997</span>) * <span class="number">4</span> + <span class="number">2</span>];</span><br><span class="line">  <span class="title class_">Bytes</span>[<span class="number">3</span>] = <span class="title class_">CnData</span>[(yyyy - <span class="number">1997</span>) * <span class="number">4</span> + <span class="number">3</span>];</span><br><span class="line">  <span class="keyword">if</span> ((<span class="title class_">Bytes</span>[<span class="number">0</span>] &amp; <span class="number">0x80</span>) != <span class="number">0</span>) &#123;<span class="title class_">CnMonth</span>[<span class="number">0</span>] = <span class="number">12</span>;&#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;<span class="title class_">CnMonth</span>[<span class="number">0</span>] = <span class="number">11</span>;&#125;</span><br><span class="line">  <span class="title class_">CnBeginDay</span> = (<span class="title class_">Bytes</span>[<span class="number">0</span>] &amp; <span class="number">0x7f</span>);</span><br><span class="line">  <span class="title class_">CnMonthData</span> = <span class="title class_">Bytes</span>[<span class="number">1</span>];</span><br><span class="line">  <span class="title class_">CnMonthData</span> = <span class="title class_">CnMonthData</span> &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  <span class="title class_">CnMonthData</span> = <span class="title class_">CnMonthData</span> | <span class="title class_">Bytes</span>[<span class="number">2</span>];</span><br><span class="line">  <span class="title class_">LeapMonth</span> = <span class="title class_">Bytes</span>[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">for</span> (I = <span class="number">15</span>; I &gt;= <span class="number">0</span> ; I--)&#123;</span><br><span class="line">    <span class="title class_">CnMonthDays</span>[<span class="number">15</span> - I] = <span class="number">29</span>;</span><br><span class="line">    <span class="keyword">if</span> (((<span class="number">1</span> &lt;&lt; I) &amp; <span class="title class_">CnMonthData</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">      <span class="title class_">CnMonthDays</span>[<span class="number">15</span> - I]++;&#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">CnMonth</span>[<span class="number">15</span> - I] == <span class="title class_">LeapMonth</span> )&#123;</span><br><span class="line">      <span class="title class_">CnMonth</span>[<span class="number">15</span> - I + <span class="number">1</span>] = - <span class="title class_">LeapMonth</span>;&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">CnMonth</span>[<span class="number">15</span> - I] &lt; <span class="number">0</span> )&#123;<span class="title class_">CnMonth</span>[<span class="number">15</span> - I + <span class="number">1</span>] = - <span class="title class_">CnMonth</span>[<span class="number">15</span> - I] + <span class="number">1</span>;&#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;<span class="title class_">CnMonth</span>[<span class="number">15</span> - I + <span class="number">1</span>] = <span class="title class_">CnMonth</span>[<span class="number">15</span> - I] + <span class="number">1</span>;&#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">CnMonth</span>[<span class="number">15</span> - I + <span class="number">1</span>] &gt; <span class="number">12</span> )&#123; <span class="title class_">CnMonth</span>[<span class="number">15</span> - I + <span class="number">1</span>] = <span class="number">1</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title class_">DaysCount</span> = <span class="title class_">DaysNumberofDate</span>(<span class="title class_">DateGL</span>) - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">DaysCount</span> &lt;= (<span class="title class_">CnMonthDays</span>[<span class="number">0</span>] - <span class="title class_">CnBeginDay</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span> ((yyyy &gt; <span class="number">1901</span>)  &amp;&amp;  (<span class="title class_">CnDateofDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>((yyyy - <span class="number">1</span>)+<span class="string">&quot;/12/31&quot;</span>)) &lt; <span class="number">0</span>))&#123;</span><br><span class="line">      <span class="title class_">ResultMonth</span> = - <span class="title class_">CnMonth</span>[<span class="number">0</span>];&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;<span class="title class_">ResultMonth</span> = <span class="title class_">CnMonth</span>[<span class="number">0</span>];&#125;</span><br><span class="line">    <span class="title class_">ResultDay</span> = <span class="title class_">CnBeginDay</span> + <span class="title class_">DaysCount</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title class_">CnDaysCount</span> = <span class="title class_">CnMonthDays</span>[<span class="number">0</span>] - <span class="title class_">CnBeginDay</span>;</span><br><span class="line">    I = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((<span class="title class_">CnDaysCount</span> &lt; <span class="title class_">DaysCount</span>)  &amp;&amp;  (<span class="title class_">CnDaysCount</span> + <span class="title class_">CnMonthDays</span>[I] &lt; <span class="title class_">DaysCount</span>))&#123;</span><br><span class="line">      <span class="title class_">CnDaysCount</span>+= <span class="title class_">CnMonthDays</span>[I];</span><br><span class="line">      I++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">ResultMonth</span> = <span class="title class_">CnMonth</span>[I];</span><br><span class="line">    <span class="title class_">ResultDay</span> = <span class="title class_">DaysCount</span> - <span class="title class_">CnDaysCount</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">ResultMonth</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ResultMonth</span> * <span class="number">100</span> + <span class="title class_">ResultDay</span>;&#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;<span class="keyword">return</span> <span class="title class_">ResultMonth</span> * <span class="number">100</span> - <span class="title class_">ResultDay</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CnYearofDate</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">YYYY</span>= <span class="title class_">DateGL</span>.<span class="title function_">getFullYear</span>();</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">MM</span> = <span class="title class_">DateGL</span>.<span class="title function_">getMonth</span>()+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnMM</span>=<span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="title class_">CnDateofDate</span>(<span class="title class_">DateGL</span>))/<span class="number">100</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable constant_">YYYY</span> &lt; <span class="number">100</span>) <span class="variable constant_">YYYY</span> += <span class="number">1900</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title class_">CnMM</span> &gt; <span class="variable constant_">MM</span>) <span class="variable constant_">YYYY</span>--;</span><br><span class="line"><span class="variable constant_">YYYY</span> -= <span class="number">1864</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title class_">CnEra</span>(<span class="variable constant_">YYYY</span>) + <span class="string">&quot;年&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CnMonthofDate</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line"><span class="keyword">var</span>  <span class="title class_">CnMonthStr</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;零&quot;</span>,<span class="string">&quot;正&quot;</span>,<span class="string">&quot;二&quot;</span>,<span class="string">&quot;三&quot;</span>,<span class="string">&quot;四&quot;</span>,<span class="string">&quot;五&quot;</span>,<span class="string">&quot;六&quot;</span>,<span class="string">&quot;七&quot;</span>,<span class="string">&quot;八&quot;</span>,<span class="string">&quot;九&quot;</span>,<span class="string">&quot;十&quot;</span>,<span class="string">&quot;冬&quot;</span>,<span class="string">&quot;腊&quot;</span>);</span><br><span class="line"><span class="keyword">var</span>  <span class="title class_">Month</span>;</span><br><span class="line">  <span class="title class_">Month</span> = <span class="built_in">parseInt</span>(<span class="title class_">CnDateofDate</span>(<span class="title class_">DateGL</span>)/<span class="number">100</span>);</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Month</span> &lt; <span class="number">0</span>)&#123;<span class="keyword">return</span> <span class="string">&quot;闰&quot;</span> + <span class="title class_">CnMonthStr</span>[-<span class="title class_">Month</span>] + <span class="string">&quot;月&quot;</span>;&#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;<span class="keyword">return</span> <span class="title class_">CnMonthStr</span>[<span class="title class_">Month</span>] + <span class="string">&quot;月&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CnDayofDate</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CnDayStr</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;零&quot;</span>,</span><br><span class="line">    <span class="string">&quot;初一&quot;</span>, <span class="string">&quot;初二&quot;</span>, <span class="string">&quot;初三&quot;</span>, <span class="string">&quot;初四&quot;</span>, <span class="string">&quot;初五&quot;</span>,</span><br><span class="line">    <span class="string">&quot;初六&quot;</span>, <span class="string">&quot;初七&quot;</span>, <span class="string">&quot;初八&quot;</span>, <span class="string">&quot;初九&quot;</span>, <span class="string">&quot;初十&quot;</span>,</span><br><span class="line">    <span class="string">&quot;十一&quot;</span>, <span class="string">&quot;十二&quot;</span>, <span class="string">&quot;十三&quot;</span>, <span class="string">&quot;十四&quot;</span>, <span class="string">&quot;十五&quot;</span>,</span><br><span class="line">    <span class="string">&quot;十六&quot;</span>, <span class="string">&quot;十七&quot;</span>, <span class="string">&quot;十八&quot;</span>, <span class="string">&quot;十九&quot;</span>, <span class="string">&quot;二十&quot;</span>,</span><br><span class="line">    <span class="string">&quot;廿一&quot;</span>, <span class="string">&quot;廿二&quot;</span>, <span class="string">&quot;廿三&quot;</span>, <span class="string">&quot;廿四&quot;</span>, <span class="string">&quot;廿五&quot;</span>,</span><br><span class="line">    <span class="string">&quot;廿六&quot;</span>, <span class="string">&quot;廿七&quot;</span>, <span class="string">&quot;廿八&quot;</span>, <span class="string">&quot;廿九&quot;</span>, <span class="string">&quot;三十&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Day</span>;</span><br><span class="line">  <span class="title class_">Day</span> = (<span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="title class_">CnDateofDate</span>(<span class="title class_">DateGL</span>)))%<span class="number">100</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">CnDayStr</span>[<span class="title class_">Day</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">DaysNumberofMonth</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">MM1</span>=<span class="title class_">DateGL</span>.<span class="title function_">getFullYear</span>();</span><br><span class="line">    <span class="title class_">MM1</span>&lt;<span class="number">100</span> ? <span class="title class_">MM1</span>+=<span class="number">1900</span>:<span class="title class_">MM1</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">MM2</span>=<span class="title class_">MM1</span>;</span><br><span class="line">    <span class="title class_">MM1</span>+=<span class="string">&quot;/&quot;</span>+(<span class="title class_">DateGL</span>.<span class="title function_">getMonth</span>()+<span class="number">1</span>);</span><br><span class="line">    <span class="title class_">MM2</span>+=<span class="string">&quot;/&quot;</span>+(<span class="title class_">DateGL</span>.<span class="title function_">getMonth</span>()+<span class="number">2</span>);</span><br><span class="line">    <span class="title class_">MM1</span>+=<span class="string">&quot;/1&quot;</span>;</span><br><span class="line">    <span class="title class_">MM2</span>+=<span class="string">&quot;/1&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parseInt</span>((<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="title class_">MM2</span>)-<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="title class_">MM1</span>))/<span class="number">86400000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CnEra</span>(<span class="params">YYYY</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Tiangan</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;甲&quot;</span>,<span class="string">&quot;乙&quot;</span>,<span class="string">&quot;丙&quot;</span>,<span class="string">&quot;丁&quot;</span>,<span class="string">&quot;戊&quot;</span>,<span class="string">&quot;己&quot;</span>,<span class="string">&quot;庚&quot;</span>,<span class="string">&quot;辛&quot;</span>,<span class="string">&quot;壬&quot;</span>,<span class="string">&quot;癸&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Dizhi</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;子(鼠)&quot;</span>,<span class="string">&quot;丑(牛)&quot;</span>,<span class="string">&quot;寅(虎)&quot;</span>,<span class="string">&quot;卯(兔)&quot;</span>,<span class="string">&quot;辰(龙)&quot;</span>,<span class="string">&quot;巳(蛇)&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;午(马)&quot;</span>,<span class="string">&quot;未(羊)&quot;</span>,<span class="string">&quot;申(猴)&quot;</span>,<span class="string">&quot;酉(鸡)&quot;</span>,<span class="string">&quot;戌(狗)&quot;</span>,<span class="string">&quot;亥(猪)&quot;</span>);</span><br><span class="line"><span class="comment">//var Dizhi=new Array(&quot;子&quot;,&quot;丑&quot;,&quot;寅&quot;,&quot;卯&quot;,&quot;辰&quot;,&quot;巳&quot;,&quot;午&quot;,&quot;未&quot;,&quot;申&quot;,&quot;酉&quot;,&quot;戌&quot;,&quot;亥&quot;);</span></span><br><span class="line"><span class="keyword">return</span> <span class="title class_">Tiangan</span>[<span class="variable constant_">YYYY</span>%<span class="number">10</span>]+<span class="title class_">Dizhi</span>[<span class="variable constant_">YYYY</span>%<span class="number">12</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CnDateofDateStr</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title class_">CnMonthofDate</span>(<span class="title class_">DateGL</span>)==<span class="string">&quot;零月&quot;</span>) <span class="keyword">return</span> <span class="string">&quot;　请调整您的计算机日期!&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="string">&quot; &quot;</span>+<span class="title class_">CnYearofDate</span>(<span class="title class_">DateGL</span>)+ <span class="string">&quot; &quot;</span> + <span class="title class_">CnMonthofDate</span>(<span class="title class_">DateGL</span>) + <span class="title class_">CnDayofDate</span>(<span class="title class_">DateGL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SolarTerm</span>(<span class="params">DateGL</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">SolarTermStr</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(</span><br><span class="line">        <span class="string">&quot;小寒&quot;</span>,<span class="string">&quot;大寒&quot;</span>,<span class="string">&quot;立春&quot;</span>,<span class="string">&quot;雨水&quot;</span>,<span class="string">&quot;惊蛰&quot;</span>,<span class="string">&quot;春分&quot;</span>,</span><br><span class="line">        <span class="string">&quot;清明&quot;</span>,<span class="string">&quot;谷雨&quot;</span>,<span class="string">&quot;立夏&quot;</span>,<span class="string">&quot;小满&quot;</span>,<span class="string">&quot;芒种&quot;</span>,<span class="string">&quot;夏至&quot;</span>,</span><br><span class="line">        <span class="string">&quot;小暑&quot;</span>,<span class="string">&quot;大暑&quot;</span>,<span class="string">&quot;立秋&quot;</span>,<span class="string">&quot;处暑&quot;</span>,<span class="string">&quot;白露&quot;</span>,<span class="string">&quot;秋分&quot;</span>,</span><br><span class="line">        <span class="string">&quot;寒露&quot;</span>,<span class="string">&quot;霜降&quot;</span>,<span class="string">&quot;立冬&quot;</span>,<span class="string">&quot;小雪&quot;</span>,<span class="string">&quot;大雪&quot;</span>,<span class="string">&quot;冬至&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">DifferenceInMonth</span>=<span class="keyword">new</span> <span class="title class_">Array</span>(</span><br><span class="line">        <span class="number">1272060</span>, <span class="number">1275495</span>, <span class="number">1281180</span>, <span class="number">1289445</span>, <span class="number">1299225</span>, <span class="number">1310355</span>,</span><br><span class="line">        <span class="number">1321560</span>, <span class="number">1333035</span>, <span class="number">1342770</span>, <span class="number">1350855</span>, <span class="number">1356420</span>, <span class="number">1359045</span>,</span><br><span class="line">        <span class="number">1358580</span>, <span class="number">1355055</span>, <span class="number">1348695</span>, <span class="number">1340040</span>, <span class="number">1329630</span>, <span class="number">1318455</span>,</span><br><span class="line">        <span class="number">1306935</span>, <span class="number">1297380</span>, <span class="number">1286865</span>, <span class="number">1278430</span>, <span class="number">1274550</span>, <span class="number">1271556</span>);</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">DifferenceInYear</span>=<span class="number">31556926</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">BeginTime</span>=<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1901</span>/<span class="number">1</span>/<span class="number">1</span>);</span><br><span class="line">  <span class="title class_">BeginTime</span>.<span class="title function_">setTime</span>(<span class="number">947120460000</span>);</span><br><span class="line">     <span class="keyword">for</span>(;<span class="title class_">DateGL</span>.<span class="title function_">getFullYear</span>()&lt;<span class="title class_">BeginTime</span>.<span class="title function_">getFullYear</span>();)&#123;</span><br><span class="line">        <span class="title class_">BeginTime</span>.<span class="title function_">setTime</span>(<span class="title class_">BeginTime</span>.<span class="title function_">getTime</span>()-<span class="title class_">DifferenceInYear</span>*<span class="number">1000</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">for</span>(;<span class="title class_">DateGL</span>.<span class="title function_">getFullYear</span>()&gt;<span class="title class_">BeginTime</span>.<span class="title function_">getFullYear</span>();)&#123;</span><br><span class="line">        <span class="title class_">BeginTime</span>.<span class="title function_">setTime</span>(<span class="title class_">BeginTime</span>.<span class="title function_">getTime</span>()+<span class="title class_">DifferenceInYear</span>*<span class="number">1000</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">var</span> M=<span class="number">0</span>;<span class="title class_">DateGL</span>.<span class="title function_">getMonth</span>()&gt;<span class="title class_">BeginTime</span>.<span class="title function_">getMonth</span>();M++)&#123;</span><br><span class="line">        <span class="title class_">BeginTime</span>.<span class="title function_">setTime</span>(<span class="title class_">BeginTime</span>.<span class="title function_">getTime</span>()+<span class="title class_">DifferenceInMonth</span>[M]*<span class="number">1000</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span>(<span class="title class_">DateGL</span>.<span class="title function_">getDate</span>()&gt;<span class="title class_">BeginTime</span>.<span class="title function_">getDate</span>())&#123;</span><br><span class="line">        <span class="title class_">BeginTime</span>.<span class="title function_">setTime</span>(<span class="title class_">BeginTime</span>.<span class="title function_">getTime</span>()+<span class="title class_">DifferenceInMonth</span>[M]*<span class="number">1000</span>);</span><br><span class="line">        M++;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span>(<span class="title class_">DateGL</span>.<span class="title function_">getDate</span>()&gt;<span class="title class_">BeginTime</span>.<span class="title function_">getDate</span>())&#123;</span><br><span class="line">        <span class="title class_">BeginTime</span>.<span class="title function_">setTime</span>(<span class="title class_">BeginTime</span>.<span class="title function_">getTime</span>()+<span class="title class_">DifferenceInMonth</span>[M]*<span class="number">1000</span>);</span><br><span class="line">        M==<span class="number">23</span>?M=<span class="number">0</span>:M++;</span><br><span class="line">     &#125;</span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">JQ</span>=<span class="string">&quot; &quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title class_">DateGL</span>.<span class="title function_">getDate</span>()==<span class="title class_">BeginTime</span>.<span class="title function_">getDate</span>())&#123;</span><br><span class="line">    <span class="variable constant_">JQ</span>+=<span class="string">&quot;   今天 &lt;font color=&#x27;#8B0000&#x27;&gt;&quot;</span>+<span class="title class_">SolarTermStr</span>[M]+<span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title class_">DateGL</span>.<span class="title function_">getDate</span>()==<span class="title class_">BeginTime</span>.<span class="title function_">getDate</span>()-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="variable constant_">JQ</span>+=<span class="string">&quot;　 明天 &lt;font color=&#x27;red&#x27;&gt;&lt;b&gt;&quot;</span>+<span class="title class_">SolarTermStr</span>[M]+<span class="string">&quot;&lt;/b&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title class_">DateGL</span>.<span class="title function_">getDate</span>()==<span class="title class_">BeginTime</span>.<span class="title function_">getDate</span>()-<span class="number">2</span>)&#123;</span><br><span class="line">    <span class="variable constant_">JQ</span>+=<span class="string">&quot;　 后天 &lt;font color=&#x27;red&#x27;&gt;&lt;b&gt;&quot;</span>+<span class="title class_">SolarTermStr</span>[M]+ <span class="string">&quot;&lt;/b&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="variable constant_">JQ</span>=<span class="string">&quot;   &quot;</span>;</span><br><span class="line">   <span class="keyword">if</span>(<span class="title class_">DateGL</span>.<span class="title function_">getMonth</span>()==<span class="title class_">BeginTime</span>.<span class="title function_">getMonth</span>())&#123;</span><br><span class="line">      <span class="variable constant_">JQ</span>+=<span class="string">&quot; 本月&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="variable constant_">JQ</span>+=<span class="string">&quot; 下月&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable constant_">JQ</span>+=<span class="title class_">BeginTime</span>.<span class="title function_">getDate</span>()+<span class="string">&quot;日&quot;</span>+<span class="string">&quot;&lt;font color=&#x27;blue&#x27;&gt;&quot;</span>+<span class="title class_">SolarTermStr</span>[M]+<span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="variable constant_">JQ</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>【代码未查到作者，因此没办法注明来源！】<br>其中公农历转换16进制数组说明：  </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//用1997年举例:</span></span><br><span class="line"><span class="comment">// CnData前四个数据是 0x16 0x2a 0xda 0x00</span></span><br><span class="line"><span class="comment">// 第一个字节0x16共8位</span></span><br><span class="line"><span class="comment">// 第1位表示第一个月是冬月[0]还是腊月[1]</span></span><br><span class="line"><span class="comment">// 后7位表示第一天的日期  </span></span><br><span class="line"><span class="comment">//即：  </span></span><br><span class="line"><span class="comment">// 0x16 = 0001 0110  1997年第一个月是冬月22，其中22对应后七位001 0110，左边第一位0，对应冬月</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二三字节0x2a 0xda</span></span><br><span class="line"><span class="comment">// 0x2a 0xda = 0010 1010 1101 1010  共16位 余下4位可继续表示后面连续四个月情况</span></span><br><span class="line"><span class="comment">// 前12位,每一位表示全年大小月情况 小月29天[0], 大月30天[1]</span></span><br><span class="line"><span class="comment">// 冬 腊 正 二   三 四 五 六   七 八 九 十   冬 腊 正 二</span></span><br><span class="line"><span class="comment">// 小 小 大 小   大 小 大 小   大 大 小 大   大 小 大 小</span></span><br><span class="line"><span class="comment">//  0  0 1  0    1  0  1  0   1  1  0  1   1  0  1 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第四个字节0x00共8位</span></span><br><span class="line"><span class="comment">// 表示闰月情况,0表示不闰月, 1998年0x05表示润五月</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 又如1998年：</span></span><br><span class="line"><span class="comment">// 0x83,0x49,0xb6,0x05</span></span><br><span class="line"><span class="comment">// 0x83 = 1000 0011  1998年第一个月是腊月初3，其中3对应000 0011</span></span><br><span class="line"><span class="comment">// 0x49,0xb6 = 0100 1001 1011 0110</span></span><br><span class="line"><span class="comment">// 腊 正 二  三   四 五 润五 六   七 八 九 十   冬 腊 正 二</span></span><br><span class="line"><span class="comment">// 小 大 小  小   大 小 小   大   大 小 大 大   小 大 大 小</span></span><br><span class="line"><span class="comment">//  0 1  0   0    1  0  0   1    1  0  1  1   0  1  1  0</span></span><br><span class="line"><span class="comment">//  0x05 = 润五月</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//其他对应：</span></span><br><span class="line"><span class="comment">// 0x83 = 1000 0011  1998年第一个月是腊月初3，其中3对应000 0011</span></span><br><span class="line"><span class="comment">// 0x0e = 0000 1110  1999年第一个月是冬月14，其中14对应000 1110</span></span><br><span class="line"><span class="comment">// 0x19 = 0001 1001  2000年第一个月是冬月25，其中25对应001 1001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x87 = 1000 0111  2020年第一个月是腊月初7，其中7对应000 0111</span></span><br><span class="line"><span class="comment">// 0x12 = 0001 0010  2021年第一个月是冬月18，其中25对应001 0010</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2021年</span></span><br><span class="line"><span class="comment">// 0x12,0xba,0x55,0x00</span></span><br><span class="line"><span class="comment">// 0x12 = 0001 0010，2021年第一个月是冬月18，其中冬月对应--0，18对应--001 0010，</span></span><br><span class="line"><span class="comment">// 0x5a,0xaa = 0101 1010 1010 1010 </span></span><br><span class="line"><span class="comment">// 0x00 = 无闰月</span></span><br></pre></td></tr></table></figure>
<h1 id="二、html页面引用"><a href="#二、html页面引用" class="headerlink" title="二、html页面引用"></a>二、<code>html</code>页面引用</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>公农历转换及24节气计算<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&#x27;text/javascript&#x27;</span> <span class="attr">src</span>=<span class="string">&#x27;./js/date_new.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> 今天是  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span>RunGLNLJQ();<span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>程序语言</category>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>公农历转换</tag>
      </tags>
  </entry>
  <entry>
    <title>删除当前目录下非文件夹文件命令</title>
    <url>/2020/11/22/%E5%88%A0%E9%99%A4%E9%9D%9E%E6%96%87%E4%BB%B6%E5%A4%B9%E6%96%87%E4%BB%B6%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>删除当前目录下非文件夹文件命令<br><code>ls --file-type | grep -v &quot;/$&quot; | xargs rm -f</code><br>说明：</p>
<h1 id="1、ls-file-type-gt-列出当前目录下所有的文件和文件夹"><a href="#1、ls-file-type-gt-列出当前目录下所有的文件和文件夹" class="headerlink" title="1、ls --file-type ==&gt; 列出当前目录下所有的文件和文件夹"></a>1、<code>ls --file-type</code> ==&gt; 列出当前目录下所有的文件和文件夹</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/文档/程序设计/C语言$ <span class="built_in">ls</span> --file-type </span><br><span class="line">判断/  删除非文件夹命令  数据类型/  数组/  循环/  指针/  综合练习/  c_lan/</span><br></pre></td></tr></table></figure>
<h1 id="2、-grep-v-quot-quot-gt-管道命令，过滤掉文件夹"><a href="#2、-grep-v-quot-quot-gt-管道命令，过滤掉文件夹" class="headerlink" title="2、| grep -v &quot;/$&quot; ==&gt; 管道命令，过滤掉文件夹"></a>2、<code>| grep -v &quot;/$&quot;</code> ==&gt; 管道命令，过滤掉文件夹</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/文档/程序设计/C语言$ <span class="built_in">ls</span> --file-type | grep -v <span class="string">&quot;/$&quot;</span></span><br><span class="line">删除非文件夹命令</span><br></pre></td></tr></table></figure>
<h1 id="3、xargs-gt-eXtended-ARGumentS"><a href="#3、xargs-gt-eXtended-ARGumentS" class="headerlink" title="3、xargs ==&gt; eXtended ARGumentS,"></a>3、<code>xargs</code> ==&gt; eXtended ARGumentS,</h1><p>用于给其他命令传递参数的一个过滤器，通过<code>xargs</code>传递给后面命令<code>rm</code>参数，删除符合前面管道符合条件的文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/文档/程序设计/C语言$ <span class="built_in">ls</span> --file-type | grep -v <span class="string">&quot;/$&quot;</span> | xargs <span class="built_in">rm</span> -f</span><br><span class="line">user@user-pc:~/文档/程序设计/C语言$ <span class="built_in">ls</span> --file-type</span><br><span class="line">判断/  数据类型/  数组/  循环/  指针/  综合练习/  c_lan/</span><br></pre></td></tr></table></figure></p>
<h1 id="一些用法举例："><a href="#一些用法举例：" class="headerlink" title="一些用法举例："></a>一些用法举例：</h1><p>1、创建<code>t1</code>、<code>t2</code>、<code>t3</code>三个文件夹<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/文档/test$ <span class="built_in">ls</span> -al</span><br><span class="line">总用量 8</span><br><span class="line">drwxr-xr-x  2 user user 4096 11月 24 17:47 .</span><br><span class="line">drwxr-xr-x 11 user user 4096 11月 18 13:18 ..</span><br><span class="line">user@user-pc:~/文档/test$ <span class="built_in">echo</span> <span class="string">&#x27;t1 t2 t3&#x27;</span> | xargs <span class="built_in">mkdir</span></span><br><span class="line">user@user-pc:~/文档/test$ <span class="built_in">ls</span> -al</span><br><span class="line">总用量 20</span><br><span class="line">drwxr-xr-x  5 user user 4096 11月 24 17:50 .</span><br><span class="line">drwxr-xr-x 11 user user 4096 11月 18 13:18 ..</span><br><span class="line">drwxr-xr-x  2 user user 4096 11月 24 17:50 t1</span><br><span class="line">drwxr-xr-x  2 user user 4096 11月 24 17:50 t2</span><br><span class="line">drwxr-xr-x  2 user user 4096 11月 24 17:50 t3</span><br></pre></td></tr></table></figure><br>2、创建文本<code>test.txt</code>分行输入<code>one two three</code>，然后读取根据<code>test.txt</code>内容并根据内容创建<code>one two three</code>三个文件夹<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/文档/test$ <span class="built_in">touch</span> test.txt &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&#x27;one\ntwo\nthree&#x27;</span> &gt; test.txt</span><br><span class="line">user@user-pc:~/文档/test$ <span class="built_in">cat</span> test.txt | xargs -I file sh -c <span class="string">&#x27;echo file; mkdir file&#x27;</span></span><br><span class="line"><span class="comment"># 以上命令合并为：</span></span><br><span class="line"><span class="comment"># touch test.txt &amp;&amp; echo -e &#x27;one\ntwo\nthree&#x27; &gt; test.txt &amp;&amp; cat test.txt | xargs -I file sh -c &#x27;echo file; mkdir file&#x27;</span></span><br><span class="line">one</span><br><span class="line">two</span><br><span class="line">three</span><br><span class="line">user@user-pc:~/文档/test$ <span class="built_in">ls</span></span><br><span class="line">one  test.txt  three  two</span><br></pre></td></tr></table></figure><br><code>-I</code> ==&gt; 指定每一项命令行参数的替代字符串<br><code>-I file</code> ==&gt; <code>file</code>是命令行参数的替代字符<br>后面命令行中<code>file</code>将被替换前面传递过来的<code>one</code>、<code>two</code>、<code>three</code>替换<br>3、删除<code>*.txt</code>文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/文档/test$ <span class="built_in">ls</span> --file-type | grep <span class="string">&quot;txt&quot;</span> | xargs <span class="built_in">rm</span></span><br><span class="line"><span class="comment"># ls --file-type | grep -v &quot;/$&quot; | xargs rm  // 针对例2的文件夹</span></span><br><span class="line">user@user-pc:~/文档/test$ <span class="built_in">ls</span></span><br><span class="line">one  three  two</span><br></pre></td></tr></table></figure></p>
<p><code>xargs</code>详细介绍可查询：<br><a href="http://c.biancheng.net/linux/xargs.html">xargs命令_Linux xargs命令：一个给其他命令传递参数的过滤器</a></p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>命令</category>
      </categories>
      <tags>
        <tag>Grep</tag>
        <tag>Xargs</tag>
      </tags>
  </entry>
  <entry>
    <title>在Debian10上配置Hexo+Github做个人博客</title>
    <url>/2020/12/19/%E5%9C%A8Debian10%E4%B8%8A%E9%85%8D%E7%BD%AEHexo+Github%E5%81%9A%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在<code>Debian10</code>上配置<code>Hexo+Github</code>做个人博客  </p>
<h1 id="一、nvm安装node"><a href="#一、nvm安装node" class="headerlink" title="一、nvm安装node"></a>一、<code>nvm</code>安装<code>node</code></h1><h2 id="安装nvm"><a href="#安装nvm" class="headerlink" title="安装nvm"></a>安装<code>nvm</code></h2><p>命令：<br><code>cURL</code>:<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ curl https://raw.github.com/creationix/nvm/master/install.sh | sh</span><br></pre></td></tr></table></figure><br>或者<code>wget</code>:<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget -qO- https://raw.github.com/creationix/nvm/master/install.sh | sh</span><br></pre></td></tr></table></figure></p>
<h3 id="解决nvm安装成功后，但命令不可用-command-not-found"><a href="#解决nvm安装成功后，但命令不可用-command-not-found" class="headerlink" title="解决nvm安装成功后，但命令不可用(command not found)"></a>解决<code>nvm</code>安装成功后，但命令不可用(<code>command not found</code>)</h3><p>运行以下命令<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><br><del>输入以下内容</del>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span>~~</span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span>  <span class="comment"># This loads nvm</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/bash_completion&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/bash_completion&quot;</span>  <span class="comment"># This loads nvm bash_completion</span></span><br></pre></td></tr></table></figure><br><del>查看输入内容：</del><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/.nvm$ <span class="built_in">cat</span> .bash_profile</span><br><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span></span><br></pre></td></tr></table></figure><br>加载环境变量，使其生效。<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></p>
<h3 id="解决node-没有那个文件或目录"><a href="#解决node-没有那个文件或目录" class="headerlink" title="解决node: 没有那个文件或目录"></a>解决<code>node: 没有那个文件或目录</code></h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm install -g hexo-cli</span><br><span class="line"><span class="comment">##/usr/bin/env: “node”: 没有那个文件或目录</span></span><br></pre></td></tr></table></figure>
<p>用<code>ln -s</code>命令设置一个软链接<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">ln</span> -s ~/.nvm/versions/node/v14.15.2/bin/node /usr/bin/node</span><br></pre></td></tr></table></figure></p>
<h2 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装<code>node</code></h2><h3 id="查看可安装版本："><a href="#查看可安装版本：" class="headerlink" title="查看可安装版本："></a>查看可安装版本：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nvm ls-remote</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">      v16.13.0   (LTS: Gallium)</span><br><span class="line">       v16.13.1   (Latest LTS: Gallium)</span><br><span class="line">        v17.0.0</span><br><span class="line">        v17.0.1</span><br><span class="line">        v17.1.0</span><br><span class="line">        v17.2.0</span><br></pre></td></tr></table></figure>
<h3 id="安装node-1"><a href="#安装node-1" class="headerlink" title="安装node"></a>安装<code>node</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvm install 16.13.1</span><br><span class="line">Downloading and installing node v16.13.1...</span><br><span class="line">Downloading https://nodejs.org/dist/v16.13.1/node-v16.13.1-linux-x64.tar.xz...</span><br><span class="line"><span class="comment">######################################################################### 100.0%</span></span><br><span class="line">Computing checksum with <span class="built_in">sha256sum</span></span><br><span class="line">Checksums matched!</span><br><span class="line">Now using node v16.13.1 (npm v8.1.2)</span><br><span class="line">Creating default <span class="built_in">alias</span>: default -&gt; 16.13.1 (-&gt; v16.13.1)</span><br></pre></td></tr></table></figure>
<h3 id="查看已安装node"><a href="#查看已安装node" class="headerlink" title="查看已安装node"></a>查看已安装<code>node</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nvm list</span><br><span class="line">-&gt;     v16.13.1</span><br><span class="line">default -&gt; 16.13.1 (-&gt; v16.13.1)</span><br></pre></td></tr></table></figure>
<h3 id="使用某个已安装node版本"><a href="#使用某个已安装node版本" class="headerlink" title="使用某个已安装node版本"></a>使用某个已安装<code>node</code>版本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nvm use 14.18.2</span><br></pre></td></tr></table></figure>
<h2 id="查看npm版本"><a href="#查看npm版本" class="headerlink" title="查看npm版本"></a>查看<code>npm</code>版本</h2><p>node已经附带安装npm，无需单独安装,查看其版本：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm -v</span><br><span class="line">8.1.2</span><br></pre></td></tr></table></figure><br>如果不是最新版本，运行指令<br><code>npm install -g npm</code><br>如果想更新到指定版本，运行指令<br><code>npm -g install npm@6.8.0</code>  </p>
<p><a href="https://github.com/nvm-sh/nvm"><code>nvm</code>开源项目地址</a></p>
<h2 id="其他升级nodejs方法："><a href="#其他升级nodejs方法：" class="headerlink" title="其他升级nodejs方法："></a>其他升级<code>nodejs</code>方法：</h2><h4 id="（1）用n升级nodejs"><a href="#（1）用n升级nodejs" class="headerlink" title="（1）用n升级nodejs"></a>（1）用<code>n</code>升级<code>nodejs</code></h4><p> 全局安装n<br><code>npm install -g n</code><br> 升级到最新稳定版<br><code>n stable</code><br> 升级到最新版<br><code>n latest</code><br> 升级到定制版<br><code>n v7.10.0</code><br> 切换使用版本<br><code>n 7.10.0 (ENTER)</code><br> 删除制定版本<br><code>n rm 7.10.0</code><br>用制定的版本执行脚本<br><code>n use 7.10.0 some.js</code>  </p>
<h2 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装<code>git</code></h2><p>命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/.nvm$ npm install --lts  <span class="comment">##长期支持版本</span></span><br></pre></td></tr></table></figure><br>将<code>Debian10.1</code>中默认的<code>node</code>更改文件名：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> /usr/bin/node /usr/bin/node10</span><br></pre></td></tr></table></figure><br>在<code>/etc/profile</code>,添加新的<code>node</code>路径 <code>/usr/local/bin</code></p>
<p><code>export PATH=$PATH:/usr/local/bin</code></p>
<h1 id="二、安装Next主题并部署到github【含从wordpress中导出】"><a href="#二、安装Next主题并部署到github【含从wordpress中导出】" class="headerlink" title="二、安装Next主题并部署到github【含从wordpress中导出】"></a>二、安装<code>Next</code>主题并部署到<code>github</code>【含从<code>wordpress</code>中导出】</h1><h2 id="1、按照Github提示，创建SSH秘钥："><a href="#1、按照Github提示，创建SSH秘钥：" class="headerlink" title="1、按照Github提示，创建SSH秘钥："></a>1、按照<code>Github</code>提示，创建<code>SSH秘钥</code>：</h2><p>（1）命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ~/.ssh</span><br><span class="line"><span class="built_in">cd</span> ~/.ssh</span><br><span class="line">user@user-pc:~/.ssh$ ssh-keygen -t rsa -C <span class="string">&quot;邮箱地址&quot;</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/用户名/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/用户名/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/用户名/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:0NY9YEJ+aCViuJzyv**juiZ8 邮箱地址</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|     .o.*o++.    |</span></span><br><span class="line"><span class="string">|    .. * B=o     |</span></span><br><span class="line"><span class="string">|  o. o      o    |</span></span><br><span class="line"><span class="string">| ..o+o *     .   |</span></span><br><span class="line"><span class="string">|   o*.o So .     |</span></span><br><span class="line"><span class="string">| . =.o. .        |</span></span><br><span class="line"><span class="string">|  * .... . .     |</span></span><br><span class="line"><span class="string">| oo.o..          |</span></span><br><span class="line"><span class="string">| .o=             |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">user@user-pc:~/.ssh$ ls -a</span></span><br><span class="line"><span class="string">.  ..  id_rsa  id_rsa.pub</span></span><br><span class="line"><span class="string">user@user-pc:~/.ssh$ cat id_rsa.pub</span></span><br><span class="line"><span class="string">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXoLe6b+9fvDT/L8hcz***************eh+GK4vVv+1dyv9 注册github的邮箱</span></span><br></pre></td></tr></table></figure></p>
<p>（2）打开<code>https://github.com/settings/keys</code>，点击<code>New SSH key</code>新增 <code>SSH KEY</code>，tittle<code>debian10</code>内容如上<br>（3）新建并配置<code>github</code>仓库<br>  ①打开<code>https://github.com/</code>登录后，在右上角点击<code>+</code>==&gt;<code>New repository</code>==&gt;<code>Repository name</code>输入：<code>XXX.github.io</code>==&gt;<code>Create repository</code><br>  ②进入新仓库，<code>Add file</code>==&gt;文件名<code>CNAME</code>,内容<code>你的域名</code>（域名需自己注册，没域名就直接用<code>XXX.github.io</code>访问网页）。<br>  ③点击仓库右边<code>Settins</code>==&gt;网页下方<code>pages</code>==&gt;<code>Source</code>选择<code>master</code>(因为网页文件上传是传到<code>master</code>分支)==&gt;<code>Custom domain</code>根据上面<code>你的域名</code>填写。  </p>
<p>关于域名解析在主机运营商处填写，比如<code>WWW</code>或者<code>@</code>等，记录值填写<code>XXX.github.io</code>.  </p>
<p>（4）在电脑上配置<code>git</code><br>在<code>debian</code>终端输入命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;注册github的用户名&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;注册github的邮箱&quot;</span></span><br></pre></td></tr></table></figure><br>其他命令<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git config --list  查看git配置</span><br><span class="line">ssh -T git@github.com 查看与git的连接</span><br><span class="line">[sudo] yk 的密码：</span><br><span class="line">ssh: connect to host github.com port 22: Connection timed out</span><br></pre></td></tr></table></figure><br>连接提示错误解决方法：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/.ssh$ sudo vim config</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">User 注册github的邮箱</span><br><span class="line">Hostname ssh.github.com</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityFile ~/.ssh/id_rsa</span><br><span class="line">Port 443</span><br></pre></td></tr></table></figure><br>设置和取消代理:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy 你的代理地址</span><br><span class="line">git config --global https.proxy 你的代理地址</span><br></pre></td></tr></table></figure><br><strong><code>http://</code>也可以改成<code>sockets5://</code>,但是区别在于：<code>socks5</code>不支持通过<code>pubkey</code>免密登录<code>github</code>，每次提交代码只能输入用户名和密码,<code>http</code>可以支持免密登录。</strong><br>取消代理：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global --<span class="built_in">unset</span> http.proxy </span><br><span class="line">git config --global --<span class="built_in">unset</span> https.proxy </span><br></pre></td></tr></table></figure></p>
<h2 id="2、安装hexo"><a href="#2、安装hexo" class="headerlink" title="2、安装hexo"></a>2、安装<code>hexo</code></h2><p>命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo npm install -g hexo-cli</span><br><span class="line">npm WARN deprecated fsevents@2.1.3: Please update to v 2.2.x</span><br><span class="line">/usr/local/bin/hexo -&gt; /usr/local/lib/node_modules/hexo-cli/bin/hexo</span><br></pre></td></tr></table></figure></p>
<h2 id="3、创建存放博客的文件夹"><a href="#3、创建存放博客的文件夹" class="headerlink" title="3、创建存放博客的文件夹"></a>3、创建存放博客的文件夹</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web$ sudo <span class="built_in">mkdir</span> gitblog</span><br><span class="line">user@user-pc:~/www/html/php-web$ <span class="built_in">cd</span> gitblog</span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo hexo init   <span class="comment">##初始化hexo设置</span></span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm install</span><br><span class="line"></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install urix</span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install resolve-url</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>文件夹出现<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml     #配置文件</span><br><span class="line">├── package.json    #应用程序数据</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source          #网站内容</span><br><span class="line">|   ├── _drafts     #草稿</span><br><span class="line">|   └── _posts      #文章</span><br><span class="line">└── themes          #主题</span><br></pre></td></tr></table></figure></p>
<h2 id="4、安装Next主题"><a href="#4、安装Next主题" class="headerlink" title="4、安装Next主题"></a>4、安装<code>Next</code>主题</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/gitblogs$ sudo git <span class="built_in">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>
<p>安装一些必备插件：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">// user@user-pc:~/www/html/php-web/gitblog$ sudo npm i hexo-renderer-multi-markdown-it --save --ignore-scripts <span class="comment"># 安装必备插件,`--ignore-scripts` 解决安装依赖失败问题,  </span></span><br><span class="line">//但是安装此插件会出现数学公式重复解析  </span><br><span class="line"></span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm i hexo-autoprefixer --save</span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm i hexo-algoliasearch --save</span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm i hexo-symbols-count-time --save</span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm i hexo-feed --save</span><br><span class="line"></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm uninstall hexo-renderer-marked --save</span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install hexo-renderer-kramed --save</span><br><span class="line"></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm uninstall hexo-math --save  <span class="comment">#停止使用 hexo-math</span></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install hexo-renderer-mathjax --save  <span class="comment">#然后安装 hexo-renderer-mathjax 包：</span></span><br><span class="line"></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install hexo-generator-search --save</span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install hexo-generator-searchdb --save  <span class="comment"># 本地搜索 #</span></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install hexo-tag-cloud@^2.1.* --save   <span class="comment">##标签云</span></span><br><span class="line">user@user-pc:~/www/gitblogs$ sudo npm install eslint --save  <span class="comment">##阅读时长依赖</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5、开启标签云："><a href="#5、开启标签云：" class="headerlink" title="5、开启标签云："></a>5、开启标签云：</h2><p><code>swig</code> 用户 (<code>Next</code>主题在列)  </p>
<p>在主题文件夹找到文件 <code>theme/next/layout/_macro/sidebar.swig</code>, 然后添加如下代码：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% if site.tags.length &gt; 1 %&#125;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcloud.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcanvas.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;div class=&quot;widget-wrap&quot;&gt;</span><br><span class="line">    &lt;h3 class=&quot;widget-title&quot;&gt;Tag Cloud&lt;/h3&gt;</span><br><span class="line">    &lt;div id=&quot;myCanvasContainer&quot; class=&quot;widget tagcloud&quot;&gt;</span><br><span class="line">        &lt;canvas width=&quot;260&quot; height=&quot;280&quot; id=&quot;resCanvas&quot; style=&quot;width=100%&quot;&gt;</span><br><span class="line">            &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">        &lt;/canvas&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="6、从-Wordpress-迁移（没有用wordpress建站可无须此步）"><a href="#6、从-Wordpress-迁移（没有用wordpress建站可无须此步）" class="headerlink" title="6、从 Wordpress 迁移（没有用wordpress建站可无须此步）"></a>6、从 <code>Wordpress</code> 迁移（没有用<code>wordpress</code>建站可无须此步）</h2><p>（1）首先安装 <code>hexo-migrator-wordpress</code> 插件：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo npm install hexo-migrator-wordpress --save</span><br></pre></td></tr></table></figure><br>登录<code>Wordpress</code> 后台，在<code>工具</code>-<code>导出</code>中导出所有记录。<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ user@user-pc:~/www/html/php-web/gitblog$ sudo hexo migrate wordpress &lt;<span class="built_in">source</span>&gt;</span><br></pre></td></tr></table></figure><br><code>source</code> 是 <code>Wordpress</code> 导出文件的存放目录：<code>/media/yk/文档/BackUp/数据备份/Linux相关/Debian网站文章备份/lifeinpieces.WordPress.2020-12-16.xml</code>。  </p>
<p>文章导入到<code>_posts</code> 目录中了！  </p>
<h2 id="7、提交到github"><a href="#7、提交到github" class="headerlink" title="7、提交到github"></a>7、提交到<code>github</code></h2><p>安装支持：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog/owenyk.github.io$ sudo npm install hexo-deployer-git --unsafe-perm</span><br></pre></td></tr></table></figure><br>提交命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo hexo generate</span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo hexo deploy</span><br></pre></td></tr></table></figure></p>
<h3 id="一些问题："><a href="#一些问题：" class="headerlink" title="一些问题："></a>一些问题：</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog$  git remote add origin git@github.com:<span class="comment">#####/#####.github.io.git</span></span><br><span class="line">fatal: 不是一个 git 仓库（或者直至挂载点 / 的任何父目录）</span><br><span class="line">停止在文件系统边界（未设置 GIT_DISCOVERY_ACROSS_FILESYSTEM）</span><br></pre></td></tr></table></figure>
<p>解决：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo git init</span><br><span class="line">已初始化空的 Git 仓库于 /home/yk/www/html/php-web/gitblog/.git/</span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo git remote add origin git@github.com:<span class="comment">###/###.github.io.git</span></span><br><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo git remote -v</span><br><span class="line">origin	git@github.com:<span class="comment">###/###.github.io.git (fetch)</span></span><br><span class="line">origin	git@github.com:<span class="comment">###/###.github.io.git (push)</span></span><br></pre></td></tr></table></figure></p>
<p>提示：<code>This version of npm is compatible with lockfileVersion@1, but package-lock.json was generated for lockfileVersion@0. I&#39;ll try to do my best with it!</code><br>解决：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/gitblogs$ sudo <span class="built_in">rm</span> -rf node_modules package-lock.json &amp;&amp; npm install</span><br></pre></td></tr></table></figure></p>
<h2 id="8、换机操作"><a href="#8、换机操作" class="headerlink" title="8、换机操作"></a>8、换机操作</h2><h3 id="1-、在你的博客Repository中新建一个hexo分支，名字自定："><a href="#1-、在你的博客Repository中新建一个hexo分支，名字自定：" class="headerlink" title="(1)、在你的博客Repository中新建一个hexo分支，名字自定："></a>(1)、在你的博客<code>Repository</code>中新建一个<code>hexo</code>分支，名字自定：</h3><h3 id="2-、然后在setting中设置默认分支为hexo，便于推送："><a href="#2-、然后在setting中设置默认分支为hexo，便于推送：" class="headerlink" title="(2)、然后在setting中设置默认分支为hexo，便于推送："></a>(2)、然后在<code>setting</code>中设置默认分支为<code>hexo</code>，便于推送：</h3><h3 id="3-、新建目录，在目录下运行命令："><a href="#3-、新建目录，在目录下运行命令：" class="headerlink" title="(3)、新建目录，在目录下运行命令："></a>(3)、新建目录，在目录下运行命令：</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog$ sudo git <span class="built_in">clone</span> https://github.com/owenyk/owenyk.github.io.git</span><br></pre></td></tr></table></figure>
<h3 id="4-、把除了-git-文件夹外的所有文件都删掉（这些是编译后的网页文件）"><a href="#4-、把除了-git-文件夹外的所有文件都删掉（这些是编译后的网页文件）" class="headerlink" title="(4)、把除了.git 文件夹外的所有文件都删掉（这些是编译后的网页文件）"></a>(4)、把除了<code>.git</code> 文件夹外的所有文件都删掉（这些是编译后的网页文件）</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user@user-pc:~/www/html/php-web/gitblog/owenyk.github.io$ sudo <span class="built_in">rm</span> -rf [^.]*</span><br></pre></td></tr></table></figure>
<h3 id="5-、把之前我们写的博客源文件全部复制过来，除了-deploy-git（编译后的文件目录）。"><a href="#5-、把之前我们写的博客源文件全部复制过来，除了-deploy-git（编译后的文件目录）。" class="headerlink" title="(5)、把之前我们写的博客源文件全部复制过来，除了.deploy_git（编译后的文件目录）。"></a>(5)、把之前我们写的博客源文件全部复制过来，除了<code>.deploy_git</code>（编译后的文件目录）。</h3><p>其中，<code>.gitignore</code>（设置不需要<code>git</code>的文件或目录）文件中中需要设置部分不需要上传的目录：<br>删除题中有一个<code>.git</code>目录<br>命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo git commit –m <span class="string">&#x27;add branch&#x27;</span></span><br><span class="line"></span><br><span class="line">sudo git checkout -b hexo_backup --track origin / hexo_backup</span><br></pre></td></tr></table></figure></p>
<h2 id="9、数学公式显示不正常问题："><a href="#9、数学公式显示不正常问题：" class="headerlink" title="9、数学公式显示不正常问题："></a>9、数学公式显示不正常问题：</h2><h3 id="第一步：-使用Kramed代替Marked"><a href="#第一步：-使用Kramed代替Marked" class="headerlink" title="第一步： 使用Kramed代替Marked"></a>第一步： 使用<code>Kramed</code>代替<code>Marked</code></h3><p><code>hexo</code> 默认的渲染引擎是 <code>marked</code>，但是 <code>marked</code> 不支持 <code>mathjax</code>。 <code>kramed</code> 是在 <code>marked</code> 的基础上进行修改。我们在工程目录下执行以下命令来安装 <code>kramed</code>.<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-kramed --save</span><br></pre></td></tr></table></figure><br>然后，更改<code>&lt;your-project-dir&gt;/node_modules/hexo-renderer-kramed/lib/renderer.js</code>，更改：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Change inline math rule</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="comment">// Fit kramed&#x27;s rule: $$ + \1 + $$</span></span><br><span class="line">    <span class="keyword">return</span> text.<span class="title function_">replace</span>(<span class="regexp">/`\$(.*?)\$`/g</span>, <span class="string">&#x27;$$$$$1$$$$&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>为：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Change inline math rule</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="第二步-停止使用-hexo-math"><a href="#第二步-停止使用-hexo-math" class="headerlink" title="第二步: 停止使用 hexo-math"></a>第二步: 停止使用 <code>hexo-math</code></h3><p>首先，如果你已经安装 <code>hexo-math</code>, 请卸载它：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-math --save`</span><br></pre></td></tr></table></figure><br>然后安装 <code>hexo-renderer-mathjax</code> 包：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install hexo-renderer-mathjax --save</span><br></pre></td></tr></table></figure></p>
<h3 id="第三步-更新-Mathjax-的-CDN-链接"><a href="#第三步-更新-Mathjax-的-CDN-链接" class="headerlink" title="第三步: 更新 Mathjax 的 CDN 链接"></a>第三步: 更新 <code>Mathjax</code> 的 <code>CDN</code> 链接</h3><p>首先，打开<code>&lt;path-to-your-project&gt;/node_modules/hexo-renderer-mathjax/mathjax.html</code></p>
<p>然后，把<code>&lt;script&gt;</code>更改为：<br><code>&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt;&lt;/script&gt;</code></p>
<h3 id="第四步-更改默认转义规则"><a href="#第四步-更改默认转义规则" class="headerlink" title="第四步: 更改默认转义规则"></a>第四步: 更改默认转义规则</h3><p>因为 <code>hexo</code> 默认的转义规则会将一些字符进行转义，比如 <code>_</code>转为 <code>&lt;em&gt;</code>, 所以我们需要对默认的规则进行修改.<br>首先， 打开<code>&lt;path-to-your-project/node_modules/kramed/lib/rules/inline.js</code>,</p>
<p>然后，把:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">escape</span>: <span class="regexp">/^\\([\\`*&#123;&#125;\[\]()#$+\-.!_&gt;])/</span>,</span><br></pre></td></tr></table></figure><br>更改为:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">escape</span>: <span class="regexp">/^\\([`*\[\]()# +\-.!_&gt;])/</span>,</span><br><span class="line"><span class="string">``</span><span class="string">``</span></span><br><span class="line">把</span><br><span class="line"><span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string">em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span></span><br></pre></td></tr></table></figure><br>更改为:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">em</span>: <span class="regexp">/^\*((?:\*\*|[\s\S])+?)\*(?!\*)/</span>,</span><br></pre></td></tr></table></figure></p>
<h3 id="第五步-开启mathjax"><a href="#第五步-开启mathjax" class="headerlink" title="第五步: 开启mathjax"></a>第五步: 开启<code>mathjax</code></h3><p>在主题<code>_config.yml</code> 中开启 <code>Mathjax</code>， 找到 <code>mathjax</code> 字段添加如下代码：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mathjax:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>这一步可选，在博客中开启 <code>Mathjax</code>，， 添加以下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Testing</span> <span class="string">Mathjax</span> <span class="string">with</span> <span class="string">Hexo</span>  </span><br><span class="line"><span class="attr">category:</span> <span class="string">Uncategorized</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2017</span><span class="string">/05/03</span></span><br><span class="line"><span class="attr">mathjax:</span> <span class="literal">true</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></p>
<p>通过以上步骤，我们就可以在 <code>hexo</code> 中使用 <code>Mathjax</code> 来书写数学公式。</p>
<p><a name="div1"></a></p>
<h2 id="10、改变tag因为大小写问题而404的问题"><a href="#10、改变tag因为大小写问题而404的问题" class="headerlink" title="10、改变tag因为大小写问题而404的问题"></a>10、改变<code>tag</code>因为大小写问题而<code>404</code>的问题</h2><p>在博客根目录下的<code>.deploy_git/.git/config</code>文件配置中忽略大小写选项<code>ignorecase = true</code>改成<code>ignorecase = false</code>（注意：<code>.git</code>是隐藏文件夹，记得调一下显示隐藏文件夹）。</p>
<h2 id="11、Windows上部署时出现warning-LF-will-be-replaced-by-CRLF-in-xxxxxx的警告问题"><a href="#11、Windows上部署时出现warning-LF-will-be-replaced-by-CRLF-in-xxxxxx的警告问题" class="headerlink" title="11、Windows上部署时出现warning: LF will be replaced by CRLF in xxxxxx的警告问题"></a>11、<code>Windows</code>上部署时出现<code>warning: LF will be replaced by CRLF in xxxxxx</code>的警告问题</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global core.autocrlf <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><p><a href="https://www.jianshu.com/p/6a29f5243ab4">换终端更新hexo博客：</a><br><a href="https://blog.csdn.net/nightwishh/article/details/99647545">git报错ssh: connect to host github.com port 22: Connection timed out:</a><br><a href="https://zhuanlan.zhihu.com/p/149575559">Hexo博客建立标签云及效果展示:</a><br><a href="https://blog.csdn.net/jomes_wang/article/details/111628334">hexo博客本地搜索失效，一直转圈:</a><br><a href="https://www.jianshu.com/p/e8d433a2c5b7">如何在 hexo 中支持 Mathjax？：</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Hexo</category>
        <category>Next主题</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Next</tag>
        <tag>Nvm</tag>
        <tag>Debian10</tag>
      </tags>
  </entry>
  <entry>
    <title>在Debian11上安装clash</title>
    <url>/2021/12/15/%E5%9C%A8Debian11%E4%B8%8A%E5%AE%89%E8%A3%85clash%E7%9A%84%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装go环境"><a href="#安装go环境" class="headerlink" title="安装go环境"></a>安装<code>go</code>环境</h1><p>参见<a href="../../../../2021/12/15/在Debian11上安装go环境/">在Debian11上安装go环境</a></p>
<h1 id="为依赖包设置代理"><a href="#为依赖包设置代理" class="headerlink" title="为依赖包设置代理"></a>为依赖包设置代理</h1><p>终端窗口输入如下命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 其用Go Modules功能</span></span><br><span class="line">go <span class="built_in">env</span> -w GO111MODULE=on</span><br><span class="line"><span class="comment"># 配置 GOPROXY 环境变量</span></span><br><span class="line">go <span class="built_in">env</span> -w GOPROXY=https://goproxy.cn</span><br></pre></td></tr></table></figure></p>
<h1 id="安装clash"><a href="#安装clash" class="headerlink" title="安装clash"></a>安装<code>clash</code></h1><p>终端窗口输入如下命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">go install github.com/Dreamacro/clash@latest</span><br></pre></td></tr></table></figure></p>
<h1 id="修改clash配置"><a href="#修改clash配置" class="headerlink" title="修改clash配置"></a>修改<code>clash</code>配置</h1><p>默认配置目录是 <code>$HOME/.config/clash</code>，下载订阅配置：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O config.yaml https://你得到的订阅网址/Clash.yml</span><br></pre></td></tr></table></figure><br>配置文件的名称是<code>config.yaml</code>，如果要使用其他目录，可以使用 <code>-d</code> 控制配置目录。<br>例如，您可以使用当前目录作为配置目录，命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">clash -d .  <span class="comment"># 注意“.”</span></span><br></pre></td></tr></table></figure><br>在默认配置目录启动命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">clash</span><br></pre></td></tr></table></figure></p>
<h1 id="下载-mmdb"><a href="#下载-mmdb" class="headerlink" title="下载.mmdb"></a>下载<code>.mmdb</code></h1><p><code>Country.mmdb</code>为全球IP库，可以实现各个国家的IP信息解析和地理定位，没有这个文件<code>clash</code>是无法运行的。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O Country.mmdb https://www.sub-speeder.com/client-download/Country.mmdb</span><br></pre></td></tr></table></figure></p>
<p>附<code>config.yaml</code>的<a href="https://raw.githubusercontent.com/ssrsub/ssr/master/Clash.yml">订阅地址：</a></p>
<h1 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h1><h2 id="移动clash到-usr-bin-文件夹下并赋予可执行权限"><a href="#移动clash到-usr-bin-文件夹下并赋予可执行权限" class="headerlink" title="移动clash到/usr/bin/文件夹下并赋予可执行权限"></a>移动<code>clash</code>到<code>/usr/bin/</code>文件夹下并赋予可执行权限</h2><p>也可以不移动，但是注意设置程序路径为<code>clash</code>所在路径。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">mv</span> ~/gopath/bin/clash /usr/bin/</span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/bin/clash</span><br></pre></td></tr></table></figure></p>
<h2 id="创建clash-service文件"><a href="#创建clash-service文件" class="headerlink" title="创建clash@.service文件"></a>创建<code>clash@.service</code>文件</h2><p>在<code>/lib/systemd/system/</code>目录下创建<code>clash@.service</code>文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /lib/systemd/system/clash@.service</span><br></pre></td></tr></table></figure></p>
<p>写入以下内容(不用修改)并保存:<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=A rule based proxy in Go for %i.</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=%i</span><br><span class="line">Restart=on-abort</span><br><span class="line">ExecStart=/usr/bin/clash</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></p>
<h2 id="重新加载systemd模块"><a href="#重新加载systemd模块" class="headerlink" title="重新加载systemd模块"></a>重新加载<code>systemd</code>模块</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure>
<h2 id="启动clash服务"><a href="#启动clash服务" class="headerlink" title="启动clash服务"></a>启动<code>clash</code>服务</h2><p><strong><code>user</code> 表示的是当前用户名</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start clash@user</span><br></pre></td></tr></table></figure></p>
<h2 id="设置开机自启"><a href="#设置开机自启" class="headerlink" title="设置开机自启"></a>设置开机自启</h2><p><strong><code>user</code> 表示的是当前用户名</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> clash@user</span><br><span class="line">  Created symlink /etc/systemd/system/multi-user.target.wants/clash@user.service → /lib/systemd/system/clash@.service.</span><br></pre></td></tr></table></figure></p>
<p>参考资料：<br><a href="https://github.com/Sitoi/SystemdClash">Linux Clash 教程</a><br><a href="https://zhuanlan.zhihu.com/p/420381244">在ARM-ubuntu上安装和使用clash</a><br><a href="https://github.com/Dreamacro/clash/wiki">clash wiki</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Clash</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>Clash</tag>
      </tags>
  </entry>
  <entry>
    <title>在Debian11上安装go环境</title>
    <url>/2021/12/15/%E5%9C%A8Debian11%E4%B8%8A%E5%AE%89%E8%A3%85go%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://dl.google.com/go/go1.17.5.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>
<h1 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar zxvf  go1.17.5.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>
<h1 id="移动解压go文件夹到要配置的路径"><a href="#移动解压go文件夹到要配置的路径" class="headerlink" title="移动解压go文件夹到要配置的路径"></a>移动解压<code>go</code>文件夹到要配置的路径</h1><p>本人放在<code>~/local/</code>文件夹下<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mv</span> go ~/local/</span><br></pre></td></tr></table></figure></p>
<h1 id="配置全局变量"><a href="#配置全局变量" class="headerlink" title="配置全局变量"></a>配置全局变量</h1><p>根据自己使用的<code>Shell</code>是<code>bash</code>还是<del><code>zsh</code></del>，对<code>~/.bashrc</code>和<del><code>/.zshrc</code></del>进行编辑，这里本人安装对<code>~/.bashrc</code>进行编辑。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#修改~/.bashrc</span></span><br><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure></p>
<h1 id="添加Gopath路径"><a href="#添加Gopath路径" class="headerlink" title="添加Gopath路径"></a>添加<code>Gopath</code>路径</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GOROOT=~/local/go #GOROOT是系统上安装Go软件包的位置。</span><br><span class="line">export GOROOT</span><br><span class="line">export PATH=$PATH:$GOROOT/bin</span><br><span class="line"></span><br><span class="line">GOPATH=~/gopath  #GOPATH是工作目录的位置。</span><br><span class="line">export GOPATH</span><br><span class="line">export PATH=$PATH:$GOPATH/bin</span><br></pre></td></tr></table></figure>
<h1 id="激活配置"><a href="#激活配置" class="headerlink" title="激活配置"></a>激活配置</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br><span class="line">go version</span><br><span class="line"><span class="comment"># 输出 go version go1.17.5 linux/amd64</span></span><br></pre></td></tr></table></figure>
<p>参考资料：<br><a href="https://www.cnblogs.com/on-the-way-w/p/14481482.html">Debian10 安装Go环境</a></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Go</category>
      </categories>
      <tags>
        <tag>Debian11</tag>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>在Debian上安装LANMP及在Win10下安装MariaDB的zip版本</title>
    <url>/2020/11/15/%E5%9C%A8Debian%E4%B8%8A%E5%AE%89%E8%A3%85LANMP%E5%8F%8A%E5%9C%A8Win10%E4%B8%8B%E5%AE%89%E8%A3%85MariaDB%E7%9A%84zip%E7%89%88%E6%9C%AC/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、安装Apache"><a href="#一、安装Apache" class="headerlink" title="一、安装Apache"></a>一、安装<code>Apache</code></h1><h2 id="一-、安装apache命令："><a href="#一-、安装apache命令：" class="headerlink" title="(一)、安装apache命令："></a>(一)、安装<code>apache</code>命令：</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install apache2`   </span><br></pre></td></tr></table></figure>
<p><code>Apache</code>安装完成后，安装程序将立即触发<code>systemd</code>系统和服务管理器启动<code>Apache2</code>服务，并使其在系统引导时自动启动。<br>要检查<code>Apache</code>服务是否已启动并正常运行，请运行以下<code>systemctl</code>命令。<br><code># systemctl status apache2</code><br>其他常用命令<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># systemctl start apache2.service</span></span><br><span class="line"><span class="comment"># systemctl restart apache2.service</span></span><br><span class="line"><span class="comment"># systemctl stop apache2.service</span></span><br><span class="line"><span class="comment"># systemctl reload apache2.service</span></span><br><span class="line"><span class="comment"># systemctl status apache2.service</span></span><br></pre></td></tr></table></figure></p>
<h2 id="（二）、修改apache网站服务路径为自己网站目录"><a href="#（二）、修改apache网站服务路径为自己网站目录" class="headerlink" title="（二）、修改apache网站服务路径为自己网站目录"></a>（二）、修改<code>apache</code>网站服务路径为自己网站目录</h2><h3 id="（1）修改-etc-apache2-sites-available-000-default-conf"><a href="#（1）修改-etc-apache2-sites-available-000-default-conf" class="headerlink" title="（1）修改 /etc/apache2/sites-available/000-default.conf"></a>（1）修改 <code>/etc/apache2/sites-available/000-default.conf</code></h3><p><strong>不建议直接修改</strong>,而是新建网站配置文件并监听<code>8080</code>端口：<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/apache2/sites-available/wpweb.conf</span><br></pre></td></tr></table></figure><br>添加以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;VirtualHost *:8080&gt;  </span><br><span class="line">  #ServerName www.example.com  </span><br><span class="line">  ServerAdmin webmaster@localhost  </span><br><span class="line">  DocumentRoot ~/www/html/php-web/  </span><br><span class="line">  ErrorLog ~/www/html/php-web/wordpress/logs/error.log  </span><br><span class="line">  CustomLog ~/www/html/php-web/wordpress/logs/access.log combined  </span><br><span class="line">&lt;/VirtualHost&gt;  </span><br></pre></td></tr></table></figure><br>可以将网站配置命名为：<code>网站名.conf</code></p>
<h3 id="（2）-修改-etc-apache2-apache2-conf"><a href="#（2）-修改-etc-apache2-apache2-conf" class="headerlink" title="（2）###修改 /etc/apache2/apache2.conf"></a>（2）###修改 <code>/etc/apache2/apache2.conf</code></h3><p>[不建议直接修改]<br>将 <code>&lt;Directory /var/www/&gt;</code> 改为 <code>&lt;Directory 你的路径&gt;</code><br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment">####&lt;Directory /var/www/&gt;</span></span><br><span class="line"><span class="comment">#####Options Indexes FollowSymLinks</span></span><br><span class="line"><span class="comment">#####AllowOverride None</span></span><br><span class="line"><span class="comment">#####Require all granted</span></span><br><span class="line"><span class="comment">######&lt;/Directory&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="1》在ports-conf添加新增监听端口"><a href="#1》在ports-conf添加新增监听端口" class="headerlink" title="1》在ports.conf添加新增监听端口"></a>1》在<code>ports.conf</code>添加新增监听端口</h4><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/apache2/ports.conf</span><br></pre></td></tr></table></figure><br>在<code>Linsten</code>下添加以下内容：<br><code>Listen 8080</code>  </p>
<h4 id="2》新建网站的日子文件夹："><a href="#2》新建网站的日子文件夹：" class="headerlink" title="2》新建网站的日子文件夹："></a>2》新建网站的日子文件夹：</h4><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p ~/www/html/php-web/wordpress/logs/</span><br></pre></td></tr></table></figure></p>
<h4 id="3》启用配置："><a href="#3》启用配置：" class="headerlink" title="3》启用配置："></a>3》启用配置：</h4><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo a2ensite wpweb.conf</span><br></pre></td></tr></table></figure></p>
<h2 id="（三）安装libapache2-mod-fastcgi模块启用php-fpm管理"><a href="#（三）安装libapache2-mod-fastcgi模块启用php-fpm管理" class="headerlink" title="（三）安装libapache2-mod-fastcgi模块启用php-fpm管理"></a>（三）安装<code>libapache2-mod-fastcgi</code>模块启用<code>php-fpm</code>管理</h2><p><a href="https://packages.debian.org/jessie/i386/libapache2-mod-fastcgi/download">模块源地址下载</a></p>
<h3 id="（1）添加安装源："><a href="#（1）添加安装源：" class="headerlink" title="（1）添加安装源："></a>（1）添加安装源：</h3><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure><br>添加源地址：<code>deb http://ftp.cn.debian.org/debian buster main non-free</code><br>根据速度可以选择网页各地区地址。</p>
<h3 id="（2）安装fastcgi模块和php7-4支持模块"><a href="#（2）安装fastcgi模块和php7-4支持模块" class="headerlink" title="（2）安装fastcgi模块和php7.4支持模块:"></a>（2）安装<code>fastcgi模块</code>和<code>php7.4支持模块</code>:</h3><h4 id="1》安装模块及添加模块支持命令："><a href="#1》安装模块及添加模块支持命令：" class="headerlink" title="1》安装模块及添加模块支持命令："></a>1》安装模块及添加模块支持命令：</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install libapache2-mod-fastcgi php7.4-fpm    <span class="comment">#安装模块</span></span><br><span class="line">sudo a2enmod actions    <span class="comment">#启用模块操作</span></span><br><span class="line">sudo vim /etc/apache2/conf-available/php7.4-fpm.conf    <span class="comment">#添加支持</span></span><br></pre></td></tr></table></figure>
<p>添加以下内容：<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">&lt;IfModule</span> <span class="string">mod_fastcgi.c&gt;</span></span><br><span class="line">   <span class="string">AddHandler</span> <span class="string">php7.4-fcgi</span> <span class="string">.php</span></span><br><span class="line">   <span class="string">Action</span> <span class="string">php7.4-fcgi</span> <span class="string">/php7.4-fcgi</span></span><br><span class="line">   <span class="string">Alias</span> <span class="string">/php7.4-fcgi</span> <span class="string">/usr/lib/cgi-bin/php7.4-fcgi</span></span><br><span class="line">   <span class="string">FastCgiExternalServer</span> <span class="string">/usr/lib/cgi-bin/php7.4-fcgi</span> <span class="string">-socket</span> <span class="string">/var/run/php/php7.4-fpm.sock</span> <span class="string">-pass-header</span> <span class="string">Authorization</span></span><br><span class="line"><span class="string">&lt;/IfModule&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="2》检查用户组"><a href="#2》检查用户组" class="headerlink" title="2》检查用户组"></a>2》检查用户组</h4><p>查看<code>/etc/php/7.4/fpm/pool.d/www.conf</code> 文件中用户和用户组是否为<code>www-data</code>。<br>不是就改为该用户名和用户组，否则可能会出现权限问题。</p>
<h2 id="（四）验证配置"><a href="#（四）验证配置" class="headerlink" title="（四）验证配置:"></a>（四）验证配置:</h2><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apache2ctl configtest</span><br><span class="line">Syntax OK</span><br></pre></td></tr></table></figure></p>
<h2 id="（五）重启apache服务器"><a href="#（五）重启apache服务器" class="headerlink" title="（五）重启apache服务器"></a>（五）重启<code>apache</code>服务器</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo service apache2 restart</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">sudo systemctl restart apache2</span><br></pre></td></tr></table></figure>
<h3 id="可能的问题："><a href="#可能的问题：" class="headerlink" title="可能的问题："></a>可能的问题：</h3><p><code>403 Forbiden</code> 或者 <code>You don&#39;t have permission to access / on this server</code><br>修改你的路径目录权限为可读写<br>（1）<code>chown -R www-data:www-data  网站目录名</code><br>（2）修改<code>apache2.conf</code>配置文件；将 <code>&lt;Directory /&gt;</code>中的”<code>Require all denied</code>“修改成”<code>Require all granted</code>“；<br>最后重启<code>apache2</code><br>常用命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">chown</span> www-data:www-data ~/www/html/php-web/ -R <span class="comment">#修改网站根目录所有权限改为Apache进程用户</span></span><br><span class="line">sudo apache2ctl configtest <span class="comment">#测试Apache2配置</span></span><br><span class="line">sudo a2ensite wordpress.conf <span class="comment">#启用配置</span></span><br><span class="line">sudo a2dissite wordpress.conf <span class="comment">#取消配置</span></span><br><span class="line">a2enmod rewrite  <span class="comment">#启用伪静态重写url功能</span></span><br></pre></td></tr></table></figure><br>[关于为静态可能出现无反映或读取<code>.htaccess</code>的问题]<br><code>sudo vim /etc/apache2/apache2.conf</code><br>将其中的：<br><code>AllowOverride None</code><br>修改为：<br><code>AllowOverride All</code><br>上面的 <code>/etc/apache2/sites-enabled/000-default</code> 实则为 <code>/etc/apache2/sites-available/default</code> 的连接。<br>而 <code>AllowwOverride None</code> 则会完全忽略 <code>.htaccess</code> 文件，自然其中所定义的 <code>rewrite</code> 规则也就不能生效了。  </p>
<p>其他内容可参考：<br><a href="https://www.linode.com/docs/web-servers/apache/install-php-fpm-and-apache-on-debian-8/">Install PHP-FPM and Apache on Debian 8</a><br><a href="https://blog.csdn.net/z_qifa/article/details/74202771">debian下为apache启用rewrite模块</a></p>
<h1 id="二、安装nginx官网稳定版-nginx1-16-1-并配置和apache2共存"><a href="#二、安装nginx官网稳定版-nginx1-16-1-并配置和apache2共存" class="headerlink" title="二、安装nginx官网稳定版[nginx1.16.1]并配置和apache2共存"></a>二、安装<code>nginx官网稳定版[nginx1.16.1]</code>并配置和<code>apache2</code>共存</h1><h2 id="（一）更新源并安装nginx"><a href="#（一）更新源并安装nginx" class="headerlink" title="（一）更新源并安装nginx"></a>（一）更新源并安装<code>nginx</code></h2><h3 id="命令："><a href="#命令：" class="headerlink" title="命令："></a>命令：</h3><p><code>sudo apt install curl gnupg2 ca-certificates lsb-release   #安装必要的支持包</code><br>打开安装源列表:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure><br>添加以下内容：<br><code>deb http://nginx.org/packages/debian/ buster nginx #安装稳定版本</code><br>或者有安装直接输入以下命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;deb http://nginx.org/packages/debian `lsb_release -cs` nginx&quot;</span> \ | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/nginx.list</span><br><span class="line">```  </span><br><span class="line">上述命令将直接在`/etc/apt/sources.list.d`下新建`nginx`安装源</span><br><span class="line">```bash</span><br><span class="line">sudo curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -   <span class="comment">#添加nginx的key到系统</span></span><br><span class="line">sudo apt update &amp;&amp; sudo apt upgrade</span><br><span class="line">sudo apt install nginx</span><br></pre></td></tr></table></figure></p>
<h3 id="因80端口被先安装的apache2占用，安装完启动会提示错误，"><a href="#因80端口被先安装的apache2占用，安装完启动会提示错误，" class="headerlink" title="因80端口被先安装的apache2占用，安装完启动会提示错误，"></a>因<code>80</code>端口被先安装的<code>apache2</code>占用，安装完启动会提示错误，</h3><p>修改<code>/etc/nginx/nginx/conf.d/default.conf</code>的默认端口<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/nginx/conf.d/default.conf</span><br></pre></td></tr></table></figure><br>修改：<code>listen 80 default_server;</code>为：<code>listen 8090 default_server;</code></p>
<h3 id="修改nginx目录下nginx-conf"><a href="#修改nginx目录下nginx-conf" class="headerlink" title="修改nginx目录下nginx.conf"></a>修改<code>nginx</code>目录下<code>nginx.conf</code></h3><p>第二行<br><code>user  nginx;</code>改为：<br><code>user  www-data;</code><br>因为前面<code>apache2</code>的设置中<code>php7.4-fpm</code>的用户和用户组为<code>www-data</code>。<br>文件位于：<code>/etc/php/7.4/fpm/pool.d/www.conf</code>件中用户和用户组为<code>www-data</code>。</p>
<h2 id="（二）添加网站配置："><a href="#（二）添加网站配置：" class="headerlink" title="（二）添加网站配置："></a>（二）添加网站配置：</h2><p>拷贝一份配置到<code>conf.d</code>文件夹：<br>命令:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> /etc/nginx/nginx.conf /etc/nginx/conf.d/nginxsite1.conf</span><br></pre></td></tr></table></figure><br>修改<code>nginxsite1.conf</code>的配置：<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/nginx/conf.d/nginxsite1.conf</span><br></pre></td></tr></table></figure><br>删除全部内容，替换为以下内容：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       8091;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    #charset koi8-r;</span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root   ~/www/html/nginx-web;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    #</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        root           ~/www/html/nginx-web/;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">        include        fastcgi_params;</span><br><span class="line">    #   # With php-fpm (or other unix sockets):</span><br><span class="line">        fastcgi_pass unix:/run/php/php7.4-fpm.sock;  </span><br><span class="line">    #   # With php-cgi (or other tcp sockets):</span><br><span class="line">    #    fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">    # concurs with nginx&#x27;s one</span><br><span class="line">    #</span><br><span class="line">    #location ~ /\.ht &#123;</span><br><span class="line">    #    deny  all;</span><br><span class="line">    #&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="（三）重启服务器"><a href="#（三）重启服务器" class="headerlink" title="（三）重启服务器"></a>（三）重启服务器</h2><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo nginx -t <span class="comment">#测试配置是否正确</span></span><br><span class="line">sudosystemctl start/restart nginx  <span class="comment">#启动/重启服务器</span></span><br><span class="line">sudosystemctl stop/status nginx  <span class="comment">#停止服务器/查看服务器状态</span></span><br></pre></td></tr></table></figure></p>
<h3 id="测试Nginx安装结果"><a href="#测试Nginx安装结果" class="headerlink" title="测试Nginx安装结果"></a>测试<code>Nginx</code>安装结果</h3><p>打开浏览器，输入 ：<code>http://localhost:8090/index.nginx-debian.html</code><br>其中<code>index.nginx-debian.html</code>为<code>nginx</code>在<code>debian</code>的默认首页<br>出现：“<code>Welcome to nginx!</code>”则安装成功。</p>
<h3 id="测试PHP网页"><a href="#测试PHP网页" class="headerlink" title="测试PHP网页"></a>测试<code>PHP</code>网页</h3><p>新建<code>php</code>网页，输入如下内容：<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>保存并命名为：<code>info.php</code><br>打开浏览器，输入 ：<code>http://localhost:8091/info.php</code><br>出现<code>php</code>信息页面，则安装完成。</p>
<h3 id="nginx加入到systemctl服务运行"><a href="#nginx加入到systemctl服务运行" class="headerlink" title="nginx加入到systemctl服务运行"></a><code>nginx</code>加入到<code>systemctl</code>服务运行</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo vim /usr/lib/systemd/system/nginx.service</span><br></pre></td></tr></table></figure>
<p>输入以下内容并保存<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx</span><br><span class="line">After=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/etc/nginx/logs/nginx.pid</span><br><span class="line">ExecStart=/etc/nginx/sbin/nginx</span><br><span class="line">ExecReload=/etc/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/etc/nginx/sbin/nginx -s stop</span><br><span class="line">PrivateTmp=true</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><br>重新加载服务配置：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload  <span class="comment"># 重新加载服务配置文件</span></span><br><span class="line">sudo systemctl start/stop/reload nginx <span class="comment">#开启、停止、重新加载nginx</span></span><br></pre></td></tr></table></figure></p>
<h3 id="可能的一些情况"><a href="#可能的一些情况" class="headerlink" title="可能的一些情况"></a>可能的一些情况</h3><p>1、若因为因为安装源造成版本升级错误：<br>如出现：<code>dpkg-deb: 子进程 粘贴 被信号(断开的管道) 终止了 导致无法继续安装</code>,这个问题可以使用<code>dpkg</code>强制覆盖解决。<br>找到安装包位置 <code>cd /var/cache/apt/archives</code> 之后强制安装 <code>dpkg -i --force-overwrite xxx.deb</code>即可。<br>2、若出现打开<code>php</code>页面空白，请检查配置(<code>nginxsite1.conf</code>)中网站路径是否正确。<br>3、一些命令[在<code>nginx1.16.1</code>中未用到]<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">ln</span> -s /etc/nginx/sites-available/nginxsite1 /etc/nginx/sites-enabled/nginxsite1  <span class="comment">#建立软链接</span></span><br><span class="line">sudo dpkg --get-selections | grep nginx   // 查看剩余的与nginx相关的软件包</span><br><span class="line">sudo apt　--purge remove nginx           // 卸载nginx(不保留配置文件)</span><br><span class="line">sudo apt autoremove                     // 卸载自动安装的软件包</span><br><span class="line">sudo apt install net-tools               //安装网络配置工具</span><br><span class="line">sudo netstat -nlp |grep 端口号           //查询端口占用情况</span><br></pre></td></tr></table></figure></p>
<p>更多内容参考：<a href="http://nginx.org/en/linux_packages.html#Debian">Installation instructions for debian</a></p>
<h1 id="三、安装PHP"><a href="#三、安装PHP" class="headerlink" title="三、安装PHP"></a>三、安装<code>PHP</code></h1><p><strong>安装首要条件</strong><br>使用<code>shell</code>访问权限登录<code>Debian10</code>系统，对于远程系统，使用<code>SSH</code>连接。<code>Windows</code>用户可以使用<code>Putty</code>或其他替代应用程序进行<code>SSH</code>连接。</p>
<h2 id="（一）运行以下命令将当前包升级到最新版本。"><a href="#（一）运行以下命令将当前包升级到最新版本。" class="headerlink" title="（一）运行以下命令将当前包升级到最新版本。"></a>（一）运行以下命令将当前包升级到最新版本。</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt upgrade</span><br></pre></td></tr></table></figure>
<h2 id="（二）在Debian10上设置PPA"><a href="#（二）在Debian10上设置PPA" class="headerlink" title="（二）在Debian10上设置PPA"></a>（二）在<code>Debian10</code>上设置<code>PPA</code></h2><p>分别执行以下命令，首先在系统上安装所需的软件包。然后导入包签名密钥。之后，为系统上的<code>PHP</code>包配置<code>PPA</code>。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt -y install software-properties-common apt-transport-https lsb-release ca-certificates</span><br><span class="line">wget -q https://packages.sury.org/php/apt.gpg -O- | sudo apt-key add -</span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;deb https://packages.sury.org/php/ buster main&quot;</span> | <span class="built_in">tee</span> /etc/apt/sources.list.d/php.list</span><br><span class="line">sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://mirror.xtom.com.hk/sury/php/apt.gpg</span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;deb https://mirror.xtom.com.hk/sury/php/ buster main&quot;</span> | <span class="built_in">tee</span> /etc/apt/sources.list.d/php.list</span><br></pre></td></tr></table></figure><br>若提示<code>tee: /etc/apt/sources.list.d/php.list: 权限不够</code><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb https://packages.sury.org/php/ buster main`</span><br><span class="line">deb https://mirror.xtom.com.hk/sury/php/ buster main</span><br></pre></td></tr></table></figure><br>可用命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/apt/sources.list.d/php.list</span><br></pre></td></tr></table></figure><br>手动创建添加<code>php安装源</code>：“<code>deb https://packages.sury.org/php/ buster main</code>”<br><code>Debian10</code>系统已经准备好安装<code>PHP</code>了。</p>
<h2 id="（三）在Debian10上安装稳定版PHP7-4"><a href="#（三）在Debian10上安装稳定版PHP7-4" class="headerlink" title="（三）在Debian10上安装稳定版PHP7.4"></a>（三）在<code>Debian10</code>上安装稳定版<code>PHP7.4</code></h2><p>还可以在系统上安装稳定的<code>PHP</code>版本。运行以下命令在<code>Debian10</code>安装<code>php7.4</code>。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install php7.4</span><br></pre></td></tr></table></figure><br>同时安装所需的<code>PHP</code>模块。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install php7.4-cli php7.4-common php7.4-curl php7.4-gd php7.4-json php7.4-mbstring php7.4-mysql php7.4-xml</span><br></pre></td></tr></table></figure><br>安装后，使用以下命令验证已安装和运行的<code>PHP</code>版本<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure></p>
<h2 id="（四）切换php版本为默认用于Apache和命令行（可多版本PHP共存）"><a href="#（四）切换php版本为默认用于Apache和命令行（可多版本PHP共存）" class="headerlink" title="（四）切换php版本为默认用于Apache和命令行（可多版本PHP共存）"></a>（四）切换<code>php</code>版本为默认用于<code>Apache</code>和命令行（可多版本<code>PHP</code>共存）</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo a2dismod php7.3</span><br><span class="line">sudo a2enmod php7.4        <span class="comment">##以上两命令用于配置apache的一个模块,禁用/启用</span></span><br><span class="line">sudo update-alternatives --<span class="built_in">set</span> php /usr/bin/php7.4  <span class="comment">##该命令用于处理 Linux 系统中软件版本的切换</span></span><br></pre></td></tr></table></figure>
<p><strong><code>PHP</code>最新版<code>PHP8.1.0</code>已经于2021年11月25日发布，源安装可参照如上方法，注意对应版本号，其编译安装可参考：</strong><br><a href="../../../../2021/11/28/Debian11编译安装PHP8.1.0版/">Debian11编译安装PHP8.1.0版</a></p>
<h2 id="（五）安装imagick"><a href="#（五）安装imagick" class="headerlink" title="（五）安装imagick"></a>（五）安装<code>imagick</code></h2><h3 id="1-依次运行以下命令"><a href="#1-依次运行以下命令" class="headerlink" title="1. 依次运行以下命令"></a>1. 依次运行以下命令</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install imagemagick</span><br><span class="line">sudo apt install libmagickcore-dev libmagickwand-dev     <span class="comment">##失效sudo apt install imagemagick-devel </span></span><br><span class="line">sudo apt install pkg-config</span><br><span class="line">sudo apt install php-pear </span><br><span class="line">sudo pecl channel-update pecl.php.net  <span class="comment">#更新pecl</span></span><br></pre></td></tr></table></figure>
<p>安装<code>php-pear</code>是为了使用<code>pecl</code> 中的 <code>phpize</code><br><code>sudo apt install php7.4-dev</code></p>
<h3 id="2-安装C语言编译器"><a href="#2-安装C语言编译器" class="headerlink" title="2. 安装C语言编译器"></a>2. 安装<code>C语言编译器</code></h3><p><code>sudo apt install gcc</code><br>如果装不了gcc就用这个命令：<br><code>sudo apt install gcc gcc- c++ autoconf automake</code></p>
<h3 id="3-安装imagick"><a href="#3-安装imagick" class="headerlink" title="3. 安装imagick"></a>3. 安装<code>imagick</code></h3><p><code>sudo pecl install imagick</code></p>
<h3 id="4-加载imagick到php"><a href="#4-加载imagick到php" class="headerlink" title="4. 加载imagick到php"></a>4. 加载<code>imagick</code>到<code>php</code></h3><p>在<code>/etc/php/7.4/apache2/php.ini</code> 加上<code>extension=imagick.so</code>  </p>
<h3 id="5-重启service-httpd-restart"><a href="#5-重启service-httpd-restart" class="headerlink" title="5. 重启service httpd restart"></a>5. 重启<code>service httpd restart</code></h3><h3 id="6-查看安装结果"><a href="#6-查看安装结果" class="headerlink" title="6. 查看安装结果"></a>6. 查看安装结果</h3><p>使用 <code>phpinfo()</code> 或运行 <code>php -m | grep imagick</code> 来查看是否安装成功</p>
<p>其他操作：<br>停止<code>PHP</code>：<code>sudo pkill php-fpm</code><br>查看<code>9000</code>端口：<code>netstat -lnt | grep 9000</code>  </p>
<p>启动<code>PHP</code>：如果修改过配置文件，一定要重新加载配置文件才行<br><code>/usr/sbin/php-fpm7.4 -c /etc/php/7.4/apache2/php.ini</code><br>查看<code>9000</code>端口：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">netstat -tunlp | grep 9000</span><br><span class="line">tcp        0      0 127.0.0.1:9000              0.0.0.0:*                   LISTEN</span><br></pre></td></tr></table></figure></p>
<p>参考网站：<a href="https://www.cnblogs.com/i6010/articles/10974575.html">linux下 安装 ImageMagick 及其 php imagick扩展</a><br>其他安装源：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://www.dotdeb.org/dotdeb.gpg</span><br><span class="line">sudo apt-key add dotdeb.gpg</span><br></pre></td></tr></table></figure><br>源：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb http://packages.dotdeb.org buster all</span><br><span class="line">deb-src http://packages.dotdeb.org buster all</span><br></pre></td></tr></table></figure></p>
<h1 id="四、在Debian-10上安装MariaDB"><a href="#四、在Debian-10上安装MariaDB" class="headerlink" title="四、在Debian 10上安装MariaDB"></a>四、在<code>Debian 10</code>上安装<code>MariaDB</code></h1><p><code>Apache Web</code>服务器启动并运行后，您需要安装数据库系统才能保留和管理您网站的数据。</p>
<h2 id="（一）要安装MariaDB，请使用Debian的apt包管理器。"><a href="#（一）要安装MariaDB，请使用Debian的apt包管理器。" class="headerlink" title="（一）要安装MariaDB，请使用Debian的apt包管理器。"></a>（一）要安装<code>MariaDB</code>，请使用<code>Debian</code>的<code>apt</code>包管理器。</h2><p><code>sudo apt install mariadb-server</code></p>
<h2 id="（二）安装MariaDB后，建议运行以下安全脚本，"><a href="#（二）安装MariaDB后，建议运行以下安全脚本，" class="headerlink" title="（二）安装MariaDB后，建议运行以下安全脚本，"></a>（二）安装<code>MariaDB</code>后，建议运行以下安全脚本，</h2><p>该脚本将删除一些不安全的默认设置并禁用对数据库系统的访问。<br>命令：<br><code>sudo mysql_secure_installation</code><br>上述安全脚本将引导您完成以下一系列问题，您可以在其中对<code>MariaDB</code>设置进行一些更改。<br>均选择：<code>y</code><br>若提示：<code>ERROR 1698 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39;</code><br>请用管理员权限重新运行上述命令。</p>
<h2 id="（三）如果要创建名为wpDB的数据库和用户名和密码均为wpadmin且具有数据库完全权限的用户，请运行以下命令。"><a href="#（三）如果要创建名为wpDB的数据库和用户名和密码均为wpadmin且具有数据库完全权限的用户，请运行以下命令。" class="headerlink" title="（三）如果要创建名为wpDB的数据库和用户名和密码均为wpadmin且具有数据库完全权限的用户，请运行以下命令。"></a>（三）如果要创建名为<code>wpDB</code>的数据库和用户名和密码均为<code>wpadmin</code>且具有数据库完全权限的用户，请运行以下命令。</h2><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mysql -u root -p××××××</span><br><span class="line">  MariaDB [(none)]&gt; CREATE DATABASE wpDB;</span><br><span class="line">  MariaDB [(none)]&gt; grant all on wpDB.* to <span class="string">&#x27;wpadmin&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;wpadmin&#x27;</span> with grant option;</span><br><span class="line">  MariaDB [(none)]&gt; FLUSH PRIVILEGES;</span><br><span class="line">  MariaDB [(none)]&gt; <span class="built_in">exit</span>;</span><br></pre></td></tr></table></figure><br>您可以通过使用用户凭据登录<code>MariaDB</code>来确认新用户是否具有数据库的完全权限，如下所示。<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -uwpadmin -pwpadmin</span><br><span class="line">  MariaDB [(none)]&gt; SHOW DATABASES;</span><br></pre></td></tr></table></figure></p>
<h1 id="五、在windows下安装madiadb数据库zip版本"><a href="#五、在windows下安装madiadb数据库zip版本" class="headerlink" title="五、在windows下安装madiadb数据库zip版本"></a>五、在<code>windows</code>下安装<code>madiadb</code>数据库<code>zip</code>版本</h1><h2 id="1-下载"><a href="#1-下载" class="headerlink" title="1. 下载"></a>1. 下载</h2><p><a href="https://mariadb.org/download/">mariadb下载地址：</a> 选择<code>windows</code>和<code>zip</code></p>
<h2 id="2-解压"><a href="#2-解压" class="headerlink" title="2. 解压"></a>2. 解压</h2><p>比如：解压到<code>D:\mariadb</code>。</p>
<h2 id="3-服务安装"><a href="#3-服务安装" class="headerlink" title="3. 服务安装"></a>3. 服务安装</h2><p>需要在<code>windows</code>中的安装一个名字为<code>MariaDB</code>的服务：<br>在<code>d盘</code>下新建一个<code>data</code>的文件夹。<br>用户管理员身份启动<code>powershell</code>。<br>键入如下命令：<br><code>D:\mariadb\bin&gt; .\mysql_install_db.exe --datadir=D:\data --service=MariaDB --password=123</code></p>
<p>【<code>tip: --datadir= 如果指定不同的路径，配合my.ini文件设置不同的端口，即可以完成多个MariaDB的服务实例。</code>】<br>服务启动：<br>方法一：<code>win+R</code>—&gt;运行<code>services.msc</code>，然后在服务列表中找到<code>MariaDB</code>，点击运行。<br>方法二：在《管理员的<code>POWERSHELL</code>》中，运行<code>net start MariaDB</code><br>客户端接入：<br> <code>.\mariadb.exe -uroot -P3306 -p</code></p>
<h2 id="4-注意：可以修改端口的方式："><a href="#4-注意：可以修改端口的方式：" class="headerlink" title="4. 注意：可以修改端口的方式："></a>4. 注意：可以修改端口的方式：</h2><p>在<code>D:\data\my.ini</code>文件中,加入<code>port=xxxx</code><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">datadir=D:/data</span><br><span class="line">port=3306</span><br><span class="line">[client]</span><br><span class="line">plugin-dir=D:/mariadb/lib/plugin</span><br></pre></td></tr></table></figure><br>作者：JohnYuCN<br>链接：<a href="https://www.jianshu.com/p/68aac1d2f304|">win10中MariaDB的zip压缩版的安装和使用（多服务实例）</a></p>
<h1 id="六、安装wordpress"><a href="#六、安装wordpress" class="headerlink" title="六、安装wordpress"></a>六、安装<code>wordpress</code></h1><p>[需科学工具，否则打开网页可能会出现：<code>429 Too Many Requests</code>错误]</p>
<h2 id="（一）下载"><a href="#（一）下载" class="headerlink" title="（一）下载"></a>（一）下载</h2><p><a href="https://wordpress.org/latest.tar.gz">下载地址：</a><br>下载后解压到网站目录</p>
<h2 id="（二）安装"><a href="#（二）安装" class="headerlink" title="（二）安装"></a>（二）安装</h2><p>在数据库中建立网站数据库，后面依照安装指引填写就可以了。<br>注意事项：<br>1、若安装为英文版后要切换中文版需要在：<code>wp-config.php</code>文件中添加以下内容：<br> 在设置中切换为中文<br><code>define(&#39;WPLANG&#39;,&#39;zh_CN&#39;);</code><br>取消切换为中文后升级后本地网站需要填写FTP信息提示<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">define(&quot;FS_METHOD&quot;,&quot;direct&quot;);</span><br><span class="line">define(&quot;FS_CHMOD_DIR&quot;, 0777);</span><br><span class="line">define(&quot;FS_CHMOD_FILE&quot;, 0777);</span><br></pre></td></tr></table></figure><br>2、升级中若出现无法写入目录文件，则需要对网站目录授权[<code>apache2</code>运行的<code>www-data</code>用户权限]：<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">chown</span> -R www-data:www-data  网站目录名</span><br></pre></td></tr></table></figure><br>[授予该权限也能解决需要FTP信息的提示]<br>3、解决更新提示另一更新存在的问题<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mysql -u wpadmin -pwpadmin</span><br><span class="line">MariaDB [(none)]&gt; show databases</span><br><span class="line">MariaDB [(none)]&gt; use wpDB;</span><br><span class="line">MariaDB [wpDB]&gt; delete from wp_options <span class="built_in">where</span> option_name=<span class="string">&#x27;core_updater.lock&#x27;</span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="（三）若更换端口需更改数据库中wp-options中的端口配置"><a href="#（三）若更换端口需更改数据库中wp-options中的端口配置" class="headerlink" title="（三）若更换端口需更改数据库中wp_options中的端口配置"></a>（三）若更换端口需更改数据库中<code>wp_options</code>中的端口配置</h2><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [wpDBtest]&gt; update wp_options <span class="built_in">set</span> option_value= <span class="string">&quot;http://localhost:8090/wordpress&quot;</span> <span class="built_in">where</span> option_name <span class="keyword">in</span>(<span class="string">&quot;siteurl&quot;</span>,<span class="string">&quot;home&quot;</span>);</span><br><span class="line">MariaDB [wpDBtest]&gt; select * from wp_options <span class="built_in">where</span> option_name <span class="keyword">in</span>(<span class="string">&quot;siteurl&quot;</span>,<span class="string">&quot;home&quot;</span>);  //查看修改情况</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Nginx</category>
        <category>MariaDB</category>
        <category>Apache2</category>
        <category>Wordpress</category>
      </categories>
      <tags>
        <tag>数据库</tag>
        <tag>Nginx</tag>
        <tag>MariaDB</tag>
        <tag>Debian10</tag>
        <tag>Apache2</tag>
      </tags>
  </entry>
  <entry>
    <title>在Windows10上为powershell配置oh-my-posh</title>
    <url>/2022/03/05/%E5%9C%A8Windows10%E4%B8%8A%E4%B8%BApowershell%E9%85%8D%E7%BD%AEoh-my-posh/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="安装模块"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\Windows\system32&gt; Install-Module oh-my-posh -Scope CurrentUser   </span><br><span class="line">需要使用 NuGet 提供程序来继续操作</span><br><span class="line">PowerShellGet 需要使用 NuGet 提供程序“2.8.5.201”或更高版本来与基于 NuGet</span><br><span class="line">的存储库交互。必须在“C:\Program</span><br><span class="line">Files\PackageManagement\ProviderAssemblies”或“C:\Users\xxxxx\AppData\Local\PackageManagement\ProviderAssemb</span><br><span class="line">lies”中提供 NuGet 提供程序。也可以通过运行 <span class="string">&#x27;Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201</span></span><br><span class="line"><span class="string"> -Force&#x27;</span> 安装 NuGet 提供程序。是否要让 PowerShellGet 立即安装并导入 NuGet 提供程序?</span><br><span class="line">[Y] 是(Y)  [N] 否(N)  [S] 暂停(S)  [?] 帮助 (默认值为“Y”): y</span><br><span class="line"></span><br><span class="line">不受信任的存储库</span><br><span class="line">你正在从不受信任的存储库安装模块。如果你信任该存储库，请通过运行 Set-PSRepository cmdlet 更改其</span><br><span class="line">InstallationPolicy 值。是否确实要从“PSGallery”安装模块?</span><br><span class="line">[Y] 是(Y)  [A] 全是(A)  [N] 否(N)  [L] 全否(L)  [S] 暂停(S)  [?] 帮助 (默认值为“N”): y</span><br><span class="line"></span><br><span class="line">PS C:\Windows\system32&gt; Install-Module posh-git -Scope CurrentUser</span><br><span class="line">不受信任的存储库</span><br><span class="line">你正在从不受信任的存储库安装模块。如果你信任该存储库，请通过运行 Set-PSRepository cmdlet 更改其</span><br><span class="line">InstallationPolicy 值。是否确实要从“PSGallery”安装模块?</span><br><span class="line">[Y] 是(Y)  [A] 全是(A)  [N] 否(N)  [L] 全否(L)  [S] 暂停(S)  [?] 帮助 (默认值为“N”): y</span><br></pre></td></tr></table></figure>
<h1 id="设置执行权限"><a href="#设置执行权限" class="headerlink" title="设置执行权限"></a>设置执行权限</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\Windows\system32&gt; set-ExecutionPolicy RemoteSigned</span><br><span class="line"></span><br><span class="line">执行策略更改</span><br><span class="line">执行策略可帮助你防止执行不信任的脚本。更改执行策略可能会产生安全风险，如</span><br><span class="line">https:/go.microsoft.com/fwlink/?LinkID=135170 中的 about_Execution_Policies</span><br><span class="line">帮助主题所述。是否要更改执行策略?</span><br><span class="line">[Y] 是(Y)  [A] 全是(A)  [N] 否(N)  [L] 全否(L)  [S] 暂停(S)  [?] 帮助 (默认值为“N”): y</span><br><span class="line">PS C:\Windows\system32&gt; Import-Module oh-my-posh</span><br><span class="line">Downloading oh-my-posh executable <span class="keyword">for</span> 7.31.1</span><br><span class="line"> 正在写入 Web 请求         </span><br><span class="line">  正在写入请求流... (已写入字节数: 15066734) </span><br></pre></td></tr></table></figure>
<h1 id="查看配置环境并添加到环境变量"><a href="#查看配置环境并添加到环境变量" class="headerlink" title="查看配置环境并添加到环境变量"></a>查看配置环境并添加到环境变量</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\Windows\system32&gt; <span class="variable">$env</span>:POSH_PATH</span><br><span class="line">C:\Users\xxxxx\AppData\Local\oh-my-posh</span><br></pre></td></tr></table></figure>
<p>依次操作：<code>桌面</code>右键—&gt;<code>属性</code>—&gt;<code>高级系统设置</code>—&gt;<code>环境变量</code>—&gt;<code>新建</code>，将以上路径添加到系统环境变量。</p>
<h1 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Export-PoshTheme -FilePath <span class="string">&quot;~/.mt.omp.json&quot;</span> -Format json</span><br><span class="line">PS C:\Users\yk&gt; notepad <span class="variable">$profile</span></span><br></pre></td></tr></table></figure>
<p>输入以下内容：<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">Import-Module posh-git </span><br><span class="line">Import-Module oh-my-posh</span><br><span class="line"># oh-my-posh --init --shell pwsh --config https<span class="punctuation">:</span><span class="comment">//raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/v$(oh-my-posh --version)/themes/mt.omp.json | Invoke-Expression</span></span><br><span class="line"># Set-PoshPrompt Paradox</span><br><span class="line">Set-PoshPrompt mt</span><br></pre></td></tr></table></figure></p>
<h1 id="使配置生效"><a href="#使配置生效" class="headerlink" title="使配置生效"></a>使配置生效</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\Users\yk&gt; . <span class="variable">$profile</span></span><br></pre></td></tr></table></figure>
<h1 id="下载安装字体"><a href="#下载安装字体" class="headerlink" title="下载安装字体"></a>下载安装字体</h1><p><a href="https://www.nerdfonts.com/font-downloads">下载地址：</a><br>本人安装的是<a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v2.1.0/Mononoki.zip">Mononoki</a>和<a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v2.1.0/SourceCodePro.zip">SourceCodePro</a>.<br>下载后解压，进入解压文件夹，<code>全选</code>—&gt;<code>右键</code>—&gt;<code>安装</code>,可以选择为所有用户安装。</p>
<h1 id="配置powershell终端"><a href="#配置powershell终端" class="headerlink" title="配置powershell终端"></a>配置<code>powershell</code>终端</h1><p>打开<code>powershell</code>终端，顶部右键<code>属性</code>—&gt;<code>字体</code>，设置为刚下载安装的字体。</p>
<p>在<a href="https://github.com/microsoft/terminal"><code>window终端</code></a>上可参考安装。</p>
<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p>1、<a href="https://github.com/JanDeDobbeleer/oh-my-posh">oh-my-posh开源地址</a><br>2、<a href="https://ohmyposh.dev/docs/installation/windows">oh-my-posh官网</a><br>3、<a href="https://docs.microsoft.com/zh-cn/windows/terminal/tutorials/custom-prompt-setup#customize-your-wsl-prompt-with-oh-my-posh">教程：使用 Oh My Posh 为 PowerShell 或 WSL 设置自定义提示符</a><br>4、<a href="https://www.zhihu.com/question/330813656">win10 terminal配色可以好看到什么程度？能分享你的profile.json吗?</a></p>
]]></content>
      <categories>
        <category>运维</category>
        <category>Windows</category>
        <category>终端</category>
      </categories>
      <tags>
        <tag>Powershell</tag>
        <tag>Windows terminal</tag>
      </tags>
  </entry>
  <entry>
    <title>在Windows10上配置Hexo+Github做个人博客</title>
    <url>/2021/12/03/%E5%9C%A8Windows10%E4%B8%8A%E9%85%8D%E7%BD%AEHexo+Github%E5%81%9A%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、安装wget用于下载-可选"><a href="#一、安装wget用于下载-可选" class="headerlink" title="一、安装wget用于下载(可选)"></a>一、安装<code>wget</code>用于下载(可选)</h1><p><a href="https://eternallybored.org/misc/wget/">wget的windows版本下载地址</a><br>根据系统及个人需要选择版本，将下载的<code>exe</code>放到<code>C:\Windows\System32</code>文件夹里。</p>
<h1 id="二、安装nvm-可选"><a href="#二、安装nvm-可选" class="headerlink" title="二、安装nvm(可选)"></a>二、安装<code>nvm</code>(可选)</h1><p>用于管理<code>node</code>版本<br><a href="https://github.com/coreybutler/nvm-windows/releases"><code>nvm</code>下载地址</a></p>
<h2 id="1、配置nvm和node环境变量下载nvm-setup-zip"><a href="#1、配置nvm和node环境变量下载nvm-setup-zip" class="headerlink" title="1、配置nvm和node环境变量下载nvm-setup.zip"></a>1、<del>配置<code>nvm</code>和<code>node</code>环境变量</del>下载<code>nvm-setup.zip</code></h2><p>①<del><code>win(图标)+r</code>—&gt;输入<code>sysdm.cpl</code>—&gt;<code>高级</code>—&gt;<code>环境变量</code>—&gt;<code>用户变量path</code>—&gt;<code>新建</code>输入<code>%NVM_HOME%</code>,继续<code>新建</code>输入<code>%NVM_SYMLINK%</code></del><br>②<del><code>在系统变量</code>—&gt;新建—&gt;变量名<code>NVM_HOME</code>，路径<code>D:\Programs\nvm-noinstall</code>(根据自己解压后放置的目录修改)—&gt;确定后，新建—&gt;变量名<code>NVM_SYMLINK</code>,路径<code>D:\Program Files\nodejs</code>(nodejs安装路径)</del><font color='red'><strong>解压安装，注意安装时路径选择一个是<code>nvm</code>安装路径，一个是<code>nodejs</code>路径，路径不能有空格中文。</strong></font><br>③<del>在<code>D:\Programs\nvm-noinstall</code>文件夹新建settings.txt文件，内容如下：</del><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root: D:\Programs\nvm</span><br><span class="line">path: D:\Programs\nodejs</span><br></pre></td></tr></table></figure><br>④打开终端设置国内安装源<br>命令如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS D:\Programs\nvm&gt; nvm node_mirror https://npm.taobao.org/mirrors/node/</span><br><span class="line">PS D:\Programs\nvm&gt; nvm npm_mirror https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure><br>⑤查看可安装版本<br>命令如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS D:\Programs\nvm&gt; nvm <span class="built_in">ls</span> available</span><br></pre></td></tr></table></figure><br>结果如图：<br><img src="\pic\2021\12\nvm安装node.png" alt="nvm安装node.png"><br>安装并使用<code>16.13.1</code>版本：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS D:\Programs\nvm&gt; nvm install 16.13.1</span><br><span class="line">PS D:\Programs\nvm&gt; nvm list</span><br><span class="line"></span><br><span class="line">    16.13.1</span><br><span class="line">PS D:\Programs\nvm&gt; nvm use 16.13.1</span><br><span class="line">Now using node v16.13.1 (64-bit)</span><br></pre></td></tr></table></figure><br><strong>如果不安装<code>nvm</code>则需要到<a href="https://nodejs.org/en/"><code>nodejs</code>官网</a>下载安装<code>nodejs</code></strong></p>
<h1 id="三、创建SSH密钥"><a href="#三、创建SSH密钥" class="headerlink" title="三、创建SSH密钥"></a>三、创建<code>SSH</code>密钥</h1><h2 id="1、按照Github提示，创建SSH秘钥："><a href="#1、按照Github提示，创建SSH秘钥：" class="headerlink" title="1、按照Github提示，创建SSH秘钥："></a>1、按照<code>Github</code>提示，创建<code>SSH</code>秘钥：</h2><p>（1）命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">PS D:Programs\nvm&gt; <span class="built_in">mkdir</span> ~/.ssh</span><br><span class="line">PS D:Programs\nvm&gt; <span class="built_in">cd</span> ~/.ssh</span><br><span class="line">PS C:\Users\XXX\.ssh&gt; ssh-keygen -t rsa -C <span class="string">&quot;邮箱地址&quot;</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/用户名/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/用户名/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/用户名/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:0NY9YEJ+aCViuJzyv**juiZ8 邮箱地址</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|     .o.*o++.    |</span></span><br><span class="line"><span class="string">|    .. * B=o     |</span></span><br><span class="line"><span class="string">|  o. o      o    |</span></span><br><span class="line"><span class="string">| ..o+o *     .   |</span></span><br><span class="line"><span class="string">|   o*.o So .     |</span></span><br><span class="line"><span class="string">| . =.o. .        |</span></span><br><span class="line"><span class="string">|  * .... . .     |</span></span><br><span class="line"><span class="string">| oo.o..          |</span></span><br><span class="line"><span class="string">| .o=             |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">PS C:\Users\XXX\.ssh&gt; ls</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Directory: C:\Users\XXX\.ssh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Mode                 LastWriteTime         Length Name</span></span><br><span class="line"><span class="string">----                 -------------         ------ ----</span></span><br><span class="line"><span class="string">-a---          2020-12-13    16:22           2602 id_rsa</span></span><br><span class="line"><span class="string">-a---          2020-12-13    16:22            572 id_rsa.pub</span></span><br><span class="line"><span class="string">-a---          2020-12-25    16:30           1596 known_hosts</span></span><br><span class="line"><span class="string">PS C:\Users\XXX\.ssh&gt; cat id_rsa.pub</span></span><br><span class="line"><span class="string">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXoLe6b+9fvDT/L8hcz***************eh+GK4vVv+1dyv9 您注册github的邮箱</span></span><br></pre></td></tr></table></figure></p>
<p>（2）打开<code>https://github.com/settings/keys</code>，点击<code>New SSH key</code>新增 <code>SSH KEY</code>，<code>tittle</code>填入<code>win10</code>内容如上：<code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXoLe6b+9fvDT/L8hcz***************eh+GK4vVv+1dyv9 您注册github的邮箱</code><br>（3）新建并配置<code>github</code>仓库<br>  ①打开<code>https://github.com/</code>登录后，在右上角点击<code>+</code>==&gt;<code>New repository</code>==&gt;<code>Repository name</code>输入：<code>XXX.github.io</code>==&gt;<code>Create repository</code><br>  ②进入新仓库，<code>Add file</code>==&gt;文件名<code>CNAME</code>,内容<code>你的域名</code>（域名需自己注册，没域名就直接用<code>XXX.github.io</code>访问网页）。<br>  ③点击仓库右边<code>Settins</code>==&gt;网页下方<code>pages</code>==&gt;<code>Source</code>选择<code>master</code>(因为网页文件上传是传到<code>master</code>分支)==&gt;<code>Custom domain</code>根据上面<code>你的域名</code>填写。  </p>
<p>关于域名解析在主机运营商处填写，比如<code>WWW</code>或者<code>@</code>等，记录值填写<code>XXX.github.io</code>.  </p>
<h1 id="四、安装并配置git"><a href="#四、安装并配置git" class="headerlink" title="四、安装并配置git"></a>四、安装并配置<code>git</code></h1><h2 id="1、安装git"><a href="#1、安装git" class="headerlink" title="1、安装git"></a>1、安装<code>git</code></h2><p><a href="https://git-scm.com/download/win">下载地址</a>【注意会自动下载】<br>你可以使用<code>Git Chocolatey</code>包自动安装<a href="https://community.chocolatey.org/packages/git#testingResults">下载地址</a> </p>
<h2 id="2、在电脑上配置git"><a href="#2、在电脑上配置git" class="headerlink" title="2、在电脑上配置git"></a>2、在电脑上配置<code>git</code></h2><p>在终端输入命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">PS C:\Users\XXX\.ssh&gt; git config --global user.name <span class="string">&quot;注册github的用户名&quot;</span></span><br><span class="line">PS C:\Users\XXX\.ssh&gt; git config --global user.email <span class="string">&quot;注册github的邮箱&quot;</span></span><br></pre></td></tr></table></figure><br>其他命令<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">PS C:\Users\XXX\.ssh&gt; git config --global -l  <span class="comment"># 查看git配置</span></span><br><span class="line">core.editor=<span class="string">&quot;D:\Program Files (x86)\Sublime Text 3\sublime_text.exe&quot;</span> -w</span><br><span class="line">core.autocrlf=<span class="literal">false</span></span><br><span class="line">user.name=你设置的用户名</span><br><span class="line">user.email=你github的邮箱地址 </span><br><span class="line">PS C:\Users\XXX\.ssh&gt; ssh -T git@github.com  <span class="comment"># 查看与git的连接</span></span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;github.com (52.192.72.89)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:p2QAMXNIC1TJYWeIOttrVc98/R1BUFWu3/LiyKgUfQM.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>github.com,XXX.XXX.XXX.XXX<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Hi owenyk! You&#x27;</span>ve successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure><br>设置和取消代理:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy 你的代理地址</span><br><span class="line">git config --global https.proxy 你的代理地址</span><br></pre></td></tr></table></figure><br><strong>代理地址中<code>http://</code>也可以改成<code>sockets5://</code>,但是区别在于：<code>socks5</code>不支持通过<code>pubkey</code>免密登录<code>github</code>，每次提交代码只能输入用户名和密码,<code>http</code>可以支持免密登录。</strong><br>取消代理：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global --<span class="built_in">unset</span> http.proxy </span><br><span class="line">git config --global --<span class="built_in">unset</span> https.proxy </span><br></pre></td></tr></table></figure></p>
<h1 id="五、安装hexo"><a href="#五、安装hexo" class="headerlink" title="五、安装hexo"></a>五、安装<code>hexo</code></h1><h2 id="1、安装hexo命令："><a href="#1、安装hexo命令：" class="headerlink" title="1、安装hexo命令："></a>1、安装<code>hexo</code>命令：</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">PS C:\Users\XXX\.ssh&gt; npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<h2 id="2、创建存放博客的文件夹"><a href="#2、创建存放博客的文件夹" class="headerlink" title="2、创建存放博客的文件夹"></a>2、创建存放博客的文件夹</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">PS C:\Users\XXX\.ssh&gt; <span class="built_in">mkdir</span> E:\WebSites\GitWeb\gitBlog</span><br><span class="line">PS C:\Users\XXX\.ssh&gt; <span class="built_in">cd</span> E:\WebSites\GitWeb\gitBlog</span><br><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; hexo init   <span class="comment">##初始化hexo设置</span></span><br><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; npm install</span><br><span class="line"></span><br><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; npm install urix</span><br><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; npm install resolve-url <span class="comment"># `url`格式相关</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>文件夹出现<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml     #配置文件</span><br><span class="line">├── package.json    #应用程序数据</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source          #网站内容</span><br><span class="line">|   ├── _drafts     #草稿</span><br><span class="line">|   └── _posts      #文章</span><br><span class="line">└── themes          #主题</span><br></pre></td></tr></table></figure><br>查询相关信息：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xx &gt; E:\WebSites\GitWeb\gitBlog &gt; 16.13.2 &gt; ♥ 15:29 hexo -V</span><br><span class="line">INFO  Validating config</span><br><span class="line">INFO  ==================================</span><br><span class="line">  ███╗   ██╗███████╗██╗  ██╗████████╗</span><br><span class="line">  ████╗  ██║██╔════╝╚██╗██╔╝╚══██╔══╝</span><br><span class="line">  ██╔██╗ ██║█████╗   ╚███╔╝    ██║</span><br><span class="line">  ██║╚██╗██║██╔══╝   ██╔██╗    ██║</span><br><span class="line">  ██║ ╚████║███████╗██╔╝ ██╗   ██║</span><br><span class="line">  ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝   ╚═╝</span><br><span class="line">========================================</span><br><span class="line">NexT version 8.11.1</span><br><span class="line">Documentation: https://theme-next.js.org</span><br><span class="line">========================================</span><br><span class="line">hexo: 6.1.0</span><br><span class="line">hexo-cli: 4.3.0</span><br><span class="line">os: win32 10.0.19045</span><br><span class="line">node: 16.13.2</span><br><span class="line">v8: 9.4.146.24-node.14</span><br><span class="line">zlib: 1.2.11</span><br><span class="line">brotli: 1.0.9</span><br><span class="line">ares: 1.18.1</span><br><span class="line">modules: 93</span><br><span class="line">nghttp2: 1.45.1</span><br><span class="line">napi: 8</span><br><span class="line">llhttp: 6.0.4</span><br><span class="line">openssl: 1.1.1l+quic</span><br><span class="line">cldr: 39.0</span><br><span class="line">icu: 69.1</span><br><span class="line">tz: 2021a</span><br><span class="line">unicode: 13.0</span><br><span class="line">ngtcp2: 0.1.0-DEV</span><br><span class="line">nghttp3: 0.1.0-DEV</span><br></pre></td></tr></table></figure><br>详见：<a href="https://hexo.io/">hexo官网</a></p>
<h1 id="六、安装next-v8-8-2-主题"><a href="#六、安装next-v8-8-2-主题" class="headerlink" title="六、安装next[v8.8.2]主题"></a>六、安装<code>next[v8.8.2]</code>主题</h1><h2 id="1、安装next"><a href="#1、安装next" class="headerlink" title="1、安装next"></a>1、安装<code>next</code></h2><p><code>Hexo 5.0</code>或更新版本<code>npm</code>安装命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-theme-next</span><br></pre></td></tr></table></figure>
<p><strong>或者</strong>进入<strong>站点根目录</strong>后利用<code>git</code>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/next-theme/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><br>详见：<a href="https://github.com/next-theme/hexo-theme-next/blob/master/docs/zh-CN/README.md">主题介绍</a><br><code>NexT</code>和<code>Hexo</code>版本的兼容性  </p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Version</th>
<th>Hexo 3.0.0-beta.4或者更早版本</th>
<th>Hexo 3.0.0-rc.1 ~ 3.9</th>
<th>Hexo 4.0 ~ 4.2.1</th>
<th>Hexo 5.0或者更新版</th>
</tr>
</thead>
<tbody>
<tr>
<td>NexT v0.4.5.1 or 早期</td>
<td>✅</td>
<td>✅</td>
<td>❌ Icon (2)</td>
<td>❌ Icon (2)</td>
</tr>
<tr>
<td>NexT v0.4.5.2 ~ v7.4.1</td>
<td>⚠️ Data Files (1)</td>
<td>✅</td>
<td>❌ Icon (2)</td>
<td>❌ Icon (2)</td>
</tr>
<tr>
<td>NexT v7.4.2 ~ v8.1.0</td>
<td>⚠️ Data Files (1)</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>NexT v8.2.0 or 后期</td>
<td>⚠️ Nunjucks (3)</td>
<td>⚠️ Nunjucks (3)</td>
<td>⚠️ Nunjucks (3)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
<p>(1): <code>Hexo 3.0.0-beta.4</code>或者更早版本不支持数据文件.<br>(2): 图标可能无法正常显示.<br>(3): <code>Nunjucks</code>需要渲染器插件.<br><code>Next</code>各版本的仓库  </p>
<div class="table-container">
<table>
<thead>
<tr>
<th>年份</th>
<th>版本</th>
<th>仓库</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014 ~ 2017</td>
<td>v5</td>
<td><a href="https://github.com/iissnan/hexo-theme-next">https://github.com/iissnan/hexo-theme-next</a></td>
</tr>
<tr>
<td>2018 ~ 2019</td>
<td>v6 ~ v7</td>
<td><a href="https://github.com/theme-next/hexo-theme-next">https://github.com/theme-next/hexo-theme-next</a></td>
</tr>
<tr>
<td>2020</td>
<td>v8</td>
<td><a href="https://github.com/next-theme/hexo-theme-next">https://github.com/next-theme/hexo-theme-next</a></td>
</tr>
</tbody>
</table>
</div>
<h2 id="2、配置主题为next"><a href="#2、配置主题为next" class="headerlink" title="2、配置主题为next"></a>2、配置主题为<code>next</code></h2><p>(1)、复制<code>next</code>配置到站点根目录并命名为<code>_config.next.yml</code>,此后修改<code>next</code>配置修改此文件即可。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; <span class="built_in">cp</span> E:\WebSites\GitWeb\gitBlog\node_modules\hexo-theme-next\_config.yml _config.next.yml</span><br></pre></td></tr></table></figure><br>(2)、修改站点目录下<code>_config.yml</code>中主题配置,改为<code>next</code>：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure><br>(3)、复制<code>next主题</code>到<code>站点根目录\themes\</code>，此后配置修改此<code>主题文件夹</code>里的文件即可。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; <span class="built_in">cp</span> E:\WebSites\GitWeb\gitBlog\node_modules\hexo-theme-next\ \themes\next</span><br></pre></td></tr></table></figure></p>
<h1 id="七、其他简单美化配置"><a href="#七、其他简单美化配置" class="headerlink" title="七、其他简单美化配置"></a>七、其他简单美化配置</h1><h2 id="1、标题链接项目"><a href="#1、标题链接项目" class="headerlink" title="1、标题链接项目"></a>1、标题链接项目</h2><p>打开主题配置文件<code>_config.next.yml</code>,找到如下项目并修改为如下：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br></pre></td></tr></table></figure><br>然后在<code>站点/source/</code>目录下新建，<code>about</code>、<code>tags</code>、<code>categories</code>、<code>archives</code>几个文件夹，里面以<code>index.html</code>命名新建文件：<br>内容分别如下：<br><figure class="highlight md"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: about</span><br><span class="line">date: 2020-12-27 08:43:10</span><br><span class="line"><span class="section">comments: false</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 关于我</span></span><br><span class="line">你的内容</span><br><span class="line">Email：xxxx</span><br></pre></td></tr></table></figure><br><figure class="highlight md"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2020-12-27 08:47:54</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line"><span class="section">comments: false</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><br><figure class="highlight md"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2020-12-27 17:15:22</span><br><span class="line">type: categories</span><br><span class="line"><span class="section">comments: false</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><br><figure class="highlight md"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: archives</span><br><span class="line">date: 2020-12-27 17:15:22</span><br><span class="line">type: archives</span><br><span class="line"><span class="section">comments: false</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><br>另外若站点图片也存于此<code>站点/source/</code>目录下，则新建<code>pic</code>文件夹放入图片，做图片链接即可。</p>
<h2 id="2、安装sitemap"><a href="#2、安装sitemap" class="headerlink" title="2、安装sitemap"></a>2、安装<code>sitemap</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure>
<p>打开<strong>主题配置</strong>文件<code>_config.next.yml</code>,找到如下项目并修改为如下：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3、安装本地搜索"><a href="#3、安装本地搜索" class="headerlink" title="3、安装本地搜索"></a>3、安装本地搜索</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; npm install hexo-generator-searchdb --saved</span><br></pre></td></tr></table></figure>
<p>打开<strong>主题配置</strong>文件<code>_config.next.yml</code>,找到如下项目并修改为如下以启用本地搜索：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><br>打开<strong>站点配置</strong>添加以下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br></pre></td></tr></table></figure></p>
<h2 id="4、数学公式"><a href="#4、数学公式" class="headerlink" title="4、数学公式"></a>4、数学公式</h2><h3 id="第一步：-使用Kramed代替Marked"><a href="#第一步：-使用Kramed代替Marked" class="headerlink" title="第一步： 使用Kramed代替Marked"></a>第一步： 使用<code>Kramed</code>代替<code>Marked</code></h3><p><code>hexo</code> 默认的渲染引擎是 <code>marked</code>，但是 <code>marked</code> 不支持 <code>mathjax</code>。 <code>kramed</code> 是在 <code>marked</code> 的基础上进行修改。我们在工程目录下执行以下命令来安装 <code>kramed</code>.<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-kramed --save</span><br></pre></td></tr></table></figure><br>然后，更改<code>&lt;your-project-dir&gt;/node_modules/hexo-renderer-kramed/lib/renderer.js</code>，更改：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Change inline math rule</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="comment">// Fit kramed&#x27;s rule: $$ + \1 + $$</span></span><br><span class="line">    <span class="keyword">return</span> text.<span class="title function_">replace</span>(<span class="regexp">/`\$(.*?)\$`/g</span>, <span class="string">&#x27;$$$$$1$$$$&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>为：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Change inline math rule</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="第二步-停止使用-hexo-math"><a href="#第二步-停止使用-hexo-math" class="headerlink" title="第二步: 停止使用 hexo-math"></a>第二步: 停止使用 <code>hexo-math</code></h3><p>首先，如果你已经安装 <code>hexo-math</code>, 请卸载它：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-math --save</span><br></pre></td></tr></table></figure><br>然后安装 <code>hexo-renderer-mathjax</code> 包：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install hexo-renderer-mathjax --save</span><br></pre></td></tr></table></figure></p>
<h3 id="第三步-更新-Mathjax-的-CDN-链接-可选"><a href="#第三步-更新-Mathjax-的-CDN-链接-可选" class="headerlink" title="第三步: 更新 Mathjax 的 CDN 链接(可选)"></a>第三步: 更新 <code>Mathjax</code> 的 <code>CDN</code> 链接(可选)</h3><p>首先，打开<code>&lt;path-to-your-project&gt;/node_modules/hexo-renderer-mathjax/mathjax.html</code></p>
<p>然后，把<code>&lt;script&gt;</code>更改为：<br><code>&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt;&lt;/script&gt;</code></p>
<h3 id="第四步-更改默认转义规则"><a href="#第四步-更改默认转义规则" class="headerlink" title="第四步: 更改默认转义规则"></a>第四步: 更改默认转义规则</h3><p>因为 <code>hexo</code> 默认的转义规则会将一些字符进行转义，比如 <code>_</code>转为 <code>&lt;em&gt;</code>, 所以我们需要对默认的规则进行修改.<br>首先， 打开<code>&lt;path-to-your-project/node_modules/kramed/lib/rules/inline.js</code>,</p>
<p>然后，把:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">escape</span>: <span class="regexp">/^\\([\\`*&#123;&#125;\[\]()#$+\-.!_&gt;])/</span>,</span><br></pre></td></tr></table></figure><br>更改为:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">escape</span>: <span class="regexp">/^\\([`*\[\]()# +\-.!_&gt;])/</span>,</span><br></pre></td></tr></table></figure><br>把<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">em</span>: <span class="regexp">/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/</span>,</span><br></pre></td></tr></table></figure><br>更改为:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">em</span>: <span class="regexp">/^\*((?:\*\*|[\s\S])+?)\*(?!\*)/</span>,</span><br></pre></td></tr></table></figure></p>
<h3 id="第五步-开启mathjax"><a href="#第五步-开启mathjax" class="headerlink" title="第五步: 开启mathjax"></a>第五步: 开启<code>mathjax</code></h3><p>在<strong>站点和主题配置</strong><code>_config.yml</code>、<code>_config.next.yml</code> 中开启 <code>Mathjax</code>， 找到 <code>mathjax</code> 字段添加如下代码：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="comment"># Default (false) will load mathjax / katex script on demand.</span></span><br><span class="line">  <span class="comment"># That is it only render those page which has `mathjax: true` in front-matter.</span></span><br><span class="line">  <span class="comment"># If you set it to true, it will load mathjax / katex script EVERY PAGE.</span></span><br><span class="line">  <span class="attr">every_page:</span> <span class="literal">false</span>  <span class="comment"># 此项关闭，则需要在有mathjax内容的页面表头添加mathjax: true即如下一步。</span></span><br><span class="line"><span class="attr">mathjax:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>这一步可选，在博客中开启 <code>Mathjax</code>，， 添加以下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Testing</span> <span class="string">Mathjax</span> <span class="string">with</span> <span class="string">Hexo</span>  </span><br><span class="line"><span class="attr">category:</span> <span class="string">Uncategorized</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2017</span><span class="string">/05/03</span></span><br><span class="line"><span class="attr">mathjax:</span> <span class="literal">true</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><br>关于流程图<br><strong>需安装插件：<code>flowchart</code></strong><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm i hexo-filter-flowchart --save </span><br></pre></td></tr></table></figure><br>在<strong>站点</strong>根目录：<code>\_config.yml</code>加入<code>flowchart</code>支持:</p>
<p>通过以上步骤，我们就可以在 <code>hexo</code> 中使用 <code>Mathjax</code> 来书写数学公式。  </p>
<h2 id="5、标签云"><a href="#5、标签云" class="headerlink" title="5、标签云"></a>5、标签云</h2><p>安装支持：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS E:\WebSites\GitWeb\gitBlog&gt; npm install hexo-tag-cloud --save</span><br></pre></td></tr></table></figure><br>开启标签云：<br><code>swig</code> 用户 (<code>Next</code>主题在列)<br>在主题文件夹找到文件 <code>theme/next/layout/_macro/sidebar.swig</code>, 然后在<code>&lt;aside&gt;&lt;/aside&gt;</code>之间添加如下代码：<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% if site.tags.length &gt; 1 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/tagcloud.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/tagcanvas.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;widget-wrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;widget-title&quot;</span>&gt;</span>Tag Cloud<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myCanvasContainer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;widget tagcloud&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">width</span>=<span class="string">&quot;260&quot;</span> <span class="attr">height</span>=<span class="string">&quot;280&quot;</span> <span class="attr">id</span>=<span class="string">&quot;resCanvas&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width=100%&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><br>在<strong>站点配置</strong>添加以下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># hexo-tag-cloud</span></span><br><span class="line"><span class="attr">tag_cloud:</span></span><br><span class="line">    <span class="attr">textFont:</span> <span class="string">Trebuchet</span> <span class="string">MS,</span> <span class="string">Helvetica</span></span><br><span class="line">    <span class="attr">textColor:</span> <span class="string">&#x27;#333&#x27;</span></span><br><span class="line">    <span class="attr">textHeight:</span> <span class="number">25</span></span><br><span class="line">    <span class="attr">outlineColor:</span> <span class="string">&#x27;#E2E1D1&#x27;</span></span><br><span class="line">    <span class="attr">maxSpeed:</span> <span class="number">0.1</span></span><br></pre></td></tr></table></figure><br>最终效果如图： <img src="/pic/2021/12/标签云.png" alt="标签云"></p>
<h2 id="6、-添加RSS标签"><a href="#6、-添加RSS标签" class="headerlink" title="6、 添加RSS标签"></a>6、 添加<code>RSS</code>标签</h2><p>安装依赖：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><br>打开<strong>主题配置</strong>文件<code>_config.next.yml</code>,找到并增加如下项目：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line">  <span class="attr">RSS:</span>  <span class="string">/atom.xml</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-rss</span></span><br></pre></td></tr></table></figure><br>打开<strong>站点配置</strong>文件，添加以下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">feed:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">atom</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">atom.xml</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">20</span></span><br><span class="line">  <span class="attr">hub:</span></span><br><span class="line">  <span class="attr">content:</span></span><br><span class="line">  <span class="attr">content_limit:</span> <span class="number">140</span></span><br><span class="line">  <span class="attr">content_limit_delim:</span> <span class="string">&quot; &quot;</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">icon.png</span></span><br></pre></td></tr></table></figure></p>
<h2 id="7、相关文章推荐"><a href="#7、相关文章推荐" class="headerlink" title="7、相关文章推荐"></a>7、相关文章推荐</h2><p>安装推荐文章的插件：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-related-popular-posts --save</span><br></pre></td></tr></table></figure><br><strong>【Next8.13.2配置说明已更新新的插件依赖】<a href="https://github.com/sergeyzwezdin/hexo-related-posts">插件地址</a></strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先卸载后安装</span></span><br><span class="line">npm uninstall hexo-related-popular-posts -g --save</span><br><span class="line">npm install hexo-related-posts --save-dev</span><br></pre></td></tr></table></figure><br><del><font color='red'>打开<strong>主题配置</strong>文件<code>_config.next.yml</code>,找到并修改如下项目【已失效】：</font></del><br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">related_posts:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">title:</span> <span class="comment"># Custom header, leave empty to use the default one</span></span><br><span class="line">  <span class="attr">display_in_home:</span> <span class="literal">false</span> <span class="comment">#首页不显示</span></span><br><span class="line">  <span class="attr">params:</span></span><br><span class="line">    <span class="attr">maxCount:</span> <span class="number">5</span></span><br><span class="line">    <span class="comment">#PPMixingRate: 0.0  #相关度</span></span><br><span class="line">    <span class="comment">#isDate: false      #是否显示日期</span></span><br><span class="line">    <span class="comment">#isImage: false     #是否显示配图</span></span><br><span class="line">    <span class="attr">isExcerpt:</span> <span class="literal">false</span>    <span class="comment">#是否显示摘要</span></span><br></pre></td></tr></table></figure><br><strong>根据新插件说明，配置如下：</strong><br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">related_posts:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">title:</span> <span class="comment"># Custom header, leave empty to use the default one</span></span><br><span class="line">  <span class="attr">display_in_home:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></p>
<p><font color='red'>测试有<code>bug</code>,其相关推荐列表文章路径不对，会自动加上当前页面路径，造成无法访问。</font><br>【2022年11月10日更新】推荐此插件<a href="https://github.com/Sukwants/hexo-related-posts-bysk">hexo-related-posts-bysk</a><br>可解决相关问题：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-related-posts-bysk --save</span><br></pre></td></tr></table></figure><br>在文件 <code>themes/next/layout/_partials/post/post-related.njk</code> 里，替换全部为<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">%</span> <span class="string">set</span> <span class="string">related_post</span> <span class="string">=</span>  <span class="string">related_posts_bysk(post</span>, &#123;<span class="attr">maxCount:</span> <span class="string">theme.related_posts.max_count</span>, <span class="attr">orderBy:</span> <span class="string">theme.related_posts.order_by</span>, <span class="attr">order:</span> <span class="string">theme.related_posts.order</span>, <span class="attr">excludeTags:</span> <span class="string">theme.related_posts.exclude.tags</span>, <span class="attr">excludeCategories:</span> <span class="string">theme.related_posts.exclude.categories</span>&#125;<span class="string">)</span> <span class="string">%</span>&#125;</span><br><span class="line">&#123;<span class="string">%</span> <span class="string">if</span> <span class="string">related_post.length</span> <span class="string">&gt;</span> <span class="number">0</span> <span class="string">%</span>&#125;</span><br><span class="line">  <span class="string">&lt;div</span> <span class="string">class=&quot;popular-posts-header&quot;&gt;&#123;&#123;</span> <span class="string">theme.related_posts.title</span> <span class="string">or</span> <span class="string">__(&#x27;post.related_posts&#x27;)</span> <span class="string">&#125;&#125;&lt;/div&gt;</span></span><br><span class="line">  <span class="string">&lt;ul</span> <span class="string">class=&quot;related-posts&quot;&gt;</span></span><br><span class="line">  &#123;<span class="string">%</span> <span class="string">for</span> <span class="string">rl_post</span> <span class="string">in</span> <span class="string">related_post</span> <span class="string">%</span>&#125;</span><br><span class="line">      <span class="string">&lt;li</span> <span class="string">class=&quot;related-posts-item&quot;&gt;&lt;a</span> <span class="string">href=&quot;&#123;&#123;</span> <span class="string">url_for(rl_post.path)</span> <span class="string">&#125;&#125;&quot;&gt;&#123;&#123;</span> <span class="string">rl_post.title</span> <span class="string">&#125;&#125;&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line">  &#123;<span class="string">%</span> <span class="string">endfor</span> <span class="string">%</span>&#125;</span><br><span class="line">  <span class="string">&lt;/ul&gt;</span></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">endif</span> <span class="string">%</span>&#125;</span><br></pre></td></tr></table></figure><br>在文件 <code>themes/next/_config.yml</code> 里，重写 <code>related_posts</code> 以下的内容为<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># List related posts, written by Sukwants</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/Sukwants/hexo-related-posts-bysk</span></span><br><span class="line"><span class="attr">related_posts:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">title:</span> <span class="comment"># Custom header, leave empty to use the default one</span></span><br><span class="line">  <span class="attr">display_in_home:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">max_count:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">&#x27;date&#x27;</span></span><br><span class="line">  <span class="comment">#order: &#x27;positive&#x27;</span></span><br><span class="line">  <span class="attr">order:</span> <span class="string">&#x27;negative&#x27;</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">      <span class="comment">#- &#x27;some tags&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span></span><br><span class="line">      <span class="comment">#- &#x27;some categories&#x27;</span></span><br></pre></td></tr></table></figure><br>修改 <code>enable</code> 来打开和关闭该功能。<br>修改 <code>title</code> 来设置显示在相关文章之前的标题。如果没有设置，将使用默认标题。<br>修改 <code>display_in_home</code> 来决定是否在主页显示相关文章。<br>修改 <code>max_count</code> 来调整相关文章数量的上限。<br>修改 <code>order_by</code> 来设置相关文章的排序依据。你可以选择 <code>&#39;date&#39;</code>,<code>&#39;updated&#39;</code>,<code>&#39;title&#39;</code>,<code>&#39;random&#39;</code>。默认选择为 <code>&#39;date&#39;</code>.<br>选择 <code>order</code> 的值，可选值为 <code>&#39;positive&#39;</code>（升序）和 <code>&#39;negative&#39;</code>（降序），来设置相关文章的排列顺序。默认选择为 <code>&#39;negative&#39;</code>.<br>在 <code>exclude</code> 以下，在 <code>tags</code> 以下列出你不想让它参与文章相关性计算的标签，在 <code>categories</code> 以下列出你不想让它参与的分类。</p>
<h2 id="8、阅读统计"><a href="#8、阅读统计" class="headerlink" title="8、阅读统计"></a>8、阅读统计</h2><p>安装阅读时长依赖：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-symbols-count-time --save</span><br></pre></td></tr></table></figure><br>打开<strong>主题配置</strong>文件<code>_config.next.yml</code>,找到并增加如下项目：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">item_text_post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">5</span>                   <span class="comment"># Average Word Length</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">120</span>                 <span class="comment"># Words Per Minute（每分钟阅读词数）</span></span><br></pre></td></tr></table></figure><br>打开<strong>站点配置</strong>文件<code>_config.yml</code>,找到并增加如下项目：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line"><span class="comment">#文章内显示</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#网页底部显示</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">120</span></span><br></pre></td></tr></table></figure></p>
<p>其他优化可参考：<a href="https://blog.51cto.com/u_12877374/2853816">使用 Github 空间搭建 Hexo 技术博客——使用NexT优化博客</a></p>
<h2 id="9、繁简转换"><a href="#9、繁简转换" class="headerlink" title="9、繁简转换"></a>9、繁简转换</h2><p>下载<code>cn_tw.js</code>文件，或者将以下代码保存为<code>cn_tw.js</code>放在路径<code>hexo站点\themes\next\source\js</code>下面:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 来源网络，感谢作者</span></span><br><span class="line"><span class="keyword">var</span> defaultEncoding = <span class="number">2</span>; <span class="comment">// 网站默认语言，1: 繁體中文, 2: 简体中文</span></span><br><span class="line"><span class="keyword">var</span> translateDelay = <span class="number">0</span>; <span class="comment">//延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0</span></span><br><span class="line"><span class="keyword">var</span> cookieDomain = <span class="string">&quot;https://tding.top/&quot;</span>; <span class="comment">//更改为你的博客网址</span></span><br><span class="line"><span class="keyword">var</span> msgToTraditionalChinese = <span class="string">&quot;繁體&quot;</span>; <span class="comment">//此处可以更改为你想要显示的文字</span></span><br><span class="line"><span class="keyword">var</span> msgToSimplifiedChinese = <span class="string">&quot;简体&quot;</span>; <span class="comment">//同上，但两处均不建议更改</span></span><br><span class="line"><span class="keyword">var</span> translateButtonId = <span class="string">&quot;translateLink&quot;</span>; <span class="comment">//默认互换id</span></span><br><span class="line"><span class="keyword">var</span> currentEncoding = defaultEncoding;</span><br><span class="line"><span class="keyword">var</span> targetEncodingCookie = <span class="string">&quot;targetEncoding&quot;</span> + cookieDomain.<span class="title function_">replace</span>(<span class="regexp">/\./g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> targetEncoding = (<span class="title function_">getCookie</span>(targetEncodingCookie) == <span class="literal">null</span> ? <span class="attr">defaultEncoding</span>: <span class="title function_">getCookie</span>(targetEncodingCookie));</span><br><span class="line"><span class="keyword">var</span> translateButtonObject;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">translateText</span>(<span class="params">txt</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> (txt == <span class="string">&quot;&quot;</span> || txt == <span class="literal">null</span>) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">if</span> (currentEncoding == <span class="number">1</span> &amp;&amp; targetEncoding == <span class="number">2</span>) <span class="keyword">return</span> <span class="title class_">Simplized</span>(txt);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (currentEncoding == <span class="number">2</span> &amp;&amp; targetEncoding == <span class="number">1</span>) <span class="keyword">return</span> <span class="title class_">Traditionalized</span>(txt);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> txt</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">translateBody</span>(<span class="params">fobj</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_">typeof</span>(fobj) == <span class="string">&quot;object&quot;</span>) <span class="keyword">var</span> objs = fobj.<span class="property">childNodes</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">var</span> objs = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">childNodes</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; objs.<span class="property">length</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">var</span> obj = objs.<span class="title function_">item</span>(i);</span><br><span class="line">		<span class="keyword">if</span> (<span class="string">&quot;||BR|HR|TEXTAREA|&quot;</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;|&quot;</span> + obj.<span class="property">tagName</span> + <span class="string">&quot;|&quot;</span>) &gt; <span class="number">0</span> || obj == translateButtonObject) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span> (obj.<span class="property">title</span> != <span class="string">&quot;&quot;</span> &amp;&amp; obj.<span class="property">title</span> != <span class="literal">null</span>) obj.<span class="property">title</span> = <span class="title function_">translateText</span>(obj.<span class="property">title</span>);</span><br><span class="line">		<span class="keyword">if</span> (obj.<span class="property">alt</span> != <span class="string">&quot;&quot;</span> &amp;&amp; obj.<span class="property">alt</span> != <span class="literal">null</span>) obj.<span class="property">alt</span> = <span class="title function_">translateText</span>(obj.<span class="property">alt</span>);</span><br><span class="line">		<span class="keyword">if</span> (obj.<span class="property">tagName</span> == <span class="string">&quot;INPUT&quot;</span> &amp;&amp; obj.<span class="property">value</span> != <span class="string">&quot;&quot;</span> &amp;&amp; obj.<span class="property">type</span> != <span class="string">&quot;text&quot;</span> &amp;&amp; obj.<span class="property">type</span> != <span class="string">&quot;hidden&quot;</span>) obj.<span class="property">value</span> = <span class="title function_">translateText</span>(obj.<span class="property">value</span>);</span><br><span class="line">		<span class="keyword">if</span> (obj.<span class="property">nodeType</span> == <span class="number">3</span>) obj.<span class="property">data</span> = <span class="title function_">translateText</span>(obj.<span class="property">data</span>);</span><br><span class="line">		<span class="keyword">else</span> <span class="title function_">translateBody</span>(obj)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">translatePage</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> (targetEncoding == <span class="number">1</span>) &#123;</span><br><span class="line">		currentEncoding = <span class="number">1</span>;</span><br><span class="line">		targetEncoding = <span class="number">2</span>;</span><br><span class="line">		translateButtonObject.<span class="property">innerHTML</span> = msgToTraditionalChinese;</span><br><span class="line">		<span class="title function_">setCookie</span>(targetEncodingCookie, targetEncoding, <span class="number">7</span>);</span><br><span class="line">		<span class="title function_">translateBody</span>()</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (targetEncoding == <span class="number">2</span>) &#123;</span><br><span class="line">		currentEncoding = <span class="number">2</span>;</span><br><span class="line">		targetEncoding = <span class="number">1</span>;</span><br><span class="line">		translateButtonObject.<span class="property">innerHTML</span> = msgToSimplifiedChinese;</span><br><span class="line">		<span class="title function_">setCookie</span>(targetEncodingCookie, targetEncoding, <span class="number">7</span>);</span><br><span class="line">		<span class="title function_">translateBody</span>()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">JTPYStr</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;万与丑专业丛东丝丢两严丧个丬丰临为丽举么义乌乐乔习乡书买乱争于亏云亘亚产亩亲亵亸亿仅从仑仓仪们价众优伙会伛伞伟传伤伥伦伧伪伫体余佣佥侠侣侥侦侧侨侩侪侬俣俦俨俩俪俭债倾偬偻偾偿傥傧储傩儿兑兖党兰关兴兹养兽冁内冈册写军农冢冯冲决况冻净凄凉凌减凑凛几凤凫凭凯击凼凿刍划刘则刚创删别刬刭刽刿剀剂剐剑剥剧劝办务劢动励劲劳势勋勐勚匀匦匮区医华协单卖卢卤卧卫却卺厂厅历厉压厌厍厕厢厣厦厨厩厮县参叆叇双发变叙叠叶号叹叽吁后吓吕吗吣吨听启吴呒呓呕呖呗员呙呛呜咏咔咙咛咝咤咴咸哌响哑哒哓哔哕哗哙哜哝哟唛唝唠唡唢唣唤唿啧啬啭啮啰啴啸喷喽喾嗫呵嗳嘘嘤嘱噜噼嚣嚯团园囱围囵国图圆圣圹场坂坏块坚坛坜坝坞坟坠垄垅垆垒垦垧垩垫垭垯垱垲垴埘埙埚埝埯堑堕塆墙壮声壳壶壸处备复够头夸夹夺奁奂奋奖奥妆妇妈妩妪妫姗姜娄娅娆娇娈娱娲娴婳婴婵婶媪嫒嫔嫱嬷孙学孪宁宝实宠审宪宫宽宾寝对寻导寿将尔尘尧尴尸尽层屃屉届属屡屦屿岁岂岖岗岘岙岚岛岭岳岽岿峃峄峡峣峤峥峦崂崃崄崭嵘嵚嵛嵝嵴巅巩巯币帅师帏帐帘帜带帧帮帱帻帼幂幞干并广庄庆庐庑库应庙庞废庼廪开异弃张弥弪弯弹强归当录彟彦彻径徕御忆忏忧忾怀态怂怃怄怅怆怜总怼怿恋恳恶恸恹恺恻恼恽悦悫悬悭悯惊惧惨惩惫惬惭惮惯愍愠愤愦愿慑慭憷懑懒懔戆戋戏戗战戬户扎扑扦执扩扪扫扬扰抚抛抟抠抡抢护报担拟拢拣拥拦拧拨择挂挚挛挜挝挞挟挠挡挢挣挤挥挦捞损捡换捣据捻掳掴掷掸掺掼揸揽揿搀搁搂搅携摄摅摆摇摈摊撄撑撵撷撸撺擞攒敌敛数斋斓斗斩断无旧时旷旸昙昼昽显晋晒晓晔晕晖暂暧札术朴机杀杂权条来杨杩杰极构枞枢枣枥枧枨枪枫枭柜柠柽栀栅标栈栉栊栋栌栎栏树栖样栾桊桠桡桢档桤桥桦桧桨桩梦梼梾检棂椁椟椠椤椭楼榄榇榈榉槚槛槟槠横樯樱橥橱橹橼檐檩欢欤欧歼殁殇残殒殓殚殡殴毁毂毕毙毡毵氇气氢氩氲汇汉污汤汹沓沟没沣沤沥沦沧沨沩沪沵泞泪泶泷泸泺泻泼泽泾洁洒洼浃浅浆浇浈浉浊测浍济浏浐浑浒浓浔浕涂涌涛涝涞涟涠涡涢涣涤润涧涨涩淀渊渌渍渎渐渑渔渖渗温游湾湿溃溅溆溇滗滚滞滟滠满滢滤滥滦滨滩滪漤潆潇潋潍潜潴澜濑濒灏灭灯灵灾灿炀炉炖炜炝点炼炽烁烂烃烛烟烦烧烨烩烫烬热焕焖焘煅煳熘爱爷牍牦牵牺犊犟状犷犸犹狈狍狝狞独狭狮狯狰狱狲猃猎猕猡猪猫猬献獭玑玙玚玛玮环现玱玺珉珏珐珑珰珲琎琏琐琼瑶瑷璇璎瓒瓮瓯电画畅畲畴疖疗疟疠疡疬疮疯疱疴痈痉痒痖痨痪痫痴瘅瘆瘗瘘瘪瘫瘾瘿癞癣癫癯皑皱皲盏盐监盖盗盘眍眦眬着睁睐睑瞒瞩矫矶矾矿砀码砖砗砚砜砺砻砾础硁硅硕硖硗硙硚确硷碍碛碜碱碹磙礼祎祢祯祷祸禀禄禅离秃秆种积称秽秾稆税稣稳穑穷窃窍窑窜窝窥窦窭竖竞笃笋笔笕笺笼笾筑筚筛筜筝筹签简箓箦箧箨箩箪箫篑篓篮篱簖籁籴类籼粜粝粤粪粮糁糇紧絷纟纠纡红纣纤纥约级纨纩纪纫纬纭纮纯纰纱纲纳纴纵纶纷纸纹纺纻纼纽纾线绀绁绂练组绅细织终绉绊绋绌绍绎经绐绑绒结绔绕绖绗绘给绚绛络绝绞统绠绡绢绣绤绥绦继绨绩绪绫绬续绮绯绰绱绲绳维绵绶绷绸绹绺绻综绽绾绿缀缁缂缃缄缅缆缇缈缉缊缋缌缍缎缏缐缑缒缓缔缕编缗缘缙缚缛缜缝缞缟缠缡缢缣缤缥缦缧缨缩缪缫缬缭缮缯缰缱缲缳缴缵罂网罗罚罢罴羁羟羡翘翙翚耢耧耸耻聂聋职聍联聩聪肃肠肤肷肾肿胀胁胆胜胧胨胪胫胶脉脍脏脐脑脓脔脚脱脶脸腊腌腘腭腻腼腽腾膑臜舆舣舰舱舻艰艳艹艺节芈芗芜芦苁苇苈苋苌苍苎苏苘苹茎茏茑茔茕茧荆荐荙荚荛荜荞荟荠荡荣荤荥荦荧荨荩荪荫荬荭荮药莅莜莱莲莳莴莶获莸莹莺莼萚萝萤营萦萧萨葱蒇蒉蒋蒌蓝蓟蓠蓣蓥蓦蔷蔹蔺蔼蕲蕴薮藁藓虏虑虚虫虬虮虽虾虿蚀蚁蚂蚕蚝蚬蛊蛎蛏蛮蛰蛱蛲蛳蛴蜕蜗蜡蝇蝈蝉蝎蝼蝾螀螨蟏衅衔补衬衮袄袅袆袜袭袯装裆裈裢裣裤裥褛褴襁襕见观觃规觅视觇览觉觊觋觌觍觎觏觐觑觞触觯詟誉誊讠计订讣认讥讦讧讨让讪讫训议讯记讱讲讳讴讵讶讷许讹论讻讼讽设访诀证诂诃评诅识诇诈诉诊诋诌词诎诏诐译诒诓诔试诖诗诘诙诚诛诜话诞诟诠诡询诣诤该详诧诨诩诪诫诬语诮误诰诱诲诳说诵诶请诸诹诺读诼诽课诿谀谁谂调谄谅谆谇谈谊谋谌谍谎谏谐谑谒谓谔谕谖谗谘谙谚谛谜谝谞谟谠谡谢谣谤谥谦谧谨谩谪谫谬谭谮谯谰谱谲谳谴谵谶谷豮贝贞负贠贡财责贤败账货质贩贪贫贬购贮贯贰贱贲贳贴贵贶贷贸费贺贻贼贽贾贿赀赁赂赃资赅赆赇赈赉赊赋赌赍赎赏赐赑赒赓赔赕赖赗赘赙赚赛赜赝赞赟赠赡赢赣赪赵赶趋趱趸跃跄跖跞践跶跷跸跹跻踊踌踪踬踯蹑蹒蹰蹿躏躜躯车轧轨轩轪轫转轭轮软轰轱轲轳轴轵轶轷轸轹轺轻轼载轾轿辀辁辂较辄辅辆辇辈辉辊辋辌辍辎辏辐辑辒输辔辕辖辗辘辙辚辞辩辫边辽达迁过迈运还这进远违连迟迩迳迹适选逊递逦逻遗遥邓邝邬邮邹邺邻郁郄郏郐郑郓郦郧郸酝酦酱酽酾酿释里鉅鉴銮錾钆钇针钉钊钋钌钍钎钏钐钑钒钓钔钕钖钗钘钙钚钛钝钞钟钠钡钢钣钤钥钦钧钨钩钪钫钬钭钮钯钰钱钲钳钴钵钶钷钸钹钺钻钼钽钾钿铀铁铂铃铄铅铆铈铉铊铋铍铎铏铐铑铒铕铗铘铙铚铛铜铝铞铟铠铡铢铣铤铥铦铧铨铪铫铬铭铮铯铰铱铲铳铴铵银铷铸铹铺铻铼铽链铿销锁锂锃锄锅锆锇锈锉锊锋锌锍锎锏锐锑锒锓锔锕锖锗错锚锜锞锟锠锡锢锣锤锥锦锨锩锫锬锭键锯锰锱锲锳锴锵锶锷锸锹锺锻锼锽锾锿镀镁镂镃镆镇镈镉镊镌镍镎镏镐镑镒镕镖镗镙镚镛镜镝镞镟镠镡镢镣镤镥镦镧镨镩镪镫镬镭镮镯镰镱镲镳镴镶长门闩闪闫闬闭问闯闰闱闲闳间闵闶闷闸闹闺闻闼闽闾闿阀阁阂阃阄阅阆阇阈阉阊阋阌阍阎阏阐阑阒阓阔阕阖阗阘阙阚阛队阳阴阵阶际陆陇陈陉陕陧陨险随隐隶隽难雏雠雳雾霁霉霭靓静靥鞑鞒鞯鞴韦韧韨韩韪韫韬韵页顶顷顸项顺须顼顽顾顿颀颁颂颃预颅领颇颈颉颊颋颌颍颎颏颐频颒颓颔颕颖颗题颙颚颛颜额颞颟颠颡颢颣颤颥颦颧风飏飐飑飒飓飔飕飖飗飘飙飚飞飨餍饤饥饦饧饨饩饪饫饬饭饮饯饰饱饲饳饴饵饶饷饸饹饺饻饼饽饾饿馀馁馂馃馄馅馆馇馈馉馊馋馌馍馎馏馐馑馒馓馔馕马驭驮驯驰驱驲驳驴驵驶驷驸驹驺驻驼驽驾驿骀骁骂骃骄骅骆骇骈骉骊骋验骍骎骏骐骑骒骓骔骕骖骗骘骙骚骛骜骝骞骟骠骡骢骣骤骥骦骧髅髋髌鬓魇魉鱼鱽鱾鱿鲀鲁鲂鲄鲅鲆鲇鲈鲉鲊鲋鲌鲍鲎鲏鲐鲑鲒鲓鲔鲕鲖鲗鲘鲙鲚鲛鲜鲝鲞鲟鲠鲡鲢鲣鲤鲥鲦鲧鲨鲩鲪鲫鲬鲭鲮鲯鲰鲱鲲鲳鲴鲵鲶鲷鲸鲹鲺鲻鲼鲽鲾鲿鳀鳁鳂鳃鳄鳅鳆鳇鳈鳉鳊鳋鳌鳍鳎鳏鳐鳑鳒鳓鳔鳕鳖鳗鳘鳙鳛鳜鳝鳞鳟鳠鳡鳢鳣鸟鸠鸡鸢鸣鸤鸥鸦鸧鸨鸩鸪鸫鸬鸭鸮鸯鸰鸱鸲鸳鸴鸵鸶鸷鸸鸹鸺鸻鸼鸽鸾鸿鹀鹁鹂鹃鹄鹅鹆鹇鹈鹉鹊鹋鹌鹍鹎鹏鹐鹑鹒鹓鹔鹕鹖鹗鹘鹚鹛鹜鹝鹞鹟鹠鹡鹢鹣鹤鹥鹦鹧鹨鹩鹪鹫鹬鹭鹯鹰鹱鹲鹳鹴鹾麦麸黄黉黡黩黪黾鼋鼌鼍鼗鼹齄齐齑齿龀龁龂龃龄龅龆龇龈龉龊龋龌龙龚龛龟志制咨只里系范松没尝尝闹面准钟别闲干尽脏拼&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">FTPYStr</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;萬與醜專業叢東絲丟兩嚴喪個爿豐臨為麗舉麼義烏樂喬習鄉書買亂爭於虧雲亙亞產畝親褻嚲億僅從侖倉儀們價眾優夥會傴傘偉傳傷倀倫傖偽佇體餘傭僉俠侶僥偵側僑儈儕儂俁儔儼倆儷儉債傾傯僂僨償儻儐儲儺兒兌兗黨蘭關興茲養獸囅內岡冊寫軍農塚馮衝決況凍淨淒涼淩減湊凜幾鳳鳧憑凱擊氹鑿芻劃劉則剛創刪別剗剄劊劌剴劑剮劍剝劇勸辦務勱動勵勁勞勢勳猛勩勻匭匱區醫華協單賣盧鹵臥衛卻巹廠廳曆厲壓厭厙廁廂厴廈廚廄廝縣參靉靆雙發變敘疊葉號歎嘰籲後嚇呂嗎唚噸聽啟吳嘸囈嘔嚦唄員咼嗆嗚詠哢嚨嚀噝吒噅鹹呱響啞噠嘵嗶噦嘩噲嚌噥喲嘜嗊嘮啢嗩唕喚呼嘖嗇囀齧囉嘽嘯噴嘍嚳囁嗬噯噓嚶囑嚕劈囂謔團園囪圍圇國圖圓聖壙場阪壞塊堅壇壢壩塢墳墜壟壟壚壘墾坰堊墊埡墶壋塏堖塒塤堝墊垵塹墮壪牆壯聲殼壺壼處備複夠頭誇夾奪奩奐奮獎奧妝婦媽嫵嫗媯姍薑婁婭嬈嬌孌娛媧嫻嫿嬰嬋嬸媼嬡嬪嬙嬤孫學孿寧寶實寵審憲宮寬賓寢對尋導壽將爾塵堯尷屍盡層屭屜屆屬屢屨嶼歲豈嶇崗峴嶴嵐島嶺嶽崠巋嶨嶧峽嶢嶠崢巒嶗崍嶮嶄嶸嶔崳嶁脊巔鞏巰幣帥師幃帳簾幟帶幀幫幬幘幗冪襆幹並廣莊慶廬廡庫應廟龐廢廎廩開異棄張彌弳彎彈強歸當錄彠彥徹徑徠禦憶懺憂愾懷態慫憮慪悵愴憐總懟懌戀懇惡慟懨愷惻惱惲悅愨懸慳憫驚懼慘懲憊愜慚憚慣湣慍憤憒願懾憖怵懣懶懍戇戔戲戧戰戩戶紮撲扡執擴捫掃揚擾撫拋摶摳掄搶護報擔擬攏揀擁攔擰撥擇掛摯攣掗撾撻挾撓擋撟掙擠揮撏撈損撿換搗據撚擄摑擲撣摻摜摣攬撳攙擱摟攪攜攝攄擺搖擯攤攖撐攆擷擼攛擻攢敵斂數齋斕鬥斬斷無舊時曠暘曇晝曨顯晉曬曉曄暈暉暫曖劄術樸機殺雜權條來楊榪傑極構樅樞棗櫪梘棖槍楓梟櫃檸檉梔柵標棧櫛櫳棟櫨櫟欄樹棲樣欒棬椏橈楨檔榿橋樺檜槳樁夢檮棶檢欞槨櫝槧欏橢樓欖櫬櫚櫸檟檻檳櫧橫檣櫻櫫櫥櫓櫞簷檁歡歟歐殲歿殤殘殞殮殫殯毆毀轂畢斃氈毿氌氣氫氬氳彙漢汙湯洶遝溝沒灃漚瀝淪滄渢溈滬濔濘淚澩瀧瀘濼瀉潑澤涇潔灑窪浹淺漿澆湞溮濁測澮濟瀏滻渾滸濃潯濜塗湧濤澇淶漣潿渦溳渙滌潤澗漲澀澱淵淥漬瀆漸澠漁瀋滲溫遊灣濕潰濺漵漊潷滾滯灩灄滿瀅濾濫灤濱灘澦濫瀠瀟瀲濰潛瀦瀾瀨瀕灝滅燈靈災燦煬爐燉煒熗點煉熾爍爛烴燭煙煩燒燁燴燙燼熱煥燜燾煆糊溜愛爺牘犛牽犧犢強狀獷獁猶狽麅獮獰獨狹獅獪猙獄猻獫獵獼玀豬貓蝟獻獺璣璵瑒瑪瑋環現瑲璽瑉玨琺瓏璫琿璡璉瑣瓊瑤璦璿瓔瓚甕甌電畫暢佘疇癤療瘧癘瘍鬁瘡瘋皰屙癰痙癢瘂癆瘓癇癡癉瘮瘞瘺癟癱癮癭癩癬癲臒皚皺皸盞鹽監蓋盜盤瞘眥矓著睜睞瞼瞞矚矯磯礬礦碭碼磚硨硯碸礪礱礫礎硜矽碩硤磽磑礄確鹼礙磧磣堿镟滾禮禕禰禎禱禍稟祿禪離禿稈種積稱穢穠穭稅穌穩穡窮竊竅窯竄窩窺竇窶豎競篤筍筆筧箋籠籩築篳篩簹箏籌簽簡籙簀篋籜籮簞簫簣簍籃籬籪籟糴類秈糶糲粵糞糧糝餱緊縶糸糾紆紅紂纖紇約級紈纊紀紉緯紜紘純紕紗綱納紝縱綸紛紙紋紡紵紖紐紓線紺絏紱練組紳細織終縐絆紼絀紹繹經紿綁絨結絝繞絰絎繪給絢絳絡絕絞統綆綃絹繡綌綏絛繼綈績緒綾緓續綺緋綽緔緄繩維綿綬繃綢綯綹綣綜綻綰綠綴緇緙緗緘緬纜緹緲緝縕繢緦綞緞緶線緱縋緩締縷編緡緣縉縛縟縝縫縗縞纏縭縊縑繽縹縵縲纓縮繆繅纈繚繕繒韁繾繰繯繳纘罌網羅罰罷羆羈羥羨翹翽翬耮耬聳恥聶聾職聹聯聵聰肅腸膚膁腎腫脹脅膽勝朧腖臚脛膠脈膾髒臍腦膿臠腳脫腡臉臘醃膕齶膩靦膃騰臏臢輿艤艦艙艫艱豔艸藝節羋薌蕪蘆蓯葦藶莧萇蒼苧蘇檾蘋莖蘢蔦塋煢繭荊薦薘莢蕘蓽蕎薈薺蕩榮葷滎犖熒蕁藎蓀蔭蕒葒葤藥蒞蓧萊蓮蒔萵薟獲蕕瑩鶯蓴蘀蘿螢營縈蕭薩蔥蕆蕢蔣蔞藍薊蘺蕷鎣驀薔蘞藺藹蘄蘊藪槁蘚虜慮虛蟲虯蟣雖蝦蠆蝕蟻螞蠶蠔蜆蠱蠣蟶蠻蟄蛺蟯螄蠐蛻蝸蠟蠅蟈蟬蠍螻蠑螿蟎蠨釁銜補襯袞襖嫋褘襪襲襏裝襠褌褳襝褲襇褸襤繈襴見觀覎規覓視覘覽覺覬覡覿覥覦覯覲覷觴觸觶讋譽謄訁計訂訃認譏訐訌討讓訕訖訓議訊記訒講諱謳詎訝訥許訛論訩訟諷設訪訣證詁訶評詛識詗詐訴診詆謅詞詘詔詖譯詒誆誄試詿詩詰詼誠誅詵話誕詬詮詭詢詣諍該詳詫諢詡譸誡誣語誚誤誥誘誨誑說誦誒請諸諏諾讀諑誹課諉諛誰諗調諂諒諄誶談誼謀諶諜謊諫諧謔謁謂諤諭諼讒諮諳諺諦謎諞諝謨讜謖謝謠謗諡謙謐謹謾謫譾謬譚譖譙讕譜譎讞譴譫讖穀豶貝貞負貟貢財責賢敗賬貨質販貪貧貶購貯貫貳賤賁貰貼貴貺貸貿費賀貽賊贄賈賄貲賃賂贓資賅贐賕賑賚賒賦賭齎贖賞賜贔賙賡賠賧賴賵贅賻賺賽賾贗讚贇贈贍贏贛赬趙趕趨趲躉躍蹌蹠躒踐躂蹺蹕躚躋踴躊蹤躓躑躡蹣躕躥躪躦軀車軋軌軒軑軔轉軛輪軟轟軲軻轤軸軹軼軤軫轢軺輕軾載輊轎輈輇輅較輒輔輛輦輩輝輥輞輬輟輜輳輻輯轀輸轡轅轄輾轆轍轔辭辯辮邊遼達遷過邁運還這進遠違連遲邇逕跡適選遜遞邐邏遺遙鄧鄺鄔郵鄒鄴鄰鬱郤郟鄶鄭鄆酈鄖鄲醞醱醬釅釃釀釋裏钜鑒鑾鏨釓釔針釘釗釙釕釷釺釧釤鈒釩釣鍆釹鍚釵鈃鈣鈈鈦鈍鈔鍾鈉鋇鋼鈑鈐鑰欽鈞鎢鉤鈧鈁鈥鈄鈕鈀鈺錢鉦鉗鈷缽鈳鉕鈽鈸鉞鑽鉬鉭鉀鈿鈾鐵鉑鈴鑠鉛鉚鈰鉉鉈鉍鈹鐸鉶銬銠鉺銪鋏鋣鐃銍鐺銅鋁銱銦鎧鍘銖銑鋌銩銛鏵銓鉿銚鉻銘錚銫鉸銥鏟銃鐋銨銀銣鑄鐒鋪鋙錸鋱鏈鏗銷鎖鋰鋥鋤鍋鋯鋨鏽銼鋝鋒鋅鋶鐦鐧銳銻鋃鋟鋦錒錆鍺錯錨錡錁錕錩錫錮鑼錘錐錦鍁錈錇錟錠鍵鋸錳錙鍥鍈鍇鏘鍶鍔鍤鍬鍾鍛鎪鍠鍰鎄鍍鎂鏤鎡鏌鎮鎛鎘鑷鐫鎳鎿鎦鎬鎊鎰鎔鏢鏜鏍鏰鏞鏡鏑鏃鏇鏐鐔钁鐐鏷鑥鐓鑭鐠鑹鏹鐙鑊鐳鐶鐲鐮鐿鑔鑣鑞鑲長門閂閃閆閈閉問闖閏闈閑閎間閔閌悶閘鬧閨聞闥閩閭闓閥閣閡閫鬮閱閬闍閾閹閶鬩閿閽閻閼闡闌闃闠闊闋闔闐闒闕闞闤隊陽陰陣階際陸隴陳陘陝隉隕險隨隱隸雋難雛讎靂霧霽黴靄靚靜靨韃鞽韉韝韋韌韍韓韙韞韜韻頁頂頃頇項順須頊頑顧頓頎頒頌頏預顱領頗頸頡頰頲頜潁熲頦頤頻頮頹頷頴穎顆題顒顎顓顏額顳顢顛顙顥纇顫顬顰顴風颺颭颮颯颶颸颼颻飀飄飆飆飛饗饜飣饑飥餳飩餼飪飫飭飯飲餞飾飽飼飿飴餌饒餉餄餎餃餏餅餑餖餓餘餒餕餜餛餡館餷饋餶餿饞饁饃餺餾饈饉饅饊饌饢馬馭馱馴馳驅馹駁驢駔駛駟駙駒騶駐駝駑駕驛駘驍罵駰驕驊駱駭駢驫驪騁驗騂駸駿騏騎騍騅騌驌驂騙騭騤騷騖驁騮騫騸驃騾驄驏驟驥驦驤髏髖髕鬢魘魎魚魛魢魷魨魯魴魺鮁鮃鯰鱸鮋鮓鮒鮊鮑鱟鮍鮐鮭鮚鮳鮪鮞鮦鰂鮜鱠鱭鮫鮮鮺鯗鱘鯁鱺鰱鰹鯉鰣鰷鯀鯊鯇鮶鯽鯒鯖鯪鯕鯫鯡鯤鯧鯝鯢鯰鯛鯨鯵鯴鯔鱝鰈鰏鱨鯷鰮鰃鰓鱷鰍鰒鰉鰁鱂鯿鰠鼇鰭鰨鰥鰩鰟鰜鰳鰾鱈鱉鰻鰵鱅鰼鱖鱔鱗鱒鱯鱤鱧鱣鳥鳩雞鳶鳴鳲鷗鴉鶬鴇鴆鴣鶇鸕鴨鴞鴦鴒鴟鴝鴛鴬鴕鷥鷙鴯鴰鵂鴴鵃鴿鸞鴻鵐鵓鸝鵑鵠鵝鵒鷳鵜鵡鵲鶓鵪鶤鵯鵬鵮鶉鶊鵷鷫鶘鶡鶚鶻鶿鶥鶩鷊鷂鶲鶹鶺鷁鶼鶴鷖鸚鷓鷚鷯鷦鷲鷸鷺鸇鷹鸌鸏鸛鸘鹺麥麩黃黌黶黷黲黽黿鼂鼉鞀鼴齇齊齏齒齔齕齗齟齡齙齠齜齦齬齪齲齷龍龔龕龜誌製谘隻裡係範鬆冇嚐嘗鬨麵準鐘彆閒乾儘臟拚&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Traditionalized</span>(<span class="params">cc</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> str = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">var</span> ss = <span class="title class_">JTPYStr</span>();</span><br><span class="line">	<span class="keyword">var</span> tt = <span class="title class_">FTPYStr</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cc.<span class="property">length</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (cc.<span class="title function_">charCodeAt</span>(i) &gt; <span class="number">10000</span> &amp;&amp; ss.<span class="title function_">indexOf</span>(cc.<span class="title function_">charAt</span>(i)) != -<span class="number">1</span>) str += tt.<span class="title function_">charAt</span>(ss.<span class="title function_">indexOf</span>(cc.<span class="title function_">charAt</span>(i)));</span><br><span class="line">		<span class="keyword">else</span> str += cc.<span class="title function_">charAt</span>(i)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> str</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Simplized</span>(<span class="params">cc</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> str = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">var</span> ss = <span class="title class_">JTPYStr</span>();</span><br><span class="line">	<span class="keyword">var</span> tt = <span class="title class_">FTPYStr</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cc.<span class="property">length</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (cc.<span class="title function_">charCodeAt</span>(i) &gt; <span class="number">10000</span> &amp;&amp; tt.<span class="title function_">indexOf</span>(cc.<span class="title function_">charAt</span>(i)) != -<span class="number">1</span>) str += ss.<span class="title function_">charAt</span>(tt.<span class="title function_">indexOf</span>(cc.<span class="title function_">charAt</span>(i)));</span><br><span class="line">		<span class="keyword">else</span> str += cc.<span class="title function_">charAt</span>(i)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> str</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setCookie</span>(<span class="params">name, value, days</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> (days) &#123;</span><br><span class="line">		<span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">		date.<span class="title function_">setTime</span>(date.<span class="title function_">getTime</span>() + (days * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>));</span><br><span class="line">		<span class="keyword">var</span> expires = <span class="string">&quot;; expires=&quot;</span> + date.<span class="title function_">toGMTString</span>()</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">var</span> expires = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="variable language_">document</span>.<span class="property">cookie</span> = name + <span class="string">&quot;=&quot;</span> + value + expires + <span class="string">&quot;; path=/&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCookie</span>(<span class="params">name</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> nameEQ = name + <span class="string">&quot;=&quot;</span>;</span><br><span class="line">	<span class="keyword">var</span> ca = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; ca.<span class="property">length</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">var</span> c = ca[i];</span><br><span class="line">		<span class="keyword">while</span> (c.<span class="title function_">charAt</span>(<span class="number">0</span>) == <span class="string">&#x27; &#x27;</span>) c = c.<span class="title function_">substring</span>(<span class="number">1</span>, c.<span class="property">length</span>);</span><br><span class="line">		<span class="keyword">if</span> (c.<span class="title function_">indexOf</span>(nameEQ) == <span class="number">0</span>) <span class="keyword">return</span> c.<span class="title function_">substring</span>(nameEQ.<span class="property">length</span>, c.<span class="property">length</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">translateInitilization</span>(<span class="params"></span>) &#123;</span><br><span class="line">	translateButtonObject = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(translateButtonId);</span><br><span class="line">	<span class="keyword">if</span> (translateButtonObject) &#123;</span><br><span class="line">		<span class="title function_">with</span>(<span class="params">translateButtonObject</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="title function_">typeof</span>(<span class="variable language_">document</span>.<span class="property">all</span>) != <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">				href = <span class="string">&quot;javascript:translatePage();&quot;</span></span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				href = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">				onclick = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;translatePage(); return false;&quot;</span>)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (currentEncoding != targetEncoding) &#123;</span><br><span class="line">			<span class="built_in">setTimeout</span>(<span class="string">&quot;translateBody()&quot;</span>, translateDelay);</span><br><span class="line">			<span class="keyword">if</span> (targetEncoding == <span class="number">1</span>) translateButtonObject.<span class="property">innerHTML</span> = msgToSimplifiedChinese;</span><br><span class="line">			<span class="keyword">else</span> translateButtonObject.<span class="property">innerHTML</span> = msgToTraditionalChinese</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>将以下代码放入<code>hexo站点\themes\next\layout\_partials\footer.njk</code>最后。<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;translate-style&quot;</span>&gt;</span></span><br><span class="line">繁/简：<span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;translateLink&quot;</span> <span class="attr">href</span>=<span class="string">&quot;javascript:translatePage();&quot;</span>&gt;</span>繁体</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/tw_cn.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> defaultEncoding = <span class="number">2</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> translateDelay = <span class="number">0</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> cookieDomain = <span class="string">&quot;https://kaisky.xyz/&quot;</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> msgToTraditionalChinese = <span class="string">&quot;繁体&quot;</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> msgToSimplifiedChinese = <span class="string">&quot;简体&quot;</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> translateButtonId = <span class="string">&quot;translateLink&quot;</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">translateInitilization</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="10、安装waline-重点推荐-、livere-推荐-、utterances-推荐-及和disqus评论插件"><a href="#10、安装waline-重点推荐-、livere-推荐-、utterances-推荐-及和disqus评论插件" class="headerlink" title="10、安装waline(重点推荐)、livere(推荐)、utterances(推荐)及和disqus评论插件"></a>10、安装<code>waline</code>(重点推荐)、<code>livere</code>(推荐)、<code>utterances</code>(推荐)及和<code>disqus</code>评论插件</h2><h3 id="1-、安装waline-重点推荐-评论插件【可匿名评论】"><a href="#1-、安装waline-重点推荐-评论插件【可匿名评论】" class="headerlink" title="(1)、安装waline(重点推荐)评论插件【可匿名评论】"></a>(1)、安装<code>waline</code>(重点推荐)评论插件【可匿名评论】</h3><p>先安装支持：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install @waline/hexo-next --save</span><br></pre></td></tr></table></figure><br><a href="https://vercel.com/import/project?template=https://github.com/walinejs/waline/tree/main/example">部署申请地址</a>.<br>大体步骤:<br>①、<code>leancloud</code>国际版注册账号，记下<code>id</code>、<code>key</code>、<code>masterksy</code> 三个参数；<br>②、在<code>github</code>上新建一个库；<br>③、根据上面部署申请地址申请账号，创建实例，连接<code>github</code>仓库，在实例配置依次添加<code>leancloud</code>的<code>LEAN_ID</code>和<code>LEAN_KEY</code>、<code>LEAN_MASTER_KEY</code>三项变量和对应值；<br>④、重新部署实例；<br>⑤、记录实例的<code>&lt;serverURL&gt;</code>.<br>在<strong>主题配置</strong>中添加如下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Waline</span></span><br><span class="line"><span class="comment"># For more information: https://waline.js.org, https://github.com/walinejs/waline</span></span><br><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">dark:</span> <span class="string">&#x27;body.darkmode--activated&#x27;</span>  <span class="comment"># 输入框暗黑模式</span></span><br><span class="line">  <span class="attr">serverURL:</span> <span class="string">https://你设置的名称.vercel.app/</span> <span class="comment"># Waline server address url</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">Just</span> <span class="string">go</span> <span class="string">go</span> <span class="comment"># Comment box placeholder</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">mm</span> <span class="comment"># Gravatar style</span></span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span> <span class="comment"># Pagination size</span></span><br><span class="line">  <span class="comment">#lang: # Language, available values: en, zh-cn</span></span><br><span class="line">  <span class="comment"># Warning: Do not enable both `waline.visitor` and `leancloud_visitors`.</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">true</span> <span class="comment"># Article reading statistic</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="literal">true</span> <span class="comment"># If false, comment count will only be displayed in post page, not in home page</span></span><br><span class="line">  <span class="attr">requiredFields:</span> [] <span class="comment"># Set required fields: [nick] | [nick, mail]</span></span><br></pre></td></tr></table></figure><br>【<code>20221106</code>更新为<code>@waline/hexo-next&quot;: &quot;^3.0.1&quot;,</code>后配置有做修改】<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="comment"># New! Whether enable this plugin</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">dark:</span> <span class="string">&#x27;body.darkmode--activated&#x27;</span></span><br><span class="line">  <span class="comment"># Waline server address url, you should set this to your own link</span></span><br><span class="line">  <span class="comment"># serverURL: https://waline.vercel.app</span></span><br><span class="line">  <span class="comment"># serverURL: https://gitblog-waline.vercel.app/</span></span><br><span class="line">  <span class="attr">serverURL:</span> <span class="string">https://wg3e9f.deta.dev/</span></span><br><span class="line">  <span class="comment"># serverURL: https://gitblog-waline.vercel.app/</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Waline library CDN url, you can set this to your preferred CDN</span></span><br><span class="line">  <span class="attr">libUrl:</span> <span class="string">https://unpkg.com/@waline/client@v2/dist/waline.js</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Waline CSS styles CDN url, you can set this to your preferred CDN</span></span><br><span class="line">  <span class="attr">cssUrl:</span> <span class="string">https://unpkg.com/@waline/client@v2/dist/waline.css</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Custom locales</span></span><br><span class="line">  <span class="attr">locale:</span></span><br><span class="line">    <span class="attr">placeholder:</span> <span class="string">Welcome</span> <span class="string">to</span> <span class="string">comment</span> <span class="comment"># Comment box placeholder</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If false, comment count will only be displayed in post page, not in home page</span></span><br><span class="line">  <span class="attr">commentCount:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Pageviews count, <span class="doctag">Note:</span> You should not enable both `waline.pageview` and `leancloud_visitors`.</span></span><br><span class="line">  <span class="attr">pageview:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Custom emoji</span></span><br><span class="line">  <span class="attr">emoji:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://unpkg.com/@waline/emojis@1.0.1/weibo</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://unpkg.com/@waline/emojis@1.0.1/alus</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://unpkg.com/@waline/emojis@1.0.1/bilibili</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://unpkg.com/@waline/emojis@1.0.1/qq</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://unpkg.com/@waline/emojis@1.0.1/tieba</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">https://unpkg.com/@waline/emojis@1.0.1/tw-emoji</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Comment infomation, valid meta are nick, mail and link</span></span><br><span class="line">  <span class="attr">meta:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">nick</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">mail</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">link</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Set required meta field, e.g.: [nick] | [nick, mail]</span></span><br><span class="line">  <span class="attr">requiredMeta:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">nick</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Language, available values: en-US, zh-CN, zh-TW, pt-BR, ru-RU, jp-JP</span></span><br><span class="line">  <span class="comment"># lang: zh-CN</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Word limit, no limit when setting to 0</span></span><br><span class="line">  <span class="comment"># wordLimit: 0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Whether enable login, can choose from &#x27;enable&#x27;, &#x27;disable&#x27; and &#x27;force&#x27;</span></span><br><span class="line">  <span class="attr">login:</span> <span class="string">enable</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># comment per page</span></span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure><br><a href="https://www.npmjs.com/package/@waline/hexo-next">【必读】waline/hexo-next配置参考
</a></p>
<p>因为<code>Next主题</code>对图片添加<code>display： block；</code>，避免表情包图片独占一行，在主题<code>css</code>配置路径<code>站点根目录\themes\next\source\css\_common\scaffolding\base.styl</code>中添加如下内容：<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.vcontent</span> <span class="selector-tag">p</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vpreview</span> <span class="selector-tag">p</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>配置完成需登录<code>&lt;serverURL&gt;/ui/register</code>注册管理评论。</p>
<h3 id="2-、安装livere及utterances-推荐"><a href="#2-、安装livere及utterances-推荐" class="headerlink" title="(2)、安装livere及utterances(推荐)"></a>(2)、安装<code>livere</code>及<code>utterances</code>(推荐)</h3><p><code>livere</code>【用社交账号登录时转链接到韩国站点不稳定】和<code>utterances</code>(需要<code>github</code>账户登录)<br><a href="https://livere.com"><code>livere</code>申请<code>livere_uid</code>地址</a>,<code>livere_uid</code>在<code>代码管理</code>—&gt; <code>data-uid=&quot;这是这里的代码&quot;</code>;<br><code>utterances</code>在<code>github</code>增加一个新的仓库，命名<code>xxx仓库</code><br>修改<strong>主题配置</strong><code>_config.next.yml</code>：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Multiple Comment System Support</span></span><br><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="comment"># Available values: tabs | buttons</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">buttons</span></span><br><span class="line">  <span class="comment"># Choose a comment system to be displayed by default.</span></span><br><span class="line">  <span class="comment"># Available values: disqus | disqusjs | changyan | livere | gitalk | utterances</span></span><br><span class="line">  <span class="attr">active:</span> <span class="string">waline</span></span><br><span class="line">  <span class="comment"># Setting `true` means remembering the comment system selected by the visitor.</span></span><br><span class="line">  <span class="attr">storage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Lazyload all comment systems.</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Modify texts or order for any naves, here are some examples.</span></span><br><span class="line">  <span class="attr">nav:</span></span><br><span class="line">    <span class="attr">waline:</span></span><br><span class="line">      <span class="attr">order:</span> <span class="number">-3</span></span><br><span class="line">    <span class="attr">utterances:</span></span><br><span class="line">      <span class="attr">order:</span> <span class="number">-2</span></span><br><span class="line">    <span class="attr">livere:</span></span><br><span class="line">      <span class="attr">text:</span> <span class="string">livere</span></span><br><span class="line">      <span class="attr">order:</span> <span class="number">-1</span></span><br><span class="line"><span class="string">...中间内容省略...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LiveRe comments system</span></span><br><span class="line"><span class="comment"># You can get your uid from https://livere.com/insight/myCode (General web site)</span></span><br><span class="line"><span class="attr">livere_uid:</span> <span class="string">你申请的uid</span> <span class="comment"># &lt;your_uid&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">utterances:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">uername/xxx仓库</span> <span class="comment"># Github repository name</span></span><br><span class="line">  <span class="comment"># Available values: pathname | url | title | og:title</span></span><br><span class="line">  <span class="attr">issue_term:</span> <span class="string">pathname</span></span><br><span class="line">  <span class="comment"># Available values: github-light | github-dark | preferred-color-scheme | github-dark-orange | icy-dark | dark-blue | photon-dark | boxy-light</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">preferred-color-scheme</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-、安装disqus评论插件【被墙不易登录】"><a href="#3-、安装disqus评论插件【被墙不易登录】" class="headerlink" title="(3)、安装disqus评论插件【被墙不易登录】"></a>(3)、安装<code>disqus</code>评论插件【被墙不易登录】</h3><p>的具体步骤参考<a href="https://theme-next.js.org/docs/third-party-services/comments.html#Disqus">Comment Systems</a>介绍。<br>修改<strong>主题配置</strong><code>_config.next.yml</code>：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Disqus</span></span><br><span class="line"><span class="attr">disqus:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">shortname:</span> <span class="string">你在disqus的设置</span></span><br><span class="line">  <span class="attr">count:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><br>最终启用三个评论插件后效果如图：<br><del><code>waline</code>评论：</del><br><img src="/pic/2021/12/评论插件之waline.png" alt="评论插件之waline"><br><code>waline</code>评论【20221106更新后样式】：<br><img src="/pic/2022/11/评论插件之waline_20221106.png" alt="评论插件之waline_20221106"><br><code>utterances</code>评论：<br><img src="/pic/2021/12/评论插件之utterances.png" alt="评论插件之utterances"><br><code>livere</code>评论：<br><img src="/pic/2021/12/评论插件之livere.png" alt="评论插件之livere"></p>
<h2 id="11、添加手动开启、关闭暗黑模式"><a href="#11、添加手动开启、关闭暗黑模式" class="headerlink" title="11、添加手动开启、关闭暗黑模式"></a>11、添加手动开启、关闭暗黑模式</h2><p><code>Next8+</code>主题原生支持暗黑模式，但是是随着手机而自动调整，可添加手动调整按钮：</p>
<h3 id="1-、安装-hexo-next-darkmode-插件"><a href="#1-、安装-hexo-next-darkmode-插件" class="headerlink" title="(1)、安装 hexo-next-darkmode 插件:"></a>(1)、安装 hexo-next-darkmode 插件:</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-next-darkmode --save</span><br></pre></td></tr></table></figure>
<h3 id="2-、修改主题配置"><a href="#2-、修改主题配置" class="headerlink" title="(2)、修改主题配置"></a>(2)、修改<strong>主题配置</strong></h3><p>打开<strong>主题配置</strong>文件，添加如下内容：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dark Mode</span></span><br><span class="line"><span class="attr">darkmode:</span> <span class="literal">false</span>   <span class="comment"># 这是原生暗黑模式，选择关闭</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Darkmode JS</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/rqh656418510/hexo-next-darkmode, https://github.com/sandoche/Darkmode.js</span></span><br><span class="line"><span class="attr">darkmode_js:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">&#x27;64px&#x27;</span> <span class="comment"># default: &#x27;32px&#x27;</span></span><br><span class="line">  <span class="attr">right:</span> <span class="string">&#x27;32px&#x27;</span> <span class="comment"># default: &#x27;32px&#x27; 按钮显示在右边</span></span><br><span class="line">  <span class="attr">left:</span> <span class="string">&#x27;unset&#x27;</span> <span class="comment"># default: &#x27;unset&#x27;</span></span><br><span class="line">  <span class="attr">time:</span> <span class="string">&#x27;0.5s&#x27;</span> <span class="comment"># default: &#x27;0.3s&#x27;</span></span><br><span class="line">  <span class="attr">mixColor:</span> <span class="string">&#x27;transparent&#x27;</span> <span class="comment"># default: &#x27;#fff&#x27;</span></span><br><span class="line">  <span class="attr">backgroundColor:</span> <span class="string">&#x27;transparent&#x27;</span> <span class="comment"># default: &#x27;#fff&#x27;</span></span><br><span class="line">  <span class="attr">buttonColorDark:</span> <span class="string">&#x27;#100f2c&#x27;</span> <span class="comment"># default: &#x27;#100f2c&#x27;</span></span><br><span class="line">  <span class="attr">buttonColorLight:</span> <span class="string">&#x27;#fff&#x27;</span> <span class="comment"># default: &#x27;#fff&#x27;</span></span><br><span class="line">  <span class="attr">isActivated:</span> <span class="literal">false</span> <span class="comment"># default false</span></span><br><span class="line">  <span class="attr">saveInCookies:</span> <span class="literal">true</span> <span class="comment"># default: true</span></span><br><span class="line">  <span class="attr">label:</span> <span class="string">&#x27;🌓&#x27;</span> <span class="comment"># default: &#x27;&#x27;</span></span><br><span class="line">  <span class="attr">autoMatchOsTheme:</span> <span class="literal">true</span> <span class="comment"># default: true</span></span><br><span class="line">  <span class="attr">libUrl:</span> <span class="comment"># Set custom library cdn url for Darkmode.js</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-、自定义css配置-可选"><a href="#3-、自定义css配置-可选" class="headerlink" title="(3)、自定义css配置(可选)"></a>(3)、自定义<code>css</code>配置(可选)</h3><p>模块的样式配置是<code>站点根目录\node_modules\hexo-next-darkmode\lib\</code>下<code>darkmode.css</code>文件，内容如下：<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.darkmode--activated</span> &#123;</span><br><span class="line">  <span class="attr">--body-bg-color</span>: <span class="number">#282828</span>;</span><br><span class="line">  <span class="attr">--content-bg-color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attr">--card-bg-color</span>: <span class="number">#555</span>;</span><br><span class="line">  <span class="attr">--text-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attr">--blockquote-color</span>: <span class="number">#bbb</span>;</span><br><span class="line">  <span class="attr">--link-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attr">--link-hover-color</span>: <span class="number">#eee</span>;</span><br><span class="line">  <span class="attr">--brand-color</span>: <span class="number">#ddd</span>;</span><br><span class="line">  <span class="attr">--brand-hover-color</span>: <span class="number">#ddd</span>;</span><br><span class="line">  <span class="attr">--table-row-odd-bg-color</span>: <span class="number">#282828</span>;</span><br><span class="line">  <span class="attr">--table-row-hover-bg-color</span>: <span class="number">#363636</span>;</span><br><span class="line">  <span class="attr">--menu-item-bg-color</span>: <span class="number">#555</span>;</span><br><span class="line">  <span class="attr">--btn-default-bg</span>: <span class="number">#222</span>;</span><br><span class="line">  <span class="attr">--btn-default-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attr">--btn-default-border-color</span>: <span class="number">#555</span>;</span><br><span class="line">  <span class="attr">--btn-default-hover-bg</span>: <span class="number">#666</span>;</span><br><span class="line">  <span class="attr">--btn-default-hover-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attr">--btn-default-hover-border-color</span>: <span class="number">#666</span>;</span><br><span class="line">  <span class="attr">--highlight-background</span>: <span class="number">#282b2e</span>;</span><br><span class="line">  <span class="attr">--highlight-foreground</span>: <span class="number">#a9b7c6</span>;</span><br><span class="line">  <span class="attr">--highlight-gutter-background</span>: <span class="number">#34393d</span>;</span><br><span class="line">  <span class="attr">--highlight-gutter-foreground</span>: <span class="number">#9ca9b6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.darkmode--activated</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.75</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.darkmode--activated</span> <span class="selector-tag">img</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.darkmode--activated</span> <span class="selector-tag">code</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#69dbdc</span>;</span><br><span class="line">  <span class="attribute">background</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-class">.darkmode-toggle</span> &#123;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>可根据自己情况修改。</p>
<h2 id="12、-使用Pajx实现背景音乐全局播放"><a href="#12、-使用Pajx实现背景音乐全局播放" class="headerlink" title="12、 使用Pajx实现背景音乐全局播放"></a>12、 使用<code>Pajx</code>实现背景音乐全局播放</h2><p>安装支持：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-tag-aplayer --save //aplayer播放器</span><br></pre></td></tr></table></figure><br>打开<code>主题文件夹\layout</code>文件夹找到<code>_layout.njk</code>,在<code>&lt;head&gt;这里添加如下内容&lt;/head&gt;</code>:<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--pjax：防止跳转页面音乐暂停--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br></pre></td></tr></table></figure></p>
<h3 id="1-、只用aplayer插件："><a href="#1-、只用aplayer插件：" class="headerlink" title="(1)、只用aplayer插件："></a>(1)、只用<code>aplayer</code>插件：</h3><p>打开<code>主题配置</code>文件,设置<code>pjax: true</code>,增加<code>aplayer</code>配置,配置如下:<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pjax:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><br>然后在<code>主题文件夹\layout\_macro\sidebar</code>配置中<code>&lt;div class=&quot;sidebar-inner&gt;根据自己爱好在这里添加如下代码&lt;/div&gt;</code>进行配置：<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% if(theme.aplayer.enable) %&#125;</span><br><span class="line">      <span class="comment">&lt;!-- require APlayer --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--&lt;script src=&quot;https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/color-thief-don@2.0.2/src/color-thief.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;aplayer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position:absolute;right:0;bottom:0;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>  //style可以不设置</span><br><span class="line">  // 以下为aplayer配置部分</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> ap = <span class="keyword">new</span> <span class="title class_">APlayer</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">container</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;aplayer&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">mini</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">autoplay</span>: <span class="literal">false</span>, <span class="comment">//自动播放</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">listFolded</span>: <span class="literal">true</span>, <span class="comment">//播放列表默认折叠</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">listMaxHeight</span>: <span class="number">90</span>, <span class="comment">//播放列表最大高度</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">order</span>: <span class="string">&#x27;list&#x27;</span>, <span class="comment">//音频循环顺序, 可选值: &#x27;list&#x27;, &#x27;random&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">loop</span>: <span class="string">&#x27;all&#x27;</span>, <span class="comment">//音频循环播放, 可选值: &#x27;all&#x27;, &#x27;one&#x27;, &#x27;none&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">theme</span>: <span class="string">&#x27;#e9e9e9&#x27;</span>, <span class="comment">//切换音频时的主题色，优先级低于audio.theme</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">preload</span>: <span class="string">&#x27;none&#x27;</span>, <span class="comment">//音频预加载，可选值: &#x27;none&#x27;, &#x27;metadata&#x27;, &#x27;auto&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">mutex</span>: <span class="literal">true</span>, <span class="comment">//互斥，阻止多个播放器同时播放，当前播放器播放时暂停其他播放器</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">lrcType</span>: <span class="number">3</span>, <span class="comment">//歌词格式，可选值：3（LRC文件歌词格式），1（JS字符串歌词格式）</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">volume</span>: <span class="number">0.7</span>, <span class="comment">//默认音量，请注意播放器会记忆用户设置，用户手动设置音量后默认音量即失效</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">fixed</span>: <span class="literal">false</span>, <span class="comment">//吸底模式（fixed:true），迷你模式（mini:true），普通模式（注释此行或者设置fixed:false）</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">audio</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">name</span>: <span class="string">&#x27;歌曲名&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">artist</span>: <span class="string">&#x27;演唱者&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">lrc</span>: <span class="string">&#x27;lrc路径/歌曲名.lrc&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">cover</span>: <span class="string">&#x27;音频封面路径&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">url</span>: <span class="string">&#x27;音频路径&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">name</span>: <span class="string">&#x27;歌曲名&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">artist</span>: <span class="string">&#x27;演唱者&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">lrc</span>: <span class="string">&#x27;lrc路径/歌曲名.lrc&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">cover</span>: <span class="string">&#x27;音频封面路径&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">url</span>: <span class="string">&#x27;音频路径&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      ]</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//实现切换音频时，根据音频的封面图片自适应主题色</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> colorThief = <span class="keyword">new</span> <span class="title class_">ColorThief</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">setTheme</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!ap.<span class="property">list</span>.<span class="property">audios</span>[index].<span class="property">theme</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        colorThief.<span class="title function_">getColorAsync</span>(ap.<span class="property">list</span>.<span class="property">audios</span>[index].<span class="property">cover</span>, <span class="keyword">function</span>(<span class="params">color</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          ap.<span class="title function_">theme</span>(<span class="string">`rgb(<span class="subst">$&#123;color[<span class="number">0</span>]&#125;</span>, <span class="subst">$&#123;color[<span class="number">1</span>]&#125;</span>, <span class="subst">$&#123;color[<span class="number">2</span>]&#125;</span>)`</span>, index);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">setTheme</span>(ap.<span class="property">list</span>.<span class="property">index</span>);</span></span><br><span class="line"><span class="language-javascript">    ap.<span class="title function_">on</span>(<span class="string">&#x27;listswitch&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">setTheme</span>(data.<span class="property">index</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  &#123;% endif %&#125; </span><br></pre></td></tr></table></figure><br>以上配置参考:<br><a href="https://iluis.gitee.io/2020/04/09/Hexo%E5%AE%9E%E7%8E%B0%E5%85%A8%E5%B1%80%E6%92%AD%E6%94%BE%E8%83%8C%E6%99%AF%E9%9F%B3%E4%B9%90/#%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%9A%E4%BD%BF%E7%94%A8Aplayer%E6%B7%BB%E5%8A%A0%E6%9C%AC%E5%9C%B0%E9%9F%B3%E4%B9%90">Hexo + Next 主题实现全局播放背景音乐</a></p>
<h3 id="2-、配合MetingJS"><a href="#2-、配合MetingJS" class="headerlink" title="(2)、配合MetingJS"></a>(2)、配合<code>MetingJS</code></h3><p>打开<code>主题配置</code>文件,设置<code>pjax: true</code>,增加<code>aplayer</code>配置,配置如下:<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pjax:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">meting:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><br>然后在<code>主题文件夹\layout\_macro\sidebar</code>配置中<code>&lt;div class=&quot;sidebar-inner&gt;根据自己爱好在这里添加如下代码&lt;/div&gt;</code>进行配置<strong>【即替换（1）配置的那部分的内容】</strong>：<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- require APlayer --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--&lt;script src=&quot;https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/color-thief-don@2.0.2/src/color-thief.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- require MetingJS--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;aplayer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position:absolute;right:0;bottom:5;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meting-js</span></span></span><br><span class="line"><span class="tag">    <span class="attr">server</span>=<span class="string">&quot;netease&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">&quot;playlist&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;641900597&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">mini</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">meting-js</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><br>设置在<code>&lt;aside&gt;&lt;div class=&quot;sidebar-inner&gt;放在这里&lt;/div&gt;&lt;/aside&gt;</code>用<code>网易云音乐列表</code>的效果如图：<br><img src="/pic/2021/12/音乐插件之aplayer和MetingJS.png" alt="音乐插件之aplayer和MetingJS"></p>
<p>具体设置可参照：<br>1、<a href="https://aplayer.js.org/#/zh-Hans/?id=%E5%85%A5%E9%97%A8">aplayer文档</a><br>2、<a href="https://github.com/metowolf/MetingJS">MetingJS项目介绍</a></p>
<h2 id="13、站点字体配置-可选"><a href="#13、站点字体配置-可选" class="headerlink" title="13、站点字体配置(可选)"></a>13、站点字体配置(可选)</h2><p>(1)、<code>站点根目录\source\_data\</code>新建文件<code>variables.styl</code>,内容如下：<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// Title <span class="attribute">Font</span>, set it <span class="selector-tag">to</span> <span class="attribute">font</span> family you want.</span><br><span class="line">$<span class="attribute">font-family</span>-headings = Georgia, sans</span><br><span class="line"></span><br><span class="line">// Set it <span class="selector-tag">to</span> <span class="attribute">font</span> family you want.</span><br><span class="line">$<span class="attribute">font-family</span>-base = &quot;Microsoft YaHei&quot;, Verdana, sans-serif</span><br><span class="line"></span><br><span class="line">// <span class="selector-tag">Code</span> <span class="attribute">Font</span>.</span><br><span class="line">$<span class="selector-tag">code</span>-<span class="attribute">font-family</span> = &quot;Noto Sans S Chinese Medium&quot;,&quot;<span class="selector-tag">Input</span> Mono&quot;, &quot;PT Mono&quot;, Consolas, Monaco, Menlo, monospace</span><br><span class="line"></span><br><span class="line">// <span class="attribute">Font</span> size of articles.</span><br><span class="line">$<span class="attribute">font-size</span>-base = <span class="number">16px</span></span><br><span class="line"></span><br><span class="line">// <span class="attribute">Font</span> size of <span class="selector-tag">table</span> and <span class="selector-tag">code</span>.</span><br><span class="line">$<span class="selector-tag">table</span>-<span class="attribute">font-size</span> = <span class="number">15px</span></span><br></pre></td></tr></table></figure><br>(2)修改<code>主题配置</code>文件<code>_config.next.yml</code>,修改内容如下:<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="comment">#head: source/_data/head.njk</span></span><br><span class="line">  <span class="comment">#header: source/_data/header.njk</span></span><br><span class="line">  <span class="comment">#sidebar: source/_data/sidebar.njk</span></span><br><span class="line">  <span class="comment">#postMeta: source/_data/post-meta.njk</span></span><br><span class="line">  <span class="comment">#postBodyEnd: source/_data/post-body-end.njk</span></span><br><span class="line">  <span class="comment">#footer: source/_data/footer.njk</span></span><br><span class="line">  <span class="comment">#bodyEnd: source/_data/body-end.njk</span></span><br><span class="line">  <span class="attr">variable:</span> <span class="string">source/_data/variables.styl</span></span><br></pre></td></tr></table></figure></p>
<h1 id="八、提交到github"><a href="#八、提交到github" class="headerlink" title="八、提交到github"></a>八、提交到<code>github</code></h1><p>安装支持：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --safe</span><br></pre></td></tr></table></figure><br>修改<code>站点目录</code>下<code>_config.yml</code>配置：<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span> </span><br><span class="line">  <span class="attr">repo:</span> <span class="string">&#x27;https://github.com/用户名/你设置的用户名.github.io.git&#x27;</span></span><br></pre></td></tr></table></figure><br>提交命令：<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo hexo generate <span class="comment"># hexo g</span></span><br><span class="line">sudo hexo deploy   <span class="comment"># hexo d</span></span><br></pre></td></tr></table></figure></p>
<p>至此，站点基本配置就完成了。  </p>
<p>若报错：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fatal: unsafe repository (<span class="string">&#x27;xxx/xxx/.deploy_git&#x27;</span> is owned by someone <span class="keyword">else</span>)</span><br></pre></td></tr></table></figure><br>解决方法<br>忽略单个目录<br>哪个目录里有<code>git</code>，就通过命令行添加哪个目录，多个目录，多次添加。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global --add safe.directory D:/www/your-project</span><br><span class="line">git config --global --add safe.directory D:/www/other-project</span><br></pre></td></tr></table></figure><br>或者忽略全部目录：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global --add safe.directory <span class="string">&quot;*&quot;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="九、npm升级命令"><a href="#九、npm升级命令" class="headerlink" title="九、npm升级命令"></a>九、<code>npm</code>升级命令</h1><h2 id="1、升级前备份配置"><a href="#1、升级前备份配置" class="headerlink" title="1、升级前备份配置"></a>1、升级前备份配置</h2><p><em>*</em>注意以下命令是基于<code>powershell</code>在<code>网站根目录</code>运行</p>
<h3 id="（1）个人CSS配置文件"><a href="#（1）个人CSS配置文件" class="headerlink" title="（1）个人CSS配置文件"></a>（1）个人CSS配置文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建备份目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/next/source/css/_common/scaffolding</span><br><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/next/source/css/_custom</span><br><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/next/source/js</span><br><span class="line"><span class="comment"># 备份 注意参数-Recurse&gt;递归 -Force&gt;强制覆盖</span></span><br><span class="line">Copy-Item themes/next/source/css/_common/scaffolding/base.styl -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/source/css/_common/scaffolding/ -Force</span><br><span class="line">Copy-Item themes/next/source/css/_custom/darkmode.styl -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/source/css/_custom/ -Force</span><br><span class="line">Copy-Item themes/next/source/css/main.styl -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/source/css/ -Force</span><br><span class="line">Copy-Item themes/next/source/js/tw_cn.js -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/source/js/ -Force</span><br></pre></td></tr></table></figure>
<h3 id="（2）个人布局配置文件"><a href="#（2）个人布局配置文件" class="headerlink" title="（2）个人布局配置文件"></a>（2）个人布局配置文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/next/layout/_macro</span><br><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/next/layout/_partials</span><br><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/next/layout/_scripts</span><br><span class="line">Copy-Item themes/next/layout/_macro/sidebar.njk -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/layout/_macro -Force</span><br><span class="line">Copy-Item themes/next/layout/_partials/footer.njk -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/layout/_partials -Force</span><br><span class="line">Copy-Item themes/next/layout/_scripts/vendors.njk -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/layout/_scripts -Force</span><br><span class="line">Copy-Item themes/next/layout/_layout.njk -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/layout -Force</span><br></pre></td></tr></table></figure>
<h3 id="（3）改过的模块配置"><a href="#（3）改过的模块配置" class="headerlink" title="（3）改过的模块配置"></a>（3）改过的模块配置</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/node_modules/hexo-renderer-kramed/lib</span><br><span class="line"><span class="built_in">cp</span> node_modules/hexo-renderer-kramed/lib/* -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/node_modules/hexo-renderer-kramed/lib -Force</span><br><span class="line"><span class="built_in">mkdir</span> -p ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/node_modules/kramed/lib/rules</span><br><span class="line"><span class="built_in">cp</span> node_modules/kramed/lib/rules/* -Recurse ../gitBlogBck/bck/$(Get-Date -Format <span class="string">&#x27;yyyyMMdd&#x27;</span>)/node_modules/kramed/lib/rules -Force</span><br></pre></td></tr></table></figure>
<h2 id="2、hexo相关升级"><a href="#2、hexo相关升级" class="headerlink" title="2、hexo相关升级"></a>2、<code>hexo</code>相关升级</h2><p><strong>注意修改<code>package.json</code>中版本号</strong></p>
<h3 id="（1）升级nodejs"><a href="#（1）升级nodejs" class="headerlink" title="（1）升级nodejs"></a>（1）升级<code>nodejs</code></h3><p>进入博客的<code>根目录</code>，使用<code>nvm</code>查询最新版本<code>node</code>,下载最新版本，并启用该版本<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvm list available</span><br><span class="line">nvm install lts 64</span><br><span class="line">nvm use 18.12.1</span><br><span class="line">Now using node v18.12.1 (64-bit)</span><br></pre></td></tr></table></figure></p>
<h3 id="（2）Hexo-版本升级"><a href="#（2）Hexo-版本升级" class="headerlink" title="（2）Hexo 版本升级"></a>（2）<code>Hexo</code> 版本升级</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">########### 以下为全局升级 ###########</span></span><br><span class="line"><span class="comment"># 全局安装版本检测、版本升级工具</span></span><br><span class="line">npm install npm-check npm-upgrade -g</span><br><span class="line"><span class="comment"># 全局检测哪些模块可以升级，这里可以根据打印的提示信息，手动安装最新版本的模块</span></span><br><span class="line">npm-check -g</span><br><span class="line"><span class="comment"># 全局更新模块</span></span><br><span class="line">npm update -g --save</span><br><span class="line"></span><br><span class="line"><span class="comment">##########  博客升级hexo  ##########</span></span><br><span class="line"><span class="comment"># 全局安装或更新Hexo的最新版本</span></span><br><span class="line">npm install hexo --global</span><br><span class="line">npm install -g hexo-cli</span><br><span class="line">added 59 packages, and audited 61 packages <span class="keyword">in</span> 36s</span><br><span class="line">found 0 vulnerabilities</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line"><span class="comment"># 进入博客的根目录</span></span><br><span class="line">~$ <span class="built_in">cd</span> /博客根目录</span><br><span class="line"><span class="comment"># 检测Hexo哪些模块可以升级(依赖库)</span></span><br><span class="line">~$ npm-check</span><br><span class="line"><span class="comment"># 更新全部库</span></span><br><span class="line">~$ npm-check -u</span><br><span class="line"><span class="comment"># 删除package-lock.json</span></span><br><span class="line">~<span class="comment"># rm -rf package-lock.json</span></span><br><span class="line"><span class="comment"># 更新package.json</span></span><br><span class="line">~$ npm-upgrade</span><br><span class="line"><span class="comment"># 删除整个模块目录，这样可以避免很多坑</span></span><br><span class="line">~$ <span class="built_in">rm</span> -rf node_modules</span><br><span class="line"><span class="comment"># 更新全局包</span></span><br><span class="line">~$ npm update &lt;name&gt; -g</span><br><span class="line"><span class="comment"># 更新Hexo的模块（生产环境）</span></span><br><span class="line">~$ npm update --save</span><br><span class="line"><span class="comment"># 若出现依赖的问题，用以下命令统一修复一下</span></span><br><span class="line">$ npm audix</span><br><span class="line"><span class="comment"># 或者强制更新</span></span><br><span class="line">$ npm update --save --force</span><br><span class="line"><span class="comment"># 若出现依赖的问题，用以下命令统一修复一下</span></span><br><span class="line">$ npm audix</span><br><span class="line"><span class="comment"># 或者强制更新</span></span><br><span class="line">$ npm update --save --force</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="（3）next主题升级"><a href="#（3）next主题升级" class="headerlink" title="（3）next主题升级"></a>（3）<code>next</code>主题升级</h3><p><code>NexT</code> 每个月都会发布新版本。请在更新前阅读更新说明。你可以通过如下命令更新 <code>NexT</code>。<br>通过 <code>npm</code> 安装最新版本：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> 站点根目录</span><br><span class="line">$ npm install hexo-theme-next@latest</span><br></pre></td></tr></table></figure><br>或者通过 git 更新到最新的 master 分支：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> themes/next</span><br><span class="line">$ git pull</span><br></pre></td></tr></table></figure><br>升级后查询结果：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo -V</span><br><span class="line">INFO  Validating config</span><br><span class="line">INFO  ==================================</span><br><span class="line">  ███╗   ██╗███████╗██╗  ██╗████████╗</span><br><span class="line">  ████╗  ██║██╔════╝╚██╗██╔╝╚══██╔══╝</span><br><span class="line">  ██╔██╗ ██║█████╗   ╚███╔╝    ██║</span><br><span class="line">  ██║╚██╗██║██╔══╝   ██╔██╗    ██║</span><br><span class="line">  ██║ ╚████║███████╗██╔╝ ██╗   ██║</span><br><span class="line">  ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝   ╚═╝</span><br><span class="line">========================================</span><br><span class="line">NexT version 8.13.2</span><br><span class="line">Documentation: https://theme-next.js.org</span><br><span class="line">========================================</span><br><span class="line">hexo: 6.3.0</span><br><span class="line">hexo-cli: 4.3.0</span><br><span class="line">os: win32 10.0.19045</span><br><span class="line">node: 18.12.1</span><br><span class="line">v8: 10.2.154.15-node.12</span><br><span class="line">uv: 1.43.0</span><br><span class="line">zlib: 1.2.11</span><br><span class="line">ares: 1.18.1</span><br><span class="line">modules: 108</span><br><span class="line">nghttp2: 1.47.0</span><br><span class="line">napi: 8</span><br><span class="line">llhttp: 6.0.10</span><br><span class="line">openssl: 3.0.7+quic</span><br><span class="line">cldr: 41.0</span><br><span class="line">icu: 71.1</span><br><span class="line">tz: 2022b</span><br><span class="line">unicode: 14.0</span><br><span class="line">ngtcp2: 0.8.1</span><br><span class="line">nghttp3: 0.7.0</span><br></pre></td></tr></table></figure></p>
<h3 id="（3）恢复备份文件"><a href="#（3）恢复备份文件" class="headerlink" title="（3）恢复备份文件"></a>（3）恢复备份文件</h3><p>批处理去恢复，将以下命令命名为<code>恢复备份文件.bat</code><br><figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\source\css\_common\scaffolding\base.styl themes\next\source\css\_common\scaffolding\base.styl /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\source\css\_custom\darkmode.styl  themes\next\source\css\_custom\ /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\source\css\main.styl themes\next\source\css\ /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\source\js\tw_cn.js themes\next\source\js\ /y</span><br><span class="line"></span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\layout\_macro\sidebar.njk themes\next\layout\_macro\ /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\layout\_partials\footer.njk themes\next\layout\_partials\ /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\layout\_scripts\vendors.njk themes\next\layout\_scripts\ /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\themes\next\layout\_layout.njk themes\next\layout\ /y</span><br><span class="line"></span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\node_modules\hexo-renderer-kramed\lib\renderer.js  node_modules\hexo-renderer-kramed\lib\ /y</span><br><span class="line"><span class="built_in">copy</span> ..\gitBlogBck\bck\<span class="number">20221105</span>\node_modules\kramed\lib\rules\inline.js node_modules\kramed\lib\rules\ /y</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure><br>或用<code>powershell</code>处理,将以下命令命名为<code>恢复备份文件.ps1</code><br><figure class="highlight ps1"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Copy-Item</span> <span class="string">&quot;../gitBlogBck/bck/<span class="variable">$</span>(Get-Date -Format &#x27;yyyyMMdd&#x27;)/themes/next/source/css/_common/scaffolding/base.styl&quot;</span>  <span class="literal">-Recurse</span> <span class="string">&quot;themes/next/source/css/_common/scaffolding/base.styl&quot;</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Copy-Item</span> <span class="string">&quot;../gitBlogBck/bck/<span class="variable">$</span>(Get-Date -Format &#x27;yyyyMMdd&#x27;)/themes/next/source/css/_custom/darkmode.styl&quot;</span>  <span class="literal">-Recurse</span> <span class="string">&quot;themes/next/source/css/_custom/&quot;</span>  <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Copy-Item</span> ../gitBlogBck/bck/<span class="variable">$</span>(<span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/source/css/main.styl <span class="literal">-Recurse</span> themes/next/source/css/ <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Copy-Item</span> ../gitBlogBck/bck/<span class="variable">$</span>(<span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&#x27;yyyyMMdd&#x27;</span>)/themes/next/source/js/tw_cn.js <span class="literal">-Recurse</span> themes/next/source/js/ <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Copy-Item</span> <span class="string">&quot;../gitBlogBck/bck/<span class="variable">$</span>(Get-Date -Format &#x27;yyyyMMdd&#x27;)/themes/next/layout/_macro/sidebar.njk&quot;</span> <span class="literal">-Recurse</span> <span class="string">&quot;themes/next/layout/_macro/&quot;</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Copy-Item</span> <span class="string">&quot;../gitBlogBck/bck/<span class="variable">$</span>(Get-Date -Format &#x27;yyyyMMdd&#x27;)/themes/next/layout/_partials/footer.njk&quot;</span> <span class="literal">-Recurse</span> <span class="string">&quot;themes/next/layout/_partials/&quot;</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Copy-Item</span> <span class="string">&quot;../gitBlogBck/bck/<span class="variable">$</span>(Get-Date -Format &#x27;yyyyMMdd&#x27;)/themes/next/layout/_scripts/vendors.njk&quot;</span> <span class="literal">-Recurse</span> <span class="string">&quot;themes/next/layout/_scripts/&quot;</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Copy-Item</span> <span class="string">&quot;../gitBlogBck/bck/<span class="variable">$</span>(Get-Date -Format &#x27;yyyyMMdd&#x27;)/themes/next/layout/_layout.njk&quot;</span> <span class="literal">-Recurse</span> themes/next/layout/ <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> ../gitBlogBck/bck/<span class="variable">$</span>(<span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&#x27;yyyyMMdd&#x27;</span>)/node_modules/hexo<span class="literal">-renderer-kramed</span>/lib/renderer.js <span class="literal">-Recurse</span>  node_modules/hexo<span class="literal">-renderer-kramed</span>/lib/ <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">cp</span>  ../gitBlogBck/bck/<span class="variable">$</span>(<span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&#x27;yyyyMMdd&#x27;</span>)/node_modules/kramed/lib/rules/inline.js <span class="literal">-Recurse</span> node_modules/kramed/lib/rules/  <span class="literal">-Force</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3、升级后出现错误处理"><a href="#3、升级后出现错误处理" class="headerlink" title="3、升级后出现错误处理"></a>3、升级后出现错误处理</h2><p>升级后再输入<code>npm</code>命令时，出现如下错误：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm : File D:\Programs\nodejs\npm.ps1 cannot be loaded because running scripts is disabled on this system.</span><br></pre></td></tr></table></figure><br>解决:<br>管理员运行<code>Powershell</code>然后输入:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</span><br></pre></td></tr></table></figure><br>其他一些错误处理可参考见<a href="../../../../2020/12/19/在Debian10上配置Hexo+Github做个人博客/#div1">在Debian10上配置Hexo+Github做个人博客</a></p>
<p>一些参考：</p>
<p>1、<a href="https://theme-next.js.org/docs/getting-started/">官网theme-next.js.org</a>  </p>
<p>2、<a href="https://github.com/next-theme/hexo-theme-next/issues/4">【必读】更新说明及常见问题
</a></p>
<p>3、<a href="https://www.techgrow.cn/posts/ae18fb85.html#Hexo-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E9%80%89%E6%8B%A9">Hexo 评论系统选择</a></p>
]]></content>
      <categories>
        <category>软件应用</category>
        <category>Windows</category>
        <category>Hexo</category>
        <category>Next主题</category>
      </categories>
      <tags>
        <tag>Windows10</tag>
        <tag>Hexo</tag>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>文件管理器因gvfs不能浏览网络等问题</title>
    <url>/2021/01/05/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%99%A8%E5%9B%A0gvfs%E4%B8%8D%E8%83%BD%E6%B5%8F%E8%A7%88%E7%BD%91%E7%BB%9C%E7%AD%89%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在<code>Thunar文件管理器</code>—&gt;<code>编辑</code>—&gt;<code>首选项</code>—&gt;<code>高级选项</code>中，提示：<br><code>文件管理器因gvfs缺失不能浏览网络......</code>，解决方法是把gvfs重新安装一遍修复缺失。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install gvfs gvfs-backends gvfs-fuse</span><br></pre></td></tr></table></figure><br>最后，注销用户，重新登录。<br>再次打开<code>thunar文件管理器</code>，左侧可看到<code>浏览网络</code>图标，点击后可以看到局域网共享设备。</p>
]]></content>
      <categories>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Debian</tag>
        <tag>Gvfs</tag>
      </tags>
  </entry>
  <entry>
    <title>最小二乘法的算术推导</title>
    <url>/2020/12/25/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95%E7%9A%84%E7%AE%97%E6%9C%AF%E6%8E%A8%E5%AF%BC/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="\pic\2020\12\最小二乘法的算术推导.png" alt="最小二乘法的算术推导"></p>
<p>$\hat y=a+bx$</p>
<p>$\begin{aligned} Q&amp;=\displaystyle \sum^n_{i=1}{(y_i-\hat y)^2}\\\<br>&amp;={(y_1-\hat y_1)^2}+{(y_2-\hat y_2)^2}+ \cdots +{(y_n-\hat y_n)^2} \end{aligned}$</p>
<p>其中$\hat y$为回归方程，求$Q$最小时回归方程的系数a，b取值。</p>
<h2 id="具体推导如下："><a href="#具体推导如下：" class="headerlink" title="具体推导如下："></a>具体推导如下：</h2><h2 id="一、预备公式"><a href="#一、预备公式" class="headerlink" title="一、预备公式"></a><strong>一、预备公式</strong></h2><h3 id="1-gt"><a href="#1-gt" class="headerlink" title="1&gt;"></a>1&gt;</h3><p>$\displaystyle \sum^n_{i=1}{(x_i-{\bar x})^2}=\displaystyle \sum^n_{i=1}{x_i^2-n{\bar x}^2}$,</p>
<p>其中:$\bar x=\frac {x_1+x_2+\cdots +x_n}{n}$</p>
<h5 id="推导"><a href="#推导" class="headerlink" title="推导:"></a><strong>推导:</strong></h5><p>$\begin{aligned} 左边&amp;={(x_1-\bar x_1)^2}+{(x_2-\bar x_2)^2}+ \cdots +{(x_n-\bar x_n)^2}\\\<br>&amp;=x_1^2+x_2^2+ \cdots +x_n^2-2\bar x·(x_1+x_2+ \cdots +x_n)+n\bar x^2\\\<br>&amp;=\displaystyle \sum^n_{i=1}{x_i^2}-2\bar x·n·\bar x + n·\bar x^2\\\<br>&amp;=\displaystyle\sum^n_{i=1}{x_i^2-n\bar x^2}=右边 \end{aligned}$</p>
<h3 id="2-gt"><a href="#2-gt" class="headerlink" title="2&gt;"></a>2&gt;</h3><p>$\displaystyle\sum^n_{i=1}{(x_i-\bar x)}{(y_i-\bar y)}=\displaystyle \sum^n_{i=1}{x_i}{y_i}-n\bar x\bar y$，</p>
<p>其中:$\bar x=\frac {x_1+x_2+\cdots+x_n}{n},\bar y=\frac{y_1+y_2+\cdots + y_n}{n}$</p>
<h5 id="推导："><a href="#推导：" class="headerlink" title="推导："></a><strong>推导：</strong></h5><p>$\begin{aligned} 左边&amp;={(x_1-\bar x_1)}{(y_1-\bar y_1)}+{(x_2-\bar x_2)}{(y_2-\bar y_2)}+ \cdots +{(x_n-\bar x_n)}{(y_n-\bar y_n)}\\\<br>&amp;=(x_1y_1+x_2y_2+\cdots+x_n·y_n)+n\bar x·\bar y-(y_1+y_2+\cdots+y_n)·\bar x-(x_1+x_2+\cdots+x_n)·\bar y\\\<br>&amp;=\displaystyle\sum^ n_{i=1}{x_i}{y_i}+n\bar x·\bar y-n\bar y·\bar x-n\bar x\bar y\\\<br>&amp;=\displaystyle\sum^n_{i=1}{x_i}{y_i}-n\bar x\bar y=右边 \end{aligned}$</p>
<h2 id="二、推导过程"><a href="#二、推导过程" class="headerlink" title="二、推导过程"></a><strong>二、推导过程</strong></h2><p>$\begin{aligned} Q &amp;=\displaystyle \sum^n_{i=1}{(y_i-\hat y)^2}\\\<br>&amp;=\displaystyle \sum^n_{i=1}{[y_i-(a+bx_i)]}^2\\\<br>&amp;=(y_1^2+y_2^2+ \cdots +y_n^2)+na^2+b^2(x_1^2 + x_2^2 + \cdots +x_n^2)+2a·b·(x_1+x_2+\cdots+x_n)-2a·(y_1+y_2+\cdots +y_n)-2b(x_1·y_1+x_2·y_2+\cdots +x_n·y_n)\\\<br>&amp;=\displaystyle \sum^n_{i=1}y_i^2+na^2+b^2·\displaystyle \sum^n_{i=1}x_i^2+2ab·n·\bar x-2a·n·\bar y-2b·\displaystyle \sum^n_{i=1}x_iy_i\\\<br>&amp;=\displaystyle \sum^n_{i=1}y_i^2-2b\displaystyle \sum^n_{i=1}x_iy_i+b^2·\displaystyle \sum^n_{i=1}x_i^2+na^2-n·2a·(\bar y-b\bar x)\\\<br>&amp;=\displaystyle \sum^n_{i=1}y_i^2-2b\displaystyle \sum^n_{i=1}x_iy_i+b^2·\displaystyle \sum^n_{i=1}x_i^2+n[a-(\bar y-b\bar x)]^2-n[(\bar y-b\bar x)]^2\\\<br>&amp;=n[(\bar y-b\bar x)]^2-n\bar y^2+2n·b·\bar x·\bar y-n·b^2·\bar x^2+b^2·\displaystyle \sum^n_{i=1}x_i^2-2b·\displaystyle \sum^n_{i=1}x_iy_i+\displaystyle \sum^n_{i=1}y_i^2\\\<br>&amp;=n[(\bar y-b\bar x)]^2+b^2(\displaystyle \sum^n_{i=1}x_i^2-n·\bar x^2)+\displaystyle \sum^n_{i=1}y_i^2-n·\bar y^2-2b·(\displaystyle \sum^n_{i=1}x_iy_i-n·\bar x·\bar y)\\\<br>&amp;=n[a-(\bar y-b\bar x)]^2+b^2{\displaystyle \sum^n_{i=1}(x_i-\bar x)^2}-2b·\displaystyle \sum^n_{i=1}{(x_i-\bar x)(y_i-\bar y)}+\displaystyle \sum^n_{i=1}y_i^2-n·\bar y^2\\\<br>&amp;=n[a-(\bar y-b\bar x)]^2+{\displaystyle \sum^n_{i=1}(x_i-\bar x)^2}·\left [b^2-2b·\frac {\displaystyle \sum^n_{i=1}(x_i-\bar x)(y_i-\bar y)}{\displaystyle \sum^n_{i=1}{(x_i-\bar x)^2}}\right ] +\displaystyle \sum^n_{i=1}y_i-n·\bar y^2\\\<br>&amp;=n[a-(\bar y-b\bar x)]^2+{\displaystyle \sum^n_{i=1}(x_i-\bar x)^2}·\left [b-\frac {\displaystyle \sum^n_{i=1}(x_i-\bar x)(y_i-\bar y)}{\displaystyle \sum^n_{i=1}{(x_i-\bar x)^2}}\right ]^2-\frac {\left [{\displaystyle \sum^n_{i=1}}(x_i-{\bar x})(y_i-\bar y)\right ]^2}{\displaystyle \sum^n_{i=1}{(x_i-\bar x)^2}}+ \displaystyle \sum^n_{i=1}y_i-n·\bar y^2 \end{aligned}$<br>因为：</p>
<p>$\displaystyle \sum^n_{i=1}(x_i-\bar x)^2$</p>
<p>和</p>
<p>$\frac {[\displaystyle \sum^n_{i=1}(x_i-\bar x)(y_i-\bar y)]^2}{\displaystyle \sum^n_{i=1}(x_i-\bar x)^2}$</p>
<p>及</p>
<p>$\displaystyle \sum^n_{i=1}y_i-n·\bar y^2$</p>
<p>为常数。</p>
<p>所以:</p>
<p>$Q_{min}=<br>\begin{cases}<br>a-(\bar y-b\bar x)=0\\\<br>b-\frac {\displaystyle \sum^n_{i=1}(x_i-\bar x)(y_i-\bar y)}{\displaystyle \sum^n_{i=1}(x_i-\bar x)^2}=0<br>\end{cases}<br>\Longrightarrow \begin{cases} a=\bar y-b\bar x\\\<br>b=\frac {\displaystyle \sum^n_{i=1}(x_iy_i-n·\bar x\bar y)}{\displaystyle \sum^n_{i=1}x_i^2-n·\bar x^2}<br>\end{cases}<br>$</p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Markdown</category>
        <category>学科教育</category>
        <category>Math</category>
      </categories>
      <tags>
        <tag>Math</tag>
        <tag>Mathjax</tag>
        <tag>Latex</tag>
        <tag>Statistics</tag>
      </tags>
  </entry>
  <entry>
    <title>申请免费的MongoDB云数据库</title>
    <url>/2021/12/08/%E7%94%B3%E8%AF%B7%E5%85%8D%E8%B4%B9%E7%9A%84MongoDB%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、注册登录"><a href="#1、注册登录" class="headerlink" title="1、注册登录"></a>1、注册登录</h1><p>打开<a href="https://cloud.mongodb.com">mongodb官网</a>并注册登录，免费的MongoDB云数据库有512MB大小。</p>
<h1 id="2、选择并配置"><a href="#2、选择并配置" class="headerlink" title="2、选择并配置"></a>2、选择并配置</h1><p>在项目页面点击<code>Create a New Cluster</code>按钮<br>如图：<br><img src="/pic/2021/12/MongoDB/MongoDB-1.jpg" alt="MongoDB-1"></p>
<p>可参照下图进行配置，如下列图示：<br><img src="/pic/2021/12/MongoDB/MongoDB-2.jpg" alt="MongoDB-2"><br><code>MongoDB</code>提供三种云存储方案，分别如下：<br><code>亚马逊</code><br><img src="/pic/2021/12/MongoDB/MongoDB-2-1.jpg" alt="MongoDB-2-1"><br><code>谷歌</code><br><img src="/pic/2021/12/MongoDB/MongoDB-2-2.jpg" alt="MongoDB-2-2"><br><code>微软</code><br><img src="/pic/2021/12/MongoDB/MongoDB-2-3.jpg" alt="MongoDB-2-3"><br>根据实际情况自己选择（本例选择<code>Google--&gt;taiwan</code>）</p>
<p>点击<code>Create Cluster</code>即可.</p>
<h1 id="3、设置数据库账号和密码"><a href="#3、设置数据库账号和密码" class="headerlink" title="3、设置数据库账号和密码"></a>3、设置<code>数据库账号</code>和<code>密码</code></h1><p>如下图：<br><img src="/pic/2021/12/MongoDB/MongoDB-2-4.jpg" alt="MongoDB-2-4"></p>
<p>也可选选择<code>Certificate</code>，具体可参照提示执行。带证书的操作方式可参照[<code>Python</code>连接操作]中的<a href="#solve">问题解决</a>。</p>
<h1 id="4、设置进行登录数据库操作的IP地址"><a href="#4、设置进行登录数据库操作的IP地址" class="headerlink" title="4、设置进行登录数据库操作的IP地址"></a>4、设置进行登录数据库操作的<code>IP地址</code></h1><p>点击红框所示，会自动添加本机<code>ip地址</code><br><img src="/pic/2021/12/MongoDB/MongoDB-2-5.jpg" alt="MongoDB-2-5"><br>若要设置任意<code>IP</code>可登录操作可设置为<code>0.0.0.0/0</code>,<code>Description</code>根据所好随便填写。<br><img src="/pic/2021/12/MongoDB/MongoDB-2-5-1.jpg" alt="MongoDB-2-5-1"></p>
<h1 id="5、后续操作数据库"><a href="#5、后续操作数据库" class="headerlink" title="5、后续操作数据库"></a>5、后续操作数据库</h1><p>配置完成后，点击项目页面左侧的<code>Databases</code>，会出现配置上线的数据库。<br>可以点击右边<code>Connect</code>，根据提示选择相应的连接数据库方式。<br><img src="/pic/2021/12/MongoDB/MongoDB-2-6.jpg" alt="MongoDB-2-6"><br>比如<code>mongosh</code>：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mongosh <span class="string">&quot;mongodb+srv://主机地址/数据库名&quot;</span> --username 你的数据库用户名</span><br></pre></td></tr></table></figure><br><img src="/pic/2021/12/MongoDB/MongoDB-2-7.jpg" alt="MongoDB-2-7"></p>
<p>各种方式连接如下列图：</p>
<h2 id="1-Mongosh在win10上连接和操作"><a href="#1-Mongosh在win10上连接和操作" class="headerlink" title="(1)Mongosh在win10上连接和操作"></a>(1)<code>Mongosh</code>在<code>win10</code>上连接和操作</h2><h3 id="①登录、插入、查询"><a href="#①登录、插入、查询" class="headerlink" title="①登录、插入、查询"></a>①登录、插入、查询</h3><p><img src="/pic/2021/12/MongoDB/MongoDB-mongosh.jpg" alt="MongoDB-mongosh"></p>
<h3 id="②登录、查询"><a href="#②登录、查询" class="headerlink" title="②登录、查询"></a>②登录、查询</h3><p><img src="/pic/2021/12/MongoDB/MongoDB-mongosh-1.jpg" alt="MongoDB-mongosh-1"></p>
<h2 id="2-Mongosh在Debian11上连接和操作参数"><a href="#2-Mongosh在Debian11上连接和操作参数" class="headerlink" title="(2)Mongosh在Debian11上连接和操作参数"></a>(2)<code>Mongosh</code>在<code>Debian11</code>上连接和操作参数</h2><p>按<code>win10</code>系统的参数连接会报错：<code>pymongo.errors.ConfigurationError:The DNS operation timed out after XXXXX</code><br>解决参考方法如下【选择<code>pymongo</code>低版本连接参数】：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装 mongosh</span></span><br><span class="line">wget -qO mongodb-mongosh.deb https://downloads.mongodb.com/compass/mongodb-mongosh_1.1.6_amd64.deb</span><br><span class="line">sudo dpkg -i mongodb-mongosh.deb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录</span></span><br><span class="line"></span><br><span class="line">$ mongosh <span class="string">&#x27;mongodb://主机00.mongodb.net:27017,主机01.mongodb.net:27017,主机02.mongodb.net:27017/数据库名称?ssl=true&amp;replicaSet=atlas-hkayl1-shard-0&amp;authSource=admin&amp;retryWrites=true&amp;w=majority&#x27;</span> --username 数据库用户名</span><br><span class="line">Enter password: *********</span><br><span class="line">Current Mongosh Log ID: XXXXXX</span><br><span class="line">Connecting to:   mongodb://主机00.mongodb.net:27017,主机01.mongodb.net:27017,主机02.mongodb.net:27017/数据库名称?ssl=<span class="literal">true</span>&amp;replicaSet=atlas-hkayl1-shard-0&amp;authSource=admin&amp;retryWrites=<span class="literal">true</span>&amp;w=majority</span><br><span class="line">Using MongoDB:      4.4.10</span><br><span class="line">Using Mongosh:      1.1.6</span><br></pre></td></tr></table></figure></p>
<h3 id="③修改"><a href="#③修改" class="headerlink" title="③修改"></a>③修改</h3><p>命令如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; db.test.find()</span><br><span class="line">[</span><br><span class="line">  &#123; _id: 0, name: <span class="string">&#x27;zs&#x27;</span>, age: 39, high: 172 &#125;,</span><br><span class="line">  &#123; _id: 2, name: <span class="string">&#x27;ww&#x27;</span>, age: 32, high: 172 &#125;,</span><br><span class="line">  &#123; _id: 1, name: <span class="string">&#x27;ls&#x27;</span>, age: 29, high: 175 &#125;,</span><br><span class="line">  &#123; _id: 3, name: <span class="string">&#x27;赵六&#x27;</span>, age: 39, high: 175 &#125;,</span><br><span class="line">  &#123; _id: 5, name: <span class="string">&#x27;孙八&#x27;</span>, age: 19, high: 165 &#125;,</span><br><span class="line">  &#123; _id: 6, name: <span class="string">&#x27;周公&#x27;</span>, age: 38, high: 172 &#125;,</span><br><span class="line">  &#123; _id: 4, name: <span class="string">&#x27;钱七&#x27;</span>, age: 39, high: 172 &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _id: 7,</span><br><span class="line">    name: <span class="string">&#x27;吴七&#x27;</span>,</span><br><span class="line">    age: 38,</span><br><span class="line">    high: 178,</span><br><span class="line">    comment: <span class="string">&#x27;更新于身高高于175的一条记录&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&quot;61b80df04e8e73c1813dada4&quot;</span>),</span><br><span class="line">    name: <span class="string">&#x27;重八&#x27;</span>,</span><br><span class="line">    age: 29,</span><br><span class="line">    high: 176</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&quot;61b80e014e8e73c1813dada5&quot;</span>),</span><br><span class="line">    name: <span class="string">&#x27;老九&#x27;</span>,</span><br><span class="line">    age: 32,</span><br><span class="line">    high: 169</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">&gt; db.test.updateOne(&#123;_id:ObjectId(<span class="string">&quot;61b80e014e8e73c1813dada5&quot;</span>)&#125;,&#123;<span class="variable">$set</span>:&#123;high:168&#125;&#125;)</span><br><span class="line">&#123;</span><br><span class="line">  acknowledged: <span class="literal">true</span>,</span><br><span class="line">  insertedId: null,</span><br><span class="line">  matchedCount: 1,</span><br><span class="line">  modifiedCount: 1,</span><br><span class="line">  upsertedCount: 0</span><br><span class="line">&#125;</span><br><span class="line">&gt; db.test.find()</span><br><span class="line">[</span><br><span class="line">  &#123; _id: 0, name: <span class="string">&#x27;zs&#x27;</span>, age: 39, high: 172 &#125;,</span><br><span class="line">  &#123; _id: 2, name: <span class="string">&#x27;ww&#x27;</span>, age: 32, high: 172 &#125;,</span><br><span class="line">  &#123; _id: 1, name: <span class="string">&#x27;ls&#x27;</span>, age: 29, high: 175 &#125;,</span><br><span class="line">  &#123; _id: 3, name: <span class="string">&#x27;赵六&#x27;</span>, age: 39, high: 175 &#125;,</span><br><span class="line">  &#123; _id: 5, name: <span class="string">&#x27;孙八&#x27;</span>, age: 19, high: 165 &#125;,</span><br><span class="line">  &#123; _id: 6, name: <span class="string">&#x27;周公&#x27;</span>, age: 38, high: 172 &#125;,</span><br><span class="line">  &#123; _id: 4, name: <span class="string">&#x27;钱七&#x27;</span>, age: 39, high: 172 &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _id: 7,</span><br><span class="line">    name: <span class="string">&#x27;吴七&#x27;</span>,</span><br><span class="line">    age: 38,</span><br><span class="line">    high: 178,</span><br><span class="line">    comment: <span class="string">&#x27;更新于身高高于175的一条记录&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&quot;61b80df04e8e73c1813dada4&quot;</span>),</span><br><span class="line">    name: <span class="string">&#x27;重八&#x27;</span>,</span><br><span class="line">    age: 29,</span><br><span class="line">    high: 176</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&quot;61b80e014e8e73c1813dada5&quot;</span>),</span><br><span class="line">    name: <span class="string">&#x27;老九&#x27;</span>,</span><br><span class="line">    age: 32,</span><br><span class="line">    high: 168</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h2 id="2-应用连接操作"><a href="#2-应用连接操作" class="headerlink" title="(2)应用连接操作"></a>(2)应用连接操作</h2><h3 id="Python连接在window10上操作"><a href="#Python连接在window10上操作" class="headerlink" title="Python连接在window10上操作"></a><code>Python</code>连接在<code>window10</code>上操作</h3><p><del>(但是实际测试不成功，一直报错)待解决。</del>  <font color='red'>已经解决</font>，参照：<a href="#solve">解决方式</a></p>
<p><img src="/pic/2021/12/MongoDB/MongoDB-python.jpg" alt="MongoDB-python"><br><strong>以下<code>python</code>连接参数版本针对<code>python3.10</code>&amp;<code>pymongo-3.12.3</code></strong> 参考：<a href="#pymongo4">问题解决</a><br>查询<code>python</code>及<code>pymongo</code>版本：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -V</span><br><span class="line">pip show pymongo</span><br></pre></td></tr></table></figure><br>版本驱动对应关系：<a href="https://docs.mongodb.com/drivers/pymongo/">MongoDB Drivers</a></p>
<h4 id="①安装模块："><a href="#①安装模块：" class="headerlink" title="①安装模块："></a>①安装模块：</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install pymongo</span><br><span class="line">python -m pip install --upgrade pip</span><br><span class="line">python -m pip install <span class="string">&quot;pymongo[srv]&quot;</span></span><br><span class="line">python -m pip install <span class="string">&quot;pymongo[tls]&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="②用python操作mongodb数据库"><a href="#②用python操作mongodb数据库" class="headerlink" title="②用python操作mongodb数据库"></a>②用<code>python</code>操作<code>mongodb</code>数据库</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"><span class="keyword">from</span> pymongo <span class="keyword">import</span> MongoClient</span><br><span class="line"><span class="comment"># import datetime</span></span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;主机地址&quot;</span></span><br><span class="line">user = <span class="string">&quot;数据库用户名&quot;</span></span><br><span class="line">passwd = <span class="string">&quot;数据库用户密码&quot;</span></span><br><span class="line">db_name = <span class="string">&quot;要操作的数据库名&quot;</span></span><br><span class="line">set_name = <span class="string">&quot;集合名&quot;</span></span><br><span class="line"></span><br><span class="line">uri = <span class="string">&#x27;mongodb+srv://&#x27;</span>+user+<span class="string">&#x27;:&#x27;</span>+passwd+<span class="string">&#x27;@&#x27;</span>+host+<span class="string">&#x27;/&#x27;</span>+db_name+<span class="string">&#x27;?retryWrites=true&amp;w=majority&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line">    client = MongoClient(uri, serverSelectionTimeoutMS=<span class="number">5000</span>)</span><br><span class="line">    <span class="built_in">print</span>(client)</span><br><span class="line">    <span class="built_in">print</span>(client.list_database_names())</span><br><span class="line">    <span class="comment"># dbs = client[&quot;要操作的数据库名&quot;]</span></span><br><span class="line">    <span class="comment"># mydbs = dbs[&quot;test&quot;]</span></span><br><span class="line">    <span class="comment"># print(&quot;集合名&quot;)</span></span><br><span class="line">    <span class="comment"># for mydb in mydbs.find():</span></span><br><span class="line">    <span class="comment">#     print(mydb)</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;连接失败：&quot;</span>,e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    client.close()</span><br></pre></td></tr></table></figure>
<p>但是报错如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">连接失败： 主机地址:27017: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)以下省略。。。</span><br></pre></td></tr></table></figure></p>
<p><a name="solve"></a></p>
<p><strong>解决方式</strong>：<br>在文件头加上<code>import certifi, ssl</code>,在连接参数里面加上<code>ssl_cert_reqs=ssl.CERT_NONE</code>,代码如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pymongo <span class="keyword">import</span> MongoClient</span><br><span class="line"><span class="comment"># import datetime</span></span><br><span class="line"><span class="keyword">import</span> certifi, ssl</span><br><span class="line"></span><br><span class="line"><span class="comment">########### </span></span><br><span class="line"><span class="comment"># 使用X.509证书连接</span></span><br><span class="line"><span class="comment">###########</span></span><br><span class="line"></span><br><span class="line">certPath = certifi.where().replace(<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;/&quot;</span>)  <span class="comment"># 查询ssl证书路径，下面参数`ssl=True`时需要验证证书路径</span></span><br><span class="line">uri = <span class="string">&quot;mongodb+srv://主机地址/数据库名?authSource=%24external&amp;authMechanism=MONGODB-X509&amp;retryWrites=true&amp;w=majority&quot;</span></span><br><span class="line"><span class="comment">## 带ssl证书参数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;------要求ssl证书验证------&quot;</span>)</span><br><span class="line">client = MongoClient(uri,</span><br><span class="line">                     ssl=<span class="literal">True</span>,</span><br><span class="line">                     ssl_ca_certs=certPath,</span><br><span class="line">                     tls=<span class="literal">True</span>,</span><br><span class="line">                     tlsCertificateKeyFile=<span class="string">r&#x27;X509-cert-路径\证书名.pem&#x27;</span>)</span><br><span class="line"><span class="comment">## 不要求验证ssl证书</span></span><br><span class="line"><span class="comment"># print(&quot;------不要求ssl证书验证------&quot;)</span></span><br><span class="line"><span class="comment"># client = MongoClient(uri,</span></span><br><span class="line"><span class="comment">#                      ssl_cert_reqs=ssl.CERT_NONE,       </span></span><br><span class="line"><span class="comment">#                      tls=True,</span></span><br><span class="line"><span class="comment">#                      tlsCertificateKeyFile=r&#x27;X509-cert-路径\证书名.pem&#x27;)</span></span><br><span class="line"></span><br><span class="line">db = client[<span class="string">&#x27;要操作的数据库名&#x27;</span>]</span><br><span class="line">collection = db[<span class="string">&#x27;要操作的数据库下的数据集&#x27;</span>]</span><br><span class="line">doc_count = collection.count_documents(&#123;&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;在该数据集下共有：&quot;</span>,doc_count,<span class="string">&quot;条数据&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">########### </span></span><br><span class="line"><span class="comment"># 使用账号和密码连接</span></span><br><span class="line"><span class="comment">###########</span></span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;主机地址&quot;</span></span><br><span class="line">user = <span class="string">&quot;数据库用户名&quot;</span></span><br><span class="line">passwd = <span class="string">&quot;数据库用户密码&quot;</span></span><br><span class="line">db_name = <span class="string">&quot;要操作的数据库名&quot;</span></span><br><span class="line">set_name = <span class="string">&quot;集合名&quot;</span></span><br><span class="line"></span><br><span class="line">uri = <span class="string">&#x27;mongodb+srv://&#x27;</span>+user+<span class="string">&#x27;:&#x27;</span>+passwd+<span class="string">&#x27;@&#x27;</span>+host+<span class="string">&#x27;/&#x27;</span>+db_name+<span class="string">&#x27;?retryWrites=true&amp;w=majority&#x27;</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">## 设置连接超时5秒</span></span><br><span class="line">    <span class="comment">## 添加ssl证书路径参数，`print(certifi.where())`可输出ssl证书路径</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;------要求ssl证书验证------&quot;</span>)</span><br><span class="line">    client = MongoClient(uri, ssl_ca_certs= certPath, serverSelectionTimeoutMS=<span class="number">5000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 不请求验证证书</span></span><br><span class="line">    <span class="comment">#print(&quot;------不要求ssl证书验证------&quot;)</span></span><br><span class="line">    <span class="comment"># client = MongoClient(uri, ssl_cert_reqs=ssl.CERT_NONE, serverSelectionTimeoutMS=5000)</span></span><br><span class="line">    <span class="comment"># print(client)</span></span><br><span class="line">    <span class="comment"># print(&quot;所存在的数据库有：&quot;, client.list_database_names())</span></span><br><span class="line">    dbs = client[<span class="string">&quot;数据库名&quot;</span>]</span><br><span class="line">    mydbs = dbs[<span class="string">&quot;数据集名&quot;</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;数据库连接成功&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> mydb <span class="keyword">in</span> mydbs.find():</span><br><span class="line">        <span class="built_in">print</span>(mydb)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;连接失败：&quot;</span>,e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    client.close()</span><br></pre></td></tr></table></figure><br>最终结果如图：<br><img src="/pic/2021/12/MongoDB/MongoDB-python-1.jpg" alt="MongoDB-python-1"></p>
<h4 id="Python连接在Debian11上操作"><a href="#Python连接在Debian11上操作" class="headerlink" title="Python连接在Debian11上操作"></a><code>Python</code>连接在<code>Debian11</code>上操作</h4><p>== python FOR debian==<br>按<code>win10</code>系统的参数连接会报错：<code>pymongo.errors.ConfigurationError:The DNS operation timed out after XXXXX</code><br>解决办法，更改驱动版本连接参数：<br><code>pymongo</code>驱动程序版本<code>3.4+</code>链接字符串【参数在<code>MongoDB网站</code>项目数据库连接选项里可查到】大体如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">uri = <span class="string">&#x27;mongodb://数据库用户名:数据库用户密码@主机00.mongodb.net:27017,主机01.mongodb.net:27017,主机02.mongodb.net:27017/数据库名称?ssl=true&amp;replicaSet=atlas-hkayl1-shard-0&amp;authSource=admin&amp;retryWrites=true&amp;w=majority&#x27;</span></span><br><span class="line"><span class="comment"># print(uri)</span></span><br></pre></td></tr></table></figure><br><a name="pymongo4"></a></p>
<h4 id="其他事项"><a href="#其他事项" class="headerlink" title="其他事项"></a>其他事项</h4><p>如果升级<code>pymongo</code>到最新4.0.1版本会提示：<code>mongoengine 0.23.1 requires pymongo&lt;4.0,&gt;=3.4, but you have pymongo 4.0.1 which is incompatible.</code><br>用<code>python</code>接数据库会提示：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">连接失败： Unknown option ssl_cert_reqs</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;XXXX.py&quot;</span>, line 79, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    client.close()</span><br><span class="line">NameError: name <span class="string">&#x27;client&#x27;</span> is not defined`</span><br></pre></td></tr></table></figure><br>将pymongo降级到3.12.3即可：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install -U pymongo==<span class="number">3.12</span><span class="number">.3</span></span><br></pre></td></tr></table></figure></p>
<h3 id="nodejs连接操作"><a href="#nodejs连接操作" class="headerlink" title="nodejs连接操作"></a><code>nodejs</code>连接操作</h3><h4 id="安装支持模块"><a href="#安装支持模块" class="headerlink" title="安装支持模块"></a>安装支持模块</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i mongodb</span><br></pre></td></tr></table></figure>
<h4 id="nodejs连接并执行查询"><a href="#nodejs连接并执行查询" class="headerlink" title="nodejs连接并执行查询"></a><code>nodejs</code>连接并执行查询</h4><p>新建<code>node-conn.js</code>文件,代码内容如下：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 连接并查询</span></span><br><span class="line"><span class="keyword">const</span> mongoclient = <span class="built_in">require</span>(<span class="string">&quot;mongodb&quot;</span>).<span class="property">MongoClient</span>;</span><br><span class="line"><span class="keyword">const</span> uri = <span class="string">&quot;mongodb+srv://数据库名:数据库用户密码@主机地址/数据库名?retryWrites=true&amp;w=majority&quot;</span>;</span><br><span class="line">mongoclient.<span class="title function_">connect</span>(url, <span class="keyword">function</span> (<span class="params">err, client</span>) &#123;</span><br><span class="line">    client.<span class="title function_">db</span>(<span class="string">&quot;blog&quot;</span>).<span class="title function_">collection</span>(<span class="string">&quot;test&quot;</span>).<span class="title function_">find</span>(&#123;&#125;).<span class="title function_">toArray</span>().<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">        result.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">value,index,arr</span>) &#123;       </span><br><span class="line">            <span class="comment">// console.log(value); //第一个参数是 遍历数组的元素，</span></span><br><span class="line">            <span class="comment">// console.log(index); // 第二个参数是 元素的位置，</span></span><br><span class="line">            <span class="comment">// console.log(arr);  // 第三个参数是 整个数组的值。</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="property">_id</span>,value.<span class="property">name</span>,value.<span class="property">age</span>,value.<span class="property">high</span>,value.<span class="property">comment</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>输入命令<code>node node-conn.js</code>执行查询，结果如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">node node-conn.js</span><br><span class="line">0 zs 39 172 undefined</span><br><span class="line">1 <span class="built_in">ls</span> 29 175 undefined</span><br><span class="line">2 ww 32 172 undefined</span><br><span class="line">3 赵六 39 175 undefined</span><br><span class="line">4 钱七 39 172 undefined</span><br><span class="line">5 孙八 19 165 undefined</span><br><span class="line">6 周公 38 172 undefined</span><br><span class="line">7 吴七 38 178 更新于身高高于175的一条记录</span><br></pre></td></tr></table></figure></p>
<h2 id="3-Navicat连接和操作"><a href="#3-Navicat连接和操作" class="headerlink" title="(3)Navicat连接和操作"></a>(3)<code>Navicat</code>连接和操作</h2><h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><p><img src="/pic/2021/12/MongoDB/MongoDB-navicat.jpg" alt="MongoDB-navicat"></p>
<h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p><img src="/pic/2021/12/MongoDB/MongoDB-navicat-插入数据.jpg" alt="MongoDB-navicat-插入数据"></p>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p><img src="/pic/2021/12/MongoDB/MongoDB-navicat-查询数据.jpg" alt="MongoDB-navicat-查询数据"></p>
<p>一些参考资料：<br>1、<a href="https://docs.mongodb.com/drivers/pymongo/">MongoDB驱动程序的应用程序</a><br>2、<a href="https://api.mongodb.com/python/3.4.0/examples/tls.html">TLS/SSL and PyMongo</a><br>3、<a href="https://docs.mongodb.com/php-library/master/tutorial/install-php-library/">安装 MongoDB PHP 库</a><br>4、<a href="https://docs.mongodb.com/drivers/php">驱动版本兼容性</a><br>5、<a href="https://www.npmjs.com/package/mongoose">mongoose模块</a><br>6、<a href="https://docs.mongodb.com/drivers/node/current/quick-start/">node.js Quick Start</a><br>7、<a href="https://pypi.org/project/pymongo/">pymongo 4.0.1</a></p>
]]></content>
      <categories>
        <category>数据库</category>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>数据库</tag>
        <tag>Python</tag>
        <tag>Mongosh</tag>
      </tags>
  </entry>
  <entry>
    <title>百度文字批量识别</title>
    <url>/2019/12/11/%E7%99%BE%E5%BA%A6%E6%96%87%E5%AD%97%E6%89%B9%E9%87%8F%E8%AF%86%E5%88%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">百度文字识别</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2020-10-12 12:47:57</span></span><br><span class="line"><span class="comment"># @Author  : Your Name (you@example.org)</span></span><br><span class="line"><span class="comment"># @Link    : http://example.org</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> aip <span class="keyword">import</span> AipOcr</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#获取开始时间</span></span><br><span class="line">start = time.time()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; 你的 APPID AK SK &quot;&quot;&quot;</span></span><br><span class="line">APP_ID = <span class="string">&#x27;百度APPID&#x27;</span></span><br><span class="line">API_KEY = <span class="string">&#x27;百度AK&#x27;</span></span><br><span class="line">SECRET_KEY = <span class="string">&#x27;百度SK&#x27;</span></span><br><span class="line"></span><br><span class="line">client = AipOcr(APP_ID, API_KEY, SECRET_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; 读取图片 &quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_file_content</span>(<span class="params">filePath</span>):</span><br><span class="line">    <span class="built_in">print</span>(filePath)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">return</span> fp.read()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; 写入文本 &quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_on_txt</span>(<span class="params">content,filePath,linefeed = <span class="string">&quot;1&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    content：要写入的内容</span></span><br><span class="line"><span class="string">    filePath：要写入文件的路径</span></span><br><span class="line"><span class="string">    linefeed ：判断是否换行</span></span><br><span class="line"><span class="string">        - 1 为不换行 </span></span><br><span class="line"><span class="string">        - 其他 为换行</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment">#只需要将之前的”w&quot;改为“a&quot;即可，代表追加内容</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filePath,<span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file.write(content)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;写入错误&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> linefeed != <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                file.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#图片路径</span></span><br><span class="line">img_path = <span class="string">r&quot;G:\Pictures\jy\test&quot;</span> <span class="comment"># 或者&quot;G:/Pictures/jy&quot;</span></span><br><span class="line"><span class="comment">#文本路径</span></span><br><span class="line">txt_path = <span class="string">r&quot;G:\Pictures\jy\OCR\图片.txt&quot;</span></span><br><span class="line"></span><br><span class="line">options = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历所有文件（使用 os.walk 方法）</span></span><br><span class="line"><span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(img_path):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="comment"># 使用join函数将文件名称和文件所在根目录连接起来</span></span><br><span class="line">        file_dir = os.path.join(root, file)</span><br><span class="line">        <span class="built_in">print</span>(file_dir)</span><br><span class="line">        write_on_txt(<span class="string">&quot;=============================&quot;</span>,txt_path,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        write_on_txt(<span class="string">&quot;文件名:&quot;</span>+ file_dir,txt_path,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="comment">#判断是否是图片</span></span><br><span class="line">        <span class="keyword">if</span> file_dir[-<span class="number">4</span>:]==<span class="string">&quot;.png&quot;</span><span class="keyword">or</span> file_dir[-<span class="number">4</span>:]==<span class="string">&quot;.JPG&quot;</span>:</span><br><span class="line">            <span class="comment">#传入图片</span></span><br><span class="line">            image = get_file_content(file_dir)</span><br><span class="line">            <span class="string">&quot;&quot;&quot; 调用通用文字识别, 图片参数为本地图片 &quot;&quot;&quot;</span></span><br><span class="line">            a = client.basicGeneral(image, options)</span><br><span class="line">            <span class="comment"># 查看返回的结果</span></span><br><span class="line">            <span class="comment"># print(a[&#x27;words_result&#x27;])</span></span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            <span class="keyword">for</span> dic <span class="keyword">in</span> a[<span class="string">&#x27;words_result&#x27;</span>]:</span><br><span class="line">                <span class="built_in">print</span>(dic[<span class="string">&#x27;words&#x27;</span>])</span><br><span class="line">                write_on_txt(dic[<span class="string">&#x27;words&#x27;</span>],txt_path,<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Running time: %1.2f Seconds&#x27;</span>%(end-start))</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Ocr</tag>
        <tag>文字识别</tag>
      </tags>
  </entry>
  <entry>
    <title>给kali系统终端命令后面添加时间戳</title>
    <url>/2022/01/06/%E7%BB%99kali%E7%B3%BB%E7%BB%9F%E7%BB%88%E7%AB%AF%E5%91%BD%E4%BB%A4%E5%90%8E%E6%B7%BB%E5%8A%A0%E6%97%B6%E9%97%B4%E6%88%B3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="修改-zshrc配置"><a href="#修改-zshrc配置" class="headerlink" title="修改.zshrc配置"></a>修改<code>.zshrc配置</code></h1><p><code>kali</code>系统终端默认采用<code>.zshrc</code>配置。<br>修改用户目录下<code>·zshrc</code>文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 修改第98行，若不是此行参照内容找寻，修改为：</span></span><br><span class="line">PROMPT=$<span class="string">&#x27;%F&#123;%(#.blue.green)&#125;┌──$&#123;debian_chroot:+($debian_chroot)─&#125;$&#123;VIRTUAL_ENV:+($(basename $VIRTUAL_ENV))─&#125;(%B%F&#123;%(#.red.blue)&#125;%n$prompt_symbol%m%b%F&#123;%(#.blue.green)&#125;)-[%B%F&#123;reset&#125;%(6~.%-1~/…/%4~.%5~)%b%F&#123;%(#.blue.green)&#125;] [$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)] \n└─%B%(#.%F&#123;red&#125;#.%F&#123;blue&#125;$)%b%F&#123;reset&#125; &#x27;</span></span><br></pre></td></tr></table></figure><br>注意 <strong><code>\n</code></strong>前面部分:<code>[$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)]</code>，即为新增内容。<br>如图：<br><img src="/pic/2022/1/zsh/timestamp.png" alt="timestamp"></p>
<h1 id="重新加载"><a href="#重新加载" class="headerlink" title="重新加载"></a>重新加载</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>效果如图：<br><img src="/pic/2022/1/zsh/timestamp-r.png" alt="timestamp"></p>
<p>当然也可以直接安装<code>oh-my-zsh</code>,简单便捷的插件来体验各种主题。</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Zsh</tag>
        <tag>Kali</tag>
      </tags>
  </entry>
  <entry>
    <title>腾讯文字批量识别</title>
    <url>/2020/11/05/%E8%85%BE%E8%AE%AF%E6%96%87%E5%AD%97%E6%89%B9%E9%87%8F%E8%AF%86%E5%88%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">腾讯文字批量识别</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2020-10-13 12:22:35</span></span><br><span class="line"><span class="comment"># @Author  : Your Name (you@example.org)</span></span><br><span class="line"><span class="comment"># @Link    : http://example.org</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common <span class="keyword">import</span> credential</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.profile.client_profile <span class="keyword">import</span> ClientProfile</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.profile.http_profile <span class="keyword">import</span> HttpProfile</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.exception.tencent_cloud_sdk_exception <span class="keyword">import</span> TencentCloudSDKException</span><br><span class="line"><span class="keyword">from</span> tencentcloud.ocr.v20181119 <span class="keyword">import</span> ocr_client, models</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">参考资料：</span></span><br><span class="line"><span class="string"> API 中心: </span></span><br><span class="line"><span class="string"> https://cloud.tencent.com/document/api/866/33517</span></span><br><span class="line"><span class="string"> API Explorer:</span></span><br><span class="line"><span class="string"> https://console.cloud.tencent.com/api/explorer?Product=ocr&amp;Version=2018-11-19&amp;Action=GeneralBasicOCR&amp;SignVersion=</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取开始时间</span></span><br><span class="line">start = time.time()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_file_content</span>(<span class="params">filePath</span>):</span><br><span class="line">    <span class="built_in">print</span>(filePath)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">return</span> fp.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_on_txt</span>(<span class="params">content,filePath,linefeed = <span class="string">&quot;1&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    content：要写入的内容</span></span><br><span class="line"><span class="string">    filePath：要写入文件的路径</span></span><br><span class="line"><span class="string">    linefeed ：判断是否换行</span></span><br><span class="line"><span class="string">        - 1 为不换行 </span></span><br><span class="line"><span class="string">        - 其他 为换行</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment">#只需要将之前的”w&quot;改为“a&quot;即可，代表追加内容</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filePath,<span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file.write(content)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;写入错误&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> linefeed != <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                file.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="comment">#图片路径</span></span><br><span class="line">image_path = <span class="string">r&quot;G:\Pictures\jy\test&quot;</span> <span class="comment"># 或者&quot;G:/Pictures/jy&quot;格式</span></span><br><span class="line"><span class="comment">#文本路径</span></span><br><span class="line">txt_path = <span class="string">r&quot;G:\Pictures\jy\OCR\图片.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(image_path):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="comment"># 使用join函数将文件名称和文件所在根目录连接起来</span></span><br><span class="line">        file_dir = os.path.join(root, file)</span><br><span class="line">        <span class="built_in">print</span>(file_dir)</span><br><span class="line">        write_on_txt(<span class="string">&quot;=============================&quot;</span>,txt_path,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        write_on_txt(<span class="string">&quot;文件名:&quot;</span>+ file_dir,txt_path,<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cred = credential.Credential(<span class="string">&quot;腾讯 api 的 id&quot;</span>, <span class="string">&quot;腾讯 api 的秘钥&quot;</span>)  </span><br><span class="line">            httpProfile = HttpProfile()</span><br><span class="line">            httpProfile.endpoint = <span class="string">&quot;ocr.ap-chengdu.tencentcloudapi.com&quot;</span>  <span class="comment">#就近地域接入（推荐，只支持非金融区），</span></span><br><span class="line">                                                              <span class="comment">#其他格式：西南地区(成都)    ocr.ap-chengdu.tencentcloudapi.com</span></span><br><span class="line"></span><br><span class="line">            clientProfile = ClientProfile()</span><br><span class="line">            clientProfile.httpProfile = httpProfile</span><br><span class="line">            client = ocr_client.OcrClient(cred, <span class="string">&quot;ap-guangzhou&quot;</span>, clientProfile) <span class="comment">#地域参数，用来标识希望操作哪个地域的数据</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_dir, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:  <span class="comment"># 以二进制读取本地图片</span></span><br><span class="line">                data = f.read()</span><br><span class="line">                encodestr = <span class="built_in">str</span>(base64.b64encode(data), <span class="string">&#x27;utf-8&#x27;</span>)  <span class="comment"># base64编码图片 </span></span><br><span class="line">                params = &#123;</span><br><span class="line">                <span class="string">&quot;ImageBase64&quot;</span>: encodestr,</span><br><span class="line">                <span class="string">&quot;LanguageType&quot;</span>: <span class="string">&quot;auto&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            req = models.GeneralBasicOCRRequest()  <span class="comment"># 通用高精度：GeneralAccurateOCR；</span></span><br><span class="line">                                                      <span class="comment"># 手写识别：GeneralHandwritingOCRRequest()</span></span><br><span class="line">            req.from_json_string(json.dumps(params))</span><br><span class="line"></span><br><span class="line">            resp = client.GeneralBasicOCR(req) </span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            <span class="keyword">for</span> text <span class="keyword">in</span> resp.TextDetections: <span class="comment"># 输出文字</span></span><br><span class="line">                <span class="built_in">print</span>(text.DetectedText)</span><br><span class="line">                write_on_txt(text.DetectedText,txt_path,<span class="string">&quot;0&quot;</span>)    </span><br><span class="line">        <span class="keyword">except</span> TencentCloudSDKException <span class="keyword">as</span> err: </span><br><span class="line">            <span class="built_in">print</span>(err) </span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Running time: %1.2f Seconds&#x27;</span>%(end-start))</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Ocr</tag>
        <tag>文字识别</tag>
      </tags>
  </entry>
  <entry>
    <title>解决&#39;sudo update-initramfs -u&#39;提示固件缺失问题</title>
    <url>/2021/10/05/%E8%A7%A3%E5%86%B3%20&#39;sudo%20update-initramfs%20-u&#39;%20%E6%8F%90%E7%A4%BA%E5%9B%BA%E4%BB%B6%E7%BC%BA%E5%A4%B1%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、问题："><a href="#1、问题：" class="headerlink" title="1、问题："></a>1、问题：</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yk@yk-pc:~$ sudo update-initramfs -u</span><br><span class="line">W: Possible missing firmware /lib/firmware/rtl_nic/rtl8105e-1.fw <span class="keyword">for</span> module r816</span><br><span class="line">9</span><br><span class="line">W: Possible missing firmware /lib/firmware/rtl_nic/rtl8168e-3.fw <span class="keyword">for</span> module r816</span><br><span class="line">9</span><br><span class="line">W: Possible missing firmware /lib/firmware/i915/tgl_dmc_ver2_08.bin <span class="keyword">for</span> module i915</span><br><span class="line">W: Possible missing firmware /lib/firmware/i915/rkl_dmc_ver2_02.bin <span class="keyword">for</span> module i915</span><br></pre></td></tr></table></figure>
<h1 id="2、解决"><a href="#2、解决" class="headerlink" title="2、解决"></a>2、解决</h1><p>[先进入缺失文件的文件夹]或者在<code>wget</code>后加 <code>-P+路径</code>，如： <code>wget -P /lib/firmware/rtl_nic https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8107e-2.fw</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yk@yk-pc:/lib/firmware/rtl_nic$ sudo wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8107e-2.fw</span><br><span class="line"></span><br><span class="line">yk@yk-pc:/lib/firmware/i915$ sudo wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/bxt_guc_33.0.0.bin</span><br></pre></td></tr></table></figure><br>3、批量下载<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -i list.txt</span><br></pre></td></tr></table></figure><br>把所有需要下载文件的地址放到 <code>list.txt</code> 中</p>
<p>如：<br>(1)<code>firmware_i915.txt</code>内容如下：<br><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/skl_huc_2.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/skl_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/bxt_huc_2.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/bxt_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/kbl_huc_4.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/kbl_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/glk_huc_4.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/glk_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/kbl_huc_4.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/kbl_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/cml_huc_4.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/cml_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/icl_huc_9.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/icl_guc_33.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/ehl_huc_9.0.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/ehl_guc_33.0.4.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/tgl_huc_7.5.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/tgl_guc_35.2.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/tgl_huc_7.5.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/tgl_guc_35.2.0.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/bxt_dmc_ver1_07.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/skl_dmc_ver1_27.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/kbl_dmc_ver1_04.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/glk_dmc_ver1_04.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/cnl_dmc_ver1_07.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/icl_dmc_ver1_09.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/tgl_dmc_ver2_08.bin</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/i915/rkl_dmc_ver2_02.bin</span><br></pre></td></tr></table></figure><br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo wget -P /lib/firmware/i915/ -i /path/to/firmware_i915.txt</span><br></pre></td></tr></table></figure><br>(2)<code>firmware_rtl_nic.txt</code>文件内容如下：<br><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8125b-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8125a-3.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8107e-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8107e-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168fp-3.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168h-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168h-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168g-3.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168g-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8106e-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8106e-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8411-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8411-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8402-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168f-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168f-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8105e-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168e-3.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168e-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168e-1.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168d-2.fw</span><br><span class="line">https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/rtl_nic/rtl8168d-1.fw</span><br></pre></td></tr></table></figure><br>输入命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo wget -P /lib/firmware/rtl_nic/ -i /path/to/firmware_rtl_nic.txt</span><br></pre></td></tr></table></figure></p>
<p>部分参数含义：</p>
<p><code>-P 表示下载到哪个目录</code><br><code>-r 表示递归下载</code><br><code>-np 表示不下载旁站连接</code>.<br><code>-k 表示将下载的网页里的链接修改为本地链接.</code><br><code>-p 获得所有显示网页所需的元素</code></p>
<p>参考：<br><a href="https://www.cnblogs.com/ftl1012/p/9265699.html">Linux wget命令详解</a></p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>运维</category>
        <category>Update</category>
      </categories>
      <tags>
        <tag>更新</tag>
        <tag>固件缺失</tag>
      </tags>
  </entry>
  <entry>
    <title>systemctl管理方式下设置aria2开机启动</title>
    <url>/2021/06/22/Systemctl%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F%E4%B8%8B%E8%AE%BE%E7%BD%AEaria2%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1、aria2开机启动文件配置aria2-service"><a href="#1、aria2开机启动文件配置aria2-service" class="headerlink" title="1、aria2开机启动文件配置aria2.service"></a>1、<code>aria2</code>开机启动文件配置<code>aria2.service</code></h1><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo nano /usr/lib/systemd/system/aria2.service</span><br></pre></td></tr></table></figure><br>输入以下内容：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Aria2 Service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/bin/aria2c --conf-path=/etc/aria2/aria2.conf</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=default.target</span><br></pre></td></tr></table></figure><br>写入<code>ctrl+o</code>，保存 <code>Enter</code>，退出<code>ctrl+x</code><br>拷贝到<code>/etc/systemd/user</code> 目录下<br>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo <span class="built_in">cp</span> /usr/lib/systemd/system/aria2.service /etc/systemd/system</span><br></pre></td></tr></table></figure></p>
<h1 id="2-设置开机启动"><a href="#2-设置开机启动" class="headerlink" title="2.设置开机启动"></a>2.设置开机启动</h1><p>命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ systemctl <span class="built_in">enable</span> aria2.service</span><br></pre></td></tr></table></figure><br>提示<code>Created symlink /etc/systemd/system/default.target.wants/aria2.service → /etc/systemd/system/aria2.service.</code>设置成功<br>重新加载服务配置：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload  <span class="comment"># 重新加载服务配置文件</span></span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/P3TERX/aria2.conf">一键安装及配置开源项目：</a></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>软件应用</category>
        <category>Linux</category>
        <category>Aria2</category>
        <category>运维</category>
      </categories>
      <tags>
        <tag>Aria2</tag>
        <tag>Systemctl</tag>
        <tag>启动服务</tag>
      </tags>
  </entry>
  <entry>
    <title>Python将同类型文件名写入文件</title>
    <url>/2022/05/07/Python%E5%B0%86%E5%90%8C%E7%B1%BB%E5%9E%8B%E6%96%87%E4%BB%B6%E5%90%8D%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码如下：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名</span></span><br><span class="line"><span class="comment"># filePath = &quot;/path/to/视频/波士顿机器人/&quot;</span></span><br><span class="line"><span class="comment"># file_list = sorted(os.listdir(filePath))</span></span><br><span class="line"><span class="comment"># file_name = []</span></span><br><span class="line"><span class="comment"># for i in file_list:</span></span><br><span class="line"><span class="comment"># 	f = os.path.splitext(i)</span></span><br><span class="line"><span class="comment"># 	if f[1] == &quot;.ts&quot;:  # 筛选ts文件</span></span><br><span class="line"><span class="comment"># 		newName = f[0] + &#x27;.m4s&#x27; # 给原文件赋予新的后缀名</span></span><br><span class="line"><span class="comment"># 		os.rename(</span></span><br><span class="line"><span class="comment"># 			os.path.join(filePath, i), # 保持原文件路径不变</span></span><br><span class="line"><span class="comment"># 			os.path.join(filePath, newName)) # 重命名</span></span><br><span class="line"><span class="comment"># 	print(i + &quot;完成！&quot;)</span></span><br><span class="line"><span class="comment"># print(&#x27;全部完成！&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加到文件列表</span></span><br><span class="line">filePath = <span class="string">&quot;/path/to/视频/波士顿机器人/&quot;</span></span><br><span class="line">file_list = sorted(os.listdir(filePath))</span><br><span class="line">file_name = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> file_list:</span><br><span class="line">	<span class="keyword">if</span> os.path.splitext(i)[1] == <span class="string">&quot;.m4s&quot;</span>:  <span class="comment"># 筛选ts文件</span></span><br><span class="line">		file_name.append(i)</span><br><span class="line">		with open(<span class="string">&quot;/path/to/视频/波士顿机器人/file_list.txt&quot;</span>,<span class="string">&quot;w+&quot;</span>) as f:</span><br><span class="line">		    <span class="keyword">for</span> file <span class="keyword">in</span> file_name:</span><br><span class="line">		        f.write(<span class="string">&quot;file &#x27;&#123;&#125;&#x27;\n&quot;</span>.format(file))</span><br><span class="line">		<span class="built_in">print</span>(i + <span class="string">&quot;已经添加！&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;全部完成！&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>重命名</tag>
      </tags>
  </entry>
  <entry>
    <title>python读取xml文件</title>
    <url>/2022/04/25/Python%E8%AF%BB%E5%8F%96xml%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>具体代码如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> minidom</span><br><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> Node</span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">xmlPath = <span class="string">&#x27;path/to/xxxxx.xml&#x27;</span></span><br><span class="line"><span class="comment">### dom 方法 ###</span></span><br><span class="line">dom = minidom.parse(xmlPath) <span class="comment"># 打开xml文件</span></span><br><span class="line">root=dom.documentElement  <span class="comment"># 得到文档元素对象</span></span><br><span class="line">itemLists = root.getElementsByTagName(<span class="string">&#x27;Row&#x27;</span>) <span class="comment"># 获取XML节点对象集合</span></span><br><span class="line">listInfos = []</span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> itemLists:</span><br><span class="line">	<span class="comment"># print(child, child.nodeType, Node.ELEMENT_NODE)</span></span><br><span class="line">	<span class="keyword">if</span> child.nodeType == Node.ELEMENT_NODE:  <span class="comment"># 元素节点的nodeType属性值是1.</span></span><br><span class="line">		dictAttr = &#123;&#125;</span><br><span class="line">		<span class="keyword">for</span> key <span class="keyword">in</span> child.attributes.keys():</span><br><span class="line">			attr = child.attributes[key]</span><br><span class="line">			dictAttr[attr.name] = attr.value</span><br><span class="line">	listInfos.append(dictAttr)  <span class="comment"># 将数据添加到字典</span></span><br><span class="line">v = []</span><br><span class="line"><span class="keyword">for</span> index, each <span class="keyword">in</span> <span class="built_in">enumerate</span>(listInfos):</span><br><span class="line">	v.append(each[<span class="string">&#x27;发票号码&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(v)</span><br><span class="line"></span><br><span class="line"><span class="comment">### etree 方法 ###</span></span><br><span class="line">tree =  ET.parse(xmlPath)  <span class="comment"># 获取解析对象</span></span><br><span class="line">root = tree.getroot()  <span class="comment"># 获取根节点名称 类似dom中root.nodeName</span></span><br><span class="line">v = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> root: <span class="comment"># 遍历 xml 文档</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">		v.append(j.attrib[<span class="string">&#x27;发票号码&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(v)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>程序语言</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Xml</tag>
      </tags>
  </entry>
</search>
